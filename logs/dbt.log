2021-05-12 00:04:25.702517 (MainThread): Running with dbt=0.19.1
2021-05-12 00:04:26.084482 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-12 00:04:26.086419 (MainThread): Tracking: tracking
2021-05-12 00:04:26.094606 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FE5BCC9C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FE5BD3A08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FE5BD6188>]}
2021-05-12 00:04:26.105500 (MainThread): Partial parsing not enabled
2021-05-12 00:04:26.109445 (MainThread): Parsing macros\adapters.sql
2021-05-12 00:04:26.131372 (MainThread): Parsing macros\catalog.sql
2021-05-12 00:04:26.140355 (MainThread): Parsing macros\etc.sql
2021-05-12 00:04:26.143332 (MainThread): Parsing macros\materializations\copy.sql
2021-05-12 00:04:26.149313 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-12 00:04:26.163266 (MainThread): Parsing macros\materializations\seed.sql
2021-05-12 00:04:26.166256 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-12 00:04:26.169246 (MainThread): Parsing macros\materializations\table.sql
2021-05-12 00:04:26.182202 (MainThread): Parsing macros\materializations\view.sql
2021-05-12 00:04:26.190177 (MainThread): Parsing macros\core.sql
2021-05-12 00:04:26.195159 (MainThread): Parsing macros\adapters\common.sql
2021-05-12 00:04:26.248013 (MainThread): Parsing macros\etc\datetime.sql
2021-05-12 00:04:26.259458 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-12 00:04:26.260462 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-12 00:04:26.262940 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-12 00:04:26.264935 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-12 00:04:26.265932 (MainThread): Parsing macros\etc\query.sql
2021-05-12 00:04:26.266929 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-12 00:04:26.279885 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-12 00:04:26.296829 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-12 00:04:26.298822 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-12 00:04:26.306795 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-12 00:04:26.330482 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-12 00:04:26.367361 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-12 00:04:26.372355 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-12 00:04:26.393923 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-12 00:04:26.400903 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-12 00:04:26.408919 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-12 00:04:26.415854 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-12 00:04:26.418885 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-12 00:04:26.423892 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-12 00:04:26.426859 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-12 00:04:26.433840 (MainThread): Partial parsing not enabled
2021-05-12 00:04:26.461748 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-12 00:04:26.549569 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-12 00:04:26.551514 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0522e6a0-e833-463e-b5c2-388267e16bd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FE95E51C8>]}
2021-05-12 00:04:26.562942 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0522e6a0-e833-463e-b5c2-388267e16bd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FE9775FC8>]}
2021-05-12 00:04:26.562942 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-12 00:04:26.565531 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2021-05-12 00:04:26.566775 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FE5C4F4C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FE9775D88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FE9775AC8>]}
2021-05-12 00:04:26.566775 (MainThread): Flushing usage events
2021-05-12 00:04:27.390241 (MainThread): Connection 'model.northwind_shop.stg_products' was properly closed.
2021-05-12 00:05:11.547728 (MainThread): Running with dbt=0.19.1
2021-05-12 00:05:11.928863 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-12 00:05:11.929896 (MainThread): Tracking: tracking
2021-05-12 00:05:11.929896 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0E8842988>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0E8842AC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0E88460C8>]}
2021-05-12 00:05:11.938878 (MainThread): Partial parsing not enabled
2021-05-12 00:05:11.940865 (MainThread): Parsing macros\adapters.sql
2021-05-12 00:05:11.963798 (MainThread): Parsing macros\catalog.sql
2021-05-12 00:05:11.969770 (MainThread): Parsing macros\etc.sql
2021-05-12 00:05:11.971767 (MainThread): Parsing macros\materializations\copy.sql
2021-05-12 00:05:11.978718 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-12 00:05:11.993654 (MainThread): Parsing macros\materializations\seed.sql
2021-05-12 00:05:11.997670 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-12 00:05:11.999660 (MainThread): Parsing macros\materializations\table.sql
2021-05-12 00:05:12.011584 (MainThread): Parsing macros\materializations\view.sql
2021-05-12 00:05:12.018596 (MainThread): Parsing macros\core.sql
2021-05-12 00:05:12.022587 (MainThread): Parsing macros\adapters\common.sql
2021-05-12 00:05:12.070434 (MainThread): Parsing macros\etc\datetime.sql
2021-05-12 00:05:12.081405 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-12 00:05:12.082395 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-12 00:05:12.084385 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-12 00:05:12.085378 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-12 00:05:12.087379 (MainThread): Parsing macros\etc\query.sql
2021-05-12 00:05:12.088381 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-12 00:05:12.100341 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-12 00:05:12.116279 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-12 00:05:12.119255 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-12 00:05:12.128195 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-12 00:05:12.152161 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-12 00:05:12.188047 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-12 00:05:12.190034 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-12 00:05:12.210960 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-12 00:05:12.217931 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-12 00:05:12.223906 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-12 00:05:12.232840 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-12 00:05:12.235831 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-12 00:05:12.236827 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-12 00:05:12.238821 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-12 00:05:12.248835 (MainThread): Partial parsing not enabled
2021-05-12 00:05:12.272745 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-12 00:05:12.370446 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-12 00:05:12.373218 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6fb5340-e880-4f77-b56f-63ecfdad9578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0EC3455C8>]}
2021-05-12 00:05:12.383186 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6fb5340-e880-4f77-b56f-63ecfdad9578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0EC21F448>]}
2021-05-12 00:05:12.383186 (MainThread): Found 1 model, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-05-12 00:05:12.385174 (MainThread): 
2021-05-12 00:05:12.386171 (MainThread): Acquiring new bigquery connection "master".
2021-05-12 00:05:12.388165 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-12 00:05:12.388165 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-12 00:05:13.532439 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "create_northwind1-313400_dbt_arthur".
2021-05-12 00:05:13.533434 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "create_northwind1-313400_dbt_arthur".
2021-05-12 00:05:13.533434 (ThreadPoolExecutor-0_0): Creating schema "northwind1-313400.dbt_arthur".
2021-05-12 00:05:13.533434 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-05-12 00:05:13.541036 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-12 00:05:14.940244 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-12 00:05:14.941244 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-12 00:05:14.949248 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-12 00:05:15.528106 (MainThread): 21:05:15 | Concurrency: 1 threads (target='dev')
2021-05-12 00:05:15.529112 (MainThread): 21:05:15 | 
2021-05-12 00:05:15.548471 (Thread-1): Began running node model.northwind_shop.stg_products
2021-05-12 00:05:15.548471 (Thread-1): 21:05:15 | 1 of 1 START view model dbt_arthur.stg_products...................... [RUN]
2021-05-12 00:05:15.549287 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-12 00:05:15.549287 (Thread-1): Compiling model.northwind_shop.stg_products
2021-05-12 00:05:15.551320 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_products"
2021-05-12 00:05:15.554311 (Thread-1): finished collecting timing info
2021-05-12 00:05:15.597174 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_products"
2021-05-12 00:05:15.599122 (Thread-1): Opening a new connection, currently in state init
2021-05-12 00:05:15.604156 (Thread-1): On model.northwind_shop.stg_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_products`
  OPTIONS()
  as with
    source as (
        select * from
        `northwind1-313400`.`northwind_erp`.`products`
    )
select * from source;


2021-05-12 00:05:17.130177 (Thread-1): Unhandled error while running:
/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_products`
  OPTIONS()
  as with
    source as (
        select * from
        `northwind1-313400`.`northwind_erp`.`products`
    )
select * from source;


2021-05-12 00:05:17.131174 (Thread-1): 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/e7c36cd0-1a73-4e3c-af05-8cca5a3292dc?maxResults=0&location=US&prettyPrint=false: Not found: Dataset northwind1-313400:northwind_erp was not found in location US

(job ID: e7c36cd0-1a73-4e3c-af05-8cca5a3292dc)

                                                             -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */
   2:
   3:
   4:  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_products`
   5:  OPTIONS()
   6:  as with
   7:    source as (
   8:        select * from
   9:        `northwind1-313400`.`northwind_erp`.`products`
  10:    )
  11:select * from source;
  12:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
2021-05-12 00:05:17.131174 (Thread-1): finished collecting timing info
2021-05-12 00:05:17.132171 (Thread-1): Runtime Error in model stg_products (models\staging\stg_products.sql)
  404 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/e7c36cd0-1a73-4e3c-af05-8cca5a3292dc?maxResults=0&location=US&prettyPrint=false: Not found: Dataset northwind1-313400:northwind_erp was not found in location US
  
  (job ID: e7c36cd0-1a73-4e3c-af05-8cca5a3292dc)
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.NotFound: 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/e7c36cd0-1a73-4e3c-af05-8cca5a3292dc?maxResults=0&location=US&prettyPrint=false: Not found: Dataset northwind1-313400:northwind_erp was not found in location US

(job ID: e7c36cd0-1a73-4e3c-af05-8cca5a3292dc)

                                                             -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */
   2:
   3:
   4:  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_products`
   5:  OPTIONS()
   6:  as with
   7:    source as (
   8:        select * from
   9:        `northwind1-313400`.`northwind_erp`.`products`
  10:    )
  11:select * from source;
  12:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 181, in exception_handler
    raise RuntimeException(exc_message)
dbt.exceptions.RuntimeException: Runtime Error in model stg_products (models\staging\stg_products.sql)
  404 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/e7c36cd0-1a73-4e3c-af05-8cca5a3292dc?maxResults=0&location=US&prettyPrint=false: Not found: Dataset northwind1-313400:northwind_erp was not found in location US
  
  (job ID: e7c36cd0-1a73-4e3c-af05-8cca5a3292dc)
2021-05-12 00:05:17.159964 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6fb5340-e880-4f77-b56f-63ecfdad9578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0EC1F8C48>]}
2021-05-12 00:05:17.159964 (Thread-1): 21:05:17 | 1 of 1 ERROR creating view model dbt_arthur.stg_products............. [ERROR in 1.61s]
2021-05-12 00:05:17.161843 (Thread-1): Finished running node model.northwind_shop.stg_products
2021-05-12 00:05:17.176912 (MainThread): Acquiring new bigquery connection "master".
2021-05-12 00:05:17.176912 (MainThread): 21:05:17 | 
2021-05-12 00:05:17.177908 (MainThread): 21:05:17 | Finished running 1 view model in 4.79s.
2021-05-12 00:05:17.177908 (MainThread): Connection 'master' was properly closed.
2021-05-12 00:05:17.178903 (MainThread): Connection 'create_northwind1-313400_dbt_arthur' was properly closed.
2021-05-12 00:05:17.178903 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-12 00:05:17.178903 (MainThread): Connection 'model.northwind_shop.stg_products' was properly closed.
2021-05-12 00:05:17.179913 (MainThread): unclosed <socket.socket fd=948, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 64894), raddr=('142.250.219.10', 443)>
2021-05-12 00:05:17.180897 (MainThread): unclosed <socket.socket fd=900, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 64893), raddr=('172.217.30.170', 443)>
2021-05-12 00:05:17.180897 (MainThread): unclosed <socket.socket fd=440, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 64898), raddr=('172.217.30.170', 443)>
2021-05-12 00:05:17.180897 (MainThread): unclosed <socket.socket fd=1188, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 64897), raddr=('142.250.219.10', 443)>
2021-05-12 00:05:17.180897 (MainThread): unclosed <socket.socket fd=984, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 64896), raddr=('172.217.30.170', 443)>
2021-05-12 00:05:17.180897 (MainThread): unclosed <socket.socket fd=1244, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 64899), raddr=('142.250.219.10', 443)>
2021-05-12 00:05:17.181922 (MainThread): unclosed <socket.socket fd=992, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 64900), raddr=('172.217.30.170', 443)>
2021-05-12 00:05:17.181922 (MainThread): unclosed <socket.socket fd=1308, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 64901), raddr=('142.250.219.10', 443)>
2021-05-12 00:05:17.189872 (MainThread): 
2021-05-12 00:05:17.191862 (MainThread): Completed with 1 error and 0 warnings:
2021-05-12 00:05:17.192859 (MainThread): 
2021-05-12 00:05:17.193856 (MainThread): Runtime Error in model stg_products (models\staging\stg_products.sql)
2021-05-12 00:05:17.194850 (MainThread):   404 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/e7c36cd0-1a73-4e3c-af05-8cca5a3292dc?maxResults=0&location=US&prettyPrint=false: Not found: Dataset northwind1-313400:northwind_erp was not found in location US
2021-05-12 00:05:17.196113 (MainThread):   
2021-05-12 00:05:17.196113 (MainThread):   (job ID: e7c36cd0-1a73-4e3c-af05-8cca5a3292dc)
2021-05-12 00:05:17.197417 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-12 00:05:17.199111 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0EC1F8188>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0EC265B48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0EC4855C8>]}
2021-05-12 00:05:17.199111 (MainThread): Flushing usage events
2021-05-12 00:48:20.896101 (MainThread): Running with dbt=0.19.1
2021-05-12 00:48:21.455021 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-12 00:48:21.457022 (MainThread): Tracking: tracking
2021-05-12 00:48:21.459008 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2218C2988>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2218C2AC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2218C60C8>]}
2021-05-12 00:48:21.468831 (MainThread): Partial parsing not enabled
2021-05-12 00:48:21.470826 (MainThread): Parsing macros\adapters.sql
2021-05-12 00:48:21.493217 (MainThread): Parsing macros\catalog.sql
2021-05-12 00:48:21.499196 (MainThread): Parsing macros\etc.sql
2021-05-12 00:48:21.501918 (MainThread): Parsing macros\materializations\copy.sql
2021-05-12 00:48:21.508897 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-12 00:48:21.520856 (MainThread): Parsing macros\materializations\seed.sql
2021-05-12 00:48:21.526837 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-12 00:48:21.529827 (MainThread): Parsing macros\materializations\table.sql
2021-05-12 00:48:21.540794 (MainThread): Parsing macros\materializations\view.sql
2021-05-12 00:48:21.549703 (MainThread): Parsing macros\core.sql
2021-05-12 00:48:21.553692 (MainThread): Parsing macros\adapters\common.sql
2021-05-12 00:48:21.601531 (MainThread): Parsing macros\etc\datetime.sql
2021-05-12 00:48:21.613491 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-12 00:48:21.615124 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-12 00:48:21.617038 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-12 00:48:21.619032 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-12 00:48:21.620029 (MainThread): Parsing macros\etc\query.sql
2021-05-12 00:48:21.623021 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-12 00:48:21.634062 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-12 00:48:21.650057 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-12 00:48:21.652056 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-12 00:48:21.661230 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-12 00:48:21.683159 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-12 00:48:21.720036 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-12 00:48:21.722994 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-12 00:48:21.746417 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-12 00:48:21.753317 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-12 00:48:21.761670 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-12 00:48:21.767652 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-12 00:48:21.770642 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-12 00:48:21.774631 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-12 00:48:21.777618 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-12 00:48:21.783598 (MainThread): Partial parsing not enabled
2021-05-12 00:48:21.808522 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-12 00:48:21.900118 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-12 00:48:21.903109 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea11b089-64dd-4772-86b5-1659b68ba846', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A22536C148>]}
2021-05-12 00:48:21.912080 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea11b089-64dd-4772-86b5-1659b68ba846', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A22530D748>]}
2021-05-12 00:48:21.913084 (MainThread): Found 1 model, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-05-12 00:48:21.914076 (MainThread): 
2021-05-12 00:48:21.914076 (MainThread): Acquiring new bigquery connection "master".
2021-05-12 00:48:21.916067 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-12 00:48:21.916067 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-12 00:48:23.210054 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-12 00:48:23.210054 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-12 00:48:23.217078 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-12 00:48:24.319284 (MainThread): 21:48:24 | Concurrency: 1 threads (target='dev')
2021-05-12 00:48:24.321330 (MainThread): 21:48:24 | 
2021-05-12 00:48:24.328266 (Thread-1): Began running node model.northwind_shop.stg_products
2021-05-12 00:48:24.328266 (Thread-1): 21:48:24 | 1 of 1 START view model dbt_arthur.stg_products...................... [RUN]
2021-05-12 00:48:24.330236 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-12 00:48:24.330338 (Thread-1): Compiling model.northwind_shop.stg_products
2021-05-12 00:48:24.334060 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_products"
2021-05-12 00:48:24.334810 (Thread-1): finished collecting timing info
2021-05-12 00:48:24.378153 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_products"
2021-05-12 00:48:24.379467 (Thread-1): Opening a new connection, currently in state init
2021-05-12 00:48:24.383458 (Thread-1): On model.northwind_shop.stg_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_products`
  OPTIONS()
  as with
    source as (
        select * from
        `northwind1-313400`.`northwind_erp`.`products`
    )
select * from source;


2021-05-12 00:48:25.484527 (Thread-1): Unhandled error while running:
/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_products`
  OPTIONS()
  as with
    source as (
        select * from
        `northwind1-313400`.`northwind_erp`.`products`
    )
select * from source;


2021-05-12 00:48:25.484527 (Thread-1): 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/7bd45f98-ebf8-4fc0-b2d5-9d186e448c4e?maxResults=0&location=US&prettyPrint=false: Not found: Dataset northwind1-313400:northwind_erp was not found in location US

(job ID: 7bd45f98-ebf8-4fc0-b2d5-9d186e448c4e)

                                                             -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */
   2:
   3:
   4:  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_products`
   5:  OPTIONS()
   6:  as with
   7:    source as (
   8:        select * from
   9:        `northwind1-313400`.`northwind_erp`.`products`
  10:    )
  11:select * from source;
  12:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
2021-05-12 00:48:25.484527 (Thread-1): finished collecting timing info
2021-05-12 00:48:25.485525 (Thread-1): Runtime Error in model stg_products (models\staging\stg_products.sql)
  404 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/7bd45f98-ebf8-4fc0-b2d5-9d186e448c4e?maxResults=0&location=US&prettyPrint=false: Not found: Dataset northwind1-313400:northwind_erp was not found in location US
  
  (job ID: 7bd45f98-ebf8-4fc0-b2d5-9d186e448c4e)
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.NotFound: 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/7bd45f98-ebf8-4fc0-b2d5-9d186e448c4e?maxResults=0&location=US&prettyPrint=false: Not found: Dataset northwind1-313400:northwind_erp was not found in location US

(job ID: 7bd45f98-ebf8-4fc0-b2d5-9d186e448c4e)

                                                             -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */
   2:
   3:
   4:  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_products`
   5:  OPTIONS()
   6:  as with
   7:    source as (
   8:        select * from
   9:        `northwind1-313400`.`northwind_erp`.`products`
  10:    )
  11:select * from source;
  12:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 181, in exception_handler
    raise RuntimeException(exc_message)
dbt.exceptions.RuntimeException: Runtime Error in model stg_products (models\staging\stg_products.sql)
  404 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/7bd45f98-ebf8-4fc0-b2d5-9d186e448c4e?maxResults=0&location=US&prettyPrint=false: Not found: Dataset northwind1-313400:northwind_erp was not found in location US
  
  (job ID: 7bd45f98-ebf8-4fc0-b2d5-9d186e448c4e)
2021-05-12 00:48:25.513735 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea11b089-64dd-4772-86b5-1659b68ba846', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2253CC208>]}
2021-05-12 00:48:25.513735 (Thread-1): 21:48:25 | 1 of 1 ERROR creating view model dbt_arthur.stg_products............. [ERROR in 1.18s]
2021-05-12 00:48:25.515755 (Thread-1): Finished running node model.northwind_shop.stg_products
2021-05-12 00:48:25.526585 (MainThread): Acquiring new bigquery connection "master".
2021-05-12 00:48:25.527117 (MainThread): 21:48:25 | 
2021-05-12 00:48:25.528143 (MainThread): 21:48:25 | Finished running 1 view model in 3.61s.
2021-05-12 00:48:25.528143 (MainThread): Connection 'master' was properly closed.
2021-05-12 00:48:25.528902 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-12 00:48:25.528902 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-12 00:48:25.528902 (MainThread): Connection 'model.northwind_shop.stg_products' was properly closed.
2021-05-12 00:48:25.530468 (MainThread): unclosed <socket.socket fd=396, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 50940), raddr=('142.250.219.10', 443)>
2021-05-12 00:48:25.530468 (MainThread): unclosed <socket.socket fd=776, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 50939), raddr=('142.250.218.202', 443)>
2021-05-12 00:48:25.531494 (MainThread): unclosed <socket.socket fd=708, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 50942), raddr=('142.250.219.10', 443)>
2021-05-12 00:48:25.531494 (MainThread): unclosed <socket.socket fd=1000, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 50941), raddr=('142.250.218.202', 443)>
2021-05-12 00:48:25.531494 (MainThread): unclosed <socket.socket fd=1116, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 50943), raddr=('142.250.218.202', 443)>
2021-05-12 00:48:25.532491 (MainThread): unclosed <socket.socket fd=1128, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 50944), raddr=('142.250.219.10', 443)>
2021-05-12 00:48:25.541431 (MainThread): 
2021-05-12 00:48:25.541431 (MainThread): Completed with 1 error and 0 warnings:
2021-05-12 00:48:25.543422 (MainThread): 
2021-05-12 00:48:25.544418 (MainThread): Runtime Error in model stg_products (models\staging\stg_products.sql)
2021-05-12 00:48:25.545435 (MainThread):   404 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/7bd45f98-ebf8-4fc0-b2d5-9d186e448c4e?maxResults=0&location=US&prettyPrint=false: Not found: Dataset northwind1-313400:northwind_erp was not found in location US
2021-05-12 00:48:25.546412 (MainThread):   
2021-05-12 00:48:25.546412 (MainThread):   (job ID: 7bd45f98-ebf8-4fc0-b2d5-9d186e448c4e)
2021-05-12 00:48:25.547408 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-12 00:48:25.548406 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2255D8B08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2255F1048>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2255F1708>]}
2021-05-12 00:48:25.548406 (MainThread): Flushing usage events
2021-05-12 00:52:41.894123 (MainThread): Running with dbt=0.19.1
2021-05-12 00:52:42.233185 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-12 00:52:42.234183 (MainThread): Tracking: tracking
2021-05-12 00:52:42.235207 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027358172A88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027358172548>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027358176188>]}
2021-05-12 00:52:42.245144 (MainThread): Partial parsing not enabled
2021-05-12 00:52:42.247138 (MainThread): Parsing macros\adapters.sql
2021-05-12 00:52:42.267081 (MainThread): Parsing macros\catalog.sql
2021-05-12 00:52:42.274070 (MainThread): Parsing macros\etc.sql
2021-05-12 00:52:42.276041 (MainThread): Parsing macros\materializations\copy.sql
2021-05-12 00:52:42.281030 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-12 00:52:42.292985 (MainThread): Parsing macros\materializations\seed.sql
2021-05-12 00:52:42.295974 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-12 00:52:42.297968 (MainThread): Parsing macros\materializations\table.sql
2021-05-12 00:52:42.309930 (MainThread): Parsing macros\materializations\view.sql
2021-05-12 00:52:42.315909 (MainThread): Parsing macros\core.sql
2021-05-12 00:52:42.319895 (MainThread): Parsing macros\adapters\common.sql
2021-05-12 00:52:42.362764 (MainThread): Parsing macros\etc\datetime.sql
2021-05-12 00:52:42.373840 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-12 00:52:42.374796 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-12 00:52:42.377279 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-12 00:52:42.379260 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-12 00:52:42.380834 (MainThread): Parsing macros\etc\query.sql
2021-05-12 00:52:42.381762 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-12 00:52:42.391735 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-12 00:52:42.406698 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-12 00:52:42.408692 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-12 00:52:42.414676 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-12 00:52:42.438713 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-12 00:52:42.474626 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-12 00:52:42.476605 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-12 00:52:42.495675 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-12 00:52:42.504683 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-12 00:52:42.509666 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-12 00:52:42.519138 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-12 00:52:42.522068 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-12 00:52:42.524132 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-12 00:52:42.527595 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-12 00:52:42.535752 (MainThread): Partial parsing not enabled
2021-05-12 00:52:42.561136 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-12 00:52:42.647998 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-12 00:52:42.650121 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6cfe04d1-1013-444a-bdcd-6ff95ec6d4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002735BCF60C8>]}
2021-05-12 00:52:42.655688 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6cfe04d1-1013-444a-bdcd-6ff95ec6d4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002735BC351C8>]}
2021-05-12 00:52:42.655688 (MainThread): Found 1 model, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-05-12 00:52:42.657524 (MainThread): 
2021-05-12 00:52:42.658526 (MainThread): Acquiring new bigquery connection "master".
2021-05-12 00:52:42.659524 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-12 00:52:42.660521 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-12 00:52:43.803072 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-12 00:52:43.803072 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-12 00:52:43.809063 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-12 00:52:44.913941 (MainThread): 21:52:44 | Concurrency: 1 threads (target='dev')
2021-05-12 00:52:44.914897 (MainThread): 21:52:44 | 
2021-05-12 00:52:44.917932 (Thread-1): Began running node model.northwind_shop.stg_products
2021-05-12 00:52:44.917932 (Thread-1): 21:52:44 | 1 of 1 START view model dbt_arthur.stg_products...................... [RUN]
2021-05-12 00:52:44.918887 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-12 00:52:44.918887 (Thread-1): Compiling model.northwind_shop.stg_products
2021-05-12 00:52:44.920877 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_products"
2021-05-12 00:52:44.921873 (Thread-1): finished collecting timing info
2021-05-12 00:52:44.955759 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_products"
2021-05-12 00:52:44.956756 (Thread-1): Opening a new connection, currently in state init
2021-05-12 00:52:44.961738 (Thread-1): On model.northwind_shop.stg_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_products`
  OPTIONS()
  as with
    source as (
        select * from
        `northwind1-313400`.`northwind_erp`.`products`
    )
select * from source;


2021-05-12 00:52:46.048783 (Thread-1): Unhandled error while running:
/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_products`
  OPTIONS()
  as with
    source as (
        select * from
        `northwind1-313400`.`northwind_erp`.`products`
    )
select * from source;


2021-05-12 00:52:46.049774 (Thread-1): 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/fe998f6c-21eb-4e7c-ada4-44fb91dc3fc3?maxResults=0&location=US&prettyPrint=false: Not found: Dataset northwind1-313400:northwind_erp was not found in location US

(job ID: fe998f6c-21eb-4e7c-ada4-44fb91dc3fc3)

                                                             -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */
   2:
   3:
   4:  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_products`
   5:  OPTIONS()
   6:  as with
   7:    source as (
   8:        select * from
   9:        `northwind1-313400`.`northwind_erp`.`products`
  10:    )
  11:select * from source;
  12:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
2021-05-12 00:52:46.049774 (Thread-1): finished collecting timing info
2021-05-12 00:52:46.050777 (Thread-1): Runtime Error in model stg_products (models\staging\stg_products.sql)
  404 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/fe998f6c-21eb-4e7c-ada4-44fb91dc3fc3?maxResults=0&location=US&prettyPrint=false: Not found: Dataset northwind1-313400:northwind_erp was not found in location US
  
  (job ID: fe998f6c-21eb-4e7c-ada4-44fb91dc3fc3)
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.NotFound: 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/fe998f6c-21eb-4e7c-ada4-44fb91dc3fc3?maxResults=0&location=US&prettyPrint=false: Not found: Dataset northwind1-313400:northwind_erp was not found in location US

(job ID: fe998f6c-21eb-4e7c-ada4-44fb91dc3fc3)

                                                             -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */
   2:
   3:
   4:  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_products`
   5:  OPTIONS()
   6:  as with
   7:    source as (
   8:        select * from
   9:        `northwind1-313400`.`northwind_erp`.`products`
  10:    )
  11:select * from source;
  12:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 181, in exception_handler
    raise RuntimeException(exc_message)
dbt.exceptions.RuntimeException: Runtime Error in model stg_products (models\staging\stg_products.sql)
  404 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/fe998f6c-21eb-4e7c-ada4-44fb91dc3fc3?maxResults=0&location=US&prettyPrint=false: Not found: Dataset northwind1-313400:northwind_erp was not found in location US
  
  (job ID: fe998f6c-21eb-4e7c-ada4-44fb91dc3fc3)
2021-05-12 00:52:46.057707 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cfe04d1-1013-444a-bdcd-6ff95ec6d4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002735BBEE808>]}
2021-05-12 00:52:46.058761 (Thread-1): 21:52:46 | 1 of 1 ERROR creating view model dbt_arthur.stg_products............. [ERROR in 1.14s]
2021-05-12 00:52:46.059698 (Thread-1): Finished running node model.northwind_shop.stg_products
2021-05-12 00:52:46.108666 (MainThread): Acquiring new bigquery connection "master".
2021-05-12 00:52:46.109628 (MainThread): 21:52:46 | 
2021-05-12 00:52:46.109628 (MainThread): 21:52:46 | Finished running 1 view model in 3.45s.
2021-05-12 00:52:46.110587 (MainThread): Connection 'master' was properly closed.
2021-05-12 00:52:46.110587 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-12 00:52:46.110587 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-12 00:52:46.110587 (MainThread): Connection 'model.northwind_shop.stg_products' was properly closed.
2021-05-12 00:52:46.112606 (MainThread): unclosed <socket.socket fd=1104, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 51002), raddr=('142.250.219.10', 443)>
2021-05-12 00:52:46.112606 (MainThread): unclosed <socket.socket fd=788, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 51001), raddr=('142.250.218.202', 443)>
2021-05-12 00:52:46.114728 (MainThread): unclosed <socket.socket fd=1156, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 51004), raddr=('142.250.219.10', 443)>
2021-05-12 00:52:46.115561 (MainThread): unclosed <socket.socket fd=1100, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 51003), raddr=('142.250.218.202', 443)>
2021-05-12 00:52:46.115561 (MainThread): unclosed <socket.socket fd=1164, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 51005), raddr=('142.250.218.202', 443)>
2021-05-12 00:52:46.115561 (MainThread): unclosed <socket.socket fd=956, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 51006), raddr=('142.250.219.10', 443)>
2021-05-12 00:52:46.124416 (MainThread): 
2021-05-12 00:52:46.124416 (MainThread): Completed with 1 error and 0 warnings:
2021-05-12 00:52:46.125617 (MainThread): 
2021-05-12 00:52:46.126612 (MainThread): Runtime Error in model stg_products (models\staging\stg_products.sql)
2021-05-12 00:52:46.127611 (MainThread):   404 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/fe998f6c-21eb-4e7c-ada4-44fb91dc3fc3?maxResults=0&location=US&prettyPrint=false: Not found: Dataset northwind1-313400:northwind_erp was not found in location US
2021-05-12 00:52:46.127611 (MainThread):   
2021-05-12 00:52:46.128729 (MainThread):   (job ID: fe998f6c-21eb-4e7c-ada4-44fb91dc3fc3)
2021-05-12 00:52:46.128729 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-12 00:52:46.130763 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002735BBC8E48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002735BB9B948>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002735BE86B88>]}
2021-05-12 00:52:46.131966 (MainThread): Flushing usage events
2021-05-12 00:59:36.478387 (MainThread): Running with dbt=0.19.1
2021-05-12 00:59:36.838404 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-12 00:59:36.838404 (MainThread): Tracking: tracking
2021-05-12 00:59:36.839419 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8204B3948>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8204B3B48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8204B6B88>]}
2021-05-12 00:59:36.848379 (MainThread): Partial parsing not enabled
2021-05-12 00:59:36.849373 (MainThread): Parsing macros\adapters.sql
2021-05-12 00:59:36.868318 (MainThread): Parsing macros\catalog.sql
2021-05-12 00:59:36.874299 (MainThread): Parsing macros\etc.sql
2021-05-12 00:59:36.876291 (MainThread): Parsing macros\materializations\copy.sql
2021-05-12 00:59:36.880280 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-12 00:59:36.893233 (MainThread): Parsing macros\materializations\seed.sql
2021-05-12 00:59:36.895227 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-12 00:59:36.897219 (MainThread): Parsing macros\materializations\table.sql
2021-05-12 00:59:36.907185 (MainThread): Parsing macros\materializations\view.sql
2021-05-12 00:59:36.912172 (MainThread): Parsing macros\core.sql
2021-05-12 00:59:36.916147 (MainThread): Parsing macros\adapters\common.sql
2021-05-12 00:59:36.958023 (MainThread): Parsing macros\etc\datetime.sql
2021-05-12 00:59:36.966977 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-12 00:59:36.967985 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-12 00:59:36.969971 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-12 00:59:36.971970 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-12 00:59:36.972966 (MainThread): Parsing macros\etc\query.sql
2021-05-12 00:59:36.973963 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-12 00:59:36.983929 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-12 00:59:36.996879 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-12 00:59:36.998871 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-12 00:59:37.005881 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-12 00:59:37.026758 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-12 00:59:37.059665 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-12 00:59:37.061658 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-12 00:59:37.078605 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-12 00:59:37.085588 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-12 00:59:37.090570 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-12 00:59:37.096552 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-12 00:59:37.099540 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-12 00:59:37.101533 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-12 00:59:37.103532 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-12 00:59:37.110495 (MainThread): Partial parsing not enabled
2021-05-12 00:59:37.134374 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-12 00:59:37.221083 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-12 00:59:37.224076 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9cb9703-46d4-49ae-8328-4cb9160a112a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B823F54E88>]}
2021-05-12 00:59:37.231319 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9cb9703-46d4-49ae-8328-4cb9160a112a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B823F70F88>]}
2021-05-12 00:59:37.231319 (MainThread): Found 1 model, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-05-12 00:59:37.233331 (MainThread): 
2021-05-12 00:59:37.234307 (MainThread): Acquiring new bigquery connection "master".
2021-05-12 00:59:37.235303 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-12 00:59:37.236299 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-12 00:59:38.487580 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-12 00:59:38.487580 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-12 00:59:38.492551 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-12 00:59:39.634228 (MainThread): 21:59:39 | Concurrency: 1 threads (target='dev')
2021-05-12 00:59:39.634957 (MainThread): 21:59:39 | 
2021-05-12 00:59:39.639946 (Thread-1): Began running node model.northwind_shop.stg_products
2021-05-12 00:59:39.640942 (Thread-1): 21:59:39 | 1 of 1 START view model dbt_arthur.stg_products...................... [RUN]
2021-05-12 00:59:39.642935 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-12 00:59:39.642935 (Thread-1): Compiling model.northwind_shop.stg_products
2021-05-12 00:59:39.646951 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_products"
2021-05-12 00:59:39.649915 (Thread-1): finished collecting timing info
2021-05-12 00:59:39.684437 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_products"
2021-05-12 00:59:39.687754 (Thread-1): Opening a new connection, currently in state init
2021-05-12 00:59:39.693743 (Thread-1): On model.northwind_shop.stg_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_products`
  OPTIONS()
  as with
    source as (
        select * from
        `northwind1-313400`.`northwind_erp`.`products`
    )
select * from source;


2021-05-12 00:59:41.105323 (Thread-1): Unhandled error while running:
/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_products`
  OPTIONS()
  as with
    source as (
        select * from
        `northwind1-313400`.`northwind_erp`.`products`
    )
select * from source;


2021-05-12 00:59:41.105323 (Thread-1): 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/6cc7eca7-41b2-40fc-ac6c-846bc3271ada?maxResults=0&location=US&prettyPrint=false: Not found: Dataset northwind1-313400:northwind_erp was not found in location US

(job ID: 6cc7eca7-41b2-40fc-ac6c-846bc3271ada)

                                                             -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */
   2:
   3:
   4:  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_products`
   5:  OPTIONS()
   6:  as with
   7:    source as (
   8:        select * from
   9:        `northwind1-313400`.`northwind_erp`.`products`
  10:    )
  11:select * from source;
  12:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
2021-05-12 00:59:41.106224 (Thread-1): finished collecting timing info
2021-05-12 00:59:41.106224 (Thread-1): Runtime Error in model stg_products (models\staging\stg_products.sql)
  404 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/6cc7eca7-41b2-40fc-ac6c-846bc3271ada?maxResults=0&location=US&prettyPrint=false: Not found: Dataset northwind1-313400:northwind_erp was not found in location US
  
  (job ID: 6cc7eca7-41b2-40fc-ac6c-846bc3271ada)
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.NotFound: 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/6cc7eca7-41b2-40fc-ac6c-846bc3271ada?maxResults=0&location=US&prettyPrint=false: Not found: Dataset northwind1-313400:northwind_erp was not found in location US

(job ID: 6cc7eca7-41b2-40fc-ac6c-846bc3271ada)

                                                             -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */
   2:
   3:
   4:  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_products`
   5:  OPTIONS()
   6:  as with
   7:    source as (
   8:        select * from
   9:        `northwind1-313400`.`northwind_erp`.`products`
  10:    )
  11:select * from source;
  12:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 181, in exception_handler
    raise RuntimeException(exc_message)
dbt.exceptions.RuntimeException: Runtime Error in model stg_products (models\staging\stg_products.sql)
  404 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/6cc7eca7-41b2-40fc-ac6c-846bc3271ada?maxResults=0&location=US&prettyPrint=false: Not found: Dataset northwind1-313400:northwind_erp was not found in location US
  
  (job ID: 6cc7eca7-41b2-40fc-ac6c-846bc3271ada)
2021-05-12 00:59:41.114196 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9cb9703-46d4-49ae-8328-4cb9160a112a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B823F3CA08>]}
2021-05-12 00:59:41.115193 (Thread-1): 21:59:41 | 1 of 1 ERROR creating view model dbt_arthur.stg_products............. [ERROR in 1.47s]
2021-05-12 00:59:41.116121 (Thread-1): Finished running node model.northwind_shop.stg_products
2021-05-12 00:59:41.158413 (MainThread): Acquiring new bigquery connection "master".
2021-05-12 00:59:41.158413 (MainThread): 21:59:41 | 
2021-05-12 00:59:41.160349 (MainThread): 21:59:41 | Finished running 1 view model in 3.92s.
2021-05-12 00:59:41.160349 (MainThread): Connection 'master' was properly closed.
2021-05-12 00:59:41.161344 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-12 00:59:41.161615 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-12 00:59:41.161615 (MainThread): Connection 'model.northwind_shop.stg_products' was properly closed.
2021-05-12 00:59:41.163809 (MainThread): unclosed <socket.socket fd=728, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 51127), raddr=('142.250.219.10', 443)>
2021-05-12 00:59:41.163809 (MainThread): unclosed <socket.socket fd=964, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 51126), raddr=('172.217.28.10', 443)>
2021-05-12 00:59:41.163809 (MainThread): unclosed <socket.socket fd=984, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 51133), raddr=('142.250.219.10', 443)>
2021-05-12 00:59:41.164761 (MainThread): unclosed <socket.socket fd=432, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 51128), raddr=('172.217.28.10', 443)>
2021-05-12 00:59:41.164761 (MainThread): unclosed <socket.socket fd=860, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 51135), raddr=('172.217.28.10', 443)>
2021-05-12 00:59:41.164761 (MainThread): unclosed <socket.socket fd=752, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 51136), raddr=('142.250.219.10', 443)>
2021-05-12 00:59:41.168806 (MainThread): 
2021-05-12 00:59:41.169743 (MainThread): Completed with 1 error and 0 warnings:
2021-05-12 00:59:41.170743 (MainThread): 
2021-05-12 00:59:41.171739 (MainThread): Runtime Error in model stg_products (models\staging\stg_products.sql)
2021-05-12 00:59:41.172733 (MainThread):   404 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/6cc7eca7-41b2-40fc-ac6c-846bc3271ada?maxResults=0&location=US&prettyPrint=false: Not found: Dataset northwind1-313400:northwind_erp was not found in location US
2021-05-12 00:59:41.174748 (MainThread):   
2021-05-12 00:59:41.175785 (MainThread):   (job ID: 6cc7eca7-41b2-40fc-ac6c-846bc3271ada)
2021-05-12 00:59:41.175785 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-12 00:59:41.176720 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B823F544C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B823EE2BC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8241C9848>]}
2021-05-12 00:59:41.177720 (MainThread): Flushing usage events
2021-05-12 12:30:00.442625 (MainThread): Running with dbt=0.19.1
2021-05-12 12:30:01.390447 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-12 12:30:01.390447 (MainThread): Tracking: tracking
2021-05-12 12:30:01.390447 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247F84BD908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247F84C3B88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247F84C3A48>]}
2021-05-12 12:30:01.398445 (MainThread): Partial parsing not enabled
2021-05-12 12:30:01.406382 (MainThread): Parsing macros\adapters.sql
2021-05-12 12:30:01.422444 (MainThread): Parsing macros\catalog.sql
2021-05-12 12:30:01.430435 (MainThread): Parsing macros\etc.sql
2021-05-12 12:30:01.430435 (MainThread): Parsing macros\materializations\copy.sql
2021-05-12 12:30:01.438550 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-12 12:30:01.446615 (MainThread): Parsing macros\materializations\seed.sql
2021-05-12 12:30:01.454972 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-12 12:30:01.454972 (MainThread): Parsing macros\materializations\table.sql
2021-05-12 12:30:01.463040 (MainThread): Parsing macros\materializations\view.sql
2021-05-12 12:30:01.471036 (MainThread): Parsing macros\core.sql
2021-05-12 12:30:01.479033 (MainThread): Parsing macros\adapters\common.sql
2021-05-12 12:30:01.519347 (MainThread): Parsing macros\etc\datetime.sql
2021-05-12 12:30:01.527345 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-12 12:30:01.527345 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-12 12:30:01.527345 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-12 12:30:01.535403 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-12 12:30:01.535403 (MainThread): Parsing macros\etc\query.sql
2021-05-12 12:30:01.535403 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-12 12:30:01.543397 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-12 12:30:01.559331 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-12 12:30:01.559331 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-12 12:30:01.567327 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-12 12:30:01.583321 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-12 12:30:01.615306 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-12 12:30:01.615306 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-12 12:30:01.631300 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-12 12:30:01.639300 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-12 12:30:01.647294 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-12 12:30:01.655291 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-12 12:30:01.655291 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-12 12:30:01.655291 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-12 12:30:01.655291 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-12 12:30:01.663287 (MainThread): Partial parsing not enabled
2021-05-12 12:30:01.687277 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-12 12:30:01.759247 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247FBF1D8C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247FBF1DF08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247FBF1D548>]}
2021-05-12 12:30:01.759247 (MainThread): Flushing usage events
2021-05-12 12:30:02.953770 (MainThread): Connection 'model.northwind_shop.stg_products' was properly closed.
2021-05-12 12:30:02.953770 (MainThread): Encountered an error:
2021-05-12 12:30:02.953770 (MainThread): Compilation Error in model stg_products (models\staging\stg_products.sql)
  Model 'model.northwind_shop.stg_products' (models\staging\stg_products.sql) depends on a source named 'northwind_erp.products' which was not found
2021-05-12 12:30:02.965475 (MainThread): Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 444, in load_all
    manifest = loader.create_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 422, in create_manifest
    self.process_manifest(manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 387, in process_manifest
    process_sources(manifest, project_name)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 820, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 807, in _process_sources_for_node
    disabled=(isinstance(target_source, Disabled))
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 510, in invalid_source_fail_unless_test
    disabled=disabled
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 597, in source_target_not_found
    raise_compiler_error(msg, model)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model stg_products (models\staging\stg_products.sql)
  Model 'model.northwind_shop.stg_products' (models\staging\stg_products.sql) depends on a source named 'northwind_erp.products' which was not found

2021-05-12 12:30:22.758770 (MainThread): Running with dbt=0.19.1
2021-05-12 12:30:23.113049 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-12 12:30:23.113049 (MainThread): Tracking: tracking
2021-05-12 12:30:23.113049 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D23EC42B88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D23EC42648>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D23EC47208>]}
2021-05-12 12:30:23.129047 (MainThread): Partial parsing not enabled
2021-05-12 12:30:23.129047 (MainThread): Parsing macros\adapters.sql
2021-05-12 12:30:23.145038 (MainThread): Parsing macros\catalog.sql
2021-05-12 12:30:23.153042 (MainThread): Parsing macros\etc.sql
2021-05-12 12:30:23.153042 (MainThread): Parsing macros\materializations\copy.sql
2021-05-12 12:30:23.161056 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-12 12:30:23.169050 (MainThread): Parsing macros\materializations\seed.sql
2021-05-12 12:30:23.177047 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-12 12:30:23.177047 (MainThread): Parsing macros\materializations\table.sql
2021-05-12 12:30:23.185036 (MainThread): Parsing macros\materializations\view.sql
2021-05-12 12:30:23.193042 (MainThread): Parsing macros\core.sql
2021-05-12 12:30:23.193042 (MainThread): Parsing macros\adapters\common.sql
2021-05-12 12:30:23.233014 (MainThread): Parsing macros\etc\datetime.sql
2021-05-12 12:30:23.241016 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-12 12:30:23.241016 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-12 12:30:23.241016 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-12 12:30:23.249015 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-12 12:30:23.249015 (MainThread): Parsing macros\etc\query.sql
2021-05-12 12:30:23.249015 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-12 12:30:23.256995 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-12 12:30:23.272990 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-12 12:30:23.272990 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-12 12:30:23.283570 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-12 12:30:23.303428 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-12 12:30:23.343722 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-12 12:30:23.344002 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-12 12:30:23.360127 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-12 12:30:23.368122 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-12 12:30:23.376121 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-12 12:30:23.384123 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-12 12:30:23.384123 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-12 12:30:23.384123 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-12 12:30:23.390925 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-12 12:30:23.398932 (MainThread): Partial parsing not enabled
2021-05-12 12:30:23.414977 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-12 12:30:23.494919 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-12 12:30:23.504042 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c5abafc-f65c-4ed0-bbe0-4d34a0e25d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D23ED0A388>]}
2021-05-12 12:30:23.504042 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c5abafc-f65c-4ed0-bbe0-4d34a0e25d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2426D5388>]}
2021-05-12 12:30:23.504042 (MainThread): Found 1 model, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-05-12 12:30:23.504042 (MainThread): 
2021-05-12 12:30:23.511422 (MainThread): Acquiring new bigquery connection "master".
2021-05-12 12:30:23.511422 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-12 12:30:23.511422 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-12 12:30:24.836449 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-12 12:30:24.836449 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-12 12:30:24.844626 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-12 12:30:26.095498 (MainThread): 09:30:26 | Concurrency: 1 threads (target='dev')
2021-05-12 12:30:26.096517 (MainThread): 09:30:26 | 
2021-05-12 12:30:26.148531 (Thread-1): Began running node model.northwind_shop.stg_products
2021-05-12 12:30:26.148531 (Thread-1): 09:30:26 | 1 of 1 START view model dbt_arthur.stg_products...................... [RUN]
2021-05-12 12:30:26.148531 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-12 12:30:26.156687 (Thread-1): Compiling model.northwind_shop.stg_products
2021-05-12 12:30:26.156687 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_products"
2021-05-12 12:30:26.156687 (Thread-1): finished collecting timing info
2021-05-12 12:30:26.222723 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_products"
2021-05-12 12:30:26.222723 (Thread-1): Opening a new connection, currently in state init
2021-05-12 12:30:26.230720 (Thread-1): On model.northwind_shop.stg_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_products`
  OPTIONS()
  as with
    source as (
        select * from
        `northwind1-313400`.`northwind_erp`.`products`
    )
select * from source;


2021-05-12 12:30:27.748906 (Thread-1): Unhandled error while running:
/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_products`
  OPTIONS()
  as with
    source as (
        select * from
        `northwind1-313400`.`northwind_erp`.`products`
    )
select * from source;


2021-05-12 12:30:27.748906 (Thread-1): 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/c4c3b579-1e82-41c9-8a13-920e0f886482?maxResults=0&location=US&prettyPrint=false: Not found: Dataset northwind1-313400:northwind_erp was not found in location US

(job ID: c4c3b579-1e82-41c9-8a13-920e0f886482)

                                                             -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */
   2:
   3:
   4:  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_products`
   5:  OPTIONS()
   6:  as with
   7:    source as (
   8:        select * from
   9:        `northwind1-313400`.`northwind_erp`.`products`
  10:    )
  11:select * from source;
  12:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
2021-05-12 12:30:27.748906 (Thread-1): finished collecting timing info
2021-05-12 12:30:27.748906 (Thread-1): Runtime Error in model stg_products (models\staging\stg_products.sql)
  404 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/c4c3b579-1e82-41c9-8a13-920e0f886482?maxResults=0&location=US&prettyPrint=false: Not found: Dataset northwind1-313400:northwind_erp was not found in location US
  
  (job ID: c4c3b579-1e82-41c9-8a13-920e0f886482)
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.NotFound: 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/c4c3b579-1e82-41c9-8a13-920e0f886482?maxResults=0&location=US&prettyPrint=false: Not found: Dataset northwind1-313400:northwind_erp was not found in location US

(job ID: c4c3b579-1e82-41c9-8a13-920e0f886482)

                                                             -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */
   2:
   3:
   4:  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_products`
   5:  OPTIONS()
   6:  as with
   7:    source as (
   8:        select * from
   9:        `northwind1-313400`.`northwind_erp`.`products`
  10:    )
  11:select * from source;
  12:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 181, in exception_handler
    raise RuntimeException(exc_message)
dbt.exceptions.RuntimeException: Runtime Error in model stg_products (models\staging\stg_products.sql)
  404 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/c4c3b579-1e82-41c9-8a13-920e0f886482?maxResults=0&location=US&prettyPrint=false: Not found: Dataset northwind1-313400:northwind_erp was not found in location US
  
  (job ID: c4c3b579-1e82-41c9-8a13-920e0f886482)
2021-05-12 12:30:27.827961 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c5abafc-f65c-4ed0-bbe0-4d34a0e25d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D242133808>]}
2021-05-12 12:30:27.827961 (Thread-1): 09:30:27 | 1 of 1 ERROR creating view model dbt_arthur.stg_products............. [ERROR in 1.68s]
2021-05-12 12:30:27.827961 (Thread-1): Finished running node model.northwind_shop.stg_products
2021-05-12 12:30:27.895026 (MainThread): Acquiring new bigquery connection "master".
2021-05-12 12:30:27.895026 (MainThread): 09:30:27 | 
2021-05-12 12:30:27.895026 (MainThread): 09:30:27 | Finished running 1 view model in 4.39s.
2021-05-12 12:30:27.895026 (MainThread): Connection 'master' was properly closed.
2021-05-12 12:30:27.895026 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-12 12:30:27.895026 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-12 12:30:27.895026 (MainThread): Connection 'model.northwind_shop.stg_products' was properly closed.
2021-05-12 12:30:27.895026 (MainThread): unclosed <socket.socket fd=932, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.100', 61514), raddr=('142.250.218.234', 443)>
2021-05-12 12:30:27.902899 (MainThread): unclosed <socket.socket fd=668, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.100', 61513), raddr=('142.250.79.202', 443)>
2021-05-12 12:30:27.902899 (MainThread): unclosed <socket.socket fd=984, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.100', 61516), raddr=('142.250.218.234', 443)>
2021-05-12 12:30:27.902899 (MainThread): unclosed <socket.socket fd=1116, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.100', 61515), raddr=('142.250.79.202', 443)>
2021-05-12 12:30:27.902899 (MainThread): unclosed <socket.socket fd=1152, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.100', 61517), raddr=('142.250.79.202', 443)>
2021-05-12 12:30:27.902899 (MainThread): unclosed <socket.socket fd=1156, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.100', 61518), raddr=('142.250.218.234', 443)>
2021-05-12 12:30:27.902899 (MainThread): 
2021-05-12 12:30:27.902899 (MainThread): Completed with 1 error and 0 warnings:
2021-05-12 12:30:27.902899 (MainThread): 
2021-05-12 12:30:27.910850 (MainThread): Runtime Error in model stg_products (models\staging\stg_products.sql)
2021-05-12 12:30:27.910850 (MainThread):   404 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/c4c3b579-1e82-41c9-8a13-920e0f886482?maxResults=0&location=US&prettyPrint=false: Not found: Dataset northwind1-313400:northwind_erp was not found in location US
2021-05-12 12:30:27.910850 (MainThread):   
2021-05-12 12:30:27.910850 (MainThread):   (job ID: c4c3b579-1e82-41c9-8a13-920e0f886482)
2021-05-12 12:30:27.910850 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-12 12:30:27.916217 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D24266F488>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D242957B88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D24296F6C8>]}
2021-05-12 12:30:27.916217 (MainThread): Flushing usage events
2021-05-12 12:32:25.519746 (MainThread): Running with dbt=0.19.1
2021-05-12 12:32:25.828939 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-12 12:32:25.829973 (MainThread): Tracking: tracking
2021-05-12 12:32:25.829973 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1429C2A48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1429C2C48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1429C2D08>]}
2021-05-12 12:32:25.838181 (MainThread): Partial parsing not enabled
2021-05-12 12:32:25.840213 (MainThread): Parsing macros\adapters.sql
2021-05-12 12:32:25.856215 (MainThread): Parsing macros\catalog.sql
2021-05-12 12:32:25.856215 (MainThread): Parsing macros\etc.sql
2021-05-12 12:32:25.864212 (MainThread): Parsing macros\materializations\copy.sql
2021-05-12 12:32:25.864212 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-12 12:32:25.880205 (MainThread): Parsing macros\materializations\seed.sql
2021-05-12 12:32:25.880205 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-12 12:32:25.880205 (MainThread): Parsing macros\materializations\table.sql
2021-05-12 12:32:25.888202 (MainThread): Parsing macros\materializations\view.sql
2021-05-12 12:32:25.896195 (MainThread): Parsing macros\core.sql
2021-05-12 12:32:25.904195 (MainThread): Parsing macros\adapters\common.sql
2021-05-12 12:32:25.936182 (MainThread): Parsing macros\etc\datetime.sql
2021-05-12 12:32:25.944179 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-12 12:32:25.944179 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-12 12:32:25.953286 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-12 12:32:25.955310 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-12 12:32:25.955310 (MainThread): Parsing macros\etc\query.sql
2021-05-12 12:32:25.955310 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-12 12:32:25.963317 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-12 12:32:25.979309 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-12 12:32:25.979309 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-12 12:32:25.979309 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-12 12:32:26.003298 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-12 12:32:26.035285 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-12 12:32:26.035285 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-12 12:32:26.051279 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-12 12:32:26.059276 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-12 12:32:26.059276 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-12 12:32:26.067272 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-12 12:32:26.067272 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-12 12:32:26.067272 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-12 12:32:26.075270 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-12 12:32:26.075270 (MainThread): Partial parsing not enabled
2021-05-12 12:32:26.108431 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-12 12:32:26.184820 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1464DE508>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1464DE748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1464DE948>]}
2021-05-12 12:32:26.184820 (MainThread): Flushing usage events
2021-05-12 12:32:27.749172 (MainThread): Connection 'model.northwind_shop.stg_products' was properly closed.
2021-05-12 12:32:27.749172 (MainThread): Encountered an error:
2021-05-12 12:32:27.749172 (MainThread): Compilation Error in model stg_products (models\staging\stg_products.sql)
  Model 'model.northwind_shop.stg_products' (models\staging\stg_products.sql) depends on a source named 'northwind_erp.products' which was not found
2021-05-12 12:32:27.749172 (MainThread): Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 444, in load_all
    manifest = loader.create_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 422, in create_manifest
    self.process_manifest(manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 387, in process_manifest
    process_sources(manifest, project_name)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 820, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 807, in _process_sources_for_node
    disabled=(isinstance(target_source, Disabled))
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 510, in invalid_source_fail_unless_test
    disabled=disabled
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 597, in source_target_not_found
    raise_compiler_error(msg, model)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model stg_products (models\staging\stg_products.sql)
  Model 'model.northwind_shop.stg_products' (models\staging\stg_products.sql) depends on a source named 'northwind_erp.products' which was not found

2021-05-12 12:33:28.793278 (MainThread): Running with dbt=0.19.1
2021-05-12 12:33:29.134313 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-12 12:33:29.134313 (MainThread): Tracking: tracking
2021-05-12 12:33:29.134313 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FA9303C88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FA9303C48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FA9308148>]}
2021-05-12 12:33:29.142311 (MainThread): Partial parsing not enabled
2021-05-12 12:33:29.142311 (MainThread): Parsing macros\adapters.sql
2021-05-12 12:33:29.158304 (MainThread): Parsing macros\catalog.sql
2021-05-12 12:33:29.166300 (MainThread): Parsing macros\etc.sql
2021-05-12 12:33:29.166300 (MainThread): Parsing macros\materializations\copy.sql
2021-05-12 12:33:29.174297 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-12 12:33:29.182294 (MainThread): Parsing macros\materializations\seed.sql
2021-05-12 12:33:29.182294 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-12 12:33:29.190290 (MainThread): Parsing macros\materializations\table.sql
2021-05-12 12:33:29.198286 (MainThread): Parsing macros\materializations\view.sql
2021-05-12 12:33:29.198286 (MainThread): Parsing macros\core.sql
2021-05-12 12:33:29.206284 (MainThread): Parsing macros\adapters\common.sql
2021-05-12 12:33:29.246266 (MainThread): Parsing macros\etc\datetime.sql
2021-05-12 12:33:29.254263 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-12 12:33:29.254263 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-12 12:33:29.254263 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-12 12:33:29.254263 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-12 12:33:29.254263 (MainThread): Parsing macros\etc\query.sql
2021-05-12 12:33:29.262260 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-12 12:33:29.270257 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-12 12:33:29.278254 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-12 12:33:29.278254 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-12 12:33:29.286250 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-12 12:33:29.302244 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-12 12:33:29.334230 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-12 12:33:29.334230 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-12 12:33:29.350223 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-12 12:33:29.358220 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-12 12:33:29.366217 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-12 12:33:29.374214 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-12 12:33:29.374214 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-12 12:33:29.374214 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-12 12:33:29.374214 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-12 12:33:29.382210 (MainThread): Partial parsing not enabled
2021-05-12 12:33:29.406200 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-12 12:33:29.478176 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-12 12:33:29.482428 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ccb6571b-e771-463f-b29e-98c09ab9a92c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FACE87088>]}
2021-05-12 12:33:29.482428 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ccb6571b-e771-463f-b29e-98c09ab9a92c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FACDC57C8>]}
2021-05-12 12:33:29.482428 (MainThread): Found 1 model, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-05-12 12:33:29.491448 (MainThread): 
2021-05-12 12:33:29.492808 (MainThread): Acquiring new bigquery connection "master".
2021-05-12 12:33:29.493915 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-12 12:33:29.493915 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-12 12:33:31.097070 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-12 12:33:31.097070 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-12 12:33:31.104672 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-12 12:33:33.239463 (MainThread): 09:33:33 | Concurrency: 1 threads (target='dev')
2021-05-12 12:33:33.239463 (MainThread): 09:33:33 | 
2021-05-12 12:33:33.247424 (Thread-1): Began running node model.northwind_shop.stg_products
2021-05-12 12:33:33.247424 (Thread-1): 09:33:33 | 1 of 1 START view model dbt_arthur.stg_products...................... [RUN]
2021-05-12 12:33:33.247424 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-12 12:33:33.247424 (Thread-1): Compiling model.northwind_shop.stg_products
2021-05-12 12:33:33.255441 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_products"
2021-05-12 12:33:33.256623 (Thread-1): finished collecting timing info
2021-05-12 12:33:33.288618 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_products"
2021-05-12 12:33:33.288618 (Thread-1): Opening a new connection, currently in state init
2021-05-12 12:33:33.288618 (Thread-1): On model.northwind_shop.stg_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_products`
  OPTIONS()
  as with
    source as (
        select * from
        `northwind1-313400`.`northwind_etl`.`products`
    )
select * from source;


2021-05-12 12:33:36.416659 (Thread-1): finished collecting timing info
2021-05-12 12:33:36.416659 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccb6571b-e771-463f-b29e-98c09ab9a92c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FACDA5288>]}
2021-05-12 12:33:36.424594 (Thread-1): 09:33:36 | 1 of 1 OK created view model dbt_arthur.stg_products................. [OK in 3.17s]
2021-05-12 12:33:36.424594 (Thread-1): Finished running node model.northwind_shop.stg_products
2021-05-12 12:33:36.450904 (MainThread): Acquiring new bigquery connection "master".
2021-05-12 12:33:36.450904 (MainThread): 09:33:36 | 
2021-05-12 12:33:36.450904 (MainThread): 09:33:36 | Finished running 1 view model in 6.96s.
2021-05-12 12:33:36.450904 (MainThread): Connection 'master' was properly closed.
2021-05-12 12:33:36.453352 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-12 12:33:36.453352 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-12 12:33:36.453352 (MainThread): Connection 'model.northwind_shop.stg_products' was properly closed.
2021-05-12 12:33:36.453352 (MainThread): unclosed <socket.socket fd=996, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.100', 61536), raddr=('142.250.218.234', 443)>
2021-05-12 12:33:36.453352 (MainThread): unclosed <socket.socket fd=1004, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.100', 61535), raddr=('142.250.79.202', 443)>
2021-05-12 12:33:36.453352 (MainThread): unclosed <socket.socket fd=1068, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.100', 61538), raddr=('142.250.218.234', 443)>
2021-05-12 12:33:36.453352 (MainThread): unclosed <socket.socket fd=860, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.100', 61537), raddr=('142.250.79.202', 443)>
2021-05-12 12:33:36.453352 (MainThread): unclosed <socket.socket fd=892, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.100', 61539), raddr=('142.250.79.202', 443)>
2021-05-12 12:33:36.453352 (MainThread): unclosed <socket.socket fd=1160, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.100', 61540), raddr=('142.250.218.234', 443)>
2021-05-12 12:33:36.463938 (MainThread): 
2021-05-12 12:33:36.463938 (MainThread): Completed successfully
2021-05-12 12:33:36.463938 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-12 12:33:36.465905 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FACD976C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FACDC5C08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FACE7BE88>]}
2021-05-12 12:33:36.467892 (MainThread): Flushing usage events
2021-05-13 13:18:34.390857 (MainThread): Running with dbt=0.19.1
2021-05-13 13:18:35.042922 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-13 13:18:35.050976 (MainThread): Tracking: tracking
2021-05-13 13:18:35.050976 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D533582A08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D533564EC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D533582B48>]}
2021-05-13 13:18:35.070019 (MainThread): Partial parsing not enabled
2021-05-13 13:18:35.073547 (MainThread): Parsing macros\adapters.sql
2021-05-13 13:18:35.100787 (MainThread): Parsing macros\catalog.sql
2021-05-13 13:18:35.113386 (MainThread): Parsing macros\etc.sql
2021-05-13 13:18:35.118390 (MainThread): Parsing macros\materializations\copy.sql
2021-05-13 13:18:35.132871 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-13 13:18:35.162935 (MainThread): Parsing macros\materializations\seed.sql
2021-05-13 13:18:35.173389 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-13 13:18:35.173389 (MainThread): Parsing macros\materializations\table.sql
2021-05-13 13:18:35.198723 (MainThread): Parsing macros\materializations\view.sql
2021-05-13 13:18:35.213806 (MainThread): Parsing macros\core.sql
2021-05-13 13:18:35.223599 (MainThread): Parsing macros\adapters\common.sql
2021-05-13 13:18:35.313631 (MainThread): Parsing macros\etc\datetime.sql
2021-05-13 13:18:35.328370 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-13 13:18:35.333428 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-13 13:18:35.338435 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-13 13:18:35.343526 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-13 13:18:35.343526 (MainThread): Parsing macros\etc\query.sql
2021-05-13 13:18:35.353985 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-13 13:18:35.378286 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-13 13:18:35.393387 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-13 13:18:35.403114 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-13 13:18:35.411111 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-13 13:18:35.432784 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-13 13:18:35.474458 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-13 13:18:35.474458 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-13 13:18:35.512753 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-13 13:18:35.528691 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-13 13:18:35.536690 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-13 13:18:35.544684 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-13 13:18:35.552681 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-13 13:18:35.552681 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-13 13:18:35.560719 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-13 13:18:35.570380 (MainThread): Partial parsing not enabled
2021-05-13 13:18:35.610709 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-13 13:18:35.753422 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-13 13:18:35.756415 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '517e5ad6-b46c-444e-947d-0254488e1ea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D537038448>]}
2021-05-13 13:18:35.763495 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '517e5ad6-b46c-444e-947d-0254488e1ea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D536FC86C8>]}
2021-05-13 13:18:35.763495 (MainThread): Found 1 model, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-05-13 13:18:35.764887 (MainThread): 
2021-05-13 13:18:35.764887 (MainThread): Acquiring new bigquery connection "master".
2021-05-13 13:18:35.770551 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-13 13:18:35.770551 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-13 13:18:37.449535 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-13 13:18:37.450196 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-13 13:18:37.462399 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-13 13:18:38.041409 (MainThread): 10:18:38 | Concurrency: 1 threads (target='dev')
2021-05-13 13:18:38.042928 (MainThread): 10:18:38 | 
2021-05-13 13:18:38.048020 (Thread-1): Began running node model.northwind_shop.stg_products
2021-05-13 13:18:38.048976 (Thread-1): 10:18:38 | 1 of 1 START view model dbt_arthur.stg_products...................... [RUN]
2021-05-13 13:18:38.050584 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-13 13:18:38.051159 (Thread-1): Compiling model.northwind_shop.stg_products
2021-05-13 13:18:38.057515 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_products"
2021-05-13 13:18:38.059453 (Thread-1): finished collecting timing info
2021-05-13 13:18:38.113823 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_products"
2021-05-13 13:18:38.113823 (Thread-1): Opening a new connection, currently in state init
2021-05-13 13:18:38.121726 (Thread-1): On model.northwind_shop.stg_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_products`
  OPTIONS()
  as with
    source as (
        select 
            /* Primary key */
               product_id

            /*Foreign key */
            , category_id
            , supplier_id

            , units_in_stock           	
            , unit_price	
            , product_name	
            , quantity_per_unit	
            	
            , reorder_level	
            , units_on_order	
            , 
                case
                 when discontinued = 1 then True
                 else False
                end as is_discontinued 
            /* Stitich Columns*/
            , _sdc_table_version
            , _sdc_sequence
            , _sdc_batched_at	
            , _sdc_extracted_at	
            , _sdc_received_at

        from `northwind1-313400`.`northwind_etl`.`products`
    )
select * from source;


2021-05-13 13:18:41.043746 (Thread-1): finished collecting timing info
2021-05-13 13:18:41.043746 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '517e5ad6-b46c-444e-947d-0254488e1ea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D536FB3F08>]}
2021-05-13 13:18:41.043746 (Thread-1): 10:18:41 | 1 of 1 OK created view model dbt_arthur.stg_products................. [OK in 2.99s]
2021-05-13 13:18:41.050626 (Thread-1): Finished running node model.northwind_shop.stg_products
2021-05-13 13:18:41.117579 (MainThread): Acquiring new bigquery connection "master".
2021-05-13 13:18:41.118089 (MainThread): 10:18:41 | 
2021-05-13 13:18:41.119348 (MainThread): 10:18:41 | Finished running 1 view model in 5.35s.
2021-05-13 13:18:41.119532 (MainThread): Connection 'master' was properly closed.
2021-05-13 13:18:41.119532 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-13 13:18:41.120571 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-13 13:18:41.120571 (MainThread): Connection 'model.northwind_shop.stg_products' was properly closed.
2021-05-13 13:18:41.123455 (MainThread): unclosed <socket.socket fd=1044, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 52324), raddr=('172.217.173.106', 443)>
2021-05-13 13:18:41.124521 (MainThread): unclosed <socket.socket fd=1200, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 52323), raddr=('172.217.30.170', 443)>
2021-05-13 13:18:41.124622 (MainThread): unclosed <socket.socket fd=1276, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 52326), raddr=('172.217.173.106', 443)>
2021-05-13 13:18:41.124622 (MainThread): unclosed <socket.socket fd=1268, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 52325), raddr=('172.217.30.170', 443)>
2021-05-13 13:18:41.125781 (MainThread): unclosed <socket.socket fd=1064, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 52327), raddr=('172.217.30.170', 443)>
2021-05-13 13:18:41.125781 (MainThread): unclosed <socket.socket fd=784, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 52328), raddr=('172.217.173.106', 443)>
2021-05-13 13:18:41.150486 (MainThread): 
2021-05-13 13:18:41.150486 (MainThread): Completed successfully
2021-05-13 13:18:41.154695 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-13 13:18:41.155999 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D533608CC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5370FAC88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D533642488>]}
2021-05-13 13:18:41.155999 (MainThread): Flushing usage events
2021-05-15 12:07:50.872679 (MainThread): Running with dbt=0.19.1
2021-05-15 12:07:51.741887 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 12:07:51.741887 (MainThread): Tracking: tracking
2021-05-15 12:07:51.741887 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F0F0E23CC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F0F0E28708>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F0F0E282C8>]}
2021-05-15 12:07:51.752272 (MainThread): Partial parsing not enabled
2021-05-15 12:07:51.752272 (MainThread): Parsing macros\adapters.sql
2021-05-15 12:07:51.784147 (MainThread): Parsing macros\catalog.sql
2021-05-15 12:07:51.793720 (MainThread): Parsing macros\etc.sql
2021-05-15 12:07:51.793720 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 12:07:51.801727 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 12:07:51.809722 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 12:07:51.817719 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 12:07:51.817719 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 12:07:51.825716 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 12:07:51.833712 (MainThread): Parsing macros\core.sql
2021-05-15 12:07:51.841709 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 12:07:51.890353 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 12:07:51.898348 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 12:07:51.898348 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 12:07:51.898348 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 12:07:51.906345 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 12:07:51.906345 (MainThread): Parsing macros\etc\query.sql
2021-05-15 12:07:51.906345 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 12:07:51.914342 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 12:07:51.927522 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 12:07:51.935544 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 12:07:51.935544 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 12:07:51.962050 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 12:07:51.998015 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 12:07:51.998015 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 12:07:52.022010 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 12:07:52.030007 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 12:07:52.030007 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 12:07:52.038377 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 12:07:52.038377 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 12:07:52.046395 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 12:07:52.046395 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 12:07:52.055055 (MainThread): Partial parsing not enabled
2021-05-15 12:07:52.074880 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 12:07:52.092440 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 12:07:52.168718 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 12:07:52.171711 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '161903be-bd05-4e04-8dcf-25b9fc1e3461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F0F48E21C8>]}
2021-05-15 12:07:52.171711 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '161903be-bd05-4e04-8dcf-25b9fc1e3461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F0F485E448>]}
2021-05-15 12:07:52.171711 (MainThread): Found 2 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-05-15 12:07:52.179914 (MainThread): 
2021-05-15 12:07:52.179914 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 12:07:52.179914 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 12:07:52.179914 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 12:07:53.035468 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 12:07:53.042170 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 12:07:53.053833 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 12:07:54.249082 (MainThread): 09:07:54 | Concurrency: 1 threads (target='dev')
2021-05-15 12:07:54.250776 (MainThread): 09:07:54 | 
2021-05-15 12:07:54.287210 (Thread-1): Began running node model.northwind_shop.stg_orders
2021-05-15 12:07:54.289145 (Thread-1): 09:07:54 | 1 of 2 START view model dbt_arthur.stg_orders........................ [RUN]
2021-05-15 12:07:54.289145 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 12:07:54.289145 (Thread-1): Compiling model.northwind_shop.stg_orders
2021-05-15 12:07:54.293426 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_orders"
2021-05-15 12:07:54.300406 (Thread-1): finished collecting timing info
2021-05-15 12:07:54.355121 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_orders"
2021-05-15 12:07:54.361399 (Thread-1): Opening a new connection, currently in state init
2021-05-15 12:07:54.371702 (Thread-1): On model.northwind_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_orders"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_orders`
  OPTIONS()
  as with
    source as (
        select 
          /*Primary key*/ 
            order_id
          /*Foreign Key*/
            ,employee_id
            ,customer_id
            ,ship_region	
            ,shipped_date
            ,ship_country	
            ,ship_name
            ,order_date		
            ,ship_postal_code	
            ,ship_city	
            ,freight	
            ,ship_via
            ,required_date
            ,ship_address
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`orders`
    )
select * from source;


2021-05-15 12:07:56.186404 (Thread-1): finished collecting timing info
2021-05-15 12:07:56.186404 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '161903be-bd05-4e04-8dcf-25b9fc1e3461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F0F4878648>]}
2021-05-15 12:07:56.192616 (Thread-1): 09:07:56 | 1 of 2 OK created view model dbt_arthur.stg_orders................... [OK in 1.90s]
2021-05-15 12:07:56.193849 (Thread-1): Finished running node model.northwind_shop.stg_orders
2021-05-15 12:07:56.194376 (Thread-1): Began running node model.northwind_shop.stg_products
2021-05-15 12:07:56.195570 (Thread-1): 09:07:56 | 2 of 2 START view model dbt_arthur.stg_products...................... [RUN]
2021-05-15 12:07:56.195942 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 12:07:56.195942 (Thread-1): Compiling model.northwind_shop.stg_products
2021-05-15 12:07:56.203344 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_products"
2021-05-15 12:07:56.207955 (Thread-1): finished collecting timing info
2021-05-15 12:07:56.213219 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_products"
2021-05-15 12:07:56.215038 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 12:07:56.227658 (Thread-1): On model.northwind_shop.stg_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_products`
  OPTIONS()
  as with
    source as (
        select 
            /* Primary key */
               product_id

            /*Foreign key */
            , category_id
            , supplier_id

            , units_in_stock           	
            , unit_price	
            , product_name	
            , quantity_per_unit	
            	
            , reorder_level	
            , units_on_order	
            , 
                case
                 when discontinued = 1 then True
                 else False
                end as is_discontinued 
            /* Stitich Columns*/
            , _sdc_table_version
            , _sdc_sequence
            , _sdc_batched_at	
            , _sdc_extracted_at	
            , _sdc_received_at

        from `northwind1-313400`.`northwind_etl`.`products`
    )
select * from source;


2021-05-15 12:07:58.553012 (Thread-1): finished collecting timing info
2021-05-15 12:07:58.553012 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '161903be-bd05-4e04-8dcf-25b9fc1e3461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F0F485A788>]}
2021-05-15 12:07:58.553012 (Thread-1): 09:07:58 | 2 of 2 OK created view model dbt_arthur.stg_products................. [OK in 2.36s]
2021-05-15 12:07:58.561028 (Thread-1): Finished running node model.northwind_shop.stg_products
2021-05-15 12:07:58.651508 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 12:07:58.651508 (MainThread): 09:07:58 | 
2021-05-15 12:07:58.651508 (MainThread): 09:07:58 | Finished running 2 view models in 6.47s.
2021-05-15 12:07:58.651508 (MainThread): Connection 'master' was properly closed.
2021-05-15 12:07:58.651508 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 12:07:58.651508 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 12:07:58.651508 (MainThread): Connection 'model.northwind_shop.stg_products' was properly closed.
2021-05-15 12:07:58.713631 (MainThread): 
2021-05-15 12:07:58.713631 (MainThread): Completed successfully
2021-05-15 12:07:58.713631 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-05-15 12:07:58.713631 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F0F4919D48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F0F48E21C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F0F4836B08>]}
2021-05-15 12:07:58.713631 (MainThread): Flushing usage events
2021-05-15 12:12:50.110567 (MainThread): Running with dbt=0.19.1
2021-05-15 12:12:50.575540 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 12:12:50.575540 (MainThread): Tracking: tracking
2021-05-15 12:12:50.575540 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC93D3F88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC9401CC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC9408148>]}
2021-05-15 12:12:50.595126 (MainThread): Partial parsing not enabled
2021-05-15 12:12:50.595747 (MainThread): Parsing macros\adapters.sql
2021-05-15 12:12:50.616274 (MainThread): Parsing macros\catalog.sql
2021-05-15 12:12:50.626016 (MainThread): Parsing macros\etc.sql
2021-05-15 12:12:50.630136 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 12:12:50.634727 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 12:12:50.647266 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 12:12:50.649845 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 12:12:50.649845 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 12:12:50.665279 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 12:12:50.669970 (MainThread): Parsing macros\core.sql
2021-05-15 12:12:50.680228 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 12:12:50.749750 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 12:12:50.759966 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 12:12:50.765537 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 12:12:50.767114 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 12:12:50.770267 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 12:12:50.770267 (MainThread): Parsing macros\etc\query.sql
2021-05-15 12:12:50.770267 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 12:12:50.780970 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 12:12:50.813384 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 12:12:50.816504 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 12:12:50.830937 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 12:12:50.857917 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 12:12:50.899330 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 12:12:50.901713 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 12:12:50.919900 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 12:12:50.929978 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 12:12:50.932268 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 12:12:50.942554 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 12:12:50.942554 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 12:12:50.950149 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 12:12:50.950777 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 12:12:50.961080 (MainThread): Partial parsing not enabled
2021-05-15 12:12:50.983620 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 12:12:50.993885 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 12:12:51.085778 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 12:12:51.092963 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d3ad123-6517-4ca3-976d-a61ad0759bab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EACCF72E08>]}
2021-05-15 12:12:51.093672 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d3ad123-6517-4ca3-976d-a61ad0759bab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EACCE53088>]}
2021-05-15 12:12:51.093672 (MainThread): Found 2 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-05-15 12:12:51.100651 (MainThread): 
2021-05-15 12:12:51.100651 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 12:12:51.100651 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 12:12:51.103683 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 12:12:53.012294 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 12:12:53.012294 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 12:12:53.026567 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 12:12:55.439487 (MainThread): 09:12:55 | Concurrency: 1 threads (target='dev')
2021-05-15 12:12:55.447466 (MainThread): 09:12:55 | 
2021-05-15 12:12:55.447466 (Thread-1): Began running node model.northwind_shop.stg_orders
2021-05-15 12:12:55.447466 (Thread-1): 09:12:55 | 1 of 2 START view model dbt_arthur.stg_orders........................ [RUN]
2021-05-15 12:12:55.454891 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 12:12:55.455863 (Thread-1): Compiling model.northwind_shop.stg_orders
2021-05-15 12:12:55.460101 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_orders"
2021-05-15 12:12:55.460101 (Thread-1): finished collecting timing info
2021-05-15 12:12:55.539258 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_orders"
2021-05-15 12:12:55.539258 (Thread-1): Opening a new connection, currently in state init
2021-05-15 12:12:55.555288 (Thread-1): On model.northwind_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_orders"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_orders`
  OPTIONS()
  as with
    source as (
        select 
          /*Primary key*/ 
            order_id
          /*Foreign Key*/
            ,employee_id
            ,customer_id
            ,ship_region	
            ,shipped_date
            ,ship_country	
            ,ship_name
            ,order_date		
            ,ship_postal_code	
            ,ship_city	
            ,freight	
            ,ship_via
            ,required_date
            ,ship_address
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`orders`
    )
select * from source;


2021-05-15 12:12:57.430419 (Thread-1): finished collecting timing info
2021-05-15 12:12:57.430419 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d3ad123-6517-4ca3-976d-a61ad0759bab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC94A1E08>]}
2021-05-15 12:12:57.430419 (Thread-1): 09:12:57 | 1 of 2 OK created view model dbt_arthur.stg_orders................... [OK in 1.98s]
2021-05-15 12:12:57.435407 (Thread-1): Finished running node model.northwind_shop.stg_orders
2021-05-15 12:12:57.436005 (Thread-1): Began running node model.northwind_shop.stg_products
2021-05-15 12:12:57.436552 (Thread-1): 09:12:57 | 2 of 2 START view model dbt_arthur.stg_products...................... [RUN]
2021-05-15 12:12:57.436552 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 12:12:57.436552 (Thread-1): Compiling model.northwind_shop.stg_products
2021-05-15 12:12:57.440102 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_products"
2021-05-15 12:12:57.445191 (Thread-1): finished collecting timing info
2021-05-15 12:12:57.445191 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_products"
2021-05-15 12:12:57.451938 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 12:12:57.460095 (Thread-1): On model.northwind_shop.stg_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_products`
  OPTIONS()
  as with
    source as (
        select 
            /* Primary key */
               product_id

            /*Foreign key */
            , category_id
            , supplier_id

            , units_in_stock           	
            , unit_price	
            , product_name	
            , quantity_per_unit	
            	
            , reorder_level	
            , units_on_order	
            , 
                case
                 when discontinued = 1 then True
                 else False
                end as is_discontinued 
            /* Stitich Columns*/
            , _sdc_table_version
            , _sdc_sequence
            , _sdc_batched_at	
            , _sdc_extracted_at	
            , _sdc_received_at

        from `northwind1-313400`.`northwind_etl`.`products`
    )
select * from source;


2021-05-15 12:12:58.989738 (Thread-1): finished collecting timing info
2021-05-15 12:12:58.989738 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d3ad123-6517-4ca3-976d-a61ad0759bab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EACCE50988>]}
2021-05-15 12:12:58.989738 (Thread-1): 09:12:58 | 2 of 2 OK created view model dbt_arthur.stg_products................. [OK in 1.55s]
2021-05-15 12:12:58.998112 (Thread-1): Finished running node model.northwind_shop.stg_products
2021-05-15 12:12:59.030347 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 12:12:59.030347 (MainThread): 09:12:59 | 
2021-05-15 12:12:59.030347 (MainThread): 09:12:59 | Finished running 2 view models in 7.93s.
2021-05-15 12:12:59.034157 (MainThread): Connection 'master' was properly closed.
2021-05-15 12:12:59.034939 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 12:12:59.034939 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 12:12:59.034939 (MainThread): Connection 'model.northwind_shop.stg_products' was properly closed.
2021-05-15 12:12:59.040256 (MainThread): 
2021-05-15 12:12:59.040256 (MainThread): Completed successfully
2021-05-15 12:12:59.040256 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-05-15 12:12:59.049853 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EACCE7FD88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EACCF0DB88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EACCEB0EC8>]}
2021-05-15 12:12:59.050345 (MainThread): Flushing usage events
2021-05-15 12:14:40.802267 (MainThread): Running with dbt=0.19.1
2021-05-15 12:14:41.134173 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 12:14:41.134173 (MainThread): Tracking: tracking
2021-05-15 12:14:41.134173 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269B39E2E48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269B39E2D48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269B39E2C48>]}
2021-05-15 12:14:41.142171 (MainThread): Partial parsing not enabled
2021-05-15 12:14:41.142171 (MainThread): Parsing macros\adapters.sql
2021-05-15 12:14:41.158163 (MainThread): Parsing macros\catalog.sql
2021-05-15 12:14:41.166160 (MainThread): Parsing macros\etc.sql
2021-05-15 12:14:41.166160 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 12:14:41.174157 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 12:14:41.182154 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 12:14:41.190150 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 12:14:41.190150 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 12:14:41.198147 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 12:14:41.206144 (MainThread): Parsing macros\core.sql
2021-05-15 12:14:41.206144 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 12:14:41.246127 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 12:14:41.254123 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 12:14:41.254123 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 12:14:41.254123 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 12:14:41.262120 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 12:14:41.262120 (MainThread): Parsing macros\etc\query.sql
2021-05-15 12:14:41.262120 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 12:14:41.270117 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 12:14:41.286110 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 12:14:41.286110 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 12:14:41.294107 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 12:14:41.310100 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 12:14:41.342152 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 12:14:41.342152 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 12:14:41.366950 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 12:14:41.366950 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 12:14:41.374956 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 12:14:41.382943 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 12:14:41.382943 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 12:14:41.382943 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 12:14:41.390947 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 12:14:41.390947 (MainThread): Partial parsing not enabled
2021-05-15 12:14:41.414958 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 12:14:41.422934 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 12:14:41.494903 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 12:14:41.502176 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c74becd-c138-4fd4-87b7-46fb778684f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269B754FAC8>]}
2021-05-15 12:14:41.502176 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c74becd-c138-4fd4-87b7-46fb778684f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269B742A508>]}
2021-05-15 12:14:41.502176 (MainThread): Found 2 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-05-15 12:14:41.510205 (MainThread): 
2021-05-15 12:14:41.510205 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 12:14:41.510205 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 12:14:41.510205 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 12:14:43.989743 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 12:14:43.989743 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 12:14:43.997739 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 12:14:45.391488 (MainThread): 09:14:45 | Concurrency: 1 threads (target='dev')
2021-05-15 12:14:45.391488 (MainThread): 09:14:45 | 
2021-05-15 12:14:45.398935 (Thread-1): Began running node model.northwind_shop.stg_orders
2021-05-15 12:14:45.398935 (Thread-1): 09:14:45 | 1 of 2 START view model dbt_arthur.stg_orders........................ [RUN]
2021-05-15 12:14:45.398935 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 12:14:45.398935 (Thread-1): Compiling model.northwind_shop.stg_orders
2021-05-15 12:14:45.406986 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_orders"
2021-05-15 12:14:45.406986 (Thread-1): finished collecting timing info
2021-05-15 12:14:45.438973 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_orders"
2021-05-15 12:14:45.438973 (Thread-1): Opening a new connection, currently in state init
2021-05-15 12:14:45.446969 (Thread-1): On model.northwind_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_orders"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_orders`
  OPTIONS()
  as with
    source as (
        select 
          /*Primary key*/ 
            order_id
          /*Foreign Key*/
            ,employee_id
            ,customer_id
            ,ship_region	
            ,shipped_date
            ,ship_country	
            ,ship_name
            ,order_date		
            ,ship_postal_code	
            ,ship_city	
            ,freight	
            ,ship_via as ship_id
            ,required_date
            ,ship_address
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`orders`
    )
select * from source;


2021-05-15 12:14:48.598833 (Thread-1): finished collecting timing info
2021-05-15 12:14:48.598833 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c74becd-c138-4fd4-87b7-46fb778684f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269B74B2C88>]}
2021-05-15 12:14:48.598833 (Thread-1): 09:14:48 | 1 of 2 OK created view model dbt_arthur.stg_orders................... [OK in 3.20s]
2021-05-15 12:14:48.598833 (Thread-1): Finished running node model.northwind_shop.stg_orders
2021-05-15 12:14:48.598833 (Thread-1): Began running node model.northwind_shop.stg_products
2021-05-15 12:14:48.598833 (Thread-1): 09:14:48 | 2 of 2 START view model dbt_arthur.stg_products...................... [RUN]
2021-05-15 12:14:48.598833 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 12:14:48.598833 (Thread-1): Compiling model.northwind_shop.stg_products
2021-05-15 12:14:48.606946 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_products"
2021-05-15 12:14:48.608623 (Thread-1): finished collecting timing info
2021-05-15 12:14:48.612376 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_products"
2021-05-15 12:14:48.612376 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 12:14:48.612376 (Thread-1): On model.northwind_shop.stg_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_products`
  OPTIONS()
  as with
    source as (
        select 
            /* Primary key */
               product_id

            /*Foreign key */
            , category_id
            , supplier_id

            , units_in_stock           	
            , unit_price	
            , product_name	
            , quantity_per_unit	
            	
            , reorder_level	
            , units_on_order	
            , 
                case
                 when discontinued = 1 then True
                 else False
                end as is_discontinued 
            /* Stitich Columns*/
            , _sdc_table_version
            , _sdc_sequence
            , _sdc_batched_at	
            , _sdc_extracted_at	
            , _sdc_received_at

        from `northwind1-313400`.`northwind_etl`.`products`
    )
select * from source;


2021-05-15 12:14:51.262478 (Thread-1): finished collecting timing info
2021-05-15 12:14:51.262478 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c74becd-c138-4fd4-87b7-46fb778684f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269B73F79C8>]}
2021-05-15 12:14:51.262478 (Thread-1): 09:14:51 | 2 of 2 OK created view model dbt_arthur.stg_products................. [OK in 2.66s]
2021-05-15 12:14:51.269519 (Thread-1): Finished running node model.northwind_shop.stg_products
2021-05-15 12:14:51.378979 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 12:14:51.378979 (MainThread): 09:14:51 | 
2021-05-15 12:14:51.378979 (MainThread): 09:14:51 | Finished running 2 view models in 9.87s.
2021-05-15 12:14:51.378979 (MainThread): Connection 'master' was properly closed.
2021-05-15 12:14:51.378979 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 12:14:51.378979 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 12:14:51.378979 (MainThread): Connection 'model.northwind_shop.stg_products' was properly closed.
2021-05-15 12:14:51.386667 (MainThread): 
2021-05-15 12:14:51.386667 (MainThread): Completed successfully
2021-05-15 12:14:51.386667 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-05-15 12:14:51.386667 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269B7475348>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269B74EC9C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269B74D8AC8>]}
2021-05-15 12:14:51.394792 (MainThread): Flushing usage events
2021-05-15 12:15:21.053773 (MainThread): Running with dbt=0.19.1
2021-05-15 12:15:21.479255 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 12:15:21.479255 (MainThread): Tracking: tracking
2021-05-15 12:15:21.479255 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDD0686E08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDD06B4B88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDD06B4AC8>]}
2021-05-15 12:15:21.487253 (MainThread): Partial parsing not enabled
2021-05-15 12:15:21.487253 (MainThread): Parsing macros\adapters.sql
2021-05-15 12:15:21.503245 (MainThread): Parsing macros\catalog.sql
2021-05-15 12:15:21.511242 (MainThread): Parsing macros\etc.sql
2021-05-15 12:15:21.511242 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 12:15:21.519240 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 12:15:21.527234 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 12:15:21.535233 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 12:15:21.535233 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 12:15:21.543231 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 12:15:21.551226 (MainThread): Parsing macros\core.sql
2021-05-15 12:15:21.551226 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 12:15:21.591208 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 12:15:21.599205 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 12:15:21.599205 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 12:15:21.599205 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 12:15:21.607203 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 12:15:21.607203 (MainThread): Parsing macros\etc\query.sql
2021-05-15 12:15:21.607203 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 12:15:21.615200 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 12:15:21.631191 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 12:15:21.631191 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 12:15:21.639189 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 12:15:21.655181 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 12:15:21.687167 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 12:15:21.687167 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 12:15:21.703161 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 12:15:21.711158 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 12:15:21.719155 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 12:15:21.727152 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 12:15:21.727152 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 12:15:21.727152 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 12:15:21.727152 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 12:15:21.735150 (MainThread): Partial parsing not enabled
2021-05-15 12:15:21.759140 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 12:15:21.767786 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 12:15:21.839945 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 12:15:21.842329 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f36ad189-29fc-4543-aea7-5cf3093d3319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDD421FDC8>]}
2021-05-15 12:15:21.842329 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f36ad189-29fc-4543-aea7-5cf3093d3319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDD40F7488>]}
2021-05-15 12:15:21.842329 (MainThread): Found 2 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-05-15 12:15:21.842329 (MainThread): 
2021-05-15 12:15:21.850365 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 12:15:21.851123 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 12:15:21.851123 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 12:15:23.516452 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 12:15:23.517133 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 12:15:23.526057 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 12:15:25.461605 (MainThread): 09:15:25 | Concurrency: 1 threads (target='dev')
2021-05-15 12:15:25.461605 (MainThread): 09:15:25 | 
2021-05-15 12:15:25.469556 (Thread-1): Began running node model.northwind_shop.stg_orders
2021-05-15 12:15:25.469556 (Thread-1): 09:15:25 | 1 of 2 START view model dbt_arthur.stg_orders........................ [RUN]
2021-05-15 12:15:25.469556 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 12:15:25.469556 (Thread-1): Compiling model.northwind_shop.stg_orders
2021-05-15 12:15:25.477636 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_orders"
2021-05-15 12:15:25.477636 (Thread-1): finished collecting timing info
2021-05-15 12:15:25.509537 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_orders"
2021-05-15 12:15:25.509537 (Thread-1): Opening a new connection, currently in state init
2021-05-15 12:15:25.517589 (Thread-1): On model.northwind_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_orders"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_orders`
  OPTIONS()
  as with
    source as (
        select 
          /*Primary key*/ 
            order_id
          /*Foreign Key*/
            ,employee_id
            ,customer_id
            ,ship_region	
            ,shipped_date
            ,ship_country	
            ,ship_name
            ,order_date		
            ,ship_postal_code	
            ,ship_city	
            ,freight	
            ,ship_via as ship_id
            ,required_date
            ,ship_address
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`orders`
    )
select * from source;


2021-05-15 12:15:27.873770 (Thread-1): finished collecting timing info
2021-05-15 12:15:27.873770 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f36ad189-29fc-4543-aea7-5cf3093d3319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDD40F7B48>]}
2021-05-15 12:15:27.873770 (Thread-1): 09:15:27 | 1 of 2 OK created view model dbt_arthur.stg_orders................... [OK in 2.40s]
2021-05-15 12:15:27.873770 (Thread-1): Finished running node model.northwind_shop.stg_orders
2021-05-15 12:15:27.873770 (Thread-1): Began running node model.northwind_shop.stg_products
2021-05-15 12:15:27.873770 (Thread-1): 09:15:27 | 2 of 2 START view model dbt_arthur.stg_products...................... [RUN]
2021-05-15 12:15:27.873770 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 12:15:27.873770 (Thread-1): Compiling model.northwind_shop.stg_products
2021-05-15 12:15:27.881719 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_products"
2021-05-15 12:15:27.881719 (Thread-1): finished collecting timing info
2021-05-15 12:15:27.881719 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_products"
2021-05-15 12:15:27.881719 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 12:15:27.890073 (Thread-1): On model.northwind_shop.stg_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_products`
  OPTIONS()
  as with
    source as (
        select 
            /* Primary key */
               product_id

            /*Foreign key */
            , category_id
            , supplier_id

            , units_in_stock           	
            , unit_price	
            , product_name	
            , quantity_per_unit	
            	
            , reorder_level	
            , units_on_order	
            , 
                case
                 when discontinued = 1 then True
                 else False
                end as is_discontinued 
            /* Stitich Columns*/
            , _sdc_table_version
            , _sdc_sequence
            , _sdc_batched_at	
            , _sdc_extracted_at	
            , _sdc_received_at

        from `northwind1-313400`.`northwind_etl`.`products`
    )
select * from source;


2021-05-15 12:15:30.172469 (Thread-1): finished collecting timing info
2021-05-15 12:15:30.172469 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f36ad189-29fc-4543-aea7-5cf3093d3319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDD41B2B48>]}
2021-05-15 12:15:30.172469 (Thread-1): 09:15:30 | 2 of 2 OK created view model dbt_arthur.stg_products................. [OK in 2.30s]
2021-05-15 12:15:30.172469 (Thread-1): Finished running node model.northwind_shop.stg_products
2021-05-15 12:15:30.232354 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 12:15:30.232354 (MainThread): 09:15:30 | 
2021-05-15 12:15:30.232354 (MainThread): 09:15:30 | Finished running 2 view models in 8.38s.
2021-05-15 12:15:30.232354 (MainThread): Connection 'master' was properly closed.
2021-05-15 12:15:30.232354 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 12:15:30.232354 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 12:15:30.232354 (MainThread): Connection 'model.northwind_shop.stg_products' was properly closed.
2021-05-15 12:15:30.243634 (MainThread): 
2021-05-15 12:15:30.243634 (MainThread): Completed successfully
2021-05-15 12:15:30.246248 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-05-15 12:15:30.248554 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDD41312C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDD41BB8C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDD41B72C8>]}
2021-05-15 12:15:30.249025 (MainThread): Flushing usage events
2021-05-15 12:25:59.437871 (MainThread): Running with dbt=0.19.1
2021-05-15 12:25:59.751676 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 12:25:59.751676 (MainThread): Tracking: tracking
2021-05-15 12:25:59.751676 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA75372D08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA75372B88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA75372AC8>]}
2021-05-15 12:25:59.759673 (MainThread): Partial parsing not enabled
2021-05-15 12:25:59.767671 (MainThread): Parsing macros\adapters.sql
2021-05-15 12:25:59.783663 (MainThread): Parsing macros\catalog.sql
2021-05-15 12:25:59.791660 (MainThread): Parsing macros\etc.sql
2021-05-15 12:25:59.791660 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 12:25:59.791660 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 12:25:59.807652 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 12:25:59.807652 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 12:25:59.807652 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 12:25:59.824717 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 12:25:59.832733 (MainThread): Parsing macros\core.sql
2021-05-15 12:25:59.832733 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 12:25:59.874420 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 12:25:59.882418 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 12:25:59.882418 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 12:25:59.890414 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 12:25:59.890414 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 12:25:59.890414 (MainThread): Parsing macros\etc\query.sql
2021-05-15 12:25:59.890414 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 12:25:59.902960 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 12:25:59.918961 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 12:25:59.918961 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 12:25:59.926959 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 12:25:59.948507 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 12:25:59.980279 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 12:25:59.982321 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 12:25:59.997432 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 12:26:00.005430 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 12:26:00.005430 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 12:26:00.016799 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 12:26:00.025360 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 12:26:00.025360 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 12:26:00.033364 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 12:26:00.041369 (MainThread): Partial parsing not enabled
2021-05-15 12:26:00.065649 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 12:26:00.073646 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 12:26:00.073646 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 12:26:00.142745 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 12:26:00.150704 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c220ab38-6552-4a8b-ba63-5d03731145ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA78E14A88>]}
2021-05-15 12:26:00.150704 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c220ab38-6552-4a8b-ba63-5d03731145ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA78DA2B88>]}
2021-05-15 12:26:00.150704 (MainThread): Found 3 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-05-15 12:26:00.158741 (MainThread): 
2021-05-15 12:26:00.158741 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 12:26:00.158741 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 12:26:00.158741 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 12:26:01.577610 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 12:26:01.577610 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 12:26:01.586761 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 12:26:02.740224 (MainThread): 09:26:02 | Concurrency: 1 threads (target='dev')
2021-05-15 12:26:02.740224 (MainThread): 09:26:02 | 
2021-05-15 12:26:02.746696 (Thread-1): Began running node model.northwind_shop.stg_orders
2021-05-15 12:26:02.746696 (Thread-1): 09:26:02 | 1 of 2 START view model dbt_arthur.stg_orders........................ [RUN]
2021-05-15 12:26:02.749689 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 12:26:02.750185 (Thread-1): Compiling model.northwind_shop.stg_orders
2021-05-15 12:26:02.756586 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_orders"
2021-05-15 12:26:02.758696 (Thread-1): finished collecting timing info
2021-05-15 12:26:02.828415 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_orders"
2021-05-15 12:26:02.830006 (Thread-1): Opening a new connection, currently in state init
2021-05-15 12:26:02.835685 (Thread-1): On model.northwind_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_orders"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_orders`
  OPTIONS()
  as with
    source as (
        select 
          /*Primary key*/ 
            order_id
          /*Foreign Key*/
            ,employee_id
            ,customer_id
            ,ship_region	
            ,shipped_date
            ,ship_country	
            ,ship_name
            ,order_date		
            ,ship_postal_code	
            ,ship_city	
            ,freight	
            ,ship_via as ship_id
            ,required_date
            ,ship_address
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`orders`
    )
select * from source;


2021-05-15 12:26:05.070883 (Thread-1): finished collecting timing info
2021-05-15 12:26:05.070883 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c220ab38-6552-4a8b-ba63-5d03731145ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA78E19B88>]}
2021-05-15 12:26:05.070883 (Thread-1): 09:26:05 | 1 of 2 OK created view model dbt_arthur.stg_orders................... [OK in 2.32s]
2021-05-15 12:26:05.070883 (Thread-1): Finished running node model.northwind_shop.stg_orders
2021-05-15 12:26:05.078880 (Thread-1): Began running node model.northwind_shop.stg_products
2021-05-15 12:26:05.078880 (Thread-1): 09:26:05 | 2 of 2 START view model dbt_arthur.stg_products...................... [RUN]
2021-05-15 12:26:05.078880 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 12:26:05.078880 (Thread-1): Compiling model.northwind_shop.stg_products
2021-05-15 12:26:05.078880 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_products"
2021-05-15 12:26:05.078880 (Thread-1): finished collecting timing info
2021-05-15 12:26:05.086876 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_products"
2021-05-15 12:26:05.086876 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 12:26:05.094941 (Thread-1): On model.northwind_shop.stg_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_products`
  OPTIONS()
  as with
    source as (
        select 
            /* Primary key */
               product_id

            /*Foreign key */
            , category_id
            , supplier_id

            , units_in_stock           	
            , unit_price	
            , product_name	
            , quantity_per_unit	
            	
            , reorder_level	
            , units_on_order	
            , 
                case
                 when discontinued = 1 then True
                 else False
                end as is_discontinued 
            /* Stitich Columns*/
            , _sdc_table_version
            , _sdc_sequence
            , _sdc_batched_at	
            , _sdc_extracted_at	
            , _sdc_received_at

        from `northwind1-313400`.`northwind_etl`.`products`
    )
select * from source;


2021-05-15 12:26:07.262858 (Thread-1): finished collecting timing info
2021-05-15 12:26:07.262858 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c220ab38-6552-4a8b-ba63-5d03731145ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA76DAB948>]}
2021-05-15 12:26:07.262858 (Thread-1): 09:26:07 | 2 of 2 OK created view model dbt_arthur.stg_products................. [OK in 2.18s]
2021-05-15 12:26:07.270776 (Thread-1): Finished running node model.northwind_shop.stg_products
2021-05-15 12:26:07.346602 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 12:26:07.346602 (MainThread): 09:26:07 | 
2021-05-15 12:26:07.346602 (MainThread): 09:26:07 | Finished running 2 view models in 7.19s.
2021-05-15 12:26:07.346602 (MainThread): Connection 'master' was properly closed.
2021-05-15 12:26:07.350109 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 12:26:07.350109 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 12:26:07.350109 (MainThread): Connection 'model.northwind_shop.stg_products' was properly closed.
2021-05-15 12:26:07.355183 (MainThread): 
2021-05-15 12:26:07.355183 (MainThread): Completed successfully
2021-05-15 12:26:07.355183 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-05-15 12:26:07.358272 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA78D83348>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA78DF4188>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA78DF4108>]}
2021-05-15 12:26:07.358927 (MainThread): Flushing usage events
2021-05-15 12:33:56.576753 (MainThread): Running with dbt=0.19.1
2021-05-15 12:33:56.917844 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 12:33:56.917844 (MainThread): Tracking: tracking
2021-05-15 12:33:56.917844 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C2E88D9C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C2E8939C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C2E896488>]}
2021-05-15 12:33:56.933466 (MainThread): Partial parsing not enabled
2021-05-15 12:33:56.933466 (MainThread): Parsing macros\adapters.sql
2021-05-15 12:33:56.949090 (MainThread): Parsing macros\catalog.sql
2021-05-15 12:33:56.949090 (MainThread): Parsing macros\etc.sql
2021-05-15 12:33:56.949090 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 12:33:56.964712 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 12:33:56.964712 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 12:33:56.980336 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 12:33:56.980336 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 12:33:56.980336 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 12:33:56.995959 (MainThread): Parsing macros\core.sql
2021-05-15 12:33:56.995959 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 12:33:57.034317 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 12:33:57.050014 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 12:33:57.050014 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 12:33:57.050014 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 12:33:57.050014 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 12:33:57.050014 (MainThread): Parsing macros\etc\query.sql
2021-05-15 12:33:57.050014 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 12:33:57.068296 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 12:33:57.084013 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 12:33:57.084013 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 12:33:57.084013 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 12:33:57.101230 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 12:33:57.132566 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 12:33:57.132566 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 12:33:57.148200 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 12:33:57.163816 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 12:33:57.163816 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 12:33:57.163816 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 12:33:57.179449 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 12:33:57.179449 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 12:33:57.179449 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 12:33:57.179449 (MainThread): Partial parsing not enabled
2021-05-15 12:33:57.195080 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 12:33:57.210685 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 12:33:57.210685 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 12:33:57.289887 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 12:33:57.298511 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9a7bc57-dd7e-4a78-a2c9-135199a072a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C3235BD08>]}
2021-05-15 12:33:57.298511 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9a7bc57-dd7e-4a78-a2c9-135199a072a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C32453E88>]}
2021-05-15 12:33:57.298511 (MainThread): Found 3 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-05-15 12:33:57.307094 (MainThread): 
2021-05-15 12:33:57.308467 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 12:33:57.309151 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 12:33:57.309151 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 12:33:58.711011 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 12:33:58.717818 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 12:33:58.726671 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 12:33:59.274799 (MainThread): 09:33:59 | Concurrency: 1 threads (target='dev')
2021-05-15 12:33:59.275792 (MainThread): 09:33:59 | 
2021-05-15 12:33:59.280211 (Thread-1): Began running node model.northwind_shop.stg_employees
2021-05-15 12:33:59.280715 (Thread-1): 09:33:59 | 1 of 3 START view model dbt_arthur.stg_employees..................... [RUN]
2021-05-15 12:33:59.282709 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 12:33:59.282709 (Thread-1): Compiling model.northwind_shop.stg_employees
2021-05-15 12:33:59.288940 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_employees"
2021-05-15 12:33:59.323047 (Thread-1): finished collecting timing info
2021-05-15 12:33:59.377806 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_employees"
2021-05-15 12:33:59.377806 (Thread-1): Opening a new connection, currently in state init
2021-05-15 12:33:59.383820 (Thread-1): On model.northwind_shop.stg_employees: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_employees"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_employees`
  OPTIONS()
  as with
    source as (
        select 
           /*primary key*/
            employee_id	
            ,country	
            ,city	
            ,postal_code
            ,hire_date	
            ,extension	
            ,address	
            ,birth_date	
            ,region	
            ,photo_path	
            ,last_name	
            ,first_name	
            ,title	
            ,title_of_courtesy	
            ,notes	
            ,home_phone	
            ,reports_to	
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`employees`
    )
select * from source;


2021-05-15 12:34:01.677772 (Thread-1): finished collecting timing info
2021-05-15 12:34:01.677772 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a7bc57-dd7e-4a78-a2c9-135199a072a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C322B2348>]}
2021-05-15 12:34:01.677772 (Thread-1): 09:34:01 | 1 of 3 OK created view model dbt_arthur.stg_employees................ [OK in 2.40s]
2021-05-15 12:34:01.677772 (Thread-1): Finished running node model.northwind_shop.stg_employees
2021-05-15 12:34:01.687458 (Thread-1): Began running node model.northwind_shop.stg_orders
2021-05-15 12:34:01.687458 (Thread-1): 09:34:01 | 2 of 3 START view model dbt_arthur.stg_orders........................ [RUN]
2021-05-15 12:34:01.687458 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 12:34:01.687458 (Thread-1): Compiling model.northwind_shop.stg_orders
2021-05-15 12:34:01.690195 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_orders"
2021-05-15 12:34:01.690195 (Thread-1): finished collecting timing info
2021-05-15 12:34:01.698237 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_orders"
2021-05-15 12:34:01.698237 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 12:34:01.706233 (Thread-1): On model.northwind_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_orders"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_orders`
  OPTIONS()
  as with
    source as (
        select 
          /*Primary key*/ 
            order_id
          /*Foreign Key*/
            ,employee_id
            ,customer_id
            ,ship_region	
            ,shipped_date
            ,ship_country	
            ,ship_name
            ,order_date		
            ,ship_postal_code	
            ,ship_city	
            ,freight	
            ,ship_via as ship_id
            ,required_date
            ,ship_address
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`orders`
    )
select * from source;


2021-05-15 12:34:03.865919 (Thread-1): finished collecting timing info
2021-05-15 12:34:03.866951 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a7bc57-dd7e-4a78-a2c9-135199a072a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C324F14C8>]}
2021-05-15 12:34:03.866951 (Thread-1): 09:34:03 | 2 of 3 OK created view model dbt_arthur.stg_orders................... [OK in 2.18s]
2021-05-15 12:34:03.869034 (Thread-1): Finished running node model.northwind_shop.stg_orders
2021-05-15 12:34:03.869483 (Thread-1): Began running node model.northwind_shop.stg_products
2021-05-15 12:34:03.869983 (Thread-1): 09:34:03 | 3 of 3 START view model dbt_arthur.stg_products...................... [RUN]
2021-05-15 12:34:03.870483 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 12:34:03.870483 (Thread-1): Compiling model.northwind_shop.stg_products
2021-05-15 12:34:03.874927 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_products"
2021-05-15 12:34:03.877603 (Thread-1): finished collecting timing info
2021-05-15 12:34:03.877603 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_products"
2021-05-15 12:34:03.877603 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 12:34:03.885729 (Thread-1): On model.northwind_shop.stg_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_products`
  OPTIONS()
  as with
    source as (
        select 
            /* Primary key */
               product_id

            /*Foreign key */
            , category_id
            , supplier_id

            , units_in_stock           	
            , unit_price	
            , product_name	
            , quantity_per_unit	
            	
            , reorder_level	
            , units_on_order	
            , 
                case
                 when discontinued = 1 then True
                 else False
                end as is_discontinued 
            /* Stitich Columns*/
            , _sdc_table_version
            , _sdc_sequence
            , _sdc_batched_at	
            , _sdc_extracted_at	
            , _sdc_received_at

        from `northwind1-313400`.`northwind_etl`.`products`
    )
select * from source;


2021-05-15 12:34:06.037731 (Thread-1): finished collecting timing info
2021-05-15 12:34:06.037731 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a7bc57-dd7e-4a78-a2c9-135199a072a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C325110C8>]}
2021-05-15 12:34:06.037731 (Thread-1): 09:34:06 | 3 of 3 OK created view model dbt_arthur.stg_products................. [OK in 2.17s]
2021-05-15 12:34:06.045747 (Thread-1): Finished running node model.northwind_shop.stg_products
2021-05-15 12:34:06.089757 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 12:34:06.089757 (MainThread): 09:34:06 | 
2021-05-15 12:34:06.089757 (MainThread): 09:34:06 | Finished running 3 view models in 8.78s.
2021-05-15 12:34:06.093346 (MainThread): Connection 'master' was properly closed.
2021-05-15 12:34:06.093346 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 12:34:06.093839 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 12:34:06.093839 (MainThread): Connection 'model.northwind_shop.stg_products' was properly closed.
2021-05-15 12:34:06.093839 (MainThread): unclosed <socket.socket fd=1300, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59299), raddr=('172.217.28.10', 443)>
2021-05-15 12:34:06.093839 (MainThread): unclosed <socket.socket fd=440, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59300), raddr=('142.250.219.10', 443)>
2021-05-15 12:34:06.147014 (MainThread): 
2021-05-15 12:34:06.147014 (MainThread): Completed successfully
2021-05-15 12:34:06.147014 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-05-15 12:34:06.154297 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C32360D88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C324FBE88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C32503D88>]}
2021-05-15 12:34:06.154297 (MainThread): Flushing usage events
2021-05-15 12:41:17.611628 (MainThread): Running with dbt=0.19.1
2021-05-15 12:41:17.949106 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 12:41:17.957104 (MainThread): Tracking: tracking
2021-05-15 12:41:17.957104 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A227F29C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A227F2488>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A227F2A48>]}
2021-05-15 12:41:17.965101 (MainThread): Partial parsing not enabled
2021-05-15 12:41:17.965101 (MainThread): Parsing macros\adapters.sql
2021-05-15 12:41:17.988229 (MainThread): Parsing macros\catalog.sql
2021-05-15 12:41:17.993509 (MainThread): Parsing macros\etc.sql
2021-05-15 12:41:17.995627 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 12:41:18.001132 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 12:41:18.017724 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 12:41:18.021302 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 12:41:18.023865 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 12:41:18.030629 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 12:41:18.038633 (MainThread): Parsing macros\core.sql
2021-05-15 12:41:18.038633 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 12:41:18.078616 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 12:41:18.086615 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 12:41:18.086615 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 12:41:18.086615 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 12:41:18.094611 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 12:41:18.094611 (MainThread): Parsing macros\etc\query.sql
2021-05-15 12:41:18.094611 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 12:41:18.102608 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 12:41:18.118600 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 12:41:18.118600 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 12:41:18.118600 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 12:41:18.145775 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 12:41:18.171807 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 12:41:18.179806 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 12:41:18.195797 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 12:41:18.203796 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 12:41:18.203796 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 12:41:18.211843 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 12:41:18.211843 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 12:41:18.211843 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 12:41:18.219840 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 12:41:18.219840 (MainThread): Partial parsing not enabled
2021-05-15 12:41:18.243830 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 12:41:18.252491 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 12:41:18.260707 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 12:41:18.260707 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 12:41:18.334539 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 12:41:18.339481 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5abb05e-4267-4a49-b657-c7a631b37385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A2628F088>]}
2021-05-15 12:41:18.339481 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5abb05e-4267-4a49-b657-c7a631b37385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A260F1848>]}
2021-05-15 12:41:18.339481 (MainThread): Found 4 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-05-15 12:41:18.347640 (MainThread): 
2021-05-15 12:41:18.347640 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 12:41:18.352410 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 12:41:18.352410 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 12:41:19.616627 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 12:41:19.616627 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 12:41:19.622921 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 12:41:20.138704 (MainThread): 09:41:20 | Concurrency: 1 threads (target='dev')
2021-05-15 12:41:20.140031 (MainThread): 09:41:20 | 
2021-05-15 12:41:20.144987 (Thread-1): Began running node model.northwind_shop.stg_customers
2021-05-15 12:41:20.145852 (Thread-1): 09:41:20 | 1 of 4 START view model dbt_arthur.stg_customers..................... [RUN]
2021-05-15 12:41:20.147341 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 12:41:20.147419 (Thread-1): Compiling model.northwind_shop.stg_customers
2021-05-15 12:41:20.153439 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_customers"
2021-05-15 12:41:20.156343 (Thread-1): finished collecting timing info
2021-05-15 12:41:20.215569 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_customers"
2021-05-15 12:41:20.217573 (Thread-1): Opening a new connection, currently in state init
2021-05-15 12:41:20.226982 (Thread-1): On model.northwind_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_customers"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_customers`
  OPTIONS()
  as with
    source as (
        select 
           /*primary key*/
            customer_id
            ,country	
            ,city	
            ,fax	
            ,postal_code	
            ,address	
            ,region	
            ,contact_name		
            ,phone	
            ,company_name	
            ,contact_title
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`customers`
    )
select * from source;


2021-05-15 12:41:22.040150 (Thread-1): finished collecting timing info
2021-05-15 12:41:22.040150 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5abb05e-4267-4a49-b657-c7a631b37385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A2640EF48>]}
2021-05-15 12:41:22.040150 (Thread-1): 09:41:22 | 1 of 4 OK created view model dbt_arthur.stg_customers................ [OK in 1.89s]
2021-05-15 12:41:22.040150 (Thread-1): Finished running node model.northwind_shop.stg_customers
2021-05-15 12:41:22.040150 (Thread-1): Began running node model.northwind_shop.stg_employees
2021-05-15 12:41:22.040150 (Thread-1): 09:41:22 | 2 of 4 START view model dbt_arthur.stg_employees..................... [RUN]
2021-05-15 12:41:22.040150 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 12:41:22.040150 (Thread-1): Compiling model.northwind_shop.stg_employees
2021-05-15 12:41:22.049260 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_employees"
2021-05-15 12:41:22.049260 (Thread-1): finished collecting timing info
2021-05-15 12:41:22.049260 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_employees"
2021-05-15 12:41:22.049260 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 12:41:22.057293 (Thread-1): On model.northwind_shop.stg_employees: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_employees"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_employees`
  OPTIONS()
  as with
    source as (
        select 
           /*primary key*/
            employee_id	
            ,country	
            ,city	
            ,postal_code
            ,hire_date	
            ,extension	
            ,address	
            ,birth_date	
            ,region	
            ,photo_path	
            ,last_name	
            ,first_name	
            ,title	
            ,title_of_courtesy	
            ,notes	
            ,home_phone	
            ,reports_to	
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`employees`
    )
select * from source;


2021-05-15 12:41:24.177430 (Thread-1): finished collecting timing info
2021-05-15 12:41:24.177430 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5abb05e-4267-4a49-b657-c7a631b37385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A26530F08>]}
2021-05-15 12:41:24.177430 (Thread-1): 09:41:24 | 2 of 4 OK created view model dbt_arthur.stg_employees................ [OK in 2.14s]
2021-05-15 12:41:24.185435 (Thread-1): Finished running node model.northwind_shop.stg_employees
2021-05-15 12:41:24.185435 (Thread-1): Began running node model.northwind_shop.stg_orders
2021-05-15 12:41:24.185435 (Thread-1): 09:41:24 | 3 of 4 START view model dbt_arthur.stg_orders........................ [RUN]
2021-05-15 12:41:24.185435 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 12:41:24.185435 (Thread-1): Compiling model.northwind_shop.stg_orders
2021-05-15 12:41:24.185435 (Thread-1): unclosed <socket.socket fd=1240, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59342), raddr=('172.217.162.138', 443)>
2021-05-15 12:41:24.185435 (Thread-1): unclosed <socket.socket fd=760, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59343), raddr=('142.250.219.10', 443)>
2021-05-15 12:41:24.193431 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_orders"
2021-05-15 12:41:24.193431 (Thread-1): finished collecting timing info
2021-05-15 12:41:24.193431 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_orders"
2021-05-15 12:41:24.193431 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 12:41:24.201451 (Thread-1): On model.northwind_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_orders"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_orders`
  OPTIONS()
  as with
    source as (
        select 
          /*Primary key*/ 
            order_id
          /*Foreign Key*/
            ,employee_id
            ,customer_id
            ,ship_region	
            ,shipped_date
            ,ship_country	
            ,ship_name
            ,order_date		
            ,ship_postal_code	
            ,ship_city	
            ,freight	
            ,ship_via as ship_id
            ,required_date
            ,ship_address
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`orders`
    )
select * from source;


2021-05-15 12:41:25.733464 (Thread-1): finished collecting timing info
2021-05-15 12:41:25.733464 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5abb05e-4267-4a49-b657-c7a631b37385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A2654FC88>]}
2021-05-15 12:41:25.733464 (Thread-1): 09:41:25 | 3 of 4 OK created view model dbt_arthur.stg_orders................... [OK in 1.55s]
2021-05-15 12:41:25.741084 (Thread-1): Finished running node model.northwind_shop.stg_orders
2021-05-15 12:41:25.741084 (Thread-1): Began running node model.northwind_shop.stg_products
2021-05-15 12:41:25.741084 (Thread-1): 09:41:25 | 4 of 4 START view model dbt_arthur.stg_products...................... [RUN]
2021-05-15 12:41:25.741084 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 12:41:25.741084 (Thread-1): Compiling model.northwind_shop.stg_products
2021-05-15 12:41:25.741084 (Thread-1): unclosed <socket.socket fd=1028, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59344), raddr=('172.217.162.138', 443)>
2021-05-15 12:41:25.741084 (Thread-1): unclosed <socket.socket fd=1236, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59345), raddr=('142.250.219.10', 443)>
2021-05-15 12:41:25.749093 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_products"
2021-05-15 12:41:25.749093 (Thread-1): finished collecting timing info
2021-05-15 12:41:25.749093 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_products"
2021-05-15 12:41:25.749093 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 12:41:25.758034 (Thread-1): On model.northwind_shop.stg_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_products`
  OPTIONS()
  as with
    source as (
        select 
            /* Primary key */
               product_id

            /*Foreign key */
            , category_id
            , supplier_id

            , units_in_stock           	
            , unit_price	
            , product_name	
            , quantity_per_unit	
            	
            , reorder_level	
            , units_on_order	
            , 
                case
                 when discontinued = 1 then True
                 else False
                end as is_discontinued 
            /* Stitich Columns*/
            , _sdc_table_version
            , _sdc_sequence
            , _sdc_batched_at	
            , _sdc_extracted_at	
            , _sdc_received_at

        from `northwind1-313400`.`northwind_etl`.`products`
    )
select * from source;


2021-05-15 12:41:27.970554 (Thread-1): finished collecting timing info
2021-05-15 12:41:27.970554 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5abb05e-4267-4a49-b657-c7a631b37385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A26528F08>]}
2021-05-15 12:41:27.970554 (Thread-1): 09:41:27 | 4 of 4 OK created view model dbt_arthur.stg_products................. [OK in 2.23s]
2021-05-15 12:41:27.970554 (Thread-1): Finished running node model.northwind_shop.stg_products
2021-05-15 12:41:28.059612 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 12:41:28.059612 (MainThread): 09:41:28 | 
2021-05-15 12:41:28.059612 (MainThread): 09:41:28 | Finished running 4 view models in 9.71s.
2021-05-15 12:41:28.059612 (MainThread): Connection 'master' was properly closed.
2021-05-15 12:41:28.059612 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 12:41:28.059612 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 12:41:28.059612 (MainThread): Connection 'model.northwind_shop.stg_products' was properly closed.
2021-05-15 12:41:28.071686 (MainThread): 
2021-05-15 12:41:28.072979 (MainThread): Completed successfully
2021-05-15 12:41:28.074086 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-05-15 12:41:28.075181 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A26509B88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A262A1FC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A262670C8>]}
2021-05-15 12:41:28.075181 (MainThread): Flushing usage events
2021-05-15 12:48:07.026334 (MainThread): Running with dbt=0.19.1
2021-05-15 12:48:07.362444 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 12:48:07.362444 (MainThread): Tracking: tracking
2021-05-15 12:48:07.362444 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F7037929C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F703792B08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F7037960C8>]}
2021-05-15 12:48:07.378074 (MainThread): Partial parsing not enabled
2021-05-15 12:48:07.378074 (MainThread): Parsing macros\adapters.sql
2021-05-15 12:48:07.393691 (MainThread): Parsing macros\catalog.sql
2021-05-15 12:48:07.393691 (MainThread): Parsing macros\etc.sql
2021-05-15 12:48:07.393691 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 12:48:07.393691 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 12:48:07.409315 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 12:48:07.409315 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 12:48:07.409315 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 12:48:07.424940 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 12:48:07.424940 (MainThread): Parsing macros\core.sql
2021-05-15 12:48:07.440565 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 12:48:07.471825 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 12:48:07.471825 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 12:48:07.471825 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 12:48:07.487433 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 12:48:07.487433 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 12:48:07.487433 (MainThread): Parsing macros\etc\query.sql
2021-05-15 12:48:07.487433 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 12:48:07.487433 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 12:48:07.503063 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 12:48:07.503063 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 12:48:07.518687 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 12:48:07.534300 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 12:48:07.558166 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 12:48:07.558166 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 12:48:07.573851 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 12:48:07.589494 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 12:48:07.589494 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 12:48:07.605060 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 12:48:07.605060 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 12:48:07.605060 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 12:48:07.605060 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 12:48:07.617519 (MainThread): Partial parsing not enabled
2021-05-15 12:48:07.634637 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 12:48:07.634637 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 12:48:07.650268 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 12:48:07.650268 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders_details".
2021-05-15 12:48:07.650268 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 12:48:07.738089 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F707455208>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F707455388>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F707425608>]}
2021-05-15 12:48:07.738089 (MainThread): Flushing usage events
2021-05-15 12:48:08.515348 (MainThread): Connection 'model.northwind_shop.stg_products' was properly closed.
2021-05-15 12:48:08.515348 (MainThread): Encountered an error:
2021-05-15 12:48:08.516192 (MainThread): Compilation Error in model stg_orders_details (models\staging\stg_orders_details.sql)
  Model 'model.northwind_shop.stg_orders_details' (models\staging\stg_orders_details.sql) depends on a source named 'northwind_etl.order_details' which was not found
2021-05-15 12:48:08.524083 (MainThread): Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 444, in load_all
    manifest = loader.create_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 422, in create_manifest
    self.process_manifest(manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 387, in process_manifest
    process_sources(manifest, project_name)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 820, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 807, in _process_sources_for_node
    disabled=(isinstance(target_source, Disabled))
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 510, in invalid_source_fail_unless_test
    disabled=disabled
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 597, in source_target_not_found
    raise_compiler_error(msg, model)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model stg_orders_details (models\staging\stg_orders_details.sql)
  Model 'model.northwind_shop.stg_orders_details' (models\staging\stg_orders_details.sql) depends on a source named 'northwind_etl.order_details' which was not found

2021-05-15 12:48:44.489877 (MainThread): Running with dbt=0.19.1
2021-05-15 12:48:44.805483 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 12:48:44.813480 (MainThread): Tracking: tracking
2021-05-15 12:48:44.813480 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F17614B808>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F176262A08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F176262848>]}
2021-05-15 12:48:44.821477 (MainThread): Partial parsing not enabled
2021-05-15 12:48:44.821477 (MainThread): Parsing macros\adapters.sql
2021-05-15 12:48:44.837470 (MainThread): Parsing macros\catalog.sql
2021-05-15 12:48:44.845466 (MainThread): Parsing macros\etc.sql
2021-05-15 12:48:44.845466 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 12:48:44.853463 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 12:48:44.864719 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 12:48:44.867765 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 12:48:44.869889 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 12:48:44.879012 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 12:48:44.885234 (MainThread): Parsing macros\core.sql
2021-05-15 12:48:44.889299 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 12:48:44.931995 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 12:48:44.939992 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 12:48:44.939992 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 12:48:44.939992 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 12:48:44.939992 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 12:48:44.939992 (MainThread): Parsing macros\etc\query.sql
2021-05-15 12:48:44.947989 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 12:48:44.955986 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 12:48:44.963982 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 12:48:44.971979 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 12:48:44.971979 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 12:48:44.995969 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 12:48:45.027955 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 12:48:45.027955 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 12:48:45.049917 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 12:48:45.049917 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 12:48:45.057914 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 12:48:45.065910 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 12:48:45.065910 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 12:48:45.065910 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 12:48:45.073907 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 12:48:45.073907 (MainThread): Partial parsing not enabled
2021-05-15 12:48:45.097898 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 12:48:45.105894 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 12:48:45.105894 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 12:48:45.113890 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-05-15 12:48:45.113890 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 12:48:45.185864 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F179F202C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F179F200C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F179F20088>]}
2021-05-15 12:48:45.185864 (MainThread): Flushing usage events
2021-05-15 12:48:46.340017 (MainThread): Connection 'model.northwind_shop.stg_products' was properly closed.
2021-05-15 12:48:46.340017 (MainThread): Encountered an error:
2021-05-15 12:48:46.340861 (MainThread): Compilation Error in model stg_order_details (models\staging\stg_order_details.sql)
  Model 'model.northwind_shop.stg_order_details' (models\staging\stg_order_details.sql) depends on a source named 'northwind_etl.order_details' which was not found
2021-05-15 12:48:46.345401 (MainThread): Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 444, in load_all
    manifest = loader.create_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 422, in create_manifest
    self.process_manifest(manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 387, in process_manifest
    process_sources(manifest, project_name)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 820, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 807, in _process_sources_for_node
    disabled=(isinstance(target_source, Disabled))
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 510, in invalid_source_fail_unless_test
    disabled=disabled
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 597, in source_target_not_found
    raise_compiler_error(msg, model)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model stg_order_details (models\staging\stg_order_details.sql)
  Model 'model.northwind_shop.stg_order_details' (models\staging\stg_order_details.sql) depends on a source named 'northwind_etl.order_details' which was not found

2021-05-15 12:49:31.737070 (MainThread): Running with dbt=0.19.1
2021-05-15 12:49:32.061837 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 12:49:32.061837 (MainThread): Tracking: tracking
2021-05-15 12:49:32.061837 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD24CE2BC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD24CE2908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD24CE2C48>]}
2021-05-15 12:49:32.077460 (MainThread): Partial parsing not enabled
2021-05-15 12:49:32.077460 (MainThread): Parsing macros\adapters.sql
2021-05-15 12:49:32.093744 (MainThread): Parsing macros\catalog.sql
2021-05-15 12:49:32.109411 (MainThread): Parsing macros\etc.sql
2021-05-15 12:49:32.109411 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 12:49:32.109411 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 12:49:32.125035 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 12:49:32.125035 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 12:49:32.125035 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 12:49:32.140657 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 12:49:32.140657 (MainThread): Parsing macros\core.sql
2021-05-15 12:49:32.140657 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 12:49:32.187527 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 12:49:32.187527 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 12:49:32.203151 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 12:49:32.203151 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 12:49:32.203151 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 12:49:32.203151 (MainThread): Parsing macros\etc\query.sql
2021-05-15 12:49:32.203151 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 12:49:32.218775 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 12:49:32.218775 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 12:49:32.234398 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 12:49:32.234398 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 12:49:32.250022 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 12:49:32.281266 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 12:49:32.281266 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 12:49:32.296891 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 12:49:32.312902 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 12:49:32.320900 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 12:49:32.328896 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 12:49:32.328896 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 12:49:32.328896 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 12:49:32.335173 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 12:49:32.335173 (MainThread): Partial parsing not enabled
2021-05-15 12:49:32.350797 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 12:49:32.366420 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 12:49:32.366420 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 12:49:32.366420 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-05-15 12:49:32.382044 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 12:49:32.444537 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD289AF448>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD289AF148>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD289A8C88>]}
2021-05-15 12:49:32.444537 (MainThread): Flushing usage events
2021-05-15 12:49:33.953859 (MainThread): Connection 'model.northwind_shop.stg_products' was properly closed.
2021-05-15 12:49:33.953859 (MainThread): Encountered an error:
2021-05-15 12:49:33.956574 (MainThread): Compilation Error in model stg_order_details (models\staging\stg_order_details.sql)
  Model 'model.northwind_shop.stg_order_details' (models\staging\stg_order_details.sql) depends on a source named 'northwind_etl.order_details' which was not found
2021-05-15 12:49:33.960050 (MainThread): Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 444, in load_all
    manifest = loader.create_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 422, in create_manifest
    self.process_manifest(manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 387, in process_manifest
    process_sources(manifest, project_name)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 820, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 807, in _process_sources_for_node
    disabled=(isinstance(target_source, Disabled))
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 510, in invalid_source_fail_unless_test
    disabled=disabled
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 597, in source_target_not_found
    raise_compiler_error(msg, model)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model stg_order_details (models\staging\stg_order_details.sql)
  Model 'model.northwind_shop.stg_order_details' (models\staging\stg_order_details.sql) depends on a source named 'northwind_etl.order_details' which was not found

2021-05-15 12:50:08.043984 (MainThread): Running with dbt=0.19.1
2021-05-15 12:50:08.362887 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 12:50:08.362887 (MainThread): Tracking: tracking
2021-05-15 12:50:08.362887 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297BA5D2A88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297BA5D2BC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297BA5D6188>]}
2021-05-15 12:50:08.362887 (MainThread): Partial parsing not enabled
2021-05-15 12:50:08.378556 (MainThread): Parsing macros\adapters.sql
2021-05-15 12:50:08.394184 (MainThread): Parsing macros\catalog.sql
2021-05-15 12:50:08.394184 (MainThread): Parsing macros\etc.sql
2021-05-15 12:50:08.394184 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 12:50:08.394184 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 12:50:08.409812 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 12:50:08.409812 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 12:50:08.409812 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 12:50:08.425437 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 12:50:08.425437 (MainThread): Parsing macros\core.sql
2021-05-15 12:50:08.441055 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 12:50:08.473506 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 12:50:08.483103 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 12:50:08.483103 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 12:50:08.483103 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 12:50:08.483103 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 12:50:08.483103 (MainThread): Parsing macros\etc\query.sql
2021-05-15 12:50:08.483103 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 12:50:08.498794 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 12:50:08.514423 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 12:50:08.514423 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 12:50:08.514423 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 12:50:08.530046 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 12:50:08.561278 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 12:50:08.561278 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 12:50:08.592535 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 12:50:08.596093 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 12:50:08.596093 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 12:50:08.596093 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 12:50:08.611819 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 12:50:08.611819 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 12:50:08.611819 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 12:50:08.611819 (MainThread): Partial parsing not enabled
2021-05-15 12:50:08.627444 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 12:50:08.643059 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 12:50:08.643059 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 12:50:08.658681 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-05-15 12:50:08.658681 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 12:50:08.721169 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297BE29B048>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297BE29B388>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297BE29B088>]}
2021-05-15 12:50:08.721169 (MainThread): Flushing usage events
2021-05-15 12:50:09.896834 (MainThread): Connection 'model.northwind_shop.stg_products' was properly closed.
2021-05-15 12:50:09.896834 (MainThread): Encountered an error:
2021-05-15 12:50:09.896834 (MainThread): Compilation Error in model stg_order_details (models\staging\stg_order_details.sql)
  Model 'model.northwind_shop.stg_order_details' (models\staging\stg_order_details.sql) depends on a source named 'northwind_etl.order_details' which was not found
2021-05-15 12:50:09.905329 (MainThread): Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 444, in load_all
    manifest = loader.create_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 422, in create_manifest
    self.process_manifest(manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 387, in process_manifest
    process_sources(manifest, project_name)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 820, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 807, in _process_sources_for_node
    disabled=(isinstance(target_source, Disabled))
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 510, in invalid_source_fail_unless_test
    disabled=disabled
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 597, in source_target_not_found
    raise_compiler_error(msg, model)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model stg_order_details (models\staging\stg_order_details.sql)
  Model 'model.northwind_shop.stg_order_details' (models\staging\stg_order_details.sql) depends on a source named 'northwind_etl.order_details' which was not found

2021-05-15 12:51:04.299398 (MainThread): Running with dbt=0.19.1
2021-05-15 12:51:04.686191 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 12:51:04.686191 (MainThread): Tracking: tracking
2021-05-15 12:51:04.686191 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E925B2CC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E925B2BC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E925B2B08>]}
2021-05-15 12:51:04.694194 (MainThread): Partial parsing not enabled
2021-05-15 12:51:04.694194 (MainThread): Parsing macros\adapters.sql
2021-05-15 12:51:04.710189 (MainThread): Parsing macros\catalog.sql
2021-05-15 12:51:04.718179 (MainThread): Parsing macros\etc.sql
2021-05-15 12:51:04.718179 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 12:51:04.726178 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 12:51:04.734174 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 12:51:04.734174 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 12:51:04.742181 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 12:51:04.750164 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 12:51:04.750164 (MainThread): Parsing macros\core.sql
2021-05-15 12:51:04.758165 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 12:51:04.799818 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 12:51:04.807816 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 12:51:04.807816 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 12:51:04.807816 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 12:51:04.807816 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 12:51:04.807816 (MainThread): Parsing macros\etc\query.sql
2021-05-15 12:51:04.807816 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 12:51:04.815816 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 12:51:04.831811 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 12:51:04.831811 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 12:51:04.839800 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 12:51:04.855798 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 12:51:04.887775 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 12:51:04.887775 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 12:51:04.903774 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 12:51:04.911773 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 12:51:04.919784 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 12:51:04.927765 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 12:51:04.927765 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 12:51:04.927765 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 12:51:04.927765 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 12:51:04.935774 (MainThread): Partial parsing not enabled
2021-05-15 12:51:04.959744 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 12:51:04.975740 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 12:51:04.983733 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 12:51:04.991740 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-05-15 12:51:04.991740 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 12:51:05.063659 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E9626F3C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E9626F088>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E96054C48>]}
2021-05-15 12:51:05.063659 (MainThread): Flushing usage events
2021-05-15 12:51:06.157826 (MainThread): Connection 'model.northwind_shop.stg_products' was properly closed.
2021-05-15 12:51:06.157826 (MainThread): Encountered an error:
2021-05-15 12:51:06.158555 (MainThread): Compilation Error in model stg_order_details (models\staging\stg_order_details.sql)
  Model 'model.northwind_shop.stg_order_details' (models\staging\stg_order_details.sql) depends on a source named 'northwind_etl.order_details' which was not found
2021-05-15 12:51:06.160941 (MainThread): Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 444, in load_all
    manifest = loader.create_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 422, in create_manifest
    self.process_manifest(manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 387, in process_manifest
    process_sources(manifest, project_name)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 820, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 807, in _process_sources_for_node
    disabled=(isinstance(target_source, Disabled))
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 510, in invalid_source_fail_unless_test
    disabled=disabled
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 597, in source_target_not_found
    raise_compiler_error(msg, model)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model stg_order_details (models\staging\stg_order_details.sql)
  Model 'model.northwind_shop.stg_order_details' (models\staging\stg_order_details.sql) depends on a source named 'northwind_etl.order_details' which was not found

2021-05-15 12:53:18.688043 (MainThread): Running with dbt=0.19.1
2021-05-15 12:53:19.207809 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 12:53:19.207809 (MainThread): Tracking: tracking
2021-05-15 12:53:19.207809 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4F7D02DC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4F7D02108>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4F7D07DC8>]}
2021-05-15 12:53:19.223437 (MainThread): Partial parsing not enabled
2021-05-15 12:53:19.223437 (MainThread): Parsing macros\adapters.sql
2021-05-15 12:53:19.239061 (MainThread): Parsing macros\catalog.sql
2021-05-15 12:53:19.239061 (MainThread): Parsing macros\etc.sql
2021-05-15 12:53:19.239061 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 12:53:19.254684 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 12:53:19.254684 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 12:53:19.270308 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 12:53:19.270308 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 12:53:19.270308 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 12:53:19.285930 (MainThread): Parsing macros\core.sql
2021-05-15 12:53:19.285930 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 12:53:19.322342 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 12:53:19.342580 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 12:53:19.343602 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 12:53:19.345639 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 12:53:19.347676 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 12:53:19.348700 (MainThread): Parsing macros\etc\query.sql
2021-05-15 12:53:19.349746 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 12:53:19.358994 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 12:53:19.374491 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 12:53:19.376529 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 12:53:19.382635 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 12:53:19.400283 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 12:53:19.431530 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 12:53:19.431530 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 12:53:19.447154 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 12:53:19.447154 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 12:53:19.462777 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 12:53:19.462777 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 12:53:19.462777 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 12:53:19.462777 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 12:53:19.478400 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 12:53:19.478400 (MainThread): Partial parsing not enabled
2021-05-15 12:53:19.499790 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 12:53:19.508102 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 12:53:19.519893 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 12:53:19.527865 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-05-15 12:53:19.527865 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 12:53:19.607533 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4FB9BB548>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4FB9BB488>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4FB9BB188>]}
2021-05-15 12:53:19.607533 (MainThread): Flushing usage events
2021-05-15 12:53:20.977292 (MainThread): Connection 'model.northwind_shop.stg_products' was properly closed.
2021-05-15 12:53:20.977292 (MainThread): Encountered an error:
2021-05-15 12:53:20.977292 (MainThread): Compilation Error in model stg_order_details (models\staging\stg_order_details.sql)
  Model 'model.northwind_shop.stg_order_details' (models\staging\stg_order_details.sql) depends on a source named 'northwind_etl.order_details' which was not found
2021-05-15 12:53:20.981445 (MainThread): Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 444, in load_all
    manifest = loader.create_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 422, in create_manifest
    self.process_manifest(manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 387, in process_manifest
    process_sources(manifest, project_name)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 820, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 807, in _process_sources_for_node
    disabled=(isinstance(target_source, Disabled))
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 510, in invalid_source_fail_unless_test
    disabled=disabled
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 597, in source_target_not_found
    raise_compiler_error(msg, model)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model stg_order_details (models\staging\stg_order_details.sql)
  Model 'model.northwind_shop.stg_order_details' (models\staging\stg_order_details.sql) depends on a source named 'northwind_etl.order_details' which was not found

2021-05-15 12:54:27.090912 (MainThread): Running with dbt=0.19.1
2021-05-15 12:54:27.524471 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 12:54:27.532468 (MainThread): Tracking: tracking
2021-05-15 12:54:27.532468 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024423972B48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024423972848>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244239777C8>]}
2021-05-15 12:54:27.540465 (MainThread): Partial parsing not enabled
2021-05-15 12:54:27.540465 (MainThread): Parsing macros\adapters.sql
2021-05-15 12:54:27.556458 (MainThread): Parsing macros\catalog.sql
2021-05-15 12:54:27.564454 (MainThread): Parsing macros\etc.sql
2021-05-15 12:54:27.564454 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 12:54:27.572451 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 12:54:27.580447 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 12:54:27.580447 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 12:54:27.580447 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 12:54:27.596441 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 12:54:27.596441 (MainThread): Parsing macros\core.sql
2021-05-15 12:54:27.604438 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 12:54:27.644420 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 12:54:27.652417 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 12:54:27.652417 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 12:54:27.652417 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 12:54:27.660414 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 12:54:27.660414 (MainThread): Parsing macros\etc\query.sql
2021-05-15 12:54:27.660414 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 12:54:27.668411 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 12:54:27.684404 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 12:54:27.684404 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 12:54:27.692401 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 12:54:27.708394 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 12:54:27.740381 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 12:54:27.740381 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 12:54:27.756374 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 12:54:27.764371 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 12:54:27.772367 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 12:54:27.772367 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 12:54:27.780364 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 12:54:27.780364 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 12:54:27.780364 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 12:54:27.788361 (MainThread): Partial parsing not enabled
2021-05-15 12:54:27.812351 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 12:54:27.820349 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 12:54:27.820349 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 12:54:27.828345 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_detail".
2021-05-15 12:54:27.831245 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 12:54:27.896580 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024427636208>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024427636148>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024427636608>]}
2021-05-15 12:54:27.896580 (MainThread): Flushing usage events
2021-05-15 12:54:29.010579 (MainThread): Connection 'model.northwind_shop.stg_products' was properly closed.
2021-05-15 12:54:29.010579 (MainThread): Encountered an error:
2021-05-15 12:54:29.010579 (MainThread): Compilation Error in model stg_order_detail (models\staging\stg_order_detail.sql)
  Model 'model.northwind_shop.stg_order_detail' (models\staging\stg_order_detail.sql) depends on a source named 'northwind_etl.order_details' which was not found
2021-05-15 12:54:29.015441 (MainThread): Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 444, in load_all
    manifest = loader.create_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 422, in create_manifest
    self.process_manifest(manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 387, in process_manifest
    process_sources(manifest, project_name)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 820, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 807, in _process_sources_for_node
    disabled=(isinstance(target_source, Disabled))
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 510, in invalid_source_fail_unless_test
    disabled=disabled
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 597, in source_target_not_found
    raise_compiler_error(msg, model)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model stg_order_detail (models\staging\stg_order_detail.sql)
  Model 'model.northwind_shop.stg_order_detail' (models\staging\stg_order_detail.sql) depends on a source named 'northwind_etl.order_details' which was not found

2021-05-15 12:54:47.065187 (MainThread): Running with dbt=0.19.1
2021-05-15 12:54:47.394490 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 12:54:47.394490 (MainThread): Tracking: tracking
2021-05-15 12:54:47.394490 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002865993FD48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028659943148>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002865993BE48>]}
2021-05-15 12:54:47.402486 (MainThread): Partial parsing not enabled
2021-05-15 12:54:47.402486 (MainThread): Parsing macros\adapters.sql
2021-05-15 12:54:47.426476 (MainThread): Parsing macros\catalog.sql
2021-05-15 12:54:47.426476 (MainThread): Parsing macros\etc.sql
2021-05-15 12:54:47.434472 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 12:54:47.434472 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 12:54:47.450465 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 12:54:47.450465 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 12:54:47.450465 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 12:54:47.458463 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 12:54:47.466459 (MainThread): Parsing macros\core.sql
2021-05-15 12:54:47.474455 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 12:54:47.514438 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 12:54:47.522436 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 12:54:47.522436 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 12:54:47.522436 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 12:54:47.522436 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 12:54:47.522436 (MainThread): Parsing macros\etc\query.sql
2021-05-15 12:54:47.530432 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 12:54:47.538429 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 12:54:47.546425 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 12:54:47.554422 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 12:54:47.554422 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 12:54:47.578411 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 12:54:47.610399 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 12:54:47.610399 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 12:54:47.626392 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 12:54:47.634389 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 12:54:47.634389 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 12:54:47.642386 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 12:54:47.642386 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 12:54:47.650383 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 12:54:47.650383 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 12:54:47.658379 (MainThread): Partial parsing not enabled
2021-05-15 12:54:47.674373 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 12:54:47.682370 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 12:54:47.690366 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 12:54:47.690366 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_detail".
2021-05-15 12:54:47.698363 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 12:54:47.762336 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002865D606488>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002865D6063C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002865D606808>]}
2021-05-15 12:54:47.762336 (MainThread): Flushing usage events
2021-05-15 12:54:49.650897 (MainThread): Connection 'model.northwind_shop.stg_products' was properly closed.
2021-05-15 12:54:49.650897 (MainThread): Encountered an error:
2021-05-15 12:54:49.657499 (MainThread): Compilation Error in model stg_order_detail (models\staging\stg_order_detail.sql)
  Model 'model.northwind_shop.stg_order_detail' (models\staging\stg_order_detail.sql) depends on a source named 'northwind_etl.order_detail' which was not found
2021-05-15 12:54:49.659884 (MainThread): Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 444, in load_all
    manifest = loader.create_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 422, in create_manifest
    self.process_manifest(manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 387, in process_manifest
    process_sources(manifest, project_name)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 820, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 807, in _process_sources_for_node
    disabled=(isinstance(target_source, Disabled))
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 510, in invalid_source_fail_unless_test
    disabled=disabled
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 597, in source_target_not_found
    raise_compiler_error(msg, model)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model stg_order_detail (models\staging\stg_order_detail.sql)
  Model 'model.northwind_shop.stg_order_detail' (models\staging\stg_order_detail.sql) depends on a source named 'northwind_etl.order_detail' which was not found

2021-05-15 12:57:45.511313 (MainThread): Running with dbt=0.19.1
2021-05-15 12:57:46.079775 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 12:57:46.079775 (MainThread): Tracking: tracking
2021-05-15 12:57:46.087775 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029381592C88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029381592C48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029381596148>]}
2021-05-15 12:57:46.095772 (MainThread): Partial parsing not enabled
2021-05-15 12:57:46.095772 (MainThread): Parsing macros\adapters.sql
2021-05-15 12:57:46.119770 (MainThread): Parsing macros\catalog.sql
2021-05-15 12:57:46.127758 (MainThread): Parsing macros\etc.sql
2021-05-15 12:57:46.127758 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 12:57:46.135772 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 12:57:46.151765 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 12:57:46.159745 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 12:57:46.159745 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 12:57:46.168585 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 12:57:46.176588 (MainThread): Parsing macros\core.sql
2021-05-15 12:57:46.176588 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 12:57:46.224572 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 12:57:46.240562 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 12:57:46.240562 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 12:57:46.240562 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 12:57:46.240562 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 12:57:46.240562 (MainThread): Parsing macros\etc\query.sql
2021-05-15 12:57:46.248559 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 12:57:46.256587 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 12:57:46.276901 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 12:57:46.276901 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 12:57:46.289118 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 12:57:46.305129 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 12:57:46.339536 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 12:57:46.339536 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 12:57:46.358843 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 12:57:46.373992 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 12:57:46.381999 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 12:57:46.381999 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 12:57:46.389996 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 12:57:46.389996 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 12:57:46.389996 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 12:57:46.397993 (MainThread): Partial parsing not enabled
2021-05-15 12:57:46.419011 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 12:57:46.427025 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 12:57:46.435021 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 12:57:46.435021 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_detail".
2021-05-15 12:57:46.443017 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 12:57:46.506991 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002938524F1C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002938524F348>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002938524F488>]}
2021-05-15 12:57:46.506991 (MainThread): Flushing usage events
2021-05-15 12:57:47.928810 (MainThread): Connection 'model.northwind_shop.stg_products' was properly closed.
2021-05-15 12:57:47.929915 (MainThread): Encountered an error:
2021-05-15 12:57:47.931031 (MainThread): Compilation Error in model stg_order_detail (models\staging\stg_order_detail.sql)
  Model 'model.northwind_shop.stg_order_detail' (models\staging\stg_order_detail.sql) depends on a source named 'northwind_etl.order_details' which was not found
2021-05-15 12:57:47.935271 (MainThread): Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 444, in load_all
    manifest = loader.create_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 422, in create_manifest
    self.process_manifest(manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 387, in process_manifest
    process_sources(manifest, project_name)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 820, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 807, in _process_sources_for_node
    disabled=(isinstance(target_source, Disabled))
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 510, in invalid_source_fail_unless_test
    disabled=disabled
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 597, in source_target_not_found
    raise_compiler_error(msg, model)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model stg_order_detail (models\staging\stg_order_detail.sql)
  Model 'model.northwind_shop.stg_order_detail' (models\staging\stg_order_detail.sql) depends on a source named 'northwind_etl.order_details' which was not found

2021-05-15 12:57:54.115018 (MainThread): Running with dbt=0.19.1
2021-05-15 12:57:54.458522 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 12:57:54.458522 (MainThread): Tracking: tracking
2021-05-15 12:57:54.458522 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7CF832C48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7CF819CC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7CF836B88>]}
2021-05-15 12:57:54.466518 (MainThread): Partial parsing not enabled
2021-05-15 12:57:54.466518 (MainThread): Parsing macros\adapters.sql
2021-05-15 12:57:54.490507 (MainThread): Parsing macros\catalog.sql
2021-05-15 12:57:54.490507 (MainThread): Parsing macros\etc.sql
2021-05-15 12:57:54.498504 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 12:57:54.498504 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 12:57:54.506501 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 12:57:54.514498 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 12:57:54.514498 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 12:57:54.522495 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 12:57:54.530491 (MainThread): Parsing macros\core.sql
2021-05-15 12:57:54.530491 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 12:57:54.570474 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 12:57:54.582537 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 12:57:54.582537 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 12:57:54.582537 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 12:57:54.590551 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 12:57:54.590551 (MainThread): Parsing macros\etc\query.sql
2021-05-15 12:57:54.590551 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 12:57:54.598549 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 12:57:54.614540 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 12:57:54.614540 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 12:57:54.622538 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 12:57:54.638533 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 12:57:54.670579 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 12:57:54.678576 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 12:57:54.694566 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 12:57:54.694566 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 12:57:54.702570 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 12:57:54.713070 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 12:57:54.716139 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 12:57:54.718290 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 12:57:54.719384 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 12:57:54.727136 (MainThread): Partial parsing not enabled
2021-05-15 12:57:54.749705 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 12:57:54.760616 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 12:57:54.761683 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 12:57:54.761683 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_detail".
2021-05-15 12:57:54.769754 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 12:57:54.833657 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7D34EF3C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7D34EF388>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7D34EF2C8>]}
2021-05-15 12:57:54.841653 (MainThread): Flushing usage events
2021-05-15 12:57:56.024783 (MainThread): Connection 'model.northwind_shop.stg_products' was properly closed.
2021-05-15 12:57:56.025111 (MainThread): Encountered an error:
2021-05-15 12:57:56.025653 (MainThread): Compilation Error in model stg_order_detail (models\staging\stg_order_detail.sql)
  Model 'model.northwind_shop.stg_order_detail' (models\staging\stg_order_detail.sql) depends on a source named 'northwind_etl.order_details' which was not found
2021-05-15 12:57:56.029303 (MainThread): Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 444, in load_all
    manifest = loader.create_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 422, in create_manifest
    self.process_manifest(manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 387, in process_manifest
    process_sources(manifest, project_name)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 820, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 807, in _process_sources_for_node
    disabled=(isinstance(target_source, Disabled))
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 510, in invalid_source_fail_unless_test
    disabled=disabled
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 597, in source_target_not_found
    raise_compiler_error(msg, model)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model stg_order_detail (models\staging\stg_order_detail.sql)
  Model 'model.northwind_shop.stg_order_detail' (models\staging\stg_order_detail.sql) depends on a source named 'northwind_etl.order_details' which was not found

2021-05-15 13:00:52.248518 (MainThread): Running with dbt=0.19.1
2021-05-15 13:00:52.564208 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 13:00:52.564208 (MainThread): Tracking: tracking
2021-05-15 13:00:52.564208 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025306F0D748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025306F12B08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025306F160C8>]}
2021-05-15 13:00:52.572196 (MainThread): Partial parsing not enabled
2021-05-15 13:00:52.580197 (MainThread): Parsing macros\adapters.sql
2021-05-15 13:00:52.596206 (MainThread): Parsing macros\catalog.sql
2021-05-15 13:00:52.604197 (MainThread): Parsing macros\etc.sql
2021-05-15 13:00:52.604197 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 13:00:52.604197 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 13:00:52.620181 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 13:00:52.620181 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 13:00:52.620181 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 13:00:52.628186 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 13:00:52.636180 (MainThread): Parsing macros\core.sql
2021-05-15 13:00:52.644177 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 13:00:52.684162 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 13:00:52.692155 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 13:00:52.692155 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 13:00:52.692155 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 13:00:52.692155 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 13:00:52.692155 (MainThread): Parsing macros\etc\query.sql
2021-05-15 13:00:52.700151 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 13:00:52.708156 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 13:00:52.716103 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 13:00:52.724100 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 13:00:52.724100 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 13:00:52.748131 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 13:00:52.780129 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 13:00:52.780129 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 13:00:52.796114 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 13:00:52.804109 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 13:00:52.812104 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 13:00:52.812104 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 13:00:52.820088 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 13:00:52.820088 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 13:00:52.820088 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 13:00:52.828101 (MainThread): Partial parsing not enabled
2021-05-15 13:00:52.852504 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 13:00:52.860558 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 13:00:52.860558 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 13:00:52.868506 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_detail".
2021-05-15 13:00:52.868506 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 13:00:52.993277 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002530ABCF208>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002530ABCF108>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002530A9C2C88>]}
2021-05-15 13:00:52.993277 (MainThread): Flushing usage events
2021-05-15 13:00:54.604900 (MainThread): Connection 'model.northwind_shop.stg_products' was properly closed.
2021-05-15 13:00:54.604900 (MainThread): Encountered an error:
2021-05-15 13:00:54.608274 (MainThread): Compilation Error in model stg_order_detail (models\staging\stg_order_detail.sql)
  Model 'model.northwind_shop.stg_order_detail' (models\staging\stg_order_detail.sql) depends on a source named 'northwind_etl.order_details' which was not found
2021-05-15 13:00:54.611749 (MainThread): Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 444, in load_all
    manifest = loader.create_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 422, in create_manifest
    self.process_manifest(manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 387, in process_manifest
    process_sources(manifest, project_name)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 820, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 807, in _process_sources_for_node
    disabled=(isinstance(target_source, Disabled))
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 510, in invalid_source_fail_unless_test
    disabled=disabled
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 597, in source_target_not_found
    raise_compiler_error(msg, model)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model stg_order_detail (models\staging\stg_order_detail.sql)
  Model 'model.northwind_shop.stg_order_detail' (models\staging\stg_order_detail.sql) depends on a source named 'northwind_etl.order_details' which was not found

2021-05-15 13:04:59.888240 (MainThread): Running with dbt=0.19.1
2021-05-15 13:05:00.255582 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 13:05:00.255582 (MainThread): Tracking: tracking
2021-05-15 13:05:00.255582 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A55346548>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A55373B88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A55377748>]}
2021-05-15 13:05:00.271208 (MainThread): Partial parsing not enabled
2021-05-15 13:05:00.271208 (MainThread): Parsing macros\adapters.sql
2021-05-15 13:05:00.286830 (MainThread): Parsing macros\catalog.sql
2021-05-15 13:05:00.286830 (MainThread): Parsing macros\etc.sql
2021-05-15 13:05:00.286830 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 13:05:00.302455 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 13:05:00.302455 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 13:05:00.318073 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 13:05:00.318073 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 13:05:00.318073 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 13:05:00.333703 (MainThread): Parsing macros\core.sql
2021-05-15 13:05:00.333703 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 13:05:00.375552 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 13:05:00.383550 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 13:05:00.383550 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 13:05:00.383550 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 13:05:00.391535 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 13:05:00.391535 (MainThread): Parsing macros\etc\query.sql
2021-05-15 13:05:00.391535 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 13:05:00.399531 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 13:05:00.415523 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 13:05:00.415523 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 13:05:00.415523 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 13:05:00.439520 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 13:05:00.471506 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 13:05:00.471506 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 13:05:00.487516 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 13:05:00.495497 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 13:05:00.495497 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 13:05:00.503490 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 13:05:00.503490 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 13:05:00.503490 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 13:05:00.511590 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 13:05:00.519627 (MainThread): Partial parsing not enabled
2021-05-15 13:05:00.551586 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 13:05:00.559586 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 13:05:00.567580 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 13:05:00.567580 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 13:05:00.575605 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 13:05:00.687894 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 13:05:00.690601 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21a09be6-6d5c-4e82-9705-665aa68657eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A59058FC8>]}
2021-05-15 13:05:00.698609 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21a09be6-6d5c-4e82-9705-665aa68657eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A58DEAEC8>]}
2021-05-15 13:05:00.698609 (MainThread): Found 5 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-05-15 13:05:00.707126 (MainThread): 
2021-05-15 13:05:00.707126 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 13:05:00.707126 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 13:05:00.707126 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 13:05:03.228331 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 13:05:03.228331 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 13:05:03.236488 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 13:05:04.561968 (MainThread): 10:05:04 | Concurrency: 1 threads (target='dev')
2021-05-15 13:05:04.561968 (MainThread): 10:05:04 | 
2021-05-15 13:05:04.569977 (Thread-1): Began running node model.northwind_shop.stg_customers
2021-05-15 13:05:04.569977 (Thread-1): 10:05:04 | 1 of 5 START view model dbt_arthur.stg_customers..................... [RUN]
2021-05-15 13:05:04.569977 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 13:05:04.569977 (Thread-1): Compiling model.northwind_shop.stg_customers
2021-05-15 13:05:04.579166 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_customers"
2021-05-15 13:05:04.579535 (Thread-1): finished collecting timing info
2021-05-15 13:05:04.611866 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_customers"
2021-05-15 13:05:04.611866 (Thread-1): Opening a new connection, currently in state init
2021-05-15 13:05:04.619864 (Thread-1): On model.northwind_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_customers"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_customers`
  OPTIONS()
  as with
    source as (
        select 
           /*primary key*/
            customer_id
            ,country	
            ,city	
            ,fax	
            ,postal_code	
            ,address	
            ,region	
            ,contact_name		
            ,phone	
            ,company_name	
            ,contact_title
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`customers`
    )
select * from source;


2021-05-15 13:05:07.226862 (Thread-1): finished collecting timing info
2021-05-15 13:05:07.226862 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21a09be6-6d5c-4e82-9705-665aa68657eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A58FE4148>]}
2021-05-15 13:05:07.226862 (Thread-1): 10:05:07 | 1 of 5 OK created view model dbt_arthur.stg_customers................ [OK in 2.66s]
2021-05-15 13:05:07.226862 (Thread-1): Finished running node model.northwind_shop.stg_customers
2021-05-15 13:05:07.226862 (Thread-1): Began running node model.northwind_shop.stg_employees
2021-05-15 13:05:07.226862 (Thread-1): 10:05:07 | 2 of 5 START view model dbt_arthur.stg_employees..................... [RUN]
2021-05-15 13:05:07.226862 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 13:05:07.226862 (Thread-1): Compiling model.northwind_shop.stg_employees
2021-05-15 13:05:07.234860 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_employees"
2021-05-15 13:05:07.238293 (Thread-1): finished collecting timing info
2021-05-15 13:05:07.238293 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_employees"
2021-05-15 13:05:07.238293 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 13:05:07.246360 (Thread-1): On model.northwind_shop.stg_employees: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_employees"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_employees`
  OPTIONS()
  as with
    source as (
        select 
           /*primary key*/
            employee_id	
            ,country	
            ,city	
            ,postal_code
            ,hire_date	
            ,extension	
            ,address	
            ,birth_date	
            ,region	
            ,photo_path	
            ,last_name	
            ,first_name	
            ,title	
            ,title_of_courtesy	
            ,notes	
            ,home_phone	
            ,reports_to	
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`employees`
    )
select * from source;


2021-05-15 13:05:10.191667 (Thread-1): finished collecting timing info
2021-05-15 13:05:10.191667 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21a09be6-6d5c-4e82-9705-665aa68657eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A59161F48>]}
2021-05-15 13:05:10.191667 (Thread-1): 10:05:10 | 2 of 5 OK created view model dbt_arthur.stg_employees................ [OK in 2.96s]
2021-05-15 13:05:10.191667 (Thread-1): Finished running node model.northwind_shop.stg_employees
2021-05-15 13:05:10.191667 (Thread-1): Began running node model.northwind_shop.stg_orders
2021-05-15 13:05:10.191667 (Thread-1): 10:05:10 | 3 of 5 START view model dbt_arthur.stg_orders........................ [RUN]
2021-05-15 13:05:10.199722 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 13:05:10.199722 (Thread-1): Compiling model.northwind_shop.stg_orders
2021-05-15 13:05:10.199722 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_orders"
2021-05-15 13:05:10.199722 (Thread-1): finished collecting timing info
2021-05-15 13:05:10.207667 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_orders"
2021-05-15 13:05:10.207667 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 13:05:10.215665 (Thread-1): On model.northwind_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_orders"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_orders`
  OPTIONS()
  as with
    source as (
        select 
          /*Primary key*/ 
            order_id
          /*Foreign Key*/
            ,employee_id
            ,customer_id
            ,ship_region	
            ,shipped_date
            ,ship_country	
            ,ship_name
            ,order_date		
            ,ship_postal_code	
            ,ship_city	
            ,freight	
            ,ship_via as ship_id
            ,required_date
            ,ship_address
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`orders`
    )
select * from source;


2021-05-15 13:05:12.446283 (Thread-1): finished collecting timing info
2021-05-15 13:05:12.446283 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21a09be6-6d5c-4e82-9705-665aa68657eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A59161F48>]}
2021-05-15 13:05:12.446283 (Thread-1): 10:05:12 | 3 of 5 OK created view model dbt_arthur.stg_orders................... [OK in 2.25s]
2021-05-15 13:05:12.454313 (Thread-1): Finished running node model.northwind_shop.stg_orders
2021-05-15 13:05:12.454313 (Thread-1): Began running node model.northwind_shop.stg_products
2021-05-15 13:05:12.454313 (Thread-1): 10:05:12 | 4 of 5 START view model dbt_arthur.stg_products...................... [RUN]
2021-05-15 13:05:12.454313 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 13:05:12.454313 (Thread-1): Compiling model.northwind_shop.stg_products
2021-05-15 13:05:12.454313 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_products"
2021-05-15 13:05:12.463363 (Thread-1): finished collecting timing info
2021-05-15 13:05:12.463363 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_products"
2021-05-15 13:05:12.463363 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 13:05:12.471505 (Thread-1): On model.northwind_shop.stg_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_products`
  OPTIONS()
  as with
    source as (
        select 
            /* Primary key */
               product_id

            /*Foreign key */
            , category_id
            , supplier_id

            , units_in_stock           	
            , unit_price	
            , product_name	
            , quantity_per_unit	
            	
            , reorder_level	
            , units_on_order	
            , 
                case
                 when discontinued = 1 then True
                 else False
                end as is_discontinued 
            /* Stitich Columns*/
            , _sdc_table_version
            , _sdc_sequence
            , _sdc_batched_at	
            , _sdc_extracted_at	
            , _sdc_received_at

        from `northwind1-313400`.`northwind_etl`.`products`
    )
select * from source;


2021-05-15 13:05:15.211182 (Thread-1): finished collecting timing info
2021-05-15 13:05:15.211182 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21a09be6-6d5c-4e82-9705-665aa68657eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A5916D608>]}
2021-05-15 13:05:15.211182 (Thread-1): 10:05:15 | 4 of 5 OK created view model dbt_arthur.stg_products................. [OK in 2.76s]
2021-05-15 13:05:15.219186 (Thread-1): Finished running node model.northwind_shop.stg_products
2021-05-15 13:05:15.219186 (Thread-1): Began running node model.northwind_shop.stg_suppliers
2021-05-15 13:05:15.219186 (Thread-1): 10:05:15 | 5 of 5 START view model dbt_arthur.stg_suppliers..................... [RUN]
2021-05-15 13:05:15.219186 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 13:05:15.219186 (Thread-1): Compiling model.northwind_shop.stg_suppliers
2021-05-15 13:05:15.227189 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_suppliers"
2021-05-15 13:05:15.228414 (Thread-1): finished collecting timing info
2021-05-15 13:05:15.228414 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_suppliers"
2021-05-15 13:05:15.228414 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 13:05:15.236543 (Thread-1): On model.northwind_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_suppliers"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_suppliers`
  OPTIONS()
  as with
    source as (
        select 
           /*primary key*/
            supplier_id
            ,country
            ,city	
            ,fax	
            ,postal_code
            ,homepage
            ,address	
            ,region	
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`suppliers`
    )
select * from source;


2021-05-15 13:05:18.325050 (Thread-1): finished collecting timing info
2021-05-15 13:05:18.325050 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21a09be6-6d5c-4e82-9705-665aa68657eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A5918DFC8>]}
2021-05-15 13:05:18.325050 (Thread-1): 10:05:18 | 5 of 5 OK created view model dbt_arthur.stg_suppliers................ [OK in 3.11s]
2021-05-15 13:05:18.325050 (Thread-1): Finished running node model.northwind_shop.stg_suppliers
2021-05-15 13:05:18.394998 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 13:05:18.394998 (MainThread): 10:05:18 | 
2021-05-15 13:05:18.394998 (MainThread): 10:05:18 | Finished running 5 view models in 17.69s.
2021-05-15 13:05:18.394998 (MainThread): Connection 'master' was properly closed.
2021-05-15 13:05:18.394998 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 13:05:18.394998 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 13:05:18.394998 (MainThread): Connection 'model.northwind_shop.stg_suppliers' was properly closed.
2021-05-15 13:05:18.394998 (MainThread): unclosed <socket.socket fd=1140, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59464), raddr=('172.217.162.106', 443)>
2021-05-15 13:05:18.394998 (MainThread): unclosed <socket.socket fd=1148, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59465), raddr=('142.250.219.10', 443)>
2021-05-15 13:05:18.402927 (MainThread): unclosed <socket.socket fd=1160, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59467), raddr=('142.250.219.10', 443)>
2021-05-15 13:05:18.402927 (MainThread): unclosed <socket.socket fd=1204, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59466), raddr=('172.217.162.106', 443)>
2021-05-15 13:05:18.402927 (MainThread): unclosed <socket.socket fd=1200, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59469), raddr=('142.250.219.10', 443)>
2021-05-15 13:05:18.402927 (MainThread): unclosed <socket.socket fd=756, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59468), raddr=('172.217.162.106', 443)>
2021-05-15 13:05:18.402927 (MainThread): unclosed <socket.socket fd=1252, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59471), raddr=('142.250.219.10', 443)>
2021-05-15 13:05:18.402927 (MainThread): unclosed <socket.socket fd=888, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59470), raddr=('172.217.162.106', 443)>
2021-05-15 13:05:18.402927 (MainThread): unclosed <socket.socket fd=668, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59472), raddr=('172.217.162.106', 443)>
2021-05-15 13:05:18.402927 (MainThread): unclosed <socket.socket fd=1268, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59473), raddr=('142.250.219.10', 443)>
2021-05-15 13:05:18.442903 (MainThread): unclosed <socket.socket fd=1004, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59461), raddr=('142.250.219.10', 443)>
2021-05-15 13:05:18.442903 (MainThread): unclosed <socket.socket fd=1044, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59463), raddr=('142.250.219.10', 443)>
2021-05-15 13:05:18.442903 (MainThread): unclosed <socket.socket fd=464, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59460), raddr=('172.217.162.106', 443)>
2021-05-15 13:05:18.442903 (MainThread): unclosed <socket.socket fd=516, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59462), raddr=('172.217.162.106', 443)>
2021-05-15 13:05:18.458903 (MainThread): 
2021-05-15 13:05:18.460946 (MainThread): Completed successfully
2021-05-15 13:05:18.462984 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-05-15 13:05:18.465075 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A55315CC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A55315D08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A55315C88>]}
2021-05-15 13:05:18.466102 (MainThread): Flushing usage events
2021-05-15 13:06:54.328438 (MainThread): Running with dbt=0.19.1
2021-05-15 13:06:54.663365 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 13:06:54.663365 (MainThread): Tracking: tracking
2021-05-15 13:06:54.663365 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEA65C5E48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEA65F1488>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEA65F8748>]}
2021-05-15 13:06:54.663365 (MainThread): Partial parsing not enabled
2021-05-15 13:06:54.678989 (MainThread): Parsing macros\adapters.sql
2021-05-15 13:06:54.694626 (MainThread): Parsing macros\catalog.sql
2021-05-15 13:06:54.694626 (MainThread): Parsing macros\etc.sql
2021-05-15 13:06:54.694626 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 13:06:54.694626 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 13:06:54.710228 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 13:06:54.710228 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 13:06:54.710228 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 13:06:54.725861 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 13:06:54.725861 (MainThread): Parsing macros\core.sql
2021-05-15 13:06:54.741482 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 13:06:54.781758 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 13:06:54.793320 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 13:06:54.795345 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 13:06:54.797745 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 13:06:54.799767 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 13:06:54.801785 (MainThread): Parsing macros\etc\query.sql
2021-05-15 13:06:54.807639 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 13:06:54.814509 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 13:06:54.830132 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 13:06:54.830132 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 13:06:54.830132 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 13:06:54.861379 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 13:06:54.892625 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 13:06:54.892625 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 13:06:54.912635 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 13:06:54.913680 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 13:06:54.913680 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 13:06:54.929351 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 13:06:54.929351 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 13:06:54.929351 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 13:06:54.929351 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 13:06:54.929351 (MainThread): Partial parsing not enabled
2021-05-15 13:06:54.960557 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 13:06:54.960557 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 13:06:54.960557 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 13:06:54.976223 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 13:06:54.976223 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 13:06:54.976223 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 13:06:55.038714 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEAA29EF08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEAA29ECC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEAA29ED48>]}
2021-05-15 13:06:55.038714 (MainThread): Flushing usage events
2021-05-15 13:06:56.115143 (MainThread): Connection 'model.northwind_shop.stg_suppliers' was properly closed.
2021-05-15 13:06:56.115143 (MainThread): Encountered an error:
2021-05-15 13:06:56.115143 (MainThread): Compilation Error in model stg_orderdetail (models\staging\stg_orderdetail.sql)
  Model 'model.northwind_shop.stg_orderdetail' (models\staging\stg_orderdetail.sql) depends on a source named 'northwind_etl.order_details' which was not found
2021-05-15 13:06:56.117943 (MainThread): Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 444, in load_all
    manifest = loader.create_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 422, in create_manifest
    self.process_manifest(manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 387, in process_manifest
    process_sources(manifest, project_name)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 820, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 807, in _process_sources_for_node
    disabled=(isinstance(target_source, Disabled))
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 510, in invalid_source_fail_unless_test
    disabled=disabled
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 597, in source_target_not_found
    raise_compiler_error(msg, model)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model stg_orderdetail (models\staging\stg_orderdetail.sql)
  Model 'model.northwind_shop.stg_orderdetail' (models\staging\stg_orderdetail.sql) depends on a source named 'northwind_etl.order_details' which was not found

2021-05-15 13:07:31.201569 (MainThread): Running with dbt=0.19.1
2021-05-15 13:07:31.518948 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 13:07:31.518948 (MainThread): Tracking: tracking
2021-05-15 13:07:31.518948 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F69002D88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F69002A88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F69007D88>]}
2021-05-15 13:07:31.526995 (MainThread): Partial parsing not enabled
2021-05-15 13:07:31.526995 (MainThread): Parsing macros\adapters.sql
2021-05-15 13:07:31.550989 (MainThread): Parsing macros\catalog.sql
2021-05-15 13:07:31.550989 (MainThread): Parsing macros\etc.sql
2021-05-15 13:07:31.558987 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 13:07:31.558987 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 13:07:31.574979 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 13:07:31.574979 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 13:07:31.574979 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 13:07:31.582978 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 13:07:31.590972 (MainThread): Parsing macros\core.sql
2021-05-15 13:07:31.590972 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 13:07:31.632985 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 13:07:31.641045 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 13:07:31.641045 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 13:07:31.641045 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 13:07:31.649030 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 13:07:31.649030 (MainThread): Parsing macros\etc\query.sql
2021-05-15 13:07:31.649030 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 13:07:31.657032 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 13:07:31.673023 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 13:07:31.673023 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 13:07:31.681023 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 13:07:31.697012 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 13:07:31.729000 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 13:07:31.729000 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 13:07:31.744988 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 13:07:31.752985 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 13:07:31.760984 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 13:07:31.768931 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 13:07:31.768931 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 13:07:31.768931 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 13:07:31.776979 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 13:07:31.776979 (MainThread): Partial parsing not enabled
2021-05-15 13:07:31.800973 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 13:07:31.808970 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 13:07:31.808970 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 13:07:31.816964 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 13:07:31.816964 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 13:07:31.824957 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 13:07:31.880934 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F6CCADFC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F6CCADDC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F6CCADF48>]}
2021-05-15 13:07:31.888937 (MainThread): Flushing usage events
2021-05-15 13:07:32.875130 (MainThread): Connection 'model.northwind_shop.stg_suppliers' was properly closed.
2021-05-15 13:07:32.875624 (MainThread): Encountered an error:
2021-05-15 13:07:32.876946 (MainThread): Compilation Error in model stg_orderdetail (models\staging\stg_orderdetail.sql)
  Model 'model.northwind_shop.stg_orderdetail' (models\staging\stg_orderdetail.sql) depends on a source named 'northwind_etl.orders_details' which was not found
2021-05-15 13:07:32.880630 (MainThread): Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 444, in load_all
    manifest = loader.create_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 422, in create_manifest
    self.process_manifest(manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 387, in process_manifest
    process_sources(manifest, project_name)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 820, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 807, in _process_sources_for_node
    disabled=(isinstance(target_source, Disabled))
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 510, in invalid_source_fail_unless_test
    disabled=disabled
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 597, in source_target_not_found
    raise_compiler_error(msg, model)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model stg_orderdetail (models\staging\stg_orderdetail.sql)
  Model 'model.northwind_shop.stg_orderdetail' (models\staging\stg_orderdetail.sql) depends on a source named 'northwind_etl.orders_details' which was not found

2021-05-15 13:10:14.908982 (MainThread): Running with dbt=0.19.1
2021-05-15 13:10:15.271603 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 13:10:15.271603 (MainThread): Tracking: tracking
2021-05-15 13:10:15.271603 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002819C805E88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002819E7B8EC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002819C833AC8>]}
2021-05-15 13:10:15.279602 (MainThread): Partial parsing not enabled
2021-05-15 13:10:15.279602 (MainThread): Parsing macros\adapters.sql
2021-05-15 13:10:15.300263 (MainThread): Parsing macros\catalog.sql
2021-05-15 13:10:15.300263 (MainThread): Parsing macros\etc.sql
2021-05-15 13:10:15.300263 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 13:10:15.300263 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 13:10:15.315887 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 13:10:15.315887 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 13:10:15.315887 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 13:10:15.331510 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 13:10:15.347133 (MainThread): Parsing macros\core.sql
2021-05-15 13:10:15.347133 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 13:10:15.378379 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 13:10:15.394003 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 13:10:15.394003 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 13:10:15.394003 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 13:10:15.394003 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 13:10:15.394003 (MainThread): Parsing macros\etc\query.sql
2021-05-15 13:10:15.394003 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 13:10:15.409627 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 13:10:15.425250 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 13:10:15.425250 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 13:10:15.425250 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 13:10:15.456496 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 13:10:15.487743 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 13:10:15.487743 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 13:10:15.503367 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 13:10:15.503367 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 13:10:15.503367 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 13:10:15.518990 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 13:10:15.518990 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 13:10:15.518990 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 13:10:15.518990 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 13:10:15.534614 (MainThread): Partial parsing not enabled
2021-05-15 13:10:15.550236 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 13:10:15.550236 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 13:10:15.565861 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 13:10:15.565861 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 13:10:15.565861 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 13:10:15.565861 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 13:10:15.644019 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281A04DDA88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002819C8C2908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281A04DDF48>]}
2021-05-15 13:10:15.644019 (MainThread): Flushing usage events
2021-05-15 13:10:16.530849 (MainThread): Connection 'model.northwind_shop.stg_suppliers' was properly closed.
2021-05-15 13:10:16.530849 (MainThread): Encountered an error:
2021-05-15 13:10:16.532623 (MainThread): Compilation Error in model stg_orderdetail (models\staging\stg_orderdetail.sql)
  Model 'model.northwind_shop.stg_orderdetail' (models\staging\stg_orderdetail.sql) depends on a source named 'northwind_etl.orders_details' which was not found
2021-05-15 13:10:16.535415 (MainThread): Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 444, in load_all
    manifest = loader.create_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 422, in create_manifest
    self.process_manifest(manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 387, in process_manifest
    process_sources(manifest, project_name)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 820, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 807, in _process_sources_for_node
    disabled=(isinstance(target_source, Disabled))
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 510, in invalid_source_fail_unless_test
    disabled=disabled
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 597, in source_target_not_found
    raise_compiler_error(msg, model)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model stg_orderdetail (models\staging\stg_orderdetail.sql)
  Model 'model.northwind_shop.stg_orderdetail' (models\staging\stg_orderdetail.sql) depends on a source named 'northwind_etl.orders_details' which was not found

2021-05-15 13:11:28.099857 (MainThread): Running with dbt=0.19.1
2021-05-15 13:11:28.418886 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 13:11:28.418886 (MainThread): Tracking: tracking
2021-05-15 13:11:28.419955 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229C9D62BC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229C9D62608>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229C9D67208>]}
2021-05-15 13:11:28.422095 (MainThread): Partial parsing not enabled
2021-05-15 13:11:28.422095 (MainThread): Parsing macros\adapters.sql
2021-05-15 13:11:28.446140 (MainThread): Parsing macros\catalog.sql
2021-05-15 13:11:28.446140 (MainThread): Parsing macros\etc.sql
2021-05-15 13:11:28.454149 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 13:11:28.454149 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 13:11:28.462131 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 13:11:28.470130 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 13:11:28.470130 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 13:11:28.478124 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 13:11:28.486123 (MainThread): Parsing macros\core.sql
2021-05-15 13:11:28.486123 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 13:11:28.526103 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 13:11:28.535196 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 13:11:28.535196 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 13:11:28.535196 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 13:11:28.535196 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 13:11:28.543254 (MainThread): Parsing macros\etc\query.sql
2021-05-15 13:11:28.543254 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 13:11:28.551256 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 13:11:28.559240 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 13:11:28.567246 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 13:11:28.567246 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 13:11:28.591238 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 13:11:28.615215 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 13:11:28.623214 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 13:11:28.639207 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 13:11:28.639207 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 13:11:28.647189 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 13:11:28.655201 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 13:11:28.655201 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 13:11:28.655201 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 13:11:28.663185 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 13:11:28.663185 (MainThread): Partial parsing not enabled
2021-05-15 13:11:28.698731 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 13:11:28.707412 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 13:11:28.711657 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 13:11:28.714843 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 13:11:28.718724 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 13:11:28.720823 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 13:11:28.784848 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229CDA0CA88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229CDA0CF08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229CDA0CE88>]}
2021-05-15 13:11:28.784848 (MainThread): Flushing usage events
2021-05-15 13:11:29.991402 (MainThread): Connection 'model.northwind_shop.stg_suppliers' was properly closed.
2021-05-15 13:11:29.992649 (MainThread): Encountered an error:
2021-05-15 13:11:29.992836 (MainThread): Compilation Error in model stg_orderdetail (models\staging\stg_orderdetail.sql)
  Model 'model.northwind_shop.stg_orderdetail' (models\staging\stg_orderdetail.sql) depends on a source named 'northwind_etl.northwind_etl.order_details' which was not found
2021-05-15 13:11:29.994534 (MainThread): Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 444, in load_all
    manifest = loader.create_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 422, in create_manifest
    self.process_manifest(manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 387, in process_manifest
    process_sources(manifest, project_name)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 820, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 807, in _process_sources_for_node
    disabled=(isinstance(target_source, Disabled))
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 510, in invalid_source_fail_unless_test
    disabled=disabled
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 597, in source_target_not_found
    raise_compiler_error(msg, model)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model stg_orderdetail (models\staging\stg_orderdetail.sql)
  Model 'model.northwind_shop.stg_orderdetail' (models\staging\stg_orderdetail.sql) depends on a source named 'northwind_etl.northwind_etl.order_details' which was not found

2021-05-15 13:12:05.111688 (MainThread): Running with dbt=0.19.1
2021-05-15 13:12:05.430945 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 13:12:05.430945 (MainThread): Tracking: tracking
2021-05-15 13:12:05.430945 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0E8E3BD48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0E8E43B48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0E8E47908>]}
2021-05-15 13:12:05.446536 (MainThread): Partial parsing not enabled
2021-05-15 13:12:05.446536 (MainThread): Parsing macros\adapters.sql
2021-05-15 13:12:05.463059 (MainThread): Parsing macros\catalog.sql
2021-05-15 13:12:05.474860 (MainThread): Parsing macros\etc.sql
2021-05-15 13:12:05.476987 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 13:12:05.481242 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 13:12:05.493424 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 13:12:05.496107 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 13:12:05.497166 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 13:12:05.506724 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 13:12:05.511965 (MainThread): Parsing macros\core.sql
2021-05-15 13:12:05.515143 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 13:12:05.550643 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 13:12:05.550643 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 13:12:05.550643 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 13:12:05.550643 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 13:12:05.566263 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 13:12:05.566263 (MainThread): Parsing macros\etc\query.sql
2021-05-15 13:12:05.566263 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 13:12:05.566263 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 13:12:05.581890 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 13:12:05.581890 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 13:12:05.597503 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 13:12:05.613149 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 13:12:05.648783 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 13:12:05.648783 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 13:12:05.664418 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 13:12:05.664418 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 13:12:05.664418 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 13:12:05.680031 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 13:12:05.680031 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 13:12:05.680031 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 13:12:05.680031 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 13:12:05.695652 (MainThread): Partial parsing not enabled
2021-05-15 13:12:05.711279 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 13:12:05.711279 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 13:12:05.726896 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 13:12:05.726896 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 13:12:05.726896 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 13:12:05.726896 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 13:12:05.789382 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0ECAECE88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0ECAECDC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0ECAECE48>]}
2021-05-15 13:12:05.789382 (MainThread): Flushing usage events
2021-05-15 13:12:07.324641 (MainThread): Connection 'model.northwind_shop.stg_suppliers' was properly closed.
2021-05-15 13:12:07.325304 (MainThread): Encountered an error:
2021-05-15 13:12:07.325304 (MainThread): Compilation Error in model stg_orderdetail (models\staging\stg_orderdetail.sql)
  Model 'model.northwind_shop.stg_orderdetail' (models\staging\stg_orderdetail.sql) depends on a source named 'northwind_etl.order_details' which was not found
2021-05-15 13:12:07.327013 (MainThread): Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 444, in load_all
    manifest = loader.create_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 422, in create_manifest
    self.process_manifest(manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 387, in process_manifest
    process_sources(manifest, project_name)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 820, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 807, in _process_sources_for_node
    disabled=(isinstance(target_source, Disabled))
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 510, in invalid_source_fail_unless_test
    disabled=disabled
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 597, in source_target_not_found
    raise_compiler_error(msg, model)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model stg_orderdetail (models\staging\stg_orderdetail.sql)
  Model 'model.northwind_shop.stg_orderdetail' (models\staging\stg_orderdetail.sql) depends on a source named 'northwind_etl.order_details' which was not found

2021-05-15 13:13:15.851514 (MainThread): Running with dbt=0.19.1
2021-05-15 13:13:16.169864 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 13:13:16.169864 (MainThread): Tracking: tracking
2021-05-15 13:13:16.169864 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AECC02F08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AECC02E08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AECC02D48>]}
2021-05-15 13:13:16.177862 (MainThread): Partial parsing not enabled
2021-05-15 13:13:16.177862 (MainThread): Parsing macros\adapters.sql
2021-05-15 13:13:16.193854 (MainThread): Parsing macros\catalog.sql
2021-05-15 13:13:16.201850 (MainThread): Parsing macros\etc.sql
2021-05-15 13:13:16.201850 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 13:13:16.209848 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 13:13:16.217844 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 13:13:16.217844 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 13:13:16.225840 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 13:13:16.233837 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 13:13:16.233837 (MainThread): Parsing macros\core.sql
2021-05-15 13:13:16.241834 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 13:13:16.273820 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 13:13:16.281817 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 13:13:16.289814 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 13:13:16.289814 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 13:13:16.289814 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 13:13:16.289814 (MainThread): Parsing macros\etc\query.sql
2021-05-15 13:13:16.289814 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 13:13:16.297810 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 13:13:16.313804 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 13:13:16.313804 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 13:13:16.321800 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 13:13:16.337794 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 13:13:16.369782 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 13:13:16.369782 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 13:13:16.394544 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 13:13:16.400950 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 13:13:16.405224 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 13:13:16.411736 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 13:13:16.413885 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 13:13:16.414960 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 13:13:16.417099 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 13:13:16.423493 (MainThread): Partial parsing not enabled
2021-05-15 13:13:16.435858 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 13:13:16.443843 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 13:13:16.451851 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 13:13:16.451851 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 13:13:16.459848 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 13:13:16.459848 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 13:13:16.523814 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AF08A9FC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AF08A9B48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AF08A9C88>]}
2021-05-15 13:13:16.523814 (MainThread): Flushing usage events
2021-05-15 13:13:17.626391 (MainThread): Connection 'model.northwind_shop.stg_suppliers' was properly closed.
2021-05-15 13:13:17.626391 (MainThread): Encountered an error:
2021-05-15 13:13:17.627408 (MainThread): Compilation Error in model stg_orderdetail (models\staging\stg_orderdetail.sql)
  Model 'model.northwind_shop.stg_orderdetail' (models\staging\stg_orderdetail.sql) depends on a source named 'northwind_etl.order_details' which was not found
2021-05-15 13:13:17.631913 (MainThread): Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 444, in load_all
    manifest = loader.create_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 422, in create_manifest
    self.process_manifest(manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 387, in process_manifest
    process_sources(manifest, project_name)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 820, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 807, in _process_sources_for_node
    disabled=(isinstance(target_source, Disabled))
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 510, in invalid_source_fail_unless_test
    disabled=disabled
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 597, in source_target_not_found
    raise_compiler_error(msg, model)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model stg_orderdetail (models\staging\stg_orderdetail.sql)
  Model 'model.northwind_shop.stg_orderdetail' (models\staging\stg_orderdetail.sql) depends on a source named 'northwind_etl.order_details' which was not found

2021-05-15 13:14:10.177471 (MainThread): Running with dbt=0.19.1
2021-05-15 13:14:10.495247 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 13:14:10.495247 (MainThread): Tracking: tracking
2021-05-15 13:14:10.495247 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013397332CC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013397332508>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013397336CC8>]}
2021-05-15 13:14:10.503246 (MainThread): Partial parsing not enabled
2021-05-15 13:14:10.503246 (MainThread): Parsing macros\adapters.sql
2021-05-15 13:14:10.519238 (MainThread): Parsing macros\catalog.sql
2021-05-15 13:14:10.527233 (MainThread): Parsing macros\etc.sql
2021-05-15 13:14:10.527233 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 13:14:10.535230 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 13:14:10.543227 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 13:14:10.551224 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 13:14:10.551224 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 13:14:10.567218 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 13:14:10.575214 (MainThread): Parsing macros\core.sql
2021-05-15 13:14:10.575214 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 13:14:10.615196 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 13:14:10.623193 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 13:14:10.623193 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 13:14:10.623193 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 13:14:10.631191 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 13:14:10.631191 (MainThread): Parsing macros\etc\query.sql
2021-05-15 13:14:10.631191 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 13:14:10.639189 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 13:14:10.655180 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 13:14:10.655180 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 13:14:10.655180 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 13:14:10.679169 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 13:14:10.711156 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 13:14:10.711156 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 13:14:10.727149 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 13:14:10.735147 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 13:14:10.735147 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 13:14:10.743143 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 13:14:10.743143 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 13:14:10.751140 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 13:14:10.751140 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 13:14:10.759137 (MainThread): Partial parsing not enabled
2021-05-15 13:14:10.775132 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 13:14:10.783129 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 13:14:10.791125 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 13:14:10.791125 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 13:14:10.799123 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 13:14:10.799123 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 13:14:10.863094 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001339AFDDDC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001339AFDDC88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001339AFDDF88>]}
2021-05-15 13:14:10.863094 (MainThread): Flushing usage events
2021-05-15 13:14:12.290352 (MainThread): Connection 'model.northwind_shop.stg_suppliers' was properly closed.
2021-05-15 13:14:12.290352 (MainThread): Encountered an error:
2021-05-15 13:14:12.290352 (MainThread): Compilation Error in model stg_orderdetail (models\staging\stg_orderdetail.sql)
  Model 'model.northwind_shop.stg_orderdetail' (models\staging\stg_orderdetail.sql) depends on a source named 'northwind_etl.order_details' which was not found
2021-05-15 13:14:12.294188 (MainThread): Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 444, in load_all
    manifest = loader.create_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 422, in create_manifest
    self.process_manifest(manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 387, in process_manifest
    process_sources(manifest, project_name)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 820, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 807, in _process_sources_for_node
    disabled=(isinstance(target_source, Disabled))
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 510, in invalid_source_fail_unless_test
    disabled=disabled
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 597, in source_target_not_found
    raise_compiler_error(msg, model)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model stg_orderdetail (models\staging\stg_orderdetail.sql)
  Model 'model.northwind_shop.stg_orderdetail' (models\staging\stg_orderdetail.sql) depends on a source named 'northwind_etl.order_details' which was not found

2021-05-15 13:21:43.639753 (MainThread): Running with dbt=0.19.1
2021-05-15 13:21:43.969510 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 13:21:43.969510 (MainThread): Tracking: tracking
2021-05-15 13:21:43.969510 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FADBD2D88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FADBD7B08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FADBD77C8>]}
2021-05-15 13:21:43.977507 (MainThread): Partial parsing not enabled
2021-05-15 13:21:43.977507 (MainThread): Parsing macros\adapters.sql
2021-05-15 13:21:43.998649 (MainThread): Parsing macros\catalog.sql
2021-05-15 13:21:43.998649 (MainThread): Parsing macros\etc.sql
2021-05-15 13:21:44.006648 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 13:21:44.006648 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 13:21:44.022641 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 13:21:44.022641 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 13:21:44.022641 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 13:21:44.030638 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 13:21:44.038634 (MainThread): Parsing macros\core.sql
2021-05-15 13:21:44.038634 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 13:21:44.082983 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 13:21:44.090980 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 13:21:44.090980 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 13:21:44.090980 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 13:21:44.098976 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 13:21:44.098976 (MainThread): Parsing macros\etc\query.sql
2021-05-15 13:21:44.098976 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 13:21:44.106973 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 13:21:44.122966 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 13:21:44.122966 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 13:21:44.130963 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 13:21:44.154953 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 13:21:44.178943 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 13:21:44.186940 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 13:21:44.202933 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 13:21:44.210930 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 13:21:44.210930 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 13:21:44.218926 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 13:21:44.218926 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 13:21:44.226923 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 13:21:44.226923 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 13:21:44.234920 (MainThread): Partial parsing not enabled
2021-05-15 13:21:44.250914 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 13:21:44.258910 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 13:21:44.266907 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 13:21:44.266907 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 13:21:44.274904 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 13:21:44.274904 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 13:21:44.347631 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 13:21:44.355671 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4154f2ad-ffe9-4a4c-8cb6-4ee35f43cbad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FB1893D48>]}
2021-05-15 13:21:44.367416 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4154f2ad-ffe9-4a4c-8cb6-4ee35f43cbad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FB1850108>]}
2021-05-15 13:21:44.367416 (MainThread): Found 6 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 13:21:44.367416 (MainThread): 
2021-05-15 13:21:44.367416 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 13:21:44.367416 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 13:21:44.367416 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 13:21:45.620294 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 13:21:45.620294 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 13:21:45.626560 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 13:21:46.151795 (MainThread): 10:21:46 | Concurrency: 1 threads (target='dev')
2021-05-15 13:21:46.151795 (MainThread): 10:21:46 | 
2021-05-15 13:21:46.160155 (Thread-1): Began running node model.northwind_shop.stg_customers
2021-05-15 13:21:46.161045 (Thread-1): 10:21:46 | 1 of 6 START view model dbt_arthur.stg_customers..................... [RUN]
2021-05-15 13:21:46.161045 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 13:21:46.161045 (Thread-1): Compiling model.northwind_shop.stg_customers
2021-05-15 13:21:46.168447 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_customers"
2021-05-15 13:21:46.169483 (Thread-1): finished collecting timing info
2021-05-15 13:21:46.225579 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_customers"
2021-05-15 13:21:46.225579 (Thread-1): Opening a new connection, currently in state init
2021-05-15 13:21:46.235723 (Thread-1): On model.northwind_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_customers"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_customers`
  OPTIONS()
  as with
    source as (
        select 
           /*primary key*/
            customer_id
            ,country	
            ,city	
            ,fax	
            ,postal_code	
            ,address	
            ,region	
            ,contact_name		
            ,phone	
            ,company_name	
            ,contact_title
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`customers`
    )
select * from source;


2021-05-15 13:21:48.474001 (Thread-1): finished collecting timing info
2021-05-15 13:21:48.474001 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4154f2ad-ffe9-4a4c-8cb6-4ee35f43cbad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FB18908C8>]}
2021-05-15 13:21:48.474001 (Thread-1): 10:21:48 | 1 of 6 OK created view model dbt_arthur.stg_customers................ [OK in 2.31s]
2021-05-15 13:21:48.474001 (Thread-1): Finished running node model.northwind_shop.stg_customers
2021-05-15 13:21:48.481993 (Thread-1): Began running node model.northwind_shop.stg_employees
2021-05-15 13:21:48.482633 (Thread-1): 10:21:48 | 2 of 6 START view model dbt_arthur.stg_employees..................... [RUN]
2021-05-15 13:21:48.483136 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 13:21:48.483136 (Thread-1): Compiling model.northwind_shop.stg_employees
2021-05-15 13:21:48.483136 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_employees"
2021-05-15 13:21:48.483136 (Thread-1): finished collecting timing info
2021-05-15 13:21:48.491147 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_employees"
2021-05-15 13:21:48.491147 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 13:21:48.491147 (Thread-1): On model.northwind_shop.stg_employees: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_employees"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_employees`
  OPTIONS()
  as with
    source as (
        select 
           /*primary key*/
            employee_id	
            ,country	
            ,city	
            ,postal_code
            ,hire_date	
            ,extension	
            ,address	
            ,birth_date	
            ,region	
            ,photo_path	
            ,last_name	
            ,first_name	
            ,title	
            ,title_of_courtesy	
            ,notes	
            ,home_phone	
            ,reports_to	
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`employees`
    )
select * from source;


2021-05-15 13:21:50.123166 (Thread-1): finished collecting timing info
2021-05-15 13:21:50.123166 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4154f2ad-ffe9-4a4c-8cb6-4ee35f43cbad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FB1840DC8>]}
2021-05-15 13:21:50.123166 (Thread-1): 10:21:50 | 2 of 6 OK created view model dbt_arthur.stg_employees................ [OK in 1.64s]
2021-05-15 13:21:50.131169 (Thread-1): Finished running node model.northwind_shop.stg_employees
2021-05-15 13:21:50.131169 (Thread-1): Began running node model.northwind_shop.stg_orderdetail
2021-05-15 13:21:50.131169 (Thread-1): 10:21:50 | 3 of 6 START view model dbt_arthur.stg_orderdetail................... [RUN]
2021-05-15 13:21:50.131169 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 13:21:50.131169 (Thread-1): Compiling model.northwind_shop.stg_orderdetail
2021-05-15 13:21:50.139164 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_orderdetail"
2021-05-15 13:21:50.139164 (Thread-1): finished collecting timing info
2021-05-15 13:21:50.139164 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_orderdetail"
2021-05-15 13:21:50.147163 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 13:21:50.150096 (Thread-1): On model.northwind_shop.stg_orderdetail: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_orderdetail"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_orderdetail`
  OPTIONS()
  as with
    source as (
        select 
           /*primary key*/
            order_id
            ,product_id		
            , 
               case
                  when discount = 1 then True
                  else False
               end as is_discountinued	
            ,unit_price	
            ,quantity	
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`order_details`
)
select * from source;


2021-05-15 13:21:51.649462 (Thread-1): finished collecting timing info
2021-05-15 13:21:51.649462 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4154f2ad-ffe9-4a4c-8cb6-4ee35f43cbad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FB191DF48>]}
2021-05-15 13:21:51.649462 (Thread-1): 10:21:51 | 3 of 6 OK created view model dbt_arthur.stg_orderdetail.............. [OK in 1.52s]
2021-05-15 13:21:51.649462 (Thread-1): Finished running node model.northwind_shop.stg_orderdetail
2021-05-15 13:21:51.649462 (Thread-1): Began running node model.northwind_shop.stg_orders
2021-05-15 13:21:51.649462 (Thread-1): 10:21:51 | 4 of 6 START view model dbt_arthur.stg_orders........................ [RUN]
2021-05-15 13:21:51.649462 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 13:21:51.649462 (Thread-1): Compiling model.northwind_shop.stg_orders
2021-05-15 13:21:51.657518 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_orders"
2021-05-15 13:21:51.657518 (Thread-1): finished collecting timing info
2021-05-15 13:21:51.665510 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_orders"
2021-05-15 13:21:51.665510 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 13:21:51.673508 (Thread-1): On model.northwind_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_orders"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_orders`
  OPTIONS()
  as with
    source as (
        select 
          /*Primary key*/ 
            order_id
          /*Foreign Key*/
            ,employee_id
            ,customer_id
            ,ship_region	
            ,shipped_date
            ,ship_country	
            ,ship_name
            ,order_date		
            ,ship_postal_code	
            ,ship_city	
            ,freight	
            ,ship_via as ship_id
            ,required_date
            ,ship_address
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`orders`
    )
select * from source;


2021-05-15 13:21:53.236252 (Thread-1): finished collecting timing info
2021-05-15 13:21:53.236252 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4154f2ad-ffe9-4a4c-8cb6-4ee35f43cbad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FB199B6C8>]}
2021-05-15 13:21:53.236252 (Thread-1): 10:21:53 | 4 of 6 OK created view model dbt_arthur.stg_orders................... [OK in 1.59s]
2021-05-15 13:21:53.244256 (Thread-1): Finished running node model.northwind_shop.stg_orders
2021-05-15 13:21:53.244256 (Thread-1): Began running node model.northwind_shop.stg_products
2021-05-15 13:21:53.244256 (Thread-1): 10:21:53 | 5 of 6 START view model dbt_arthur.stg_products...................... [RUN]
2021-05-15 13:21:53.244256 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 13:21:53.244256 (Thread-1): Compiling model.northwind_shop.stg_products
2021-05-15 13:21:53.252251 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_products"
2021-05-15 13:21:53.252251 (Thread-1): finished collecting timing info
2021-05-15 13:21:53.252251 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_products"
2021-05-15 13:21:53.252251 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 13:21:53.260325 (Thread-1): On model.northwind_shop.stg_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_products`
  OPTIONS()
  as with
    source as (
        select 
            /* Primary key */
               product_id

            /*Foreign key */
            , category_id
            , supplier_id

            , units_in_stock           	
            , unit_price	
            , product_name	
            , quantity_per_unit	
            	
            , reorder_level	
            , units_on_order	
            , 
                case
                 when discontinued = 1 then True
                 else False
                end as is_discontinued 
            /* Stitich Columns*/
            , _sdc_table_version
            , _sdc_sequence
            , _sdc_batched_at	
            , _sdc_extracted_at	
            , _sdc_received_at

        from `northwind1-313400`.`northwind_etl`.`products`
    )
select * from source;


2021-05-15 13:21:53.260325 (Thread-1): unclosed <socket.socket fd=1108, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59576), raddr=('142.250.219.10', 443)>
2021-05-15 13:21:53.260325 (Thread-1): unclosed <socket.socket fd=848, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59577), raddr=('142.250.219.10', 443)>
2021-05-15 13:21:53.260325 (Thread-1): unclosed <socket.socket fd=456, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59579), raddr=('142.250.219.10', 443)>
2021-05-15 13:21:53.260325 (Thread-1): unclosed <socket.socket fd=752, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59578), raddr=('142.250.219.10', 443)>
2021-05-15 13:21:53.260325 (Thread-1): unclosed <socket.socket fd=1204, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59581), raddr=('142.250.219.10', 443)>
2021-05-15 13:21:53.260325 (Thread-1): unclosed <socket.socket fd=1148, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59580), raddr=('142.250.219.10', 443)>
2021-05-15 13:21:53.260325 (Thread-1): unclosed <socket.socket fd=1232, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59583), raddr=('142.250.219.10', 443)>
2021-05-15 13:21:53.260325 (Thread-1): unclosed <socket.socket fd=1228, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59582), raddr=('142.250.219.10', 443)>
2021-05-15 13:21:55.386644 (Thread-1): finished collecting timing info
2021-05-15 13:21:55.394648 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4154f2ad-ffe9-4a4c-8cb6-4ee35f43cbad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FB19BA248>]}
2021-05-15 13:21:55.394648 (Thread-1): 10:21:55 | 5 of 6 OK created view model dbt_arthur.stg_products................. [OK in 2.15s]
2021-05-15 13:21:55.394648 (Thread-1): Finished running node model.northwind_shop.stg_products
2021-05-15 13:21:55.394648 (Thread-1): Began running node model.northwind_shop.stg_suppliers
2021-05-15 13:21:55.394648 (Thread-1): 10:21:55 | 6 of 6 START view model dbt_arthur.stg_suppliers..................... [RUN]
2021-05-15 13:21:55.394648 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 13:21:55.394648 (Thread-1): Compiling model.northwind_shop.stg_suppliers
2021-05-15 13:21:55.440755 (Thread-1): unclosed <socket.socket fd=1252, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59584), raddr=('142.250.219.10', 443)>
2021-05-15 13:21:55.440755 (Thread-1): unclosed <socket.socket fd=1244, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59585), raddr=('142.250.219.10', 443)>
2021-05-15 13:21:55.440755 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_suppliers"
2021-05-15 13:21:55.448973 (Thread-1): finished collecting timing info
2021-05-15 13:21:55.448973 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_suppliers"
2021-05-15 13:21:55.448973 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 13:21:55.457044 (Thread-1): On model.northwind_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_suppliers"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_suppliers`
  OPTIONS()
  as with
    source as (
        select 
           /*primary key*/
            supplier_id
            ,country
            ,city	
            ,fax	
            ,postal_code
            ,homepage
            ,address	
            ,region	
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`suppliers`
    )
select * from source;


2021-05-15 13:21:56.993457 (Thread-1): finished collecting timing info
2021-05-15 13:21:56.993457 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4154f2ad-ffe9-4a4c-8cb6-4ee35f43cbad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FADB91048>]}
2021-05-15 13:21:56.993457 (Thread-1): 10:21:56 | 6 of 6 OK created view model dbt_arthur.stg_suppliers................ [OK in 1.60s]
2021-05-15 13:21:57.001461 (Thread-1): Finished running node model.northwind_shop.stg_suppliers
2021-05-15 13:21:57.055064 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 13:21:57.055064 (MainThread): 10:21:57 | 
2021-05-15 13:21:57.055064 (MainThread): 10:21:57 | Finished running 6 view models in 12.69s.
2021-05-15 13:21:57.055064 (MainThread): Connection 'master' was properly closed.
2021-05-15 13:21:57.055064 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 13:21:57.055064 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 13:21:57.055064 (MainThread): Connection 'model.northwind_shop.stg_suppliers' was properly closed.
2021-05-15 13:21:57.068207 (MainThread): 
2021-05-15 13:21:57.068207 (MainThread): Completed successfully
2021-05-15 13:21:57.068207 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-05-15 13:21:57.068207 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FB1699FC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FB186D288>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FB1840148>]}
2021-05-15 13:21:57.068207 (MainThread): Flushing usage events
2021-05-15 13:23:27.687529 (MainThread): Running with dbt=0.19.1
2021-05-15 13:23:28.011656 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 13:23:28.011656 (MainThread): Tracking: tracking
2021-05-15 13:23:28.011656 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250F6BD2C48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250F6BD64C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250F6BD6108>]}
2021-05-15 13:23:28.019650 (MainThread): Partial parsing not enabled
2021-05-15 13:23:28.019650 (MainThread): Parsing macros\adapters.sql
2021-05-15 13:23:28.043601 (MainThread): Parsing macros\catalog.sql
2021-05-15 13:23:28.051599 (MainThread): Parsing macros\etc.sql
2021-05-15 13:23:28.051599 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 13:23:28.059594 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 13:23:28.067592 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 13:23:28.075587 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 13:23:28.075587 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 13:23:28.083584 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 13:23:28.091596 (MainThread): Parsing macros\core.sql
2021-05-15 13:23:28.091596 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 13:23:28.131563 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 13:23:28.139561 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 13:23:28.139561 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 13:23:28.139561 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 13:23:28.139561 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 13:23:28.147559 (MainThread): Parsing macros\etc\query.sql
2021-05-15 13:23:28.147559 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 13:23:28.155555 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 13:23:28.163551 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 13:23:28.171547 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 13:23:28.171547 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 13:23:28.195538 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 13:23:28.243515 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 13:23:28.243515 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 13:23:28.275503 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 13:23:28.283499 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 13:23:28.291496 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 13:23:28.299492 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 13:23:28.299492 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 13:23:28.299492 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 13:23:28.307489 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 13:23:28.307489 (MainThread): Partial parsing not enabled
2021-05-15 13:23:28.331480 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 13:23:28.339476 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 13:23:28.339476 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 13:23:28.347473 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 13:23:28.347473 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 13:23:28.355470 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 13:23:28.427439 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 13:23:28.431188 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7910d3a5-b58a-411d-b817-86cea0ada4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250FA8A6F08>]}
2021-05-15 13:23:28.431684 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7910d3a5-b58a-411d-b817-86cea0ada4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250FA69C0C8>]}
2021-05-15 13:23:28.431684 (MainThread): Found 6 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 13:23:28.439686 (MainThread): 
2021-05-15 13:23:28.439686 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 13:23:28.439686 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 13:23:28.439686 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 13:23:30.265448 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 13:23:30.265448 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 13:23:30.271994 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 13:23:32.147860 (MainThread): 10:23:32 | Concurrency: 1 threads (target='dev')
2021-05-15 13:23:32.147860 (MainThread): 10:23:32 | 
2021-05-15 13:23:32.155857 (Thread-1): Began running node model.northwind_shop.stg_customers
2021-05-15 13:23:32.155857 (Thread-1): 10:23:32 | 1 of 6 START view model dbt_arthur.stg_customers..................... [RUN]
2021-05-15 13:23:32.155857 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 13:23:32.155857 (Thread-1): Compiling model.northwind_shop.stg_customers
2021-05-15 13:23:32.155857 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_customers"
2021-05-15 13:23:32.163864 (Thread-1): finished collecting timing info
2021-05-15 13:23:32.195841 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_customers"
2021-05-15 13:23:32.195841 (Thread-1): Opening a new connection, currently in state init
2021-05-15 13:23:32.203838 (Thread-1): On model.northwind_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_customers"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_customers`
  OPTIONS()
  as with
    source as (
        select 
           /*primary key*/
            customer_id
            ,country	
            ,city	
            ,fax	
            ,postal_code	
            ,address	
            ,region	
            ,contact_name		
            ,phone	
            ,company_name	
            ,contact_title
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`customers`
    )
select * from source;


2021-05-15 13:23:34.268840 (Thread-1): finished collecting timing info
2021-05-15 13:23:34.268840 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7910d3a5-b58a-411d-b817-86cea0ada4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250FA854448>]}
2021-05-15 13:23:34.268840 (Thread-1): 10:23:34 | 1 of 6 OK created view model dbt_arthur.stg_customers................ [OK in 2.11s]
2021-05-15 13:23:34.268840 (Thread-1): Finished running node model.northwind_shop.stg_customers
2021-05-15 13:23:34.268840 (Thread-1): Began running node model.northwind_shop.stg_employees
2021-05-15 13:23:34.268840 (Thread-1): 10:23:34 | 2 of 6 START view model dbt_arthur.stg_employees..................... [RUN]
2021-05-15 13:23:34.268840 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 13:23:34.268840 (Thread-1): Compiling model.northwind_shop.stg_employees
2021-05-15 13:23:34.276791 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_employees"
2021-05-15 13:23:34.276791 (Thread-1): finished collecting timing info
2021-05-15 13:23:34.276791 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_employees"
2021-05-15 13:23:34.276791 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 13:23:34.284832 (Thread-1): On model.northwind_shop.stg_employees: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_employees"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_employees`
  OPTIONS()
  as with
    source as (
        select 
           /*primary key*/
            employee_id	
            ,country	
            ,city	
            ,postal_code
            ,hire_date	
            ,extension	
            ,address	
            ,birth_date	
            ,region	
            ,photo_path	
            ,last_name	
            ,first_name	
            ,title	
            ,title_of_courtesy	
            ,notes	
            ,home_phone	
            ,reports_to	
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`employees`
    )
select * from source;


2021-05-15 13:23:37.329114 (Thread-1): finished collecting timing info
2021-05-15 13:23:37.329114 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7910d3a5-b58a-411d-b817-86cea0ada4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250FA971148>]}
2021-05-15 13:23:37.329114 (Thread-1): 10:23:37 | 2 of 6 OK created view model dbt_arthur.stg_employees................ [OK in 3.06s]
2021-05-15 13:23:37.337127 (Thread-1): Finished running node model.northwind_shop.stg_employees
2021-05-15 13:23:37.337127 (Thread-1): Began running node model.northwind_shop.stg_orderdetail
2021-05-15 13:23:37.337127 (Thread-1): 10:23:37 | 3 of 6 START view model dbt_arthur.stg_orderdetail................... [RUN]
2021-05-15 13:23:37.337127 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 13:23:37.337127 (Thread-1): Compiling model.northwind_shop.stg_orderdetail
2021-05-15 13:23:37.345115 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_orderdetail"
2021-05-15 13:23:37.345115 (Thread-1): finished collecting timing info
2021-05-15 13:23:37.345115 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_orderdetail"
2021-05-15 13:23:37.345115 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 13:23:37.353163 (Thread-1): On model.northwind_shop.stg_orderdetail: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_orderdetail"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_orderdetail`
  OPTIONS()
  as with
    source as (
        select 
           /*primary key*/
            order_id
            ,product_id		
            , 
               case
                  when discount = 1 then True
                  else False
               end as is_discountinued	
            ,unit_price	
            ,quantity	
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`order_details`
)
select * from source;


2021-05-15 13:23:39.379566 (Thread-1): finished collecting timing info
2021-05-15 13:23:39.379566 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7910d3a5-b58a-411d-b817-86cea0ada4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250FA931F88>]}
2021-05-15 13:23:39.379566 (Thread-1): 10:23:39 | 3 of 6 OK created view model dbt_arthur.stg_orderdetail.............. [OK in 2.04s]
2021-05-15 13:23:39.387570 (Thread-1): Finished running node model.northwind_shop.stg_orderdetail
2021-05-15 13:23:39.387570 (Thread-1): Began running node model.northwind_shop.stg_orders
2021-05-15 13:23:39.387570 (Thread-1): 10:23:39 | 4 of 6 START view model dbt_arthur.stg_orders........................ [RUN]
2021-05-15 13:23:39.387570 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 13:23:39.387570 (Thread-1): Compiling model.northwind_shop.stg_orders
2021-05-15 13:23:39.395570 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_orders"
2021-05-15 13:23:39.395570 (Thread-1): finished collecting timing info
2021-05-15 13:23:39.395570 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_orders"
2021-05-15 13:23:39.395570 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 13:23:39.403622 (Thread-1): On model.northwind_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_orders"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_orders`
  OPTIONS()
  as with
    source as (
        select 
          /*Primary key*/ 
            order_id
          /*Foreign Key*/
            ,employee_id
            ,customer_id
            ,ship_region	
            ,shipped_date
            ,ship_country	
            ,ship_name
            ,order_date		
            ,ship_postal_code	
            ,ship_city	
            ,freight	
            ,ship_via as ship_id
            ,required_date
            ,ship_address
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`orders`
    )
select * from source;


2021-05-15 13:23:42.048368 (Thread-1): finished collecting timing info
2021-05-15 13:23:42.048368 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7910d3a5-b58a-411d-b817-86cea0ada4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250FA8837C8>]}
2021-05-15 13:23:42.048368 (Thread-1): 10:23:42 | 4 of 6 OK created view model dbt_arthur.stg_orders................... [OK in 2.66s]
2021-05-15 13:23:42.048368 (Thread-1): Finished running node model.northwind_shop.stg_orders
2021-05-15 13:23:42.051278 (Thread-1): Began running node model.northwind_shop.stg_products
2021-05-15 13:23:42.051789 (Thread-1): 10:23:42 | 5 of 6 START view model dbt_arthur.stg_products...................... [RUN]
2021-05-15 13:23:42.051789 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 13:23:42.051789 (Thread-1): Compiling model.northwind_shop.stg_products
2021-05-15 13:23:42.051789 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_products"
2021-05-15 13:23:42.051789 (Thread-1): finished collecting timing info
2021-05-15 13:23:42.059803 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_products"
2021-05-15 13:23:42.059803 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 13:23:42.067798 (Thread-1): On model.northwind_shop.stg_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_products`
  OPTIONS()
  as with
    source as (
        select 
            /* Primary key */
               product_id

            /*Foreign key */
            , category_id
            , supplier_id

            , units_in_stock           	
            , unit_price	
            , product_name	
            , quantity_per_unit	
            	
            , reorder_level	
            , units_on_order	
            , 
                case
                 when discontinued = 1 then True
                 else False
                end as is_discontinued 
            /* Stitich Columns*/
            , _sdc_table_version
            , _sdc_sequence
            , _sdc_batched_at	
            , _sdc_extracted_at	
            , _sdc_received_at

        from `northwind1-313400`.`northwind_etl`.`products`
    )
select * from source;


2021-05-15 13:23:42.067798 (Thread-1): unclosed <socket.socket fd=1128, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59597), raddr=('142.250.219.10', 443)>
2021-05-15 13:23:42.067798 (Thread-1): unclosed <socket.socket fd=1140, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59598), raddr=('142.250.219.10', 443)>
2021-05-15 13:23:42.067798 (Thread-1): unclosed <socket.socket fd=1184, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59600), raddr=('142.250.219.10', 443)>
2021-05-15 13:23:42.067798 (Thread-1): unclosed <socket.socket fd=880, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59599), raddr=('142.250.219.10', 443)>
2021-05-15 13:23:42.067798 (Thread-1): unclosed <socket.socket fd=1204, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59602), raddr=('142.250.219.10', 443)>
2021-05-15 13:23:42.067798 (Thread-1): unclosed <socket.socket fd=876, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59601), raddr=('142.250.219.10', 443)>
2021-05-15 13:23:42.067798 (Thread-1): unclosed <socket.socket fd=1240, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59604), raddr=('142.250.219.10', 443)>
2021-05-15 13:23:42.067798 (Thread-1): unclosed <socket.socket fd=1180, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59603), raddr=('142.250.219.10', 443)>
2021-05-15 13:23:44.499588 (Thread-1): finished collecting timing info
2021-05-15 13:23:44.499588 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7910d3a5-b58a-411d-b817-86cea0ada4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250FA959448>]}
2021-05-15 13:23:44.499588 (Thread-1): 10:23:44 | 5 of 6 OK created view model dbt_arthur.stg_products................. [OK in 2.45s]
2021-05-15 13:23:44.499588 (Thread-1): Finished running node model.northwind_shop.stg_products
2021-05-15 13:23:44.507609 (Thread-1): Began running node model.northwind_shop.stg_suppliers
2021-05-15 13:23:44.507609 (Thread-1): 10:23:44 | 6 of 6 START view model dbt_arthur.stg_suppliers..................... [RUN]
2021-05-15 13:23:44.507609 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 13:23:44.507609 (Thread-1): Compiling model.northwind_shop.stg_suppliers
2021-05-15 13:23:44.549314 (Thread-1): unclosed <socket.socket fd=664, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59605), raddr=('142.250.219.10', 443)>
2021-05-15 13:23:44.549314 (Thread-1): unclosed <socket.socket fd=1260, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59606), raddr=('142.250.219.10', 443)>
2021-05-15 13:23:44.549314 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_suppliers"
2021-05-15 13:23:44.549314 (Thread-1): finished collecting timing info
2021-05-15 13:23:44.557303 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_suppliers"
2021-05-15 13:23:44.557303 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 13:23:44.557303 (Thread-1): On model.northwind_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_suppliers"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_suppliers`
  OPTIONS()
  as with
    source as (
        select 
           /*primary key*/
            supplier_id
            ,country
            ,city	
            ,fax	
            ,postal_code
            ,homepage
            ,address	
            ,region	
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`suppliers`
    )
select * from source;


2021-05-15 13:23:47.981114 (Thread-1): finished collecting timing info
2021-05-15 13:23:47.981114 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7910d3a5-b58a-411d-b817-86cea0ada4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250F6B76908>]}
2021-05-15 13:23:47.981114 (Thread-1): 10:23:47 | 6 of 6 OK created view model dbt_arthur.stg_suppliers................ [OK in 3.47s]
2021-05-15 13:23:47.989117 (Thread-1): Finished running node model.northwind_shop.stg_suppliers
2021-05-15 13:23:47.997439 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 13:23:47.997439 (MainThread): 10:23:47 | 
2021-05-15 13:23:47.997439 (MainThread): 10:23:47 | Finished running 6 view models in 19.56s.
2021-05-15 13:23:47.997439 (MainThread): Connection 'master' was properly closed.
2021-05-15 13:23:47.997439 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 13:23:48.002804 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 13:23:48.002804 (MainThread): Connection 'model.northwind_shop.stg_suppliers' was properly closed.
2021-05-15 13:23:48.011092 (MainThread): 
2021-05-15 13:23:48.011092 (MainThread): Completed successfully
2021-05-15 13:23:48.011092 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-05-15 13:23:48.016720 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250FA67C748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250F6C12EC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250F6C12748>]}
2021-05-15 13:23:48.016720 (MainThread): Flushing usage events
2021-05-15 13:40:19.696337 (MainThread): Running with dbt=0.19.1
2021-05-15 13:40:20.431033 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 13:40:20.439097 (MainThread): Tracking: tracking
2021-05-15 13:40:20.441333 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC03364F08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC03393D08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC03393B48>]}
2021-05-15 13:40:20.451998 (MainThread): Partial parsing not enabled
2021-05-15 13:40:20.459477 (MainThread): Parsing macros\adapters.sql
2021-05-15 13:40:20.490161 (MainThread): Parsing macros\catalog.sql
2021-05-15 13:40:20.496216 (MainThread): Parsing macros\etc.sql
2021-05-15 13:40:20.496216 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 13:40:20.506561 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 13:40:20.533042 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 13:40:20.543162 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 13:40:20.546272 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 13:40:20.556500 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 13:40:20.566270 (MainThread): Parsing macros\core.sql
2021-05-15 13:40:20.573917 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 13:40:20.630818 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 13:40:20.644520 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 13:40:20.644520 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 13:40:20.647726 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 13:40:20.647726 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 13:40:20.656395 (MainThread): Parsing macros\etc\query.sql
2021-05-15 13:40:20.656395 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 13:40:20.672646 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 13:40:20.686327 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 13:40:20.695017 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 13:40:20.703398 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 13:40:20.744100 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 13:40:20.792135 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 13:40:20.794685 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 13:40:20.817146 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 13:40:20.828078 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 13:40:20.828078 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 13:40:20.837997 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 13:40:20.848056 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 13:40:20.848056 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 13:40:20.852360 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 13:40:20.858091 (MainThread): Partial parsing not enabled
2021-05-15 13:40:20.910498 (MainThread): Acquiring new bigquery connection "model.northwind_shop.Dim_customers".
2021-05-15 13:40:20.930188 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 13:40:20.938229 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 13:40:20.940248 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 13:40:20.950634 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 13:40:20.960759 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 13:40:20.960759 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 13:40:21.092021 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 13:40:21.096495 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '897794ee-71cd-4d6f-a5c2-a064b8130922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC0356EA88>]}
2021-05-15 13:40:21.106357 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '897794ee-71cd-4d6f-a5c2-a064b8130922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC035A3508>]}
2021-05-15 13:40:21.106357 (MainThread): Found 7 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 13:40:21.111940 (MainThread): 
2021-05-15 13:40:21.112922 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 13:40:21.116079 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 13:40:21.116079 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 13:40:22.469646 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 13:40:22.470641 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 13:40:22.476659 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 13:40:23.717034 (MainThread): 10:40:23 | Concurrency: 1 threads (target='dev')
2021-05-15 13:40:23.718822 (MainThread): 10:40:23 | 
2021-05-15 13:40:23.777366 (Thread-1): Began running node model.northwind_shop.stg_customers
2021-05-15 13:40:23.778144 (Thread-1): 10:40:23 | 1 of 7 START view model dbt_arthur.stg_customers..................... [RUN]
2021-05-15 13:40:23.779162 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 13:40:23.779162 (Thread-1): Compiling model.northwind_shop.stg_customers
2021-05-15 13:40:23.787248 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_customers"
2021-05-15 13:40:23.787248 (Thread-1): finished collecting timing info
2021-05-15 13:40:23.887371 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_customers"
2021-05-15 13:40:23.890047 (Thread-1): Opening a new connection, currently in state init
2021-05-15 13:40:23.905579 (Thread-1): On model.northwind_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_customers"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_customers`
  OPTIONS()
  as with
    source as (
        select 
           /*primary key*/
            customer_id
            ,country	
            ,city	
            ,fax	
            ,postal_code	
            ,address	
            ,region	
            ,contact_name		
            ,phone	
            ,company_name	
            ,contact_title
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`customers`
    )
select * from source;


2021-05-15 13:40:26.218410 (Thread-1): finished collecting timing info
2021-05-15 13:40:26.218410 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '897794ee-71cd-4d6f-a5c2-a064b8130922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC0345C748>]}
2021-05-15 13:40:26.218410 (Thread-1): 10:40:26 | 1 of 7 OK created view model dbt_arthur.stg_customers................ [OK in 2.44s]
2021-05-15 13:40:26.218410 (Thread-1): Finished running node model.northwind_shop.stg_customers
2021-05-15 13:40:26.218410 (Thread-1): Began running node model.northwind_shop.stg_employees
2021-05-15 13:40:26.218410 (Thread-1): 10:40:26 | 2 of 7 START view model dbt_arthur.stg_employees..................... [RUN]
2021-05-15 13:40:26.218410 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 13:40:26.218410 (Thread-1): Compiling model.northwind_shop.stg_employees
2021-05-15 13:40:26.226526 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_employees"
2021-05-15 13:40:26.233484 (Thread-1): finished collecting timing info
2021-05-15 13:40:26.236681 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_employees"
2021-05-15 13:40:26.288510 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 13:40:26.297143 (Thread-1): On model.northwind_shop.stg_employees: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_employees"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_employees`
  OPTIONS()
  as with
    source as (
        select 
           /*primary key*/
            employee_id	
            ,country	
            ,city	
            ,postal_code
            ,hire_date	
            ,extension	
            ,address	
            ,birth_date	
            ,region	
            ,photo_path	
            ,last_name	
            ,first_name	
            ,title	
            ,title_of_courtesy	
            ,notes	
            ,home_phone	
            ,reports_to	
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`employees`
    )
select * from source;


2021-05-15 13:40:28.775909 (Thread-1): finished collecting timing info
2021-05-15 13:40:28.775909 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '897794ee-71cd-4d6f-a5c2-a064b8130922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC03878EC8>]}
2021-05-15 13:40:28.775909 (Thread-1): 10:40:28 | 2 of 7 OK created view model dbt_arthur.stg_employees................ [OK in 2.56s]
2021-05-15 13:40:28.783043 (Thread-1): Finished running node model.northwind_shop.stg_employees
2021-05-15 13:40:28.783651 (Thread-1): Began running node model.northwind_shop.stg_orderdetail
2021-05-15 13:40:28.783651 (Thread-1): 10:40:28 | 3 of 7 START view model dbt_arthur.stg_orderdetail................... [RUN]
2021-05-15 13:40:28.783651 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 13:40:28.783651 (Thread-1): Compiling model.northwind_shop.stg_orderdetail
2021-05-15 13:40:28.786789 (Thread-1): unclosed <socket.socket fd=1352, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59807), raddr=('142.250.218.170', 443)>
2021-05-15 13:40:28.786789 (Thread-1): unclosed <socket.socket fd=692, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59808), raddr=('142.250.219.10', 443)>
2021-05-15 13:40:28.838985 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_orderdetail"
2021-05-15 13:40:28.846623 (Thread-1): finished collecting timing info
2021-05-15 13:40:28.849247 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_orderdetail"
2021-05-15 13:40:28.849247 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 13:40:28.865451 (Thread-1): On model.northwind_shop.stg_orderdetail: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_orderdetail"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_orderdetail`
  OPTIONS()
  as with
    source as (
        select 
           /*primary key*/
            order_id
            ,product_id		
            , 
               case
                  when discount = 1 then True
                  else False
               end as is_discountinued	
            ,unit_price	
            ,quantity	
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`order_details`
)
select * from source;


2021-05-15 13:40:31.066840 (Thread-1): finished collecting timing info
2021-05-15 13:40:31.066840 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '897794ee-71cd-4d6f-a5c2-a064b8130922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC03831348>]}
2021-05-15 13:40:31.070872 (Thread-1): 10:40:31 | 3 of 7 OK created view model dbt_arthur.stg_orderdetail.............. [OK in 2.28s]
2021-05-15 13:40:31.071657 (Thread-1): Finished running node model.northwind_shop.stg_orderdetail
2021-05-15 13:40:31.071657 (Thread-1): Began running node model.northwind_shop.stg_orders
2021-05-15 13:40:31.071657 (Thread-1): 10:40:31 | 4 of 7 START view model dbt_arthur.stg_orders........................ [RUN]
2021-05-15 13:40:31.075416 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 13:40:31.077188 (Thread-1): Compiling model.northwind_shop.stg_orders
2021-05-15 13:40:31.077188 (Thread-1): unclosed <socket.socket fd=1248, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59809), raddr=('142.250.218.170', 443)>
2021-05-15 13:40:31.077188 (Thread-1): unclosed <socket.socket fd=1392, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59810), raddr=('142.250.219.10', 443)>
2021-05-15 13:40:31.077188 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_orders"
2021-05-15 13:40:31.086432 (Thread-1): finished collecting timing info
2021-05-15 13:40:31.088229 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_orders"
2021-05-15 13:40:31.088229 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 13:40:31.096531 (Thread-1): On model.northwind_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_orders"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_orders`
  OPTIONS()
  as with
    source as (
        select 
          /*Primary key*/ 
            order_id
          /*Foreign Key*/
            ,employee_id
            ,customer_id
            ,ship_region	
            ,shipped_date
            ,ship_country	
            ,ship_name
            ,order_date		
            ,ship_postal_code	
            ,ship_city	
            ,freight	
            ,ship_via as ship_id
            ,required_date
            ,ship_address
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`orders`
    )
select * from source;


2021-05-15 13:40:33.596430 (Thread-1): finished collecting timing info
2021-05-15 13:40:33.596430 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '897794ee-71cd-4d6f-a5c2-a064b8130922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC03882C88>]}
2021-05-15 13:40:33.596430 (Thread-1): 10:40:33 | 4 of 7 OK created view model dbt_arthur.stg_orders................... [OK in 2.52s]
2021-05-15 13:40:33.607729 (Thread-1): Finished running node model.northwind_shop.stg_orders
2021-05-15 13:40:33.607729 (Thread-1): Began running node model.northwind_shop.stg_products
2021-05-15 13:40:33.609454 (Thread-1): 10:40:33 | 5 of 7 START view model dbt_arthur.stg_products...................... [RUN]
2021-05-15 13:40:33.611083 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 13:40:33.611083 (Thread-1): Compiling model.northwind_shop.stg_products
2021-05-15 13:40:33.611083 (Thread-1): unclosed <socket.socket fd=704, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59805), raddr=('142.250.218.170', 443)>
2021-05-15 13:40:33.611083 (Thread-1): unclosed <socket.socket fd=1060, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59806), raddr=('142.250.219.10', 443)>
2021-05-15 13:40:33.621727 (Thread-1): unclosed <socket.socket fd=1416, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59811), raddr=('142.250.218.170', 443)>
2021-05-15 13:40:33.621727 (Thread-1): unclosed <socket.socket fd=384, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59812), raddr=('142.250.219.10', 443)>
2021-05-15 13:40:33.626381 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_products"
2021-05-15 13:40:33.626381 (Thread-1): finished collecting timing info
2021-05-15 13:40:33.696687 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_products"
2021-05-15 13:40:33.696687 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 13:40:33.712717 (Thread-1): On model.northwind_shop.stg_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_products`
  OPTIONS()
  as with
    source as (
        select 
            /* Primary key */
               product_id

            /*Foreign key */
            , category_id
            , supplier_id

            , units_in_stock           	
            , unit_price	
            , product_name	
            , quantity_per_unit	
            	
            , reorder_level	
            , units_on_order	
            , 
                case
                 when discontinued = 1 then True
                 else False
                end as is_discontinued 
            /* Stitich Columns*/
            , _sdc_table_version
            , _sdc_sequence
            , _sdc_batched_at	
            , _sdc_extracted_at	
            , _sdc_received_at

        from `northwind1-313400`.`northwind_etl`.`products`
    )
select * from source;


2021-05-15 13:40:35.913969 (Thread-1): finished collecting timing info
2021-05-15 13:40:35.920935 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '897794ee-71cd-4d6f-a5c2-a064b8130922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC0332DD08>]}
2021-05-15 13:40:35.921712 (Thread-1): 10:40:35 | 5 of 7 OK created view model dbt_arthur.stg_products................. [OK in 2.30s]
2021-05-15 13:40:35.926879 (Thread-1): Finished running node model.northwind_shop.stg_products
2021-05-15 13:40:35.927350 (Thread-1): Began running node model.northwind_shop.stg_suppliers
2021-05-15 13:40:35.928200 (Thread-1): 10:40:35 | 6 of 7 START view model dbt_arthur.stg_suppliers..................... [RUN]
2021-05-15 13:40:35.928200 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 13:40:35.928200 (Thread-1): Compiling model.northwind_shop.stg_suppliers
2021-05-15 13:40:35.928200 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_suppliers"
2021-05-15 13:40:35.928200 (Thread-1): finished collecting timing info
2021-05-15 13:40:35.938490 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_suppliers"
2021-05-15 13:40:35.938490 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 13:40:35.956570 (Thread-1): On model.northwind_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_suppliers"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_suppliers`
  OPTIONS()
  as with
    source as (
        select 
           /*primary key*/
            supplier_id
            ,country
            ,city	
            ,fax	
            ,postal_code
            ,homepage
            ,address	
            ,region	
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`suppliers`
    )
select * from source;


2021-05-15 13:40:38.105729 (Thread-1): finished collecting timing info
2021-05-15 13:40:38.105729 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '897794ee-71cd-4d6f-a5c2-a064b8130922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC033DEF48>]}
2021-05-15 13:40:38.105729 (Thread-1): 10:40:38 | 6 of 7 OK created view model dbt_arthur.stg_suppliers................ [OK in 2.18s]
2021-05-15 13:40:38.113694 (Thread-1): Finished running node model.northwind_shop.stg_suppliers
2021-05-15 13:40:38.113694 (Thread-1): Began running node model.northwind_shop.Dim_customers
2021-05-15 13:40:38.113694 (Thread-1): 10:40:38 | 7 of 7 START view model dbt_arthur.Dim_customers..................... [RUN]
2021-05-15 13:40:38.113694 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.Dim_customers".
2021-05-15 13:40:38.113694 (Thread-1): Compiling model.northwind_shop.Dim_customers
2021-05-15 13:40:38.113694 (Thread-1): unclosed <socket.socket fd=852, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59815), raddr=('142.250.218.170', 443)>
2021-05-15 13:40:38.113694 (Thread-1): unclosed <socket.socket fd=1460, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59816), raddr=('142.250.219.10', 443)>
2021-05-15 13:40:38.126490 (Thread-1): Writing injected SQL for node "model.northwind_shop.Dim_customers"
2021-05-15 13:40:38.179994 (Thread-1): finished collecting timing info
2021-05-15 13:40:38.179994 (Thread-1): Writing runtime SQL for node "model.northwind_shop.Dim_customers"
2021-05-15 13:40:38.186938 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 13:40:38.196557 (Thread-1): On model.northwind_shop.Dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.Dim_customers"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`Dim_customers`
  OPTIONS()
  as with
    selected as (
        select 
           /*primary key*/
            customer_id
            ,country	
            ,city	
            ,fax	
            ,postal_code	
            ,address	
            ,region	
            ,contact_name		
            ,phone	
            ,company_name	
            ,contact_title


        from `northwind1-313400`.`dbt_arthur`.`stg_customers`
    )
select * from selected;


2021-05-15 13:40:40.410095 (Thread-1): finished collecting timing info
2021-05-15 13:40:40.411228 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '897794ee-71cd-4d6f-a5c2-a064b8130922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC03562D08>]}
2021-05-15 13:40:40.412664 (Thread-1): 10:40:40 | 7 of 7 OK created view model dbt_arthur.Dim_customers................ [OK in 2.30s]
2021-05-15 13:40:40.413735 (Thread-1): Finished running node model.northwind_shop.Dim_customers
2021-05-15 13:40:40.519576 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 13:40:40.519576 (MainThread): 10:40:40 | 
2021-05-15 13:40:40.521555 (MainThread): 10:40:40 | Finished running 7 view models in 19.41s.
2021-05-15 13:40:40.521698 (MainThread): Connection 'master' was properly closed.
2021-05-15 13:40:40.521698 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 13:40:40.523107 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 13:40:40.523107 (MainThread): Connection 'model.northwind_shop.Dim_customers' was properly closed.
2021-05-15 13:40:40.523107 (MainThread): unclosed <socket.socket fd=1488, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59817), raddr=('142.250.218.170', 443)>
2021-05-15 13:40:40.523107 (MainThread): unclosed <socket.socket fd=1496, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59818), raddr=('142.250.219.10', 443)>
2021-05-15 13:40:40.538465 (MainThread): 
2021-05-15 13:40:40.538465 (MainThread): Completed successfully
2021-05-15 13:40:40.538465 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-05-15 13:40:40.538465 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC0335FD88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC0335FCC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC03353688>]}
2021-05-15 13:40:40.538465 (MainThread): Flushing usage events
2021-05-15 13:50:51.244425 (MainThread): Running with dbt=0.19.1
2021-05-15 13:50:51.579655 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_customers'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 13:50:51.579655 (MainThread): Tracking: tracking
2021-05-15 13:50:51.579655 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE69C0F3C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE69C0F8C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE69C18188>]}
2021-05-15 13:50:51.595649 (MainThread): Partial parsing not enabled
2021-05-15 13:50:51.595649 (MainThread): Parsing macros\adapters.sql
2021-05-15 13:50:51.611641 (MainThread): Parsing macros\catalog.sql
2021-05-15 13:50:51.619873 (MainThread): Parsing macros\etc.sql
2021-05-15 13:50:51.619873 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 13:50:51.619873 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 13:50:51.635951 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 13:50:51.635951 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 13:50:51.635951 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 13:50:51.652035 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 13:50:51.657112 (MainThread): Parsing macros\core.sql
2021-05-15 13:50:51.657112 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 13:50:51.697099 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 13:50:51.705096 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 13:50:51.705096 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 13:50:51.705096 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 13:50:51.713093 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 13:50:51.713093 (MainThread): Parsing macros\etc\query.sql
2021-05-15 13:50:51.713093 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 13:50:51.721090 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 13:50:51.737082 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 13:50:51.737082 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 13:50:51.745080 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 13:50:51.769110 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 13:50:51.801057 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 13:50:51.801057 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 13:50:51.817051 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 13:50:51.825049 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 13:50:51.833113 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 13:50:51.841110 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 13:50:51.841110 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 13:50:51.841110 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 13:50:51.841110 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 13:50:51.849097 (MainThread): Partial parsing not enabled
2021-05-15 13:50:51.873054 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 13:50:51.881092 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 13:50:51.881092 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 13:50:51.889084 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 13:50:51.889084 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 13:50:51.897089 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 13:50:51.897089 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 13:50:51.969053 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 13:50:51.974768 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8259035c-d630-40c2-a69c-13f34ccc4bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6D8C2E48>]}
2021-05-15 13:50:51.974768 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8259035c-d630-40c2-a69c-13f34ccc4bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6D7B0E88>]}
2021-05-15 13:50:51.974768 (MainThread): Found 7 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 13:50:51.974768 (MainThread): 
2021-05-15 13:50:51.982768 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 13:50:51.982768 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 13:50:51.982768 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 13:50:52.687448 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 13:50:52.687448 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 13:50:52.696790 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 13:50:53.850260 (MainThread): 10:50:53 | Concurrency: 1 threads (target='dev')
2021-05-15 13:50:53.851742 (MainThread): 10:50:53 | 
2021-05-15 13:50:53.856605 (Thread-1): Began running node model.northwind_shop.dim_customers
2021-05-15 13:50:53.857101 (Thread-1): 10:50:53 | 1 of 1 START view model dbt_arthur.dim_customers..................... [RUN]
2021-05-15 13:50:53.857898 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 13:50:53.857898 (Thread-1): Compiling model.northwind_shop.dim_customers
2021-05-15 13:50:53.862778 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_customers"
2021-05-15 13:50:53.865007 (Thread-1): finished collecting timing info
2021-05-15 13:50:53.928655 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_customers"
2021-05-15 13:50:53.928655 (Thread-1): Opening a new connection, currently in state init
2021-05-15 13:50:53.935693 (Thread-1): On model.northwind_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.dim_customers"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`dim_customers`
  OPTIONS()
  as with
    selected as (
        select 
           /*primary key*/
            customer_id
            ,country	
            ,city	
            ,fax	
            ,postal_code	
            ,address	
            ,region	
            ,contact_name		
            ,phone	
            ,company_name	
            ,contact_title


        from `northwind1-313400`.`dbt_arthur`.`stg_customers`
    )
    , transformed as (
        select row_number() over (order by customer_id) as customers_sk
        , *
    )

select * from transformed;


2021-05-15 13:50:55.058767 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/ec6d9306-f86f-4001-a3d2-059640e44773?maxResults=0&location=US&prettyPrint=false: Unrecognized name: customer_id at [26:44]')
2021-05-15 13:50:57.268517 (Thread-1): finished collecting timing info
2021-05-15 13:50:57.268517 (Thread-1): Database Error in model dim_customers (models\marts\dim_customers.sql)
  Unrecognized name: customer_id at [26:44]
  compiled SQL at target\run\northwind_shop\models\marts\dim_customers.sql
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/10737673-7c63-43b5-95ca-103c2694bd1e?maxResults=0&location=US&prettyPrint=false: Unrecognized name: customer_id at [26:44]

(job ID: 10737673-7c63-43b5-95ca-103c2694bd1e)

                                                              -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.dim_customers"} */
   2:
   3:
   4:  create or replace view `northwind1-313400`.`dbt_arthur`.`dim_customers`
   5:  OPTIONS()
   6:  as with
   7:    selected as (
   8:        select 
   9:           /*primary key*/
  10:            customer_id
  11:            ,country	
  12:            ,city	
  13:            ,fax	
  14:            ,postal_code	
  15:            ,address	
  16:            ,region	
  17:            ,contact_name		
  18:            ,phone	
  19:            ,company_name	
  20:            ,contact_title
  21:
  22:
  23:        from `northwind1-313400`.`dbt_arthur`.`stg_customers`
  24:    )
  25:    , transformed as (
  26:        select row_number() over (order by customer_id) as customers_sk
  27:        , *
  28:    )
  29:
  30:select * from transformed;
  31:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_customers (models\marts\dim_customers.sql)
  Unrecognized name: customer_id at [26:44]
  compiled SQL at target\run\northwind_shop\models\marts\dim_customers.sql
2021-05-15 13:50:57.345117 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8259035c-d630-40c2-a69c-13f34ccc4bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6D6DBA48>]}
2021-05-15 13:50:57.345117 (Thread-1): 10:50:57 | 1 of 1 ERROR creating view model dbt_arthur.dim_customers............ [ERROR in 3.49s]
2021-05-15 13:50:57.345117 (Thread-1): Finished running node model.northwind_shop.dim_customers
2021-05-15 13:50:57.362088 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 13:50:57.362617 (MainThread): 10:50:57 | 
2021-05-15 13:50:57.364408 (MainThread): 10:50:57 | Finished running 1 view model in 5.38s.
2021-05-15 13:50:57.364547 (MainThread): Connection 'master' was properly closed.
2021-05-15 13:50:57.364547 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 13:50:57.364547 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 13:50:57.364547 (MainThread): Connection 'model.northwind_shop.dim_customers' was properly closed.
2021-05-15 13:50:57.372674 (MainThread): 
2021-05-15 13:50:57.372674 (MainThread): Completed with 1 error and 0 warnings:
2021-05-15 13:50:57.372674 (MainThread): 
2021-05-15 13:50:57.372674 (MainThread): Database Error in model dim_customers (models\marts\dim_customers.sql)
2021-05-15 13:50:57.372674 (MainThread):   Unrecognized name: customer_id at [26:44]
2021-05-15 13:50:57.372674 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\dim_customers.sql
2021-05-15 13:50:57.372674 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-15 13:50:57.372674 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE69CCFAC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE69CC47C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6D797608>]}
2021-05-15 13:50:57.380208 (MainThread): Flushing usage events
2021-05-15 13:53:59.458414 (MainThread): Running with dbt=0.19.1
2021-05-15 13:53:59.767196 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_customers'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 13:53:59.767196 (MainThread): Tracking: tracking
2021-05-15 13:53:59.775193 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158EE9BF788>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158EE9BF848>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158EE9C6188>]}
2021-05-15 13:53:59.783190 (MainThread): Partial parsing not enabled
2021-05-15 13:53:59.783190 (MainThread): Parsing macros\adapters.sql
2021-05-15 13:53:59.799183 (MainThread): Parsing macros\catalog.sql
2021-05-15 13:53:59.807180 (MainThread): Parsing macros\etc.sql
2021-05-15 13:53:59.807180 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 13:53:59.815176 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 13:53:59.823173 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 13:53:59.823173 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 13:53:59.823173 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 13:53:59.839166 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 13:53:59.839166 (MainThread): Parsing macros\core.sql
2021-05-15 13:53:59.847163 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 13:53:59.887160 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 13:53:59.895144 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 13:53:59.895144 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 13:53:59.903142 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 13:53:59.903142 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 13:53:59.903142 (MainThread): Parsing macros\etc\query.sql
2021-05-15 13:53:59.911142 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 13:53:59.919137 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 13:53:59.935129 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 13:53:59.935129 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 13:53:59.935129 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 13:53:59.959121 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 13:53:59.991108 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 13:53:59.991108 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 13:54:00.011716 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 13:54:00.019951 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 13:54:00.025154 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 13:54:00.032401 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 13:54:00.035638 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 13:54:00.037802 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 13:54:00.040012 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 13:54:00.046522 (MainThread): Partial parsing not enabled
2021-05-15 13:54:00.066410 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 13:54:00.074409 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 13:54:00.074409 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 13:54:00.082406 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 13:54:00.082406 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 13:54:00.090397 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 13:54:00.090397 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 13:54:00.164313 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 13:54:00.169536 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08a22388-725a-4a7b-87a3-f32e4c1544b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158F2671FC8>]}
2021-05-15 13:54:00.177596 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08a22388-725a-4a7b-87a3-f32e4c1544b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158F2552908>]}
2021-05-15 13:54:00.177596 (MainThread): Found 7 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 13:54:00.177596 (MainThread): 
2021-05-15 13:54:00.177596 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 13:54:00.177596 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 13:54:00.177596 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 13:54:01.985351 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 13:54:01.985848 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 13:54:01.999022 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 13:54:03.211580 (MainThread): 10:54:03 | Concurrency: 1 threads (target='dev')
2021-05-15 13:54:03.219526 (MainThread): 10:54:03 | 
2021-05-15 13:54:03.219526 (Thread-1): Began running node model.northwind_shop.dim_customers
2021-05-15 13:54:03.219526 (Thread-1): 10:54:03 | 1 of 1 START view model dbt_arthur.dim_customers..................... [RUN]
2021-05-15 13:54:03.219526 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 13:54:03.219526 (Thread-1): Compiling model.northwind_shop.dim_customers
2021-05-15 13:54:03.227590 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_customers"
2021-05-15 13:54:03.227590 (Thread-1): finished collecting timing info
2021-05-15 13:54:03.259510 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_customers"
2021-05-15 13:54:03.268493 (Thread-1): Opening a new connection, currently in state init
2021-05-15 13:54:03.268714 (Thread-1): On model.northwind_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.dim_customers"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`dim_customers`
  OPTIONS()
  as with
    selected as (
        select 
           /*primary key*/
            customer_id
            ,country	
            ,city	
            ,fax	
            ,postal_code	
            ,address	
            ,region	
            ,contact_name		
            ,phone	
            ,company_name	
            ,contact_title


        from `northwind1-313400`.`dbt_arthur`.`stg_customers`
    )
    , transformed as (
        select 
        row_number() over (order by customer_id) as customer_sk
        , *
    )

select * from transformed;


2021-05-15 13:54:05.565320 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/e8c24602-cde6-41ef-9117-10e21650fbdc?maxResults=0&location=US&prettyPrint=false: Unrecognized name: customer_id at [27:37]')
2021-05-15 13:54:07.313559 (Thread-1): finished collecting timing info
2021-05-15 13:54:07.313559 (Thread-1): Database Error in model dim_customers (models\marts\dim_customers.sql)
  Unrecognized name: customer_id at [27:37]
  compiled SQL at target\run\northwind_shop\models\marts\dim_customers.sql
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/b0ea138f-abcd-45e1-9b01-31c197a317a3?maxResults=0&location=US&prettyPrint=false: Unrecognized name: customer_id at [27:37]

(job ID: b0ea138f-abcd-45e1-9b01-31c197a317a3)

                                                              -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.dim_customers"} */
   2:
   3:
   4:  create or replace view `northwind1-313400`.`dbt_arthur`.`dim_customers`
   5:  OPTIONS()
   6:  as with
   7:    selected as (
   8:        select 
   9:           /*primary key*/
  10:            customer_id
  11:            ,country	
  12:            ,city	
  13:            ,fax	
  14:            ,postal_code	
  15:            ,address	
  16:            ,region	
  17:            ,contact_name		
  18:            ,phone	
  19:            ,company_name	
  20:            ,contact_title
  21:
  22:
  23:        from `northwind1-313400`.`dbt_arthur`.`stg_customers`
  24:    )
  25:    , transformed as (
  26:        select 
  27:        row_number() over (order by customer_id) as customer_sk
  28:        , *
  29:    )
  30:
  31:select * from transformed;
  32:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_customers (models\marts\dim_customers.sql)
  Unrecognized name: customer_id at [27:37]
  compiled SQL at target\run\northwind_shop\models\marts\dim_customers.sql
2021-05-15 13:54:07.322864 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08a22388-725a-4a7b-87a3-f32e4c1544b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158F26CA388>]}
2021-05-15 13:54:07.323880 (Thread-1): 10:54:07 | 1 of 1 ERROR creating view model dbt_arthur.dim_customers............ [ERROR in 4.10s]
2021-05-15 13:54:07.325921 (Thread-1): Finished running node model.northwind_shop.dim_customers
2021-05-15 13:54:07.368854 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 13:54:07.368854 (MainThread): 10:54:07 | 
2021-05-15 13:54:07.368854 (MainThread): 10:54:07 | Finished running 1 view model in 7.19s.
2021-05-15 13:54:07.371547 (MainThread): Connection 'master' was properly closed.
2021-05-15 13:54:07.371855 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 13:54:07.371855 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 13:54:07.371855 (MainThread): Connection 'model.northwind_shop.dim_customers' was properly closed.
2021-05-15 13:54:07.371855 (MainThread): 
2021-05-15 13:54:07.371855 (MainThread): Completed with 1 error and 0 warnings:
2021-05-15 13:54:07.380722 (MainThread): 
2021-05-15 13:54:07.381207 (MainThread): Database Error in model dim_customers (models\marts\dim_customers.sql)
2021-05-15 13:54:07.382180 (MainThread):   Unrecognized name: customer_id at [27:37]
2021-05-15 13:54:07.382180 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\dim_customers.sql
2021-05-15 13:54:07.382180 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-15 13:54:07.382180 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158F2477848>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158F244EB48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158EEA80AC8>]}
2021-05-15 13:54:07.382180 (MainThread): Flushing usage events
2021-05-15 13:56:20.540878 (MainThread): Running with dbt=0.19.1
2021-05-15 13:56:20.947573 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_customers'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 13:56:20.947573 (MainThread): Tracking: tracking
2021-05-15 13:56:20.947573 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237014C0C08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023701C11DC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023701C11D08>]}
2021-05-15 13:56:20.955569 (MainThread): Partial parsing not enabled
2021-05-15 13:56:20.955569 (MainThread): Parsing macros\adapters.sql
2021-05-15 13:56:20.979558 (MainThread): Parsing macros\catalog.sql
2021-05-15 13:56:20.987554 (MainThread): Parsing macros\etc.sql
2021-05-15 13:56:20.987554 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 13:56:20.995551 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 13:56:21.003547 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 13:56:21.003547 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 13:56:21.011545 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 13:56:21.019541 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 13:56:21.019541 (MainThread): Parsing macros\core.sql
2021-05-15 13:56:21.027538 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 13:56:21.067520 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 13:56:21.075517 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 13:56:21.075517 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 13:56:21.075517 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 13:56:21.075517 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 13:56:21.075517 (MainThread): Parsing macros\etc\query.sql
2021-05-15 13:56:21.083515 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 13:56:21.091511 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 13:56:21.099508 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 13:56:21.099508 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 13:56:21.107505 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 13:56:21.139491 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 13:56:21.171477 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 13:56:21.171477 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 13:56:21.187471 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 13:56:21.211462 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 13:56:21.217051 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 13:56:21.223431 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 13:56:21.226471 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 13:56:21.228497 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 13:56:21.229512 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 13:56:21.238032 (MainThread): Partial parsing not enabled
2021-05-15 13:56:21.258669 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 13:56:21.266673 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 13:56:21.266673 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 13:56:21.274673 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 13:56:21.274673 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 13:56:21.282669 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 13:56:21.282669 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 13:56:21.352027 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 13:56:21.360827 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a933bad-4bab-465d-ac61-d8088b785ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237056CDA08>]}
2021-05-15 13:56:21.368833 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a933bad-4bab-465d-ac61-d8088b785ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237057AEF08>]}
2021-05-15 13:56:21.368833 (MainThread): Found 7 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 13:56:21.376298 (MainThread): 
2021-05-15 13:56:21.376298 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 13:56:21.376298 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 13:56:21.376298 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 13:56:24.018845 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 13:56:24.019341 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 13:56:24.027838 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 13:56:26.260223 (MainThread): 10:56:26 | Concurrency: 1 threads (target='dev')
2021-05-15 13:56:26.260223 (MainThread): 10:56:26 | 
2021-05-15 13:56:26.267623 (Thread-1): Began running node model.northwind_shop.dim_customers
2021-05-15 13:56:26.267623 (Thread-1): 10:56:26 | 1 of 1 START view model dbt_arthur.dim_customers..................... [RUN]
2021-05-15 13:56:26.267623 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 13:56:26.267623 (Thread-1): Compiling model.northwind_shop.dim_customers
2021-05-15 13:56:26.275865 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_customers"
2021-05-15 13:56:26.275865 (Thread-1): finished collecting timing info
2021-05-15 13:56:26.307794 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_customers"
2021-05-15 13:56:26.307794 (Thread-1): Opening a new connection, currently in state init
2021-05-15 13:56:26.315840 (Thread-1): On model.northwind_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.dim_customers"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`dim_customers`
  OPTIONS()
  as with
    selected as (
        select 
           /*primary key*/
            customer_id
            ,country	
            ,city	
            ,fax	
            ,postal_code	
            ,address	
            ,region	
            ,contact_name		
            ,phone	
            ,company_name	
            ,contact_title


        from `northwind1-313400`.`dbt_arthur`.`stg_customers`
    )
    , transformed as (
        select 
        row_number() over (order by customer_id) as customer_sk
        , *
        from selected
    )

select * from transformed;


2021-05-15 13:56:29.449728 (Thread-1): finished collecting timing info
2021-05-15 13:56:29.449728 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a933bad-4bab-465d-ac61-d8088b785ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237057A8F48>]}
2021-05-15 13:56:29.449728 (Thread-1): 10:56:29 | 1 of 1 OK created view model dbt_arthur.dim_customers................ [OK in 3.18s]
2021-05-15 13:56:29.449728 (Thread-1): Finished running node model.northwind_shop.dim_customers
2021-05-15 13:56:29.512402 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 13:56:29.512402 (MainThread): 10:56:29 | 
2021-05-15 13:56:29.512402 (MainThread): 10:56:29 | Finished running 1 view model in 8.14s.
2021-05-15 13:56:29.516232 (MainThread): Connection 'master' was properly closed.
2021-05-15 13:56:29.516232 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 13:56:29.516232 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 13:56:29.516232 (MainThread): Connection 'model.northwind_shop.dim_customers' was properly closed.
2021-05-15 13:56:29.523575 (MainThread): 
2021-05-15 13:56:29.523575 (MainThread): Completed successfully
2021-05-15 13:56:29.523575 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-15 13:56:29.523575 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023701CD2848>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023701C9AF08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237058A34C8>]}
2021-05-15 13:56:29.523575 (MainThread): Flushing usage events
2021-05-15 14:02:46.105959 (MainThread): Running with dbt=0.19.1
2021-05-15 14:02:46.531210 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_employee'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 14:02:46.531210 (MainThread): Tracking: tracking
2021-05-15 14:02:46.531210 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021555361DC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021555366608>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215553661C8>]}
2021-05-15 14:02:46.539208 (MainThread): Partial parsing not enabled
2021-05-15 14:02:46.547204 (MainThread): Parsing macros\adapters.sql
2021-05-15 14:02:46.563196 (MainThread): Parsing macros\catalog.sql
2021-05-15 14:02:46.563196 (MainThread): Parsing macros\etc.sql
2021-05-15 14:02:46.571193 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 14:02:46.571193 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 14:02:46.587186 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 14:02:46.587186 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 14:02:46.587186 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 14:02:46.595183 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 14:02:46.603180 (MainThread): Parsing macros\core.sql
2021-05-15 14:02:46.603180 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 14:02:46.646013 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 14:02:46.654009 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 14:02:46.654009 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 14:02:46.654009 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 14:02:46.662006 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 14:02:46.662006 (MainThread): Parsing macros\etc\query.sql
2021-05-15 14:02:46.662006 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 14:02:46.674702 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 14:02:46.682712 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 14:02:46.682712 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 14:02:46.690708 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 14:02:46.714698 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 14:02:46.746690 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 14:02:46.746690 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 14:02:46.764171 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 14:02:46.772336 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 14:02:46.772336 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 14:02:46.780328 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 14:02:46.788324 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 14:02:46.788324 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 14:02:46.788324 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 14:02:46.796321 (MainThread): Partial parsing not enabled
2021-05-15 14:02:46.820311 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 14:02:46.828372 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 14:02:46.828372 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 14:02:46.839004 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 14:02:46.843314 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 14:02:46.846585 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 14:02:46.850913 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 14:02:46.855336 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 14:02:46.952269 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 14:02:46.958594 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e983293a-f8f7-4c82-8b3c-f39871ea78b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021559002648>]}
2021-05-15 14:02:46.972253 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e983293a-f8f7-4c82-8b3c-f39871ea78b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021558FFE4C8>]}
2021-05-15 14:02:46.972253 (MainThread): Found 8 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 14:02:46.972749 (MainThread): The selector 'dim_employee' does not match any nodes and will be ignored
2021-05-15 14:02:46.972749 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2021-05-15 14:02:46.972749 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021558FF3E08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021558FF3A08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021558FFE4C8>]}
2021-05-15 14:02:46.972749 (MainThread): Flushing usage events
2021-05-15 14:02:47.952079 (MainThread): Connection 'model.northwind_shop.stg_suppliers' was properly closed.
2021-05-15 14:03:24.642281 (MainThread): Running with dbt=0.19.1
2021-05-15 14:03:25.099219 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_employees'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 14:03:25.107269 (MainThread): Tracking: tracking
2021-05-15 14:03:25.107269 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288C587FEC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288C5860808>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288C58678C8>]}
2021-05-15 14:03:25.115915 (MainThread): Partial parsing not enabled
2021-05-15 14:03:25.115915 (MainThread): Parsing macros\adapters.sql
2021-05-15 14:03:25.131970 (MainThread): Parsing macros\catalog.sql
2021-05-15 14:03:25.140039 (MainThread): Parsing macros\etc.sql
2021-05-15 14:03:25.140039 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 14:03:25.148021 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 14:03:25.156014 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 14:03:25.156014 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 14:03:25.165148 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 14:03:25.169458 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 14:03:25.177523 (MainThread): Parsing macros\core.sql
2021-05-15 14:03:25.177523 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 14:03:25.219179 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 14:03:25.235171 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 14:03:25.235171 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 14:03:25.235171 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 14:03:25.243110 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 14:03:25.243110 (MainThread): Parsing macros\etc\query.sql
2021-05-15 14:03:25.243110 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 14:03:25.259138 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 14:03:25.284841 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 14:03:25.284841 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 14:03:25.292845 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 14:03:25.310534 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 14:03:25.342520 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 14:03:25.350517 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 14:03:25.366512 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 14:03:25.374508 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 14:03:25.374508 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 14:03:25.382504 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 14:03:25.382504 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 14:03:25.382504 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 14:03:25.390501 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 14:03:25.398498 (MainThread): Partial parsing not enabled
2021-05-15 14:03:25.412988 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 14:03:25.423436 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 14:03:25.431481 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 14:03:25.431481 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 14:03:25.439022 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 14:03:25.439022 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 14:03:25.447378 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 14:03:25.455352 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 14:03:25.527352 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 14:03:25.527352 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a44cfc4c-dd3e-4150-b05d-3ab91ccca0e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288C9328548>]}
2021-05-15 14:03:25.536278 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a44cfc4c-dd3e-4150-b05d-3ab91ccca0e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288C943D548>]}
2021-05-15 14:03:25.536278 (MainThread): Found 8 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 14:03:25.544286 (MainThread): 
2021-05-15 14:03:25.544286 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 14:03:25.544286 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 14:03:25.544286 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 14:03:26.811501 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 14:03:26.811501 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 14:03:26.821314 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 14:03:27.966353 (MainThread): 11:03:27 | Concurrency: 1 threads (target='dev')
2021-05-15 14:03:27.967556 (MainThread): 11:03:27 | 
2021-05-15 14:03:27.969454 (Thread-1): Began running node model.northwind_shop.dim_employees
2021-05-15 14:03:27.969454 (Thread-1): 11:03:27 | 1 of 1 START view model dbt_arthur.dim_employees..................... [RUN]
2021-05-15 14:03:27.969454 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 14:03:27.969454 (Thread-1): Compiling model.northwind_shop.dim_employees
2021-05-15 14:03:27.969454 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_employees"
2021-05-15 14:03:27.977558 (Thread-1): finished collecting timing info
2021-05-15 14:03:28.020662 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_employees"
2021-05-15 14:03:28.020662 (Thread-1): Opening a new connection, currently in state init
2021-05-15 14:03:28.028658 (Thread-1): On model.northwind_shop.dim_employees: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.dim_employees"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`dim_employees`
  OPTIONS()
  as with
    selected as (
        select 
           /*primary key*/
            employee_id	
            ,country	
            ,city	
            ,postal_code
            ,hire_date	
            ,extension	
            ,address	
            ,birth_date	
            ,region	
            ,photo_path	
            ,last_name	
            ,first_name	
            ,title	
            ,title_of_courtesy	
            ,notes	
            ,home_phone	
            ,reports_to	
        from `northwind1-313400`.`dbt_arthur`.`stg_employees`
    )
    , transformed as (
        select 
        row_number() over (order by employee_id) as employee_sk
        , *
        from selected
    )

select * from transformed;


2021-05-15 14:03:30.616783 (Thread-1): finished collecting timing info
2021-05-15 14:03:30.616783 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a44cfc4c-dd3e-4150-b05d-3ab91ccca0e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288C94036C8>]}
2021-05-15 14:03:30.616783 (Thread-1): 11:03:30 | 1 of 1 OK created view model dbt_arthur.dim_employees................ [OK in 2.65s]
2021-05-15 14:03:30.616783 (Thread-1): Finished running node model.northwind_shop.dim_employees
2021-05-15 14:03:30.689104 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 14:03:30.689104 (MainThread): 11:03:30 | 
2021-05-15 14:03:30.689104 (MainThread): 11:03:30 | Finished running 1 view model in 5.14s.
2021-05-15 14:03:30.689104 (MainThread): Connection 'master' was properly closed.
2021-05-15 14:03:30.693547 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 14:03:30.693547 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 14:03:30.693547 (MainThread): Connection 'model.northwind_shop.dim_employees' was properly closed.
2021-05-15 14:03:30.693547 (MainThread): 
2021-05-15 14:03:30.693547 (MainThread): Completed successfully
2021-05-15 14:03:30.701609 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-15 14:03:30.701609 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288C592DC88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288C58F5D88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288C950B488>]}
2021-05-15 14:03:30.701609 (MainThread): Flushing usage events
2021-05-15 14:05:31.474337 (MainThread): Running with dbt=0.19.1
2021-05-15 14:05:31.793425 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_products'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 14:05:31.793425 (MainThread): Tracking: tracking
2021-05-15 14:05:31.793425 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001901160AA88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019011721408>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019011721B48>]}
2021-05-15 14:05:31.809420 (MainThread): Partial parsing not enabled
2021-05-15 14:05:31.811193 (MainThread): Parsing macros\adapters.sql
2021-05-15 14:05:31.830552 (MainThread): Parsing macros\catalog.sql
2021-05-15 14:05:31.836599 (MainThread): Parsing macros\etc.sql
2021-05-15 14:05:31.838620 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 14:05:31.842662 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 14:05:31.853858 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 14:05:31.855872 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 14:05:31.855872 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 14:05:31.861613 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 14:05:31.869670 (MainThread): Parsing macros\core.sql
2021-05-15 14:05:31.869670 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 14:05:31.909651 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 14:05:31.917649 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 14:05:31.925646 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 14:05:31.925646 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 14:05:31.925646 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 14:05:31.925646 (MainThread): Parsing macros\etc\query.sql
2021-05-15 14:05:31.925646 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 14:05:31.933644 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 14:05:31.949635 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 14:05:31.949635 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 14:05:31.957632 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 14:05:31.978751 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 14:05:32.010737 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 14:05:32.010737 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 14:05:32.026732 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 14:05:32.034729 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 14:05:32.034729 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 14:05:32.042727 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 14:05:32.042727 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 14:05:32.042727 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 14:05:32.050720 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 14:05:32.050720 (MainThread): Partial parsing not enabled
2021-05-15 14:05:32.074710 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 14:05:32.082706 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 14:05:32.103567 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 14:05:32.103567 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 14:05:32.111644 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 14:05:32.111644 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 14:05:32.119641 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 14:05:32.119641 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 14:05:32.127631 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 14:05:32.191603 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 14:05:32.200868 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '225e47f6-443a-4154-8495-4710081b4a48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190153AF708>]}
2021-05-15 14:05:32.209340 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '225e47f6-443a-4154-8495-4710081b4a48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019015380C08>]}
2021-05-15 14:05:32.209340 (MainThread): Found 9 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 14:05:32.209340 (MainThread): 
2021-05-15 14:05:32.209340 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 14:05:32.209340 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 14:05:32.209340 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 14:05:33.571094 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 14:05:33.571094 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 14:05:33.578247 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 14:05:35.016651 (MainThread): 11:05:35 | Concurrency: 1 threads (target='dev')
2021-05-15 14:05:35.024653 (MainThread): 11:05:35 | 
2021-05-15 14:05:35.024653 (Thread-1): Began running node model.northwind_shop.dim_products
2021-05-15 14:05:35.024653 (Thread-1): 11:05:35 | 1 of 1 START view model dbt_arthur.dim_products...................... [RUN]
2021-05-15 14:05:35.024653 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 14:05:35.024653 (Thread-1): Compiling model.northwind_shop.dim_products
2021-05-15 14:05:35.032645 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_products"
2021-05-15 14:05:35.085682 (Thread-1): finished collecting timing info
2021-05-15 14:05:35.117678 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_products"
2021-05-15 14:05:35.117678 (Thread-1): Opening a new connection, currently in state init
2021-05-15 14:05:35.125669 (Thread-1): On model.northwind_shop.dim_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.dim_products"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`dim_products`
  OPTIONS()
  as with
    selected as (
        select 
            /* Primary key */
               product_id

            /*Foreign key */
            , category_id
            , supplier_id

            , units_in_stock           	
            , unit_price	
            , product_name	
            , quantity_per_unit	
            	
            , reorder_level	
            , units_on_order	
            , 
                case
                 when discontinued = 1 then True
                 else False
                end as is_discontinued 
                
        from `northwind1-313400`.`dbt_arthur`.`stg_products`
    )
    , transformed as (
        select 
        row_number() over (order by product_id) as product_sk
        , *
        from selected
    )

select * from transformed;


2021-05-15 14:05:38.400777 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/2b099dc6-2f4c-4ea5-bcbe-3ac8f997647d?maxResults=0&location=US&prettyPrint=false: Unrecognized name: discontinued; Did you mean is_discontinued? at [25:23]')
2021-05-15 14:05:39.668937 (Thread-1): finished collecting timing info
2021-05-15 14:05:39.668937 (Thread-1): Database Error in model dim_products (models\marts\dim_products.sql)
  Unrecognized name: discontinued; Did you mean is_discontinued? at [25:23]
  compiled SQL at target\run\northwind_shop\models\marts\dim_products.sql
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/ed422350-c2e3-4fd6-baea-e139d383746a?maxResults=0&location=US&prettyPrint=false: Unrecognized name: discontinued; Did you mean is_discontinued? at [25:23]

(job ID: ed422350-c2e3-4fd6-baea-e139d383746a)

                                                             -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.dim_products"} */
   2:
   3:
   4:  create or replace view `northwind1-313400`.`dbt_arthur`.`dim_products`
   5:  OPTIONS()
   6:  as with
   7:    selected as (
   8:        select 
   9:            /* Primary key */
  10:               product_id
  11:
  12:            /*Foreign key */
  13:            , category_id
  14:            , supplier_id
  15:
  16:            , units_in_stock           	
  17:            , unit_price	
  18:            , product_name	
  19:            , quantity_per_unit	
  20:            	
  21:            , reorder_level	
  22:            , units_on_order	
  23:            , 
  24:                case
  25:                 when discontinued = 1 then True
  26:                 else False
  27:                end as is_discontinued 
  28:                
  29:        from `northwind1-313400`.`dbt_arthur`.`stg_products`
  30:    )
  31:    , transformed as (
  32:        select 
  33:        row_number() over (order by product_id) as product_sk
  34:        , *
  35:        from selected
  36:    )
  37:
  38:select * from transformed;
  39:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_products (models\marts\dim_products.sql)
  Unrecognized name: discontinued; Did you mean is_discontinued? at [25:23]
  compiled SQL at target\run\northwind_shop\models\marts\dim_products.sql
2021-05-15 14:05:39.676934 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '225e47f6-443a-4154-8495-4710081b4a48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001901541B148>]}
2021-05-15 14:05:39.676934 (Thread-1): 11:05:39 | 1 of 1 ERROR creating view model dbt_arthur.dim_products............. [ERROR in 4.65s]
2021-05-15 14:05:39.685367 (Thread-1): Finished running node model.northwind_shop.dim_products
2021-05-15 14:05:39.733752 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 14:05:39.733752 (MainThread): 11:05:39 | 
2021-05-15 14:05:39.733752 (MainThread): 11:05:39 | Finished running 1 view model in 7.52s.
2021-05-15 14:05:39.733752 (MainThread): Connection 'master' was properly closed.
2021-05-15 14:05:39.733752 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 14:05:39.733752 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 14:05:39.733752 (MainThread): Connection 'model.northwind_shop.dim_products' was properly closed.
2021-05-15 14:05:39.741790 (MainThread): 
2021-05-15 14:05:39.741790 (MainThread): Completed with 1 error and 0 warnings:
2021-05-15 14:05:39.741790 (MainThread): 
2021-05-15 14:05:39.741790 (MainThread): Database Error in model dim_products (models\marts\dim_products.sql)
2021-05-15 14:05:39.749746 (MainThread):   Unrecognized name: discontinued; Did you mean is_discontinued? at [25:23]
2021-05-15 14:05:39.749746 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\dim_products.sql
2021-05-15 14:05:39.749746 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-15 14:05:39.749746 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001901171DD08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190151AD908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019015360E48>]}
2021-05-15 14:05:39.749746 (MainThread): Flushing usage events
2021-05-15 14:06:45.523717 (MainThread): Running with dbt=0.19.1
2021-05-15 14:06:45.825491 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_products'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 14:06:45.825491 (MainThread): Tracking: tracking
2021-05-15 14:06:45.825491 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEFAC3F088>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEFAC3FC08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEFAC3FB48>]}
2021-05-15 14:06:45.833488 (MainThread): Partial parsing not enabled
2021-05-15 14:06:45.841484 (MainThread): Parsing macros\adapters.sql
2021-05-15 14:06:45.857477 (MainThread): Parsing macros\catalog.sql
2021-05-15 14:06:45.865474 (MainThread): Parsing macros\etc.sql
2021-05-15 14:06:45.865474 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 14:06:45.865474 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 14:06:45.881468 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 14:06:45.881468 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 14:06:45.881468 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 14:06:45.897461 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 14:06:45.897461 (MainThread): Parsing macros\core.sql
2021-05-15 14:06:45.905458 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 14:06:45.938229 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 14:06:45.946231 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 14:06:45.954228 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 14:06:45.954228 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 14:06:45.954228 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 14:06:45.954228 (MainThread): Parsing macros\etc\query.sql
2021-05-15 14:06:45.954228 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 14:06:45.962224 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 14:06:45.978217 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 14:06:45.978217 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 14:06:45.986215 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 14:06:46.002207 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 14:06:46.034194 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 14:06:46.034194 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 14:06:46.050186 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 14:06:46.058184 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 14:06:46.066180 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 14:06:46.074177 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 14:06:46.074177 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 14:06:46.074177 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 14:06:46.074177 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 14:06:46.082174 (MainThread): Partial parsing not enabled
2021-05-15 14:06:46.106165 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 14:06:46.114161 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 14:06:46.114161 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 14:06:46.122158 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 14:06:46.122158 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 14:06:46.130154 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 14:06:46.130154 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 14:06:46.130154 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 14:06:46.138151 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 14:06:46.218118 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 14:06:46.222990 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea4c0b01-8ece-45d2-97b5-cd71c69475c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEFE890748>]}
2021-05-15 14:06:46.230998 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea4c0b01-8ece-45d2-97b5-cd71c69475c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEFE7DE988>]}
2021-05-15 14:06:46.230998 (MainThread): Found 9 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 14:06:46.238697 (MainThread): 
2021-05-15 14:06:46.238697 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 14:06:46.238697 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 14:06:46.238697 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 14:06:47.113954 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 14:06:47.114450 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 14:06:47.122790 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 14:06:48.549007 (MainThread): 11:06:48 | Concurrency: 1 threads (target='dev')
2021-05-15 14:06:48.549677 (MainThread): 11:06:48 | 
2021-05-15 14:06:48.554797 (Thread-1): Began running node model.northwind_shop.dim_products
2021-05-15 14:06:48.555665 (Thread-1): 11:06:48 | 1 of 1 START view model dbt_arthur.dim_products...................... [RUN]
2021-05-15 14:06:48.557018 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 14:06:48.557334 (Thread-1): Compiling model.northwind_shop.dim_products
2021-05-15 14:06:48.559514 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_products"
2021-05-15 14:06:48.564198 (Thread-1): finished collecting timing info
2021-05-15 14:06:48.623730 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_products"
2021-05-15 14:06:48.623730 (Thread-1): Opening a new connection, currently in state init
2021-05-15 14:06:48.631738 (Thread-1): On model.northwind_shop.dim_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.dim_products"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`dim_products`
  OPTIONS()
  as with
    selected as (
        select 
            /* Primary key */
               product_id

            /*Foreign key */
            , category_id
            , supplier_id

            , units_in_stock           	
            , unit_price	
            , product_name	
            , quantity_per_unit	
            	
            , reorder_level	
            , units_on_order	
            , is_discontinued

        from `northwind1-313400`.`dbt_arthur`.`stg_products`
    )
    , transformed as (
        select 
        row_number() over (order by product_id) as product_sk
        , *
        from selected
    )

select * from transformed;


2021-05-15 14:06:50.635292 (Thread-1): finished collecting timing info
2021-05-15 14:06:50.635292 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea4c0b01-8ece-45d2-97b5-cd71c69475c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEFE876588>]}
2021-05-15 14:06:50.635292 (Thread-1): 11:06:50 | 1 of 1 OK created view model dbt_arthur.dim_products................. [OK in 2.08s]
2021-05-15 14:06:50.635292 (Thread-1): Finished running node model.northwind_shop.dim_products
2021-05-15 14:06:50.707711 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 14:06:50.707711 (MainThread): 11:06:50 | 
2021-05-15 14:06:50.707711 (MainThread): 11:06:50 | Finished running 1 view model in 4.47s.
2021-05-15 14:06:50.707711 (MainThread): Connection 'master' was properly closed.
2021-05-15 14:06:50.707711 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 14:06:50.707711 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 14:06:50.707711 (MainThread): Connection 'model.northwind_shop.dim_products' was properly closed.
2021-05-15 14:06:50.715708 (MainThread): 
2021-05-15 14:06:50.715708 (MainThread): Completed successfully
2021-05-15 14:06:50.715708 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-15 14:06:50.722969 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEFAAEAB08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEFACC54C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEFE684348>]}
2021-05-15 14:06:50.723452 (MainThread): Flushing usage events
2021-05-15 14:08:43.788404 (MainThread): Running with dbt=0.19.1
2021-05-15 14:08:44.123455 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 14:08:44.123455 (MainThread): Tracking: tracking
2021-05-15 14:08:44.123455 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023E802B48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023E802708>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023E8071C8>]}
2021-05-15 14:08:44.139447 (MainThread): Partial parsing not enabled
2021-05-15 14:08:44.139447 (MainThread): Parsing macros\adapters.sql
2021-05-15 14:08:44.155445 (MainThread): Parsing macros\catalog.sql
2021-05-15 14:08:44.163463 (MainThread): Parsing macros\etc.sql
2021-05-15 14:08:44.163463 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 14:08:44.171442 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 14:08:44.179447 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 14:08:44.187442 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 14:08:44.187442 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 14:08:44.195420 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 14:08:44.203439 (MainThread): Parsing macros\core.sql
2021-05-15 14:08:44.203439 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 14:08:44.243402 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 14:08:44.251401 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 14:08:44.251401 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 14:08:44.259409 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 14:08:44.259409 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 14:08:44.259409 (MainThread): Parsing macros\etc\query.sql
2021-05-15 14:08:44.259409 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 14:08:44.267412 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 14:08:44.283392 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 14:08:44.283392 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 14:08:44.291391 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 14:08:44.315378 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 14:08:44.347363 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 14:08:44.347363 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 14:08:44.363372 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 14:08:44.371351 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 14:08:44.371351 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 14:08:44.379365 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 14:08:44.379365 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 14:08:44.387352 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 14:08:44.387352 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 14:08:44.395335 (MainThread): Partial parsing not enabled
2021-05-15 14:08:44.435267 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 14:08:44.443317 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 14:08:44.443317 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 14:08:44.451316 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 14:08:44.451316 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 14:08:44.459311 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 14:08:44.467329 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 14:08:44.467329 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 14:08:44.475311 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 14:08:44.475311 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 14:08:44.563271 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 14:08:44.572127 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c85c083-dcd4-4fd1-a1db-4d7d673b4ab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024247A248>]}
2021-05-15 14:08:44.580251 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c85c083-dcd4-4fd1-a1db-4d7d673b4ab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023E8B5108>]}
2021-05-15 14:08:44.580251 (MainThread): Found 10 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 14:08:44.589198 (MainThread): 
2021-05-15 14:08:44.589198 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 14:08:44.589198 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 14:08:44.589198 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 14:08:46.822132 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 14:08:46.822628 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 14:08:46.832316 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 14:08:48.285639 (MainThread): 11:08:48 | Concurrency: 1 threads (target='dev')
2021-05-15 14:08:48.285639 (MainThread): 11:08:48 | 
2021-05-15 14:08:48.293577 (Thread-1): Began running node model.northwind_shop.stg_customers
2021-05-15 14:08:48.293577 (Thread-1): 11:08:48 | 1 of 10 START view model dbt_arthur.stg_customers.................... [RUN]
2021-05-15 14:08:48.293577 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 14:08:48.293577 (Thread-1): Compiling model.northwind_shop.stg_customers
2021-05-15 14:08:48.301604 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_customers"
2021-05-15 14:08:48.304457 (Thread-1): finished collecting timing info
2021-05-15 14:08:48.338845 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_customers"
2021-05-15 14:08:48.339874 (Thread-1): Opening a new connection, currently in state init
2021-05-15 14:08:48.340878 (Thread-1): On model.northwind_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_customers"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_customers`
  OPTIONS()
  as with
    source as (
        select 
           /*primary key*/
            customer_id
            ,country	
            ,city	
            ,fax	
            ,postal_code	
            ,address	
            ,region	
            ,contact_name		
            ,phone	
            ,company_name	
            ,contact_title
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`customers`
    )
select * from source;


2021-05-15 14:08:51.224458 (Thread-1): finished collecting timing info
2021-05-15 14:08:51.224458 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c85c083-dcd4-4fd1-a1db-4d7d673b4ab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020242394588>]}
2021-05-15 14:08:51.224458 (Thread-1): 11:08:51 | 1 of 10 OK created view model dbt_arthur.stg_customers............... [OK in 2.93s]
2021-05-15 14:08:51.224458 (Thread-1): Finished running node model.northwind_shop.stg_customers
2021-05-15 14:08:51.231802 (Thread-1): Began running node model.northwind_shop.stg_employees
2021-05-15 14:08:51.231802 (Thread-1): 11:08:51 | 2 of 10 START view model dbt_arthur.stg_employees.................... [RUN]
2021-05-15 14:08:51.231802 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 14:08:51.231802 (Thread-1): Compiling model.northwind_shop.stg_employees
2021-05-15 14:08:51.231802 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_employees"
2021-05-15 14:08:51.231802 (Thread-1): finished collecting timing info
2021-05-15 14:08:51.241023 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_employees"
2021-05-15 14:08:51.241023 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 14:08:51.249339 (Thread-1): On model.northwind_shop.stg_employees: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_employees"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_employees`
  OPTIONS()
  as with
    source as (
        select 
           /*primary key*/
            employee_id	
            ,country	
            ,city	
            ,postal_code
            ,hire_date	
            ,extension	
            ,address	
            ,birth_date	
            ,region	
            ,photo_path	
            ,last_name	
            ,first_name	
            ,title	
            ,title_of_courtesy	
            ,notes	
            ,home_phone	
            ,reports_to	
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`employees`
    )
select * from source;


2021-05-15 14:08:54.432614 (Thread-1): finished collecting timing info
2021-05-15 14:08:54.432614 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c85c083-dcd4-4fd1-a1db-4d7d673b4ab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024250B148>]}
2021-05-15 14:08:54.432614 (Thread-1): 11:08:54 | 2 of 10 OK created view model dbt_arthur.stg_employees............... [OK in 3.20s]
2021-05-15 14:08:54.432614 (Thread-1): Finished running node model.northwind_shop.stg_employees
2021-05-15 14:08:54.440618 (Thread-1): Began running node model.northwind_shop.stg_products
2021-05-15 14:08:54.440618 (Thread-1): 11:08:54 | 3 of 10 START view model dbt_arthur.stg_products..................... [RUN]
2021-05-15 14:08:54.440618 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 14:08:54.440618 (Thread-1): Compiling model.northwind_shop.stg_products
2021-05-15 14:08:54.440618 (Thread-1): unclosed <socket.socket fd=1036, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59998), raddr=('142.250.218.202', 443)>
2021-05-15 14:08:54.440618 (Thread-1): unclosed <socket.socket fd=368, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59999), raddr=('142.250.79.202', 443)>
2021-05-15 14:08:54.440618 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_products"
2021-05-15 14:08:54.448618 (Thread-1): finished collecting timing info
2021-05-15 14:08:54.448618 (Thread-1): unclosed <socket.socket fd=828, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59996), raddr=('142.250.218.202', 443)>
2021-05-15 14:08:54.448618 (Thread-1): unclosed <socket.socket fd=1108, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 59997), raddr=('142.250.79.202', 443)>
2021-05-15 14:08:54.456610 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_products"
2021-05-15 14:08:54.456610 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 14:08:54.464655 (Thread-1): On model.northwind_shop.stg_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_products`
  OPTIONS()
  as with
    source as (
        select 
            /* Primary key */
               product_id

            /*Foreign key */
            , category_id
            , supplier_id

            , units_in_stock           	
            , unit_price	
            , product_name	
            , quantity_per_unit	
            	
            , reorder_level	
            , units_on_order	
            , 
                case
                 when discontinued = 1 then True
                 else False
                end as is_discontinued 
            /* Stitich Columns*/
            , _sdc_table_version
            , _sdc_sequence
            , _sdc_batched_at	
            , _sdc_extracted_at	
            , _sdc_received_at

        from `northwind1-313400`.`northwind_etl`.`products`
    )
select * from source;


2021-05-15 14:08:57.471608 (Thread-1): finished collecting timing info
2021-05-15 14:08:57.471608 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c85c083-dcd4-4fd1-a1db-4d7d673b4ab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202425236C8>]}
2021-05-15 14:08:57.471608 (Thread-1): 11:08:57 | 3 of 10 OK created view model dbt_arthur.stg_products................ [OK in 3.03s]
2021-05-15 14:08:57.471608 (Thread-1): Finished running node model.northwind_shop.stg_products
2021-05-15 14:08:57.471608 (Thread-1): Began running node model.northwind_shop.stg_suppliers
2021-05-15 14:08:57.471608 (Thread-1): 11:08:57 | 4 of 10 START view model dbt_arthur.stg_suppliers.................... [RUN]
2021-05-15 14:08:57.471608 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 14:08:57.471608 (Thread-1): Compiling model.northwind_shop.stg_suppliers
2021-05-15 14:08:57.511661 (Thread-1): unclosed <socket.socket fd=1112, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60000), raddr=('142.250.218.202', 443)>
2021-05-15 14:08:57.511661 (Thread-1): unclosed <socket.socket fd=456, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60001), raddr=('142.250.79.202', 443)>
2021-05-15 14:08:57.511661 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_suppliers"
2021-05-15 14:08:57.511661 (Thread-1): finished collecting timing info
2021-05-15 14:08:57.519596 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_suppliers"
2021-05-15 14:08:57.519596 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 14:08:57.527592 (Thread-1): On model.northwind_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_suppliers"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_suppliers`
  OPTIONS()
  as with
    source as (
        select 
           /*primary key*/
            supplier_id
            ,country
            ,city	
            ,fax	
            ,postal_code
            ,homepage
            ,address	
            ,region	
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`suppliers`
    )
select * from source;


2021-05-15 14:08:59.449860 (Thread-1): finished collecting timing info
2021-05-15 14:08:59.449860 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c85c083-dcd4-4fd1-a1db-4d7d673b4ab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023E7D1E88>]}
2021-05-15 14:08:59.449860 (Thread-1): 11:08:59 | 4 of 10 OK created view model dbt_arthur.stg_suppliers............... [OK in 1.98s]
2021-05-15 14:08:59.457867 (Thread-1): Finished running node model.northwind_shop.stg_suppliers
2021-05-15 14:08:59.457867 (Thread-1): Began running node model.northwind_shop.stg_orderdetail
2021-05-15 14:08:59.457867 (Thread-1): 11:08:59 | 5 of 10 START view model dbt_arthur.stg_orderdetail.................. [RUN]
2021-05-15 14:08:59.457867 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 14:08:59.457867 (Thread-1): Compiling model.northwind_shop.stg_orderdetail
2021-05-15 14:08:59.457867 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_orderdetail"
2021-05-15 14:08:59.465869 (Thread-1): finished collecting timing info
2021-05-15 14:08:59.465869 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_orderdetail"
2021-05-15 14:08:59.465869 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 14:08:59.473897 (Thread-1): On model.northwind_shop.stg_orderdetail: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_orderdetail"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_orderdetail`
  OPTIONS()
  as with
    source as (
        select 
           /*primary key*/
            order_id
            ,product_id		
            , 
               case
                  when discount = 1 then True
                  else False
               end as is_discountinued	
            ,unit_price	
            ,quantity	
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`order_details`
)
select * from source;


2021-05-15 14:09:02.157451 (Thread-1): finished collecting timing info
2021-05-15 14:09:02.157451 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c85c083-dcd4-4fd1-a1db-4d7d673b4ab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023E82BC08>]}
2021-05-15 14:09:02.165491 (Thread-1): 11:09:02 | 5 of 10 OK created view model dbt_arthur.stg_orderdetail............. [OK in 2.70s]
2021-05-15 14:09:02.165491 (Thread-1): Finished running node model.northwind_shop.stg_orderdetail
2021-05-15 14:09:02.165491 (Thread-1): Began running node model.northwind_shop.stg_orders
2021-05-15 14:09:02.165491 (Thread-1): 11:09:02 | 6 of 10 START view model dbt_arthur.stg_orders....................... [RUN]
2021-05-15 14:09:02.165491 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 14:09:02.165491 (Thread-1): Compiling model.northwind_shop.stg_orders
2021-05-15 14:09:02.165491 (Thread-1): unclosed <socket.socket fd=1244, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60004), raddr=('142.250.218.202', 443)>
2021-05-15 14:09:02.173428 (Thread-1): unclosed <socket.socket fd=1248, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60005), raddr=('142.250.79.202', 443)>
2021-05-15 14:09:02.173428 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_orders"
2021-05-15 14:09:02.173428 (Thread-1): finished collecting timing info
2021-05-15 14:09:02.173428 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_orders"
2021-05-15 14:09:02.173428 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 14:09:02.181423 (Thread-1): On model.northwind_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_orders"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_orders`
  OPTIONS()
  as with
    source as (
        select 
          /*Primary key*/ 
            order_id
          /*Foreign Key*/
            ,employee_id
            ,customer_id
            ,ship_region	
            ,shipped_date
            ,ship_country	
            ,ship_name
            ,order_date		
            ,ship_postal_code	
            ,ship_city	
            ,freight	
            ,ship_via as ship_id
            ,required_date
            ,ship_address
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`orders`
    )
select * from source;


2021-05-15 14:09:05.042380 (Thread-1): finished collecting timing info
2021-05-15 14:09:05.042380 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c85c083-dcd4-4fd1-a1db-4d7d673b4ab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202407B5788>]}
2021-05-15 14:09:05.042380 (Thread-1): 11:09:05 | 6 of 10 OK created view model dbt_arthur.stg_orders.................. [OK in 2.88s]
2021-05-15 14:09:05.049860 (Thread-1): Finished running node model.northwind_shop.stg_orders
2021-05-15 14:09:05.049860 (Thread-1): Began running node model.northwind_shop.dim_customers
2021-05-15 14:09:05.049860 (Thread-1): 11:09:05 | 7 of 10 START view model dbt_arthur.dim_customers.................... [RUN]
2021-05-15 14:09:05.049860 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 14:09:05.049860 (Thread-1): Compiling model.northwind_shop.dim_customers
2021-05-15 14:09:05.049860 (Thread-1): unclosed <socket.socket fd=1292, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60006), raddr=('142.250.218.202', 443)>
2021-05-15 14:09:05.049860 (Thread-1): unclosed <socket.socket fd=936, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60007), raddr=('142.250.79.202', 443)>
2021-05-15 14:09:05.057864 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_customers"
2021-05-15 14:09:05.057864 (Thread-1): finished collecting timing info
2021-05-15 14:09:05.057864 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_customers"
2021-05-15 14:09:05.057864 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 14:09:05.065867 (Thread-1): On model.northwind_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.dim_customers"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`dim_customers`
  OPTIONS()
  as with
    selected as (
        select 
           /*primary key*/
            customer_id
            ,country	
            ,city	
            ,fax	
            ,postal_code	
            ,address	
            ,region	
            ,contact_name		
            ,phone	
            ,company_name	
            ,contact_title


        from `northwind1-313400`.`dbt_arthur`.`stg_customers`
    )
    , transformed as (
        select 
        row_number() over (order by customer_id) as customer_sk
        , *
        from selected
    )

select * from transformed;


2021-05-15 14:09:07.676837 (Thread-1): finished collecting timing info
2021-05-15 14:09:07.676837 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c85c083-dcd4-4fd1-a1db-4d7d673b4ab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202425D6D48>]}
2021-05-15 14:09:07.676837 (Thread-1): 11:09:07 | 7 of 10 OK created view model dbt_arthur.dim_customers............... [OK in 2.63s]
2021-05-15 14:09:07.684842 (Thread-1): Finished running node model.northwind_shop.dim_customers
2021-05-15 14:09:07.684842 (Thread-1): Began running node model.northwind_shop.dim_employees
2021-05-15 14:09:07.684842 (Thread-1): 11:09:07 | 8 of 10 START view model dbt_arthur.dim_employees.................... [RUN]
2021-05-15 14:09:07.684842 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 14:09:07.684842 (Thread-1): Compiling model.northwind_shop.dim_employees
2021-05-15 14:09:07.692837 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_employees"
2021-05-15 14:09:07.692837 (Thread-1): finished collecting timing info
2021-05-15 14:09:07.692837 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_employees"
2021-05-15 14:09:07.692837 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 14:09:07.700836 (Thread-1): On model.northwind_shop.dim_employees: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.dim_employees"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`dim_employees`
  OPTIONS()
  as with
    selected as (
        select 
           /*primary key*/
            employee_id	
            ,country	
            ,city	
            ,postal_code
            ,hire_date	
            ,extension	
            ,address	
            ,birth_date	
            ,region	
            ,photo_path	
            ,last_name	
            ,first_name	
            ,title	
            ,title_of_courtesy	
            ,notes	
            ,home_phone	
            ,reports_to	
        from `northwind1-313400`.`dbt_arthur`.`stg_employees`
    )
    , transformed as (
        select 
        row_number() over (order by employee_id) as employee_sk
        , *
        from selected
    )

select * from transformed;


2021-05-15 14:09:10.169139 (Thread-1): finished collecting timing info
2021-05-15 14:09:10.169139 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c85c083-dcd4-4fd1-a1db-4d7d673b4ab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202425DA6C8>]}
2021-05-15 14:09:10.170164 (Thread-1): 11:09:10 | 8 of 10 OK created view model dbt_arthur.dim_employees............... [OK in 2.48s]
2021-05-15 14:09:10.172269 (Thread-1): Finished running node model.northwind_shop.dim_employees
2021-05-15 14:09:10.172269 (Thread-1): Began running node model.northwind_shop.dim_products
2021-05-15 14:09:10.173313 (Thread-1): 11:09:10 | 9 of 10 START view model dbt_arthur.dim_products..................... [RUN]
2021-05-15 14:09:10.174337 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 14:09:10.174337 (Thread-1): Compiling model.northwind_shop.dim_products
2021-05-15 14:09:10.178518 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_products"
2021-05-15 14:09:10.179538 (Thread-1): finished collecting timing info
2021-05-15 14:09:10.180850 (Thread-1): unclosed <socket.socket fd=932, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60002), raddr=('142.250.218.202', 443)>
2021-05-15 14:09:10.181882 (Thread-1): unclosed <socket.socket fd=376, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60003), raddr=('142.250.79.202', 443)>
2021-05-15 14:09:10.186453 (Thread-1): unclosed <socket.socket fd=1312, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60008), raddr=('142.250.218.202', 443)>
2021-05-15 14:09:10.187557 (Thread-1): unclosed <socket.socket fd=444, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60009), raddr=('142.250.79.202', 443)>
2021-05-15 14:09:10.187557 (Thread-1): unclosed <socket.socket fd=1376, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60010), raddr=('142.250.218.202', 443)>
2021-05-15 14:09:10.188748 (Thread-1): unclosed <socket.socket fd=1316, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60011), raddr=('142.250.79.202', 443)>
2021-05-15 14:09:10.191125 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_products"
2021-05-15 14:09:10.193196 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 14:09:10.198607 (Thread-1): On model.northwind_shop.dim_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.dim_products"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`dim_products`
  OPTIONS()
  as with
    selected as (
        select 
            /* Primary key */
               product_id

            /*Foreign key */
            , category_id
            , supplier_id

            , units_in_stock           	
            , unit_price	
            , product_name	
            , quantity_per_unit	
            	
            , reorder_level	
            , units_on_order	
            , is_discontinued

        from `northwind1-313400`.`dbt_arthur`.`stg_products`
    )
    , transformed as (
        select 
        row_number() over (order by product_id) as product_sk
        , *
        from selected
    )

select * from transformed;


2021-05-15 14:09:12.931001 (Thread-1): finished collecting timing info
2021-05-15 14:09:12.931001 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c85c083-dcd4-4fd1-a1db-4d7d673b4ab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202435F1288>]}
2021-05-15 14:09:12.932014 (Thread-1): 11:09:12 | 9 of 10 OK created view model dbt_arthur.dim_products................ [OK in 2.76s]
2021-05-15 14:09:12.932014 (Thread-1): Finished running node model.northwind_shop.dim_products
2021-05-15 14:09:12.933033 (Thread-1): Began running node model.northwind_shop.dim_suppliers
2021-05-15 14:09:12.933033 (Thread-1): 11:09:12 | 10 of 10 START view model dbt_arthur.dim_suppliers................... [RUN]
2021-05-15 14:09:12.934050 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 14:09:12.934050 (Thread-1): Compiling model.northwind_shop.dim_suppliers
2021-05-15 14:09:12.937134 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_suppliers"
2021-05-15 14:09:12.938154 (Thread-1): finished collecting timing info
2021-05-15 14:09:12.940493 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_suppliers"
2021-05-15 14:09:12.942610 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 14:09:12.944648 (Thread-1): On model.northwind_shop.dim_suppliers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.dim_suppliers"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
  OPTIONS()
  as with
    selected as (
        select 
          /*primary key*/
            supplier_id
            ,country
            ,city	
            ,fax	
            ,postal_code
            ,homepage
            ,address	
            ,region	

        from `northwind1-313400`.`dbt_arthur`.`stg_suppliers`
    )
    , transformed as (
        select 
        row_number() over (order by supplier_id) as supplier_sk
        , *
        from selected
    )

select * from transformed;


2021-05-15 14:09:16.047834 (Thread-1): finished collecting timing info
2021-05-15 14:09:16.047834 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c85c083-dcd4-4fd1-a1db-4d7d673b4ab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202435F1288>]}
2021-05-15 14:09:16.047834 (Thread-1): 11:09:16 | 10 of 10 OK created view model dbt_arthur.dim_suppliers.............. [OK in 3.11s]
2021-05-15 14:09:16.047834 (Thread-1): Finished running node model.northwind_shop.dim_suppliers
2021-05-15 14:09:16.119811 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 14:09:16.119811 (MainThread): 11:09:16 | 
2021-05-15 14:09:16.119811 (MainThread): 11:09:16 | Finished running 10 view models in 31.53s.
2021-05-15 14:09:16.119811 (MainThread): Connection 'master' was properly closed.
2021-05-15 14:09:16.124324 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 14:09:16.124324 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 14:09:16.124324 (MainThread): Connection 'model.northwind_shop.dim_suppliers' was properly closed.
2021-05-15 14:09:16.124324 (MainThread): unclosed <socket.socket fd=1408, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60014), raddr=('142.250.218.202', 443)>
2021-05-15 14:09:16.124324 (MainThread): unclosed <socket.socket fd=1420, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60015), raddr=('142.250.79.202', 443)>
2021-05-15 14:09:16.124324 (MainThread): 
2021-05-15 14:09:16.132416 (MainThread): Completed successfully
2021-05-15 14:09:16.132416 (MainThread): 
Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
2021-05-15 14:09:16.135247 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023E81F088>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023E81F188>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024248DD88>]}
2021-05-15 14:09:16.135742 (MainThread): Flushing usage events
2021-05-15 14:33:20.087016 (MainThread): Running with dbt=0.19.1
2021-05-15 14:33:20.443550 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['stg_shippers'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 14:33:20.443550 (MainThread): Tracking: tracking
2021-05-15 14:33:20.443550 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020916E64808>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020916E64D48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020916E64C88>]}
2021-05-15 14:33:20.451548 (MainThread): Partial parsing not enabled
2021-05-15 14:33:20.459545 (MainThread): Parsing macros\adapters.sql
2021-05-15 14:33:20.475537 (MainThread): Parsing macros\catalog.sql
2021-05-15 14:33:20.483529 (MainThread): Parsing macros\etc.sql
2021-05-15 14:33:20.483529 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 14:33:20.483529 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 14:33:20.499522 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 14:33:20.499522 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 14:33:20.507525 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 14:33:20.515520 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 14:33:20.515520 (MainThread): Parsing macros\core.sql
2021-05-15 14:33:20.523517 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 14:33:20.563499 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 14:33:20.571497 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 14:33:20.571497 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 14:33:20.571497 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 14:33:20.571497 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 14:33:20.571497 (MainThread): Parsing macros\etc\query.sql
2021-05-15 14:33:20.579494 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 14:33:20.587491 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 14:33:20.595487 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 14:33:20.603483 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 14:33:20.603483 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 14:33:20.627472 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 14:33:20.651462 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 14:33:20.659460 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 14:33:20.675453 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 14:33:20.675453 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 14:33:20.683450 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 14:33:20.691447 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 14:33:20.691447 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 14:33:20.691447 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 14:33:20.691447 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 14:33:20.699444 (MainThread): Partial parsing not enabled
2021-05-15 14:33:20.723434 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 14:33:20.731430 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 14:33:20.739429 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 14:33:20.739429 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 14:33:20.748475 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 14:33:20.748475 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 14:33:20.756858 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 14:33:20.756858 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 14:33:20.764853 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 14:33:20.764853 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 14:33:20.764853 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 14:33:20.846117 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 14:33:20.850349 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c47b73d7-df2e-423d-be2d-3dcf1669e3ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020916EF67C8>]}
2021-05-15 14:33:20.850462 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c47b73d7-df2e-423d-be2d-3dcf1669e3ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002091A96F448>]}
2021-05-15 14:33:20.850462 (MainThread): Found 11 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 14:33:20.850462 (MainThread): 
2021-05-15 14:33:20.858481 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 14:33:20.860741 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 14:33:20.860741 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 14:33:22.070719 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 14:33:22.071263 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 14:33:22.080221 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 14:33:22.634476 (MainThread): 11:33:22 | Concurrency: 1 threads (target='dev')
2021-05-15 14:33:22.635470 (MainThread): 11:33:22 | 
2021-05-15 14:33:22.640501 (Thread-1): Began running node model.northwind_shop.stg_shippers
2021-05-15 14:33:22.640501 (Thread-1): 11:33:22 | 1 of 1 START view model dbt_arthur.stg_shippers...................... [RUN]
2021-05-15 14:33:22.643508 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 14:33:22.644003 (Thread-1): Compiling model.northwind_shop.stg_shippers
2021-05-15 14:33:22.646695 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_shippers"
2021-05-15 14:33:22.651161 (Thread-1): finished collecting timing info
2021-05-15 14:33:22.706461 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_shippers"
2021-05-15 14:33:22.708141 (Thread-1): Opening a new connection, currently in state init
2021-05-15 14:33:22.713319 (Thread-1): On model.northwind_shop.stg_shippers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_shippers"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_shippers`
  OPTIONS()
  as with
    source as (
        select 
           /*primary key*/
            shipper_id
            ,phone	
            ,company_name
	
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`shippers`
    )
select * from source;


2021-05-15 14:33:24.599392 (Thread-1): finished collecting timing info
2021-05-15 14:33:24.599392 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c47b73d7-df2e-423d-be2d-3dcf1669e3ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002091A9EE448>]}
2021-05-15 14:33:24.599392 (Thread-1): 11:33:24 | 1 of 1 OK created view model dbt_arthur.stg_shippers................. [OK in 1.96s]
2021-05-15 14:33:24.602471 (Thread-1): Finished running node model.northwind_shop.stg_shippers
2021-05-15 14:33:24.679285 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 14:33:24.679285 (MainThread): 11:33:24 | 
2021-05-15 14:33:24.679285 (MainThread): 11:33:24 | Finished running 1 view model in 3.82s.
2021-05-15 14:33:24.679285 (MainThread): Connection 'master' was properly closed.
2021-05-15 14:33:24.679285 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 14:33:24.679285 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 14:33:24.679285 (MainThread): Connection 'model.northwind_shop.stg_shippers' was properly closed.
2021-05-15 14:33:24.687282 (MainThread): 
2021-05-15 14:33:24.687282 (MainThread): Completed successfully
2021-05-15 14:33:24.687282 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-15 14:33:24.696064 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002091AA26C08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020916EC5348>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002091AAB0848>]}
2021-05-15 14:33:24.696577 (MainThread): Flushing usage events
2021-05-15 14:38:05.858602 (MainThread): Running with dbt=0.19.1
2021-05-15 14:38:06.303065 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_shippers'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 14:38:06.303065 (MainThread): Tracking: tracking
2021-05-15 14:38:06.303065 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF166B10C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF166B1848>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF166B6188>]}
2021-05-15 14:38:06.319059 (MainThread): Partial parsing not enabled
2021-05-15 14:38:06.319059 (MainThread): Parsing macros\adapters.sql
2021-05-15 14:38:06.335052 (MainThread): Parsing macros\catalog.sql
2021-05-15 14:38:06.343048 (MainThread): Parsing macros\etc.sql
2021-05-15 14:38:06.343048 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 14:38:06.351045 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 14:38:06.363279 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 14:38:06.363279 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 14:38:06.363279 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 14:38:06.379277 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 14:38:06.379277 (MainThread): Parsing macros\core.sql
2021-05-15 14:38:06.387306 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 14:38:06.427256 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 14:38:06.435253 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 14:38:06.435253 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 14:38:06.435253 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 14:38:06.443250 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 14:38:06.443250 (MainThread): Parsing macros\etc\query.sql
2021-05-15 14:38:06.443250 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 14:38:06.451246 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 14:38:06.467240 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 14:38:06.467240 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 14:38:06.475236 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 14:38:06.491229 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 14:38:06.523216 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 14:38:06.523216 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 14:38:06.539209 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 14:38:06.547206 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 14:38:06.555203 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 14:38:06.563200 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 14:38:06.563200 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 14:38:06.563200 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 14:38:06.563200 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 14:38:06.571197 (MainThread): Partial parsing not enabled
2021-05-15 14:38:06.611180 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 14:38:06.619176 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 14:38:06.627173 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 14:38:06.627173 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 14:38:06.635170 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 14:38:06.643167 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 14:38:06.643167 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 14:38:06.651164 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 14:38:06.651164 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 14:38:06.651164 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 14:38:06.659160 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 14:38:06.667157 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 14:38:06.763154 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 14:38:06.771056 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5992b4e-80e1-47b9-a227-08fd44f1264e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF1A291788>]}
2021-05-15 14:38:06.779099 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5992b4e-80e1-47b9-a227-08fd44f1264e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF1A104F48>]}
2021-05-15 14:38:06.779099 (MainThread): Found 12 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 14:38:06.779099 (MainThread): 
2021-05-15 14:38:06.779099 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 14:38:06.787104 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 14:38:06.787104 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 14:38:08.603775 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 14:38:08.604448 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 14:38:08.614840 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 14:38:11.195393 (MainThread): 11:38:11 | Concurrency: 1 threads (target='dev')
2021-05-15 14:38:11.195393 (MainThread): 11:38:11 | 
2021-05-15 14:38:11.203438 (Thread-1): Began running node model.northwind_shop.dim_shippers
2021-05-15 14:38:11.203438 (Thread-1): 11:38:11 | 1 of 1 START view model dbt_arthur.dim_shippers...................... [RUN]
2021-05-15 14:38:11.203438 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 14:38:11.203438 (Thread-1): Compiling model.northwind_shop.dim_shippers
2021-05-15 14:38:11.211400 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_shippers"
2021-05-15 14:38:11.211400 (Thread-1): finished collecting timing info
2021-05-15 14:38:11.243380 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_shippers"
2021-05-15 14:38:11.243380 (Thread-1): Opening a new connection, currently in state init
2021-05-15 14:38:11.251419 (Thread-1): On model.northwind_shop.dim_shippers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.dim_shippers"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`dim_shippers`
  OPTIONS()
  as with
    selected as (
        select 
           /*primary key*/
            shipper_id
            ,phone	
            ,company_name
	

        from `northwind1-313400`.`dbt_arthur`.`stg_shippers`
    ), transformed as 
    (
    select 
    row_number() over (order by shipper_id) as shipper_sk
    , *
    from selected
    )
select * from transformed;


2021-05-15 14:38:14.237998 (Thread-1): finished collecting timing info
2021-05-15 14:38:14.237998 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5992b4e-80e1-47b9-a227-08fd44f1264e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF1A0FF608>]}
2021-05-15 14:38:14.237998 (Thread-1): 11:38:14 | 1 of 1 OK created view model dbt_arthur.dim_shippers................. [OK in 3.03s]
2021-05-15 14:38:14.237998 (Thread-1): Finished running node model.northwind_shop.dim_shippers
2021-05-15 14:38:14.268302 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 14:38:14.268302 (MainThread): 11:38:14 | 
2021-05-15 14:38:14.268302 (MainThread): 11:38:14 | Finished running 1 view model in 7.49s.
2021-05-15 14:38:14.268302 (MainThread): Connection 'master' was properly closed.
2021-05-15 14:38:14.273357 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 14:38:14.273357 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 14:38:14.273357 (MainThread): Connection 'model.northwind_shop.dim_shippers' was properly closed.
2021-05-15 14:38:14.273357 (MainThread): unclosed <socket.socket fd=672, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60351), raddr=('172.217.162.138', 443)>
2021-05-15 14:38:14.273357 (MainThread): unclosed <socket.socket fd=972, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60352), raddr=('142.250.219.10', 443)>
2021-05-15 14:38:14.273357 (MainThread): unclosed <socket.socket fd=1048, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60354), raddr=('142.250.219.10', 443)>
2021-05-15 14:38:14.273357 (MainThread): unclosed <socket.socket fd=700, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60353), raddr=('172.217.162.138', 443)>
2021-05-15 14:38:14.273357 (MainThread): unclosed <socket.socket fd=1056, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60355), raddr=('172.217.162.138', 443)>
2021-05-15 14:38:14.273357 (MainThread): unclosed <socket.socket fd=1064, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60356), raddr=('142.250.219.10', 443)>
2021-05-15 14:38:14.281489 (MainThread): 
2021-05-15 14:38:14.281489 (MainThread): Completed successfully
2021-05-15 14:38:14.281489 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-15 14:38:14.281489 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF1A31AE88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF1A10BB48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF185B8C88>]}
2021-05-15 14:38:14.281489 (MainThread): Flushing usage events
2021-05-15 15:23:39.370538 (MainThread): Running with dbt=0.19.1
2021-05-15 15:23:39.703681 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 15:23:39.703681 (MainThread): Tracking: tracking
2021-05-15 15:23:39.703681 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BB344FE48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BB344FAC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BB3456648>]}
2021-05-15 15:23:39.711679 (MainThread): Partial parsing not enabled
2021-05-15 15:23:39.719678 (MainThread): Parsing macros\adapters.sql
2021-05-15 15:23:39.737290 (MainThread): Parsing macros\catalog.sql
2021-05-15 15:23:39.739898 (MainThread): Parsing macros\etc.sql
2021-05-15 15:23:39.739898 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 15:23:39.748103 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 15:23:39.756098 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 15:23:39.764028 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 15:23:39.764028 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 15:23:39.772024 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 15:23:39.779369 (MainThread): Parsing macros\core.sql
2021-05-15 15:23:39.787674 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 15:23:39.827612 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 15:23:39.835608 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 15:23:39.835608 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 15:23:39.843666 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 15:23:39.843666 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 15:23:39.843666 (MainThread): Parsing macros\etc\query.sql
2021-05-15 15:23:39.843666 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 15:23:39.851662 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 15:23:39.867655 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 15:23:39.867655 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 15:23:39.875656 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 15:23:39.891651 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 15:23:39.923632 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 15:23:39.923632 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 15:23:39.939631 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 15:23:39.947632 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 15:23:39.947632 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 15:23:39.955626 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 15:23:39.955626 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 15:23:39.963624 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 15:23:39.963624 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 15:23:39.971633 (MainThread): Partial parsing not enabled
2021-05-15 15:23:39.987627 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 15:23:39.995609 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 15:23:40.003611 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 15:23:40.003611 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 15:23:40.012788 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 15:23:40.017212 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 15:23:40.019384 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 15:23:40.023703 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 15:23:40.028020 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 15:23:40.032184 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 15:23:40.036856 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 15:23:40.040358 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 15:23:40.045083 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 15:23:40.119062 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 15:23:40.124984 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9932352-3fda-4753-98e1-f41215a5fe50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BB701FA08>]}
2021-05-15 15:23:40.133059 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9932352-3fda-4753-98e1-f41215a5fe50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BB6F10808>]}
2021-05-15 15:23:40.133059 (MainThread): Found 13 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 15:23:40.133059 (MainThread): The selector 'fact_order_details' does not match any nodes and will be ignored
2021-05-15 15:23:40.133059 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2021-05-15 15:23:40.133059 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BB6F10188>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BB6F1E748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BB6F1E3C8>]}
2021-05-15 15:23:40.133059 (MainThread): Flushing usage events
2021-05-15 15:23:40.856369 (MainThread): Connection 'model.northwind_shop.stg_suppliers' was properly closed.
2021-05-15 15:26:34.050699 (MainThread): Running with dbt=0.19.1
2021-05-15 15:26:34.412262 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 15:26:34.412262 (MainThread): Tracking: tracking
2021-05-15 15:26:34.412262 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1FB244D48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1FB244C88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1FB244B08>]}
2021-05-15 15:26:34.420261 (MainThread): Partial parsing not enabled
2021-05-15 15:26:34.428739 (MainThread): Parsing macros\adapters.sql
2021-05-15 15:26:34.452909 (MainThread): Parsing macros\catalog.sql
2021-05-15 15:26:34.460906 (MainThread): Parsing macros\etc.sql
2021-05-15 15:26:34.468902 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 15:26:34.476899 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 15:26:34.492892 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 15:26:34.500889 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 15:26:34.500889 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 15:26:34.508886 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 15:26:34.516881 (MainThread): Parsing macros\core.sql
2021-05-15 15:26:34.524878 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 15:26:34.564860 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 15:26:34.572858 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 15:26:34.572858 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 15:26:34.572858 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 15:26:34.572858 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 15:26:34.580855 (MainThread): Parsing macros\etc\query.sql
2021-05-15 15:26:34.580855 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 15:26:34.588852 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 15:26:34.596848 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 15:26:34.604844 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 15:26:34.612842 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 15:26:34.628834 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 15:26:34.660825 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 15:26:34.660825 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 15:26:34.676815 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 15:26:34.684810 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 15:26:34.692804 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 15:26:34.700804 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 15:26:34.700804 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 15:26:34.700804 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 15:26:34.700804 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 15:26:34.708797 (MainThread): Partial parsing not enabled
2021-05-15 15:26:34.732792 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 15:26:34.740788 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 15:26:34.740788 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 15:26:34.748786 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 15:26:34.748786 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 15:26:34.756784 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 15:26:34.756784 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 15:26:34.764780 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 15:26:34.764780 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 15:26:34.772776 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 15:26:34.772776 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 15:26:34.780773 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 15:26:34.780773 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 15:26:34.844745 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1FEE87DC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1FEE87E08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1FEE87EC8>]}
2021-05-15 15:26:34.844745 (MainThread): Flushing usage events
2021-05-15 15:26:35.971389 (MainThread): Connection 'model.northwind_shop.stg_suppliers' was properly closed.
2021-05-15 15:26:35.971991 (MainThread): Encountered an error:
2021-05-15 15:26:35.972992 (MainThread): Compilation Error in model fact_order_details (models\marts\fact_order_details.sql)
  Model 'model.northwind_shop.fact_order_details' (models\marts\fact_order_details.sql) depends on a node named 'dim_oproducts' which was not found
2021-05-15 15:26:36.022902 (MainThread): Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 444, in load_all
    manifest = loader.create_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 422, in create_manifest
    self.process_manifest(manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 388, in process_manifest
    process_refs(manifest, project_name)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 758, in process_refs
    _process_refs_for_node(manifest, current_project, node)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 742, in _process_refs_for_node
    disabled=(isinstance(target_model, Disabled))
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 487, in invalid_ref_fail_unless_test
    disabled=disabled,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 566, in ref_target_not_found
    raise_compiler_error(msg, model)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model fact_order_details (models\marts\fact_order_details.sql)
  Model 'model.northwind_shop.fact_order_details' (models\marts\fact_order_details.sql) depends on a node named 'dim_oproducts' which was not found

2021-05-15 15:27:23.701017 (MainThread): Running with dbt=0.19.1
2021-05-15 15:27:24.107614 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 15:27:24.107614 (MainThread): Tracking: tracking
2021-05-15 15:27:24.107614 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187AFCB1CC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187AFCB1B48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187AFCB80C8>]}
2021-05-15 15:27:24.115611 (MainThread): Partial parsing not enabled
2021-05-15 15:27:24.115611 (MainThread): Parsing macros\adapters.sql
2021-05-15 15:27:24.131604 (MainThread): Parsing macros\catalog.sql
2021-05-15 15:27:24.139600 (MainThread): Parsing macros\etc.sql
2021-05-15 15:27:24.139600 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 15:27:24.147598 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 15:27:24.155594 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 15:27:24.163591 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 15:27:24.163591 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 15:27:24.171588 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 15:27:24.179584 (MainThread): Parsing macros\core.sql
2021-05-15 15:27:24.179584 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 15:27:24.219568 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 15:27:24.227565 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 15:27:24.227565 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 15:27:24.227565 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 15:27:24.235561 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 15:27:24.235561 (MainThread): Parsing macros\etc\query.sql
2021-05-15 15:27:24.235561 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 15:27:24.252415 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 15:27:24.265788 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 15:27:24.267883 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 15:27:24.274297 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 15:27:24.294568 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 15:27:24.329703 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 15:27:24.333316 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 15:27:24.354678 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 15:27:24.363999 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 15:27:24.371721 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 15:27:24.376344 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 15:27:24.384041 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 15:27:24.384041 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 15:27:24.384041 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 15:27:24.392044 (MainThread): Partial parsing not enabled
2021-05-15 15:27:24.416035 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 15:27:24.424032 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 15:27:24.424032 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 15:27:24.432028 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 15:27:24.432028 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 15:27:24.432028 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 15:27:24.440025 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 15:27:24.448022 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 15:27:24.448022 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 15:27:24.448022 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 15:27:24.456019 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 15:27:24.456019 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 15:27:24.464015 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 15:27:24.541400 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 15:27:24.543553 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6039e0f4-14e3-485a-9710-288bdb9fc48b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187B385FB08>]}
2021-05-15 15:27:24.543553 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6039e0f4-14e3-485a-9710-288bdb9fc48b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187B3754648>]}
2021-05-15 15:27:24.543553 (MainThread): Found 13 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 15:27:24.551725 (MainThread): 
2021-05-15 15:27:24.551725 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 15:27:24.551725 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 15:27:24.551725 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 15:27:26.662697 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 15:27:26.662697 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 15:27:26.676660 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 15:27:27.937926 (MainThread): 12:27:27 | Concurrency: 1 threads (target='dev')
2021-05-15 15:27:27.937926 (MainThread): 12:27:27 | 
2021-05-15 15:27:27.945424 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-05-15 15:27:27.945424 (Thread-1): 12:27:27 | 1 of 1 START view model dbt_arthur.fact_order_details................ [RUN]
2021-05-15 15:27:27.945424 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 15:27:27.945424 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-05-15 15:27:27.953497 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 15:27:27.953497 (Thread-1): finished collecting timing info
2021-05-15 15:27:27.985484 (Thread-1): Writing runtime SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 15:27:27.993492 (Thread-1): Opening a new connection, currently in state init
2021-05-15 15:27:27.993492 (Thread-1): On model.northwind_shop.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`fact_order_details`
  OPTIONS()
  as with 
    customers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
    )
    ,suppliers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
    )
    ,shippers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
    )
    ,products as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
    )
    ,customer as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
    )
    ,orders_with_sk as ( 
        select
            orders.order_id
            ,employees.employee_sk = employee_fk
            ,customers.customer_sk = customer_fk
            ,shippers.shipper_id = shipper_fk            
            ,ship_region	
            ,shipped_date
            ,ship_country	
            ,ship_name
            ,order_date		
            ,ship_postal_code	
            ,ship_city	
            ,freight	
            ,required_date
            ,ship_address 
        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
        left join employees on orders.employee_id = employees.employee_id
        left join customers on orders.customer_id = customers.customer_id
        left join shippers on orders.shipper_id = shippers.shipper_id
    )
select from orders_with_sk;


2021-05-15 15:27:30.550211 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/9056443b-a3fc-4c31-934f-47565ead8290?maxResults=0&location=US&prettyPrint=false: Syntax error: SELECT list must not be empty at [43:8]')
2021-05-15 15:27:32.536809 (Thread-1): finished collecting timing info
2021-05-15 15:27:32.536809 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Syntax error: SELECT list must not be empty at [43:8]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/5d1a38ce-3af3-45f8-9a9a-08e3898dedb4?maxResults=0&location=US&prettyPrint=false: Syntax error: SELECT list must not be empty at [43:8]

(job ID: 5d1a38ce-3af3-45f8-9a9a-08e3898dedb4)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */
   2:
   3:
   4:  create or replace view `northwind1-313400`.`dbt_arthur`.`fact_order_details`
   5:  OPTIONS()
   6:  as with 
   7:    customers as (
   8:        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
   9:    )
  10:    ,suppliers as (
  11:        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
  12:    )
  13:    ,shippers as (
  14:        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
  15:    )
  16:    ,products as (
  17:        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
  18:    )
  19:    ,customer as (
  20:        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
  21:    )
  22:    ,orders_with_sk as ( 
  23:        select
  24:            orders.order_id
  25:            ,employees.employee_sk = employee_fk
  26:            ,customers.customer_sk = customer_fk
  27:            ,shippers.shipper_id = shipper_fk            
  28:            ,ship_region	
  29:            ,shipped_date
  30:            ,ship_country	
  31:            ,ship_name
  32:            ,order_date		
  33:            ,ship_postal_code	
  34:            ,ship_city	
  35:            ,freight	
  36:            ,required_date
  37:            ,ship_address 
  38:        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
  39:        left join employees on orders.employee_id = employees.employee_id
  40:        left join customers on orders.customer_id = customers.customer_id
  41:        left join shippers on orders.shipper_id = shippers.shipper_id
  42:    )
  43:select from orders_with_sk;
  44:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Syntax error: SELECT list must not be empty at [43:8]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-05-15 15:27:32.536809 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6039e0f4-14e3-485a-9710-288bdb9fc48b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187B1D270C8>]}
2021-05-15 15:27:32.536809 (Thread-1): 12:27:32 | 1 of 1 ERROR creating view model dbt_arthur.fact_order_details....... [ERROR in 4.59s]
2021-05-15 15:27:32.544804 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-05-15 15:27:32.634617 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 15:27:32.634617 (MainThread): 12:27:32 | 
2021-05-15 15:27:32.634617 (MainThread): 12:27:32 | Finished running 1 view model in 8.08s.
2021-05-15 15:27:32.634617 (MainThread): Connection 'master' was properly closed.
2021-05-15 15:27:32.634617 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 15:27:32.634617 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 15:27:32.634617 (MainThread): Connection 'model.northwind_shop.fact_order_details' was properly closed.
2021-05-15 15:27:32.642302 (MainThread): unclosed <socket.socket fd=1036, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60547), raddr=('172.217.29.234', 443)>
2021-05-15 15:27:32.642302 (MainThread): unclosed <socket.socket fd=1052, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60548), raddr=('142.250.219.10', 443)>
2021-05-15 15:27:32.642302 (MainThread): unclosed <socket.socket fd=804, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60550), raddr=('142.250.219.10', 443)>
2021-05-15 15:27:32.642302 (MainThread): unclosed <socket.socket fd=680, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60549), raddr=('172.217.29.234', 443)>
2021-05-15 15:27:32.642302 (MainThread): unclosed <socket.socket fd=356, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60551), raddr=('172.217.29.234', 443)>
2021-05-15 15:27:32.642302 (MainThread): unclosed <socket.socket fd=1088, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60552), raddr=('142.250.219.10', 443)>
2021-05-15 15:27:32.690548 (MainThread): 
2021-05-15 15:27:32.690548 (MainThread): Completed with 1 error and 0 warnings:
2021-05-15 15:27:32.692595 (MainThread): 
2021-05-15 15:27:32.692595 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-05-15 15:27:32.694661 (MainThread):   Syntax error: SELECT list must not be empty at [43:8]
2021-05-15 15:27:32.695676 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-05-15 15:27:32.695898 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-15 15:27:32.697533 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187AFC56548>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187AFC563C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187AFC56BC8>]}
2021-05-15 15:27:32.698030 (MainThread): Flushing usage events
2021-05-15 15:30:31.059974 (MainThread): Running with dbt=0.19.1
2021-05-15 15:30:31.474279 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 15:30:31.474279 (MainThread): Tracking: tracking
2021-05-15 15:30:31.474279 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED0CF62548>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED0CF81548>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED0CF81BC8>]}
2021-05-15 15:30:31.482277 (MainThread): Partial parsing not enabled
2021-05-15 15:30:31.482277 (MainThread): Parsing macros\adapters.sql
2021-05-15 15:30:31.498275 (MainThread): Parsing macros\catalog.sql
2021-05-15 15:30:31.506270 (MainThread): Parsing macros\etc.sql
2021-05-15 15:30:31.506270 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 15:30:31.514268 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 15:30:31.522263 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 15:30:31.522263 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 15:30:31.522263 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 15:30:31.538260 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 15:30:31.538260 (MainThread): Parsing macros\core.sql
2021-05-15 15:30:31.546291 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 15:30:31.578279 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 15:30:31.594229 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 15:30:31.594229 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 15:30:31.594229 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 15:30:31.602225 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 15:30:31.602225 (MainThread): Parsing macros\etc\query.sql
2021-05-15 15:30:31.602225 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 15:30:31.610637 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 15:30:31.626800 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 15:30:31.626800 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 15:30:31.634796 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 15:30:31.650790 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 15:30:31.691383 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 15:30:31.694511 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 15:30:31.725539 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 15:30:31.731618 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 15:30:31.736684 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 15:30:31.737686 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 15:30:31.745686 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 15:30:31.745686 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 15:30:31.745686 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 15:30:31.753684 (MainThread): Partial parsing not enabled
2021-05-15 15:30:31.769678 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 15:30:31.777673 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 15:30:31.785671 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 15:30:31.785671 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 15:30:31.793668 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 15:30:31.793668 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 15:30:31.801664 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 15:30:31.801664 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 15:30:31.809661 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 15:30:31.809661 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 15:30:31.817658 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 15:30:31.817658 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 15:30:31.817658 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 15:30:31.899327 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 15:30:31.906446 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8cfe5b62-22a6-4275-91bf-ec5ec3de11bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED10B318C8>]}
2021-05-15 15:30:31.914466 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8cfe5b62-22a6-4275-91bf-ec5ec3de11bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED10A1C388>]}
2021-05-15 15:30:31.914466 (MainThread): Found 13 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 15:30:31.914466 (MainThread): 
2021-05-15 15:30:31.914466 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 15:30:31.914466 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 15:30:31.914466 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 15:30:35.484474 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 15:30:35.484474 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 15:30:35.496990 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 15:30:36.408797 (MainThread): 12:30:36 | Concurrency: 1 threads (target='dev')
2021-05-15 15:30:36.409832 (MainThread): 12:30:36 | 
2021-05-15 15:30:36.414968 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-05-15 15:30:36.415866 (Thread-1): 12:30:36 | 1 of 1 START view model dbt_arthur.fact_order_details................ [RUN]
2021-05-15 15:30:36.416958 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 15:30:36.417326 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-05-15 15:30:36.427991 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 15:30:36.430051 (Thread-1): finished collecting timing info
2021-05-15 15:30:36.474207 (Thread-1): Writing runtime SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 15:30:36.479266 (Thread-1): Opening a new connection, currently in state init
2021-05-15 15:30:36.481988 (Thread-1): On model.northwind_shop.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`fact_order_details`
  OPTIONS()
  as with 
     customers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
    )
    , suppliers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
    )
    , shippers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
    )
    , products as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
    )
    , customer as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
    )
    , orders_with_sk as ( 
        select
            orders.order_id
            ,employees.employee_sk = employee_fk
            ,customers.customer_sk = customer_fk
            ,shippers.shipper_id = shipper_fk            
            ,ship_region	
            ,shipped_date
            ,ship_country	
            ,ship_name
            ,order_date		
            ,ship_postal_code	
            ,ship_city	
            ,freight	
            ,required_date
            ,ship_address 

        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
        left join employees on orders.employee_id = employees.employee_id
        left join customers on orders.customer_id = customers.customer_id
        left join shippers on orders.shipper_id = shippers.shipper_id
   )

select from orders_with_sk;


2021-05-15 15:30:38.727897 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/3606d1fe-5898-447e-ae79-96d75665fa2b?maxResults=0&location=US&prettyPrint=false: Syntax error: SELECT list must not be empty at [45:8]')
2021-05-15 15:30:40.604006 (Thread-1): finished collecting timing info
2021-05-15 15:30:40.604006 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Syntax error: SELECT list must not be empty at [45:8]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/75375f66-9681-4eed-b756-098166dbc652?maxResults=0&location=US&prettyPrint=false: Syntax error: SELECT list must not be empty at [45:8]

(job ID: 75375f66-9681-4eed-b756-098166dbc652)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */
   2:
   3:
   4:  create or replace view `northwind1-313400`.`dbt_arthur`.`fact_order_details`
   5:  OPTIONS()
   6:  as with 
   7:     customers as (
   8:        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
   9:    )
  10:    , suppliers as (
  11:        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
  12:    )
  13:    , shippers as (
  14:        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
  15:    )
  16:    , products as (
  17:        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
  18:    )
  19:    , customer as (
  20:        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
  21:    )
  22:    , orders_with_sk as ( 
  23:        select
  24:            orders.order_id
  25:            ,employees.employee_sk = employee_fk
  26:            ,customers.customer_sk = customer_fk
  27:            ,shippers.shipper_id = shipper_fk            
  28:            ,ship_region	
  29:            ,shipped_date
  30:            ,ship_country	
  31:            ,ship_name
  32:            ,order_date		
  33:            ,ship_postal_code	
  34:            ,ship_city	
  35:            ,freight	
  36:            ,required_date
  37:            ,ship_address 
  38:
  39:        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
  40:        left join employees on orders.employee_id = employees.employee_id
  41:        left join customers on orders.customer_id = customers.customer_id
  42:        left join shippers on orders.shipper_id = shippers.shipper_id
  43:   )
  44:
  45:select from orders_with_sk;
  46:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Syntax error: SELECT list must not be empty at [45:8]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-05-15 15:30:40.612009 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cfe5b62-22a6-4275-91bf-ec5ec3de11bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED10AB6C88>]}
2021-05-15 15:30:40.612009 (Thread-1): 12:30:40 | 1 of 1 ERROR creating view model dbt_arthur.fact_order_details....... [ERROR in 4.20s]
2021-05-15 15:30:40.612009 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-05-15 15:30:40.668311 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 15:30:40.668311 (MainThread): 12:30:40 | 
2021-05-15 15:30:40.668311 (MainThread): 12:30:40 | Finished running 1 view model in 8.75s.
2021-05-15 15:30:40.668311 (MainThread): Connection 'master' was properly closed.
2021-05-15 15:30:40.668311 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 15:30:40.668311 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 15:30:40.668311 (MainThread): Connection 'model.northwind_shop.fact_order_details' was properly closed.
2021-05-15 15:30:40.668311 (MainThread): unclosed <socket.socket fd=992, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60562), raddr=('172.217.29.10', 443)>
2021-05-15 15:30:40.676036 (MainThread): unclosed <socket.socket fd=1008, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60564), raddr=('142.250.219.10', 443)>
2021-05-15 15:30:40.676036 (MainThread): unclosed <socket.socket fd=1084, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60566), raddr=('142.250.219.10', 443)>
2021-05-15 15:30:40.676036 (MainThread): unclosed <socket.socket fd=1068, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60565), raddr=('172.217.29.10', 443)>
2021-05-15 15:30:40.676036 (MainThread): unclosed <socket.socket fd=640, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60567), raddr=('172.217.29.10', 443)>
2021-05-15 15:30:40.676036 (MainThread): unclosed <socket.socket fd=956, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60568), raddr=('142.250.219.10', 443)>
2021-05-15 15:30:40.723962 (MainThread): 
2021-05-15 15:30:40.723962 (MainThread): Completed with 1 error and 0 warnings:
2021-05-15 15:30:40.723962 (MainThread): 
2021-05-15 15:30:40.727180 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-05-15 15:30:40.727180 (MainThread):   Syntax error: SELECT list must not be empty at [45:8]
2021-05-15 15:30:40.727180 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-05-15 15:30:40.727180 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-15 15:30:40.730316 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED0CF25708>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED0CF25588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED0CF25A08>]}
2021-05-15 15:30:40.731449 (MainThread): Flushing usage events
2021-05-15 15:34:24.827809 (MainThread): Running with dbt=0.19.1
2021-05-15 15:34:25.145850 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 15:34:25.145850 (MainThread): Tracking: tracking
2021-05-15 15:34:25.145850 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022852639B88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002285274FB48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002285274FFC8>]}
2021-05-15 15:34:25.153847 (MainThread): Partial parsing not enabled
2021-05-15 15:34:25.153847 (MainThread): Parsing macros\adapters.sql
2021-05-15 15:34:25.169839 (MainThread): Parsing macros\catalog.sql
2021-05-15 15:34:25.177836 (MainThread): Parsing macros\etc.sql
2021-05-15 15:34:25.177836 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 15:34:25.185833 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 15:34:25.193830 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 15:34:25.193830 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 15:34:25.201826 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 15:34:25.209822 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 15:34:25.209822 (MainThread): Parsing macros\core.sql
2021-05-15 15:34:25.217820 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 15:34:25.257803 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 15:34:25.265800 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 15:34:25.265800 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 15:34:25.265800 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 15:34:25.265800 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 15:34:25.273796 (MainThread): Parsing macros\etc\query.sql
2021-05-15 15:34:25.273796 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 15:34:25.281793 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 15:34:25.297786 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 15:34:25.297786 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 15:34:25.305782 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 15:34:25.321776 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 15:34:25.361760 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 15:34:25.361760 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 15:34:25.377753 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 15:34:25.385749 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 15:34:25.385749 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 15:34:25.393746 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 15:34:25.393746 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 15:34:25.401743 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 15:34:25.401743 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 15:34:25.409740 (MainThread): Partial parsing not enabled
2021-05-15 15:34:25.425733 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 15:34:25.433730 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 15:34:25.441727 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 15:34:25.441727 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 15:34:25.441727 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 15:34:25.449725 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 15:34:25.457720 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 15:34:25.457720 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 15:34:25.457720 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 15:34:25.465717 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 15:34:25.465717 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 15:34:25.473713 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 15:34:25.473713 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 15:34:25.546903 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 15:34:25.554073 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e006ba1-cc2b-4a13-96fc-345a9427a08a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002285636B608>]}
2021-05-15 15:34:25.562083 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e006ba1-cc2b-4a13-96fc-345a9427a08a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022856204608>]}
2021-05-15 15:34:25.562083 (MainThread): Found 13 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 15:34:25.562083 (MainThread): 
2021-05-15 15:34:25.562083 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 15:34:25.570076 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 15:34:25.570806 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 15:34:27.063302 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 15:34:27.063918 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 15:34:27.071223 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 15:34:29.348512 (MainThread): 12:34:29 | Concurrency: 1 threads (target='dev')
2021-05-15 15:34:29.348512 (MainThread): 12:34:29 | 
2021-05-15 15:34:29.356524 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-05-15 15:34:29.356524 (Thread-1): 12:34:29 | 1 of 1 START view model dbt_arthur.fact_order_details................ [RUN]
2021-05-15 15:34:29.356524 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 15:34:29.356524 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-05-15 15:34:29.366014 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 15:34:29.366014 (Thread-1): finished collecting timing info
2021-05-15 15:34:29.402763 (Thread-1): Writing runtime SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 15:34:29.402763 (Thread-1): Opening a new connection, currently in state init
2021-05-15 15:34:29.402763 (Thread-1): On model.northwind_shop.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`fact_order_details`
  OPTIONS()
  as with 
     customers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
    )
    , suppliers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
    )
    , shippers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
    )
    , products as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
    )
    , customer as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
    )
    , orders_with_sk as ( 
        select
            orders.order_id
            ,employees.employee_sk = employee_fk
            ,customers.customer_sk = customer_fk
            ,shippers.shipper_id = shipper_fk            
            ,orders.ship_region	
            ,orders.shipped_date
            ,orders.ship_country	
            ,orders.ship_name
            ,orders.order_date		
            ,orders.ship_postal_code	
            ,orders.ship_city	
            ,orders.freight	
            ,orders.required_date
            ,orders.ship_address 

        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
        left join employees on orders.employee_id = employees.employee_id
        left join customers on orders.customer_id = customers.customer_id
        left join shippers on orders.shipper_id = shippers.shipper_id
   )

select from orders_with_sk;


2021-05-15 15:34:30.526294 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/c9e56b6d-61f1-472c-a949-774e21517099?maxResults=0&location=US&prettyPrint=false: Syntax error: SELECT list must not be empty at [45:8]')
2021-05-15 15:34:31.817168 (Thread-1): finished collecting timing info
2021-05-15 15:34:31.825177 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Syntax error: SELECT list must not be empty at [45:8]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/292419dc-5186-418e-b8da-96b209cd2346?maxResults=0&location=US&prettyPrint=false: Syntax error: SELECT list must not be empty at [45:8]

(job ID: 292419dc-5186-418e-b8da-96b209cd2346)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */
   2:
   3:
   4:  create or replace view `northwind1-313400`.`dbt_arthur`.`fact_order_details`
   5:  OPTIONS()
   6:  as with 
   7:     customers as (
   8:        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
   9:    )
  10:    , suppliers as (
  11:        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
  12:    )
  13:    , shippers as (
  14:        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
  15:    )
  16:    , products as (
  17:        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
  18:    )
  19:    , customer as (
  20:        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
  21:    )
  22:    , orders_with_sk as ( 
  23:        select
  24:            orders.order_id
  25:            ,employees.employee_sk = employee_fk
  26:            ,customers.customer_sk = customer_fk
  27:            ,shippers.shipper_id = shipper_fk            
  28:            ,orders.ship_region	
  29:            ,orders.shipped_date
  30:            ,orders.ship_country	
  31:            ,orders.ship_name
  32:            ,orders.order_date		
  33:            ,orders.ship_postal_code	
  34:            ,orders.ship_city	
  35:            ,orders.freight	
  36:            ,orders.required_date
  37:            ,orders.ship_address 
  38:
  39:        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
  40:        left join employees on orders.employee_id = employees.employee_id
  41:        left join customers on orders.customer_id = customers.customer_id
  42:        left join shippers on orders.shipper_id = shippers.shipper_id
  43:   )
  44:
  45:select from orders_with_sk;
  46:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Syntax error: SELECT list must not be empty at [45:8]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-05-15 15:34:31.833174 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e006ba1-cc2b-4a13-96fc-345a9427a08a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022856365488>]}
2021-05-15 15:34:31.833174 (Thread-1): 12:34:31 | 1 of 1 ERROR creating view model dbt_arthur.fact_order_details....... [ERROR in 2.48s]
2021-05-15 15:34:31.833174 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-05-15 15:34:31.889386 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 15:34:31.889386 (MainThread): 12:34:31 | 
2021-05-15 15:34:31.889386 (MainThread): 12:34:31 | Finished running 1 view model in 6.33s.
2021-05-15 15:34:31.889386 (MainThread): Connection 'master' was properly closed.
2021-05-15 15:34:31.889386 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 15:34:31.889386 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 15:34:31.889386 (MainThread): Connection 'model.northwind_shop.fact_order_details' was properly closed.
2021-05-15 15:34:31.889386 (MainThread): unclosed <socket.socket fd=1076, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60590), raddr=('216.58.202.202', 443)>
2021-05-15 15:34:31.897143 (MainThread): unclosed <socket.socket fd=720, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60591), raddr=('142.250.219.10', 443)>
2021-05-15 15:34:31.897143 (MainThread): unclosed <socket.socket fd=1108, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60593), raddr=('142.250.219.10', 443)>
2021-05-15 15:34:31.897143 (MainThread): unclosed <socket.socket fd=708, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60592), raddr=('216.58.202.202', 443)>
2021-05-15 15:34:31.897143 (MainThread): unclosed <socket.socket fd=724, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60594), raddr=('216.58.202.202', 443)>
2021-05-15 15:34:31.897143 (MainThread): unclosed <socket.socket fd=1216, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60595), raddr=('142.250.219.10', 443)>
2021-05-15 15:34:31.988093 (MainThread): 
2021-05-15 15:34:31.988093 (MainThread): Completed with 1 error and 0 warnings:
2021-05-15 15:34:31.988093 (MainThread): 
2021-05-15 15:34:31.988093 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-05-15 15:34:31.988093 (MainThread):   Syntax error: SELECT list must not be empty at [45:8]
2021-05-15 15:34:31.996099 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-05-15 15:34:31.996099 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-15 15:34:31.998504 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228526F6508>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228526F6688>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228526F6B88>]}
2021-05-15 15:34:31.998504 (MainThread): Flushing usage events
2021-05-15 15:42:15.348913 (MainThread): Running with dbt=0.19.1
2021-05-15 15:42:15.695926 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 15:42:15.695926 (MainThread): Tracking: tracking
2021-05-15 15:42:15.695926 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022993B5FD88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022993B5F688>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022993B68588>]}
2021-05-15 15:42:15.703923 (MainThread): Partial parsing not enabled
2021-05-15 15:42:15.711921 (MainThread): Parsing macros\adapters.sql
2021-05-15 15:42:15.727912 (MainThread): Parsing macros\catalog.sql
2021-05-15 15:42:15.735909 (MainThread): Parsing macros\etc.sql
2021-05-15 15:42:15.735909 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 15:42:15.735909 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 15:42:15.751901 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 15:42:15.751901 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 15:42:15.751901 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 15:42:15.759899 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 15:42:15.767896 (MainThread): Parsing macros\core.sql
2021-05-15 15:42:15.775893 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 15:42:15.807878 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 15:42:15.815875 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 15:42:15.815875 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 15:42:15.823871 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 15:42:15.823871 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 15:42:15.823871 (MainThread): Parsing macros\etc\query.sql
2021-05-15 15:42:15.823871 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 15:42:15.831869 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 15:42:15.852605 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 15:42:15.854627 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 15:42:15.860840 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 15:42:15.879182 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 15:42:15.911230 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 15:42:15.911230 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 15:42:15.927212 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 15:42:15.935210 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 15:42:15.935210 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 15:42:15.943207 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 15:42:15.943207 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 15:42:15.951208 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 15:42:15.951208 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 15:42:15.959203 (MainThread): Partial parsing not enabled
2021-05-15 15:42:15.975206 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 15:42:15.983192 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 15:42:15.991189 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 15:42:15.991189 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 15:42:16.000307 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 15:42:16.003533 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 15:42:16.004601 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 15:42:16.012669 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 15:42:16.012669 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 15:42:16.020684 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 15:42:16.020684 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 15:42:16.020684 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 15:42:16.028663 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 15:42:16.100659 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 15:42:16.107985 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5923425d-fc2a-43ae-96ef-efbcda6dbf26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002299777BCC8>]}
2021-05-15 15:42:16.108562 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5923425d-fc2a-43ae-96ef-efbcda6dbf26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022997614508>]}
2021-05-15 15:42:16.108562 (MainThread): Found 13 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 15:42:16.108562 (MainThread): 
2021-05-15 15:42:16.116568 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 15:42:16.116568 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 15:42:16.116568 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 15:42:16.965584 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 15:42:16.965584 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 15:42:16.979465 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 15:42:18.137911 (MainThread): 12:42:18 | Concurrency: 1 threads (target='dev')
2021-05-15 15:42:18.140674 (MainThread): 12:42:18 | 
2021-05-15 15:42:18.145912 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-05-15 15:42:18.147221 (Thread-1): 12:42:18 | 1 of 1 START view model dbt_arthur.fact_order_details................ [RUN]
2021-05-15 15:42:18.148338 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 15:42:18.148338 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-05-15 15:42:18.158479 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 15:42:18.161161 (Thread-1): finished collecting timing info
2021-05-15 15:42:18.216326 (Thread-1): Writing runtime SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 15:42:18.217349 (Thread-1): Opening a new connection, currently in state init
2021-05-15 15:42:18.223417 (Thread-1): On model.northwind_shop.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`fact_order_details`
  OPTIONS()
  as with 
    customers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
    )
    , suppliers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
    )
    , shippers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
    )
    , products as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
    )
    , customer as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
    )
    , orders_with_sk as ( 
        select 
            orders.order_id
            ,employees.employee_sk = employee_fk
            ,customers.customer_sk = customer_fk
            ,shippers.shipper_id = shipper_fk            
            ,orders.ship_region	
            ,orders.shipped_date
            ,orders.ship_country	
            ,orders.ship_name
            ,orders.order_date		
            ,orders.ship_postal_code	
            ,orders.ship_city	
            ,orders.freight	
            ,orders.required_date
            ,orders.ship_address 

        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
        left join employees on orders.employee_id = employees.employee_id
        left join customers on orders.customer_id = customers.customer_id
        left join shippers on orders.shipper_id = shippers.shipper_id
    )

select from orders_with_sk;


2021-05-15 15:42:19.370319 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/7179e1a3-cfae-439a-8590-a8bf6b9ff09f?maxResults=0&location=US&prettyPrint=false: Syntax error: SELECT list must not be empty at [45:8]')
2021-05-15 15:42:20.474434 (Thread-1): finished collecting timing info
2021-05-15 15:42:20.474434 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Syntax error: SELECT list must not be empty at [45:8]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/ea66f0e6-ae8d-4657-bba6-13f9f4ae35cc?maxResults=0&location=US&prettyPrint=false: Syntax error: SELECT list must not be empty at [45:8]

(job ID: ea66f0e6-ae8d-4657-bba6-13f9f4ae35cc)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */
   2:
   3:
   4:  create or replace view `northwind1-313400`.`dbt_arthur`.`fact_order_details`
   5:  OPTIONS()
   6:  as with 
   7:    customers as (
   8:        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
   9:    )
  10:    , suppliers as (
  11:        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
  12:    )
  13:    , shippers as (
  14:        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
  15:    )
  16:    , products as (
  17:        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
  18:    )
  19:    , customer as (
  20:        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
  21:    )
  22:    , orders_with_sk as ( 
  23:        select 
  24:            orders.order_id
  25:            ,employees.employee_sk = employee_fk
  26:            ,customers.customer_sk = customer_fk
  27:            ,shippers.shipper_id = shipper_fk            
  28:            ,orders.ship_region	
  29:            ,orders.shipped_date
  30:            ,orders.ship_country	
  31:            ,orders.ship_name
  32:            ,orders.order_date		
  33:            ,orders.ship_postal_code	
  34:            ,orders.ship_city	
  35:            ,orders.freight	
  36:            ,orders.required_date
  37:            ,orders.ship_address 
  38:
  39:        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
  40:        left join employees on orders.employee_id = employees.employee_id
  41:        left join customers on orders.customer_id = customers.customer_id
  42:        left join shippers on orders.shipper_id = shippers.shipper_id
  43:    )
  44:
  45:select from orders_with_sk;
  46:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Syntax error: SELECT list must not be empty at [45:8]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-05-15 15:42:20.482443 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5923425d-fc2a-43ae-96ef-efbcda6dbf26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002299762D3C8>]}
2021-05-15 15:42:20.482443 (Thread-1): 12:42:20 | 1 of 1 ERROR creating view model dbt_arthur.fact_order_details....... [ERROR in 2.33s]
2021-05-15 15:42:20.482443 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-05-15 15:42:20.605625 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 15:42:20.605625 (MainThread): 12:42:20 | 
2021-05-15 15:42:20.605625 (MainThread): 12:42:20 | Finished running 1 view model in 4.49s.
2021-05-15 15:42:20.605625 (MainThread): Connection 'master' was properly closed.
2021-05-15 15:42:20.605625 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 15:42:20.605625 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 15:42:20.605625 (MainThread): Connection 'model.northwind_shop.fact_order_details' was properly closed.
2021-05-15 15:42:20.605625 (MainThread): unclosed <socket.socket fd=976, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60629), raddr=('216.58.202.138', 443)>
2021-05-15 15:42:20.613556 (MainThread): unclosed <socket.socket fd=784, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60630), raddr=('142.250.79.202', 443)>
2021-05-15 15:42:20.613556 (MainThread): unclosed <socket.socket fd=756, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60632), raddr=('142.250.79.202', 443)>
2021-05-15 15:42:20.613556 (MainThread): unclosed <socket.socket fd=864, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60631), raddr=('216.58.202.138', 443)>
2021-05-15 15:42:20.613556 (MainThread): unclosed <socket.socket fd=1112, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60633), raddr=('216.58.202.138', 443)>
2021-05-15 15:42:20.613556 (MainThread): unclosed <socket.socket fd=1124, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60634), raddr=('142.250.79.202', 443)>
2021-05-15 15:42:20.663590 (MainThread): 
2021-05-15 15:42:20.663590 (MainThread): Completed with 1 error and 0 warnings:
2021-05-15 15:42:20.663590 (MainThread): 
2021-05-15 15:42:20.663590 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-05-15 15:42:20.663590 (MainThread):   Syntax error: SELECT list must not be empty at [45:8]
2021-05-15 15:42:20.663590 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-05-15 15:42:20.663590 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-15 15:42:20.663590 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022993B11A08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022993B11F48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022993B11C48>]}
2021-05-15 15:42:20.663590 (MainThread): Flushing usage events
2021-05-15 17:06:10.414438 (MainThread): Running with dbt=0.19.1
2021-05-15 17:06:10.770198 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 17:06:10.770198 (MainThread): Tracking: tracking
2021-05-15 17:06:10.785806 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225DE034EC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225DE034DC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225DE034D08>]}
2021-05-15 17:06:10.785806 (MainThread): Partial parsing not enabled
2021-05-15 17:06:10.785806 (MainThread): Parsing macros\adapters.sql
2021-05-15 17:06:10.801440 (MainThread): Parsing macros\catalog.sql
2021-05-15 17:06:10.817059 (MainThread): Parsing macros\etc.sql
2021-05-15 17:06:10.817059 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 17:06:10.817059 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 17:06:10.832686 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 17:06:10.832686 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 17:06:10.832686 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 17:06:10.848292 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 17:06:10.848292 (MainThread): Parsing macros\core.sql
2021-05-15 17:06:10.848292 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 17:06:10.895124 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 17:06:10.910748 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 17:06:10.910748 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 17:06:10.910748 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 17:06:10.910748 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 17:06:10.910748 (MainThread): Parsing macros\etc\query.sql
2021-05-15 17:06:10.910748 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 17:06:10.926371 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 17:06:10.941994 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 17:06:10.941994 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 17:06:10.941994 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 17:06:10.973241 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 17:06:10.988864 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 17:06:11.004488 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 17:06:11.020111 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 17:06:11.020111 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 17:06:11.020111 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 17:06:11.086344 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 17:06:11.086344 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 17:06:11.086344 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 17:06:11.086344 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 17:06:11.086344 (MainThread): Partial parsing not enabled
2021-05-15 17:06:11.117684 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 17:06:11.117684 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 17:06:11.133309 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 17:06:11.133309 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 17:06:11.133309 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 17:06:11.133309 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 17:06:11.149515 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 17:06:11.149515 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 17:06:11.157596 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 17:06:11.157596 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 17:06:11.165596 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 17:06:11.165596 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 17:06:11.175774 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 17:06:11.275654 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 17:06:11.275654 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8763b8e-87b3-4f7d-b2e1-3b84a540d3b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225E1C0BD88>]}
2021-05-15 17:06:11.283635 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8763b8e-87b3-4f7d-b2e1-3b84a540d3b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225E1ACF148>]}
2021-05-15 17:06:11.283635 (MainThread): Found 13 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 17:06:11.283635 (MainThread): 
2021-05-15 17:06:11.283635 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 17:06:11.283635 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 17:06:11.283635 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 17:06:12.553612 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 17:06:12.553612 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 17:06:12.569235 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 17:06:13.697390 (MainThread): 14:06:13 | Concurrency: 1 threads (target='dev')
2021-05-15 17:06:13.697390 (MainThread): 14:06:13 | 
2021-05-15 17:06:13.710210 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-05-15 17:06:13.710210 (Thread-1): 14:06:13 | 1 of 1 START view model dbt_arthur.fact_order_details................ [RUN]
2021-05-15 17:06:13.710210 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 17:06:13.716543 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-05-15 17:06:13.716543 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 17:06:13.716543 (Thread-1): finished collecting timing info
2021-05-15 17:06:13.756534 (Thread-1): Writing runtime SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 17:06:13.756534 (Thread-1): Opening a new connection, currently in state init
2021-05-15 17:06:13.764561 (Thread-1): On model.northwind_shop.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`fact_order_details`
  OPTIONS()
  as with 
    customers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
    )
    , suppliers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
    )
    , shippers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
    )
    , products as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
    )
    , customer as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
    )
    , orders_with_sk as ( 
        select 
            orders.order_id
            ,employees.employee_sk = employee_fk
            ,customers.customer_sk = customer_fk
            ,shippers.shipper_id = shipper_fk            
            ,orders.ship_region	
            ,orders.shipped_date
            ,orders.ship_country	
            ,orders.ship_name
            ,orders.order_date		
            ,orders.ship_postal_code	
            ,orders.ship_city	
            ,orders.freight	
            ,orders.required_date
            ,orders.ship_address 

        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
        left join employees on orders.employee_id = employees.employee_id
        left join customers on orders.customer_id = customers.customer_id
        left join shippers on orders.shipper_id = shippers.shipper_id
    )

select from orders_with_sk;


2021-05-15 17:06:15.405582 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/9ec5eb20-2191-498c-92ee-942bf6094532?maxResults=0&location=US&prettyPrint=false: Syntax error: SELECT list must not be empty at [45:8]')
2021-05-15 17:06:17.322358 (Thread-1): finished collecting timing info
2021-05-15 17:06:17.322358 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Syntax error: SELECT list must not be empty at [45:8]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/ee492d5f-4df3-4355-a8c0-ef2190c796a5?maxResults=0&location=US&prettyPrint=false: Syntax error: SELECT list must not be empty at [45:8]

(job ID: ee492d5f-4df3-4355-a8c0-ef2190c796a5)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */
   2:
   3:
   4:  create or replace view `northwind1-313400`.`dbt_arthur`.`fact_order_details`
   5:  OPTIONS()
   6:  as with 
   7:    customers as (
   8:        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
   9:    )
  10:    , suppliers as (
  11:        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
  12:    )
  13:    , shippers as (
  14:        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
  15:    )
  16:    , products as (
  17:        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
  18:    )
  19:    , customer as (
  20:        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
  21:    )
  22:    , orders_with_sk as ( 
  23:        select 
  24:            orders.order_id
  25:            ,employees.employee_sk = employee_fk
  26:            ,customers.customer_sk = customer_fk
  27:            ,shippers.shipper_id = shipper_fk            
  28:            ,orders.ship_region	
  29:            ,orders.shipped_date
  30:            ,orders.ship_country	
  31:            ,orders.ship_name
  32:            ,orders.order_date		
  33:            ,orders.ship_postal_code	
  34:            ,orders.ship_city	
  35:            ,orders.freight	
  36:            ,orders.required_date
  37:            ,orders.ship_address 
  38:
  39:        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
  40:        left join employees on orders.employee_id = employees.employee_id
  41:        left join customers on orders.customer_id = customers.customer_id
  42:        left join shippers on orders.shipper_id = shippers.shipper_id
  43:    )
  44:
  45:select from orders_with_sk;
  46:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Syntax error: SELECT list must not be empty at [45:8]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-05-15 17:06:17.340138 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8763b8e-87b3-4f7d-b2e1-3b84a540d3b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225E1B72F48>]}
2021-05-15 17:06:17.340138 (Thread-1): 14:06:17 | 1 of 1 ERROR creating view model dbt_arthur.fact_order_details....... [ERROR in 3.63s]
2021-05-15 17:06:17.342600 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-05-15 17:06:17.414410 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 17:06:17.414410 (MainThread): 14:06:17 | 
2021-05-15 17:06:17.414410 (MainThread): 14:06:17 | Finished running 1 view model in 6.13s.
2021-05-15 17:06:17.414410 (MainThread): Connection 'master' was properly closed.
2021-05-15 17:06:17.414410 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 17:06:17.414410 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 17:06:17.414410 (MainThread): Connection 'model.northwind_shop.fact_order_details' was properly closed.
2021-05-15 17:06:17.422127 (MainThread): unclosed <socket.socket fd=1032, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60896), raddr=('172.217.162.106', 443)>
2021-05-15 17:06:17.422127 (MainThread): unclosed <socket.socket fd=816, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60897), raddr=('142.250.79.202', 443)>
2021-05-15 17:06:17.422127 (MainThread): unclosed <socket.socket fd=1124, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60899), raddr=('142.250.79.202', 443)>
2021-05-15 17:06:17.422127 (MainThread): unclosed <socket.socket fd=1116, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60898), raddr=('172.217.162.106', 443)>
2021-05-15 17:06:17.422127 (MainThread): unclosed <socket.socket fd=1192, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60900), raddr=('172.217.162.106', 443)>
2021-05-15 17:06:17.422127 (MainThread): unclosed <socket.socket fd=1200, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60901), raddr=('142.250.79.202', 443)>
2021-05-15 17:06:17.468467 (MainThread): 
2021-05-15 17:06:17.468467 (MainThread): Completed with 1 error and 0 warnings:
2021-05-15 17:06:17.468467 (MainThread): 
2021-05-15 17:06:17.474816 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-05-15 17:06:17.474816 (MainThread):   Syntax error: SELECT list must not be empty at [45:8]
2021-05-15 17:06:17.474816 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-05-15 17:06:17.474816 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-15 17:06:17.474816 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225DDFD5788>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225DDFD5608>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225DDFD59C8>]}
2021-05-15 17:06:17.479218 (MainThread): Flushing usage events
2021-05-15 17:06:27.667710 (MainThread): The 'warn' method is deprecated, use 'warning' instead
2021-05-15 17:06:27.667710 (MainThread): Error sending message, disabling tracking
2021-05-15 17:07:35.618110 (MainThread): Running with dbt=0.19.1
2021-05-15 17:07:36.086026 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 17:07:36.086026 (MainThread): Tracking: tracking
2021-05-15 17:07:36.086026 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8E9C5FE48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8E9C5FF08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8E9C5FD88>]}
2021-05-15 17:07:36.101736 (MainThread): Partial parsing not enabled
2021-05-15 17:07:36.101736 (MainThread): Parsing macros\adapters.sql
2021-05-15 17:07:36.132908 (MainThread): Parsing macros\catalog.sql
2021-05-15 17:07:36.132908 (MainThread): Parsing macros\etc.sql
2021-05-15 17:07:36.132908 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 17:07:36.148986 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 17:07:36.148986 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 17:07:36.164635 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 17:07:36.164635 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 17:07:36.180259 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 17:07:36.180259 (MainThread): Parsing macros\core.sql
2021-05-15 17:07:36.199652 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 17:07:36.255569 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 17:07:36.261912 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 17:07:36.261912 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 17:07:36.261912 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 17:07:36.261912 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 17:07:36.261912 (MainThread): Parsing macros\etc\query.sql
2021-05-15 17:07:36.261912 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 17:07:36.283874 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 17:07:36.287898 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 17:07:36.287898 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 17:07:36.305542 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 17:07:36.309899 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 17:07:36.341211 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 17:07:36.356909 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 17:07:36.373084 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 17:07:36.373084 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 17:07:36.373084 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 17:07:36.389239 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 17:07:36.389239 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 17:07:36.389239 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 17:07:36.397311 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 17:07:36.397311 (MainThread): Partial parsing not enabled
2021-05-15 17:07:36.408714 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 17:07:36.425639 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 17:07:36.425639 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 17:07:36.425639 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 17:07:36.444579 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 17:07:36.451131 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 17:07:36.457549 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 17:07:36.461872 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 17:07:36.465115 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 17:07:36.469464 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 17:07:36.472730 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 17:07:36.477080 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 17:07:36.480356 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 17:07:36.552739 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 17:07:36.557462 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b94b728-c6aa-4aeb-b30e-233727989cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8ED724308>]}
2021-05-15 17:07:36.557462 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b94b728-c6aa-4aeb-b30e-233727989cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8ED7B4708>]}
2021-05-15 17:07:36.557462 (MainThread): Found 13 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 17:07:36.565484 (MainThread): 
2021-05-15 17:07:36.566809 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 17:07:36.566809 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 17:07:36.566809 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 17:07:37.987882 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 17:07:37.988378 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 17:07:37.999241 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 17:07:39.400994 (MainThread): 14:07:39 | Concurrency: 1 threads (target='dev')
2021-05-15 17:07:39.400994 (MainThread): 14:07:39 | 
2021-05-15 17:07:39.410000 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-05-15 17:07:39.410000 (Thread-1): 14:07:39 | 1 of 1 START view model dbt_arthur.fact_order_details................ [RUN]
2021-05-15 17:07:39.411608 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 17:07:39.411608 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-05-15 17:07:39.416639 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 17:07:39.418730 (Thread-1): finished collecting timing info
2021-05-15 17:07:39.455119 (Thread-1): Writing runtime SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 17:07:39.457333 (Thread-1): Opening a new connection, currently in state init
2021-05-15 17:07:39.460398 (Thread-1): On model.northwind_shop.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`fact_order_details`
  OPTIONS()
  as with 
    select customers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
    )
    , suppliers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
    )
    , shippers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
    )
    , products as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
    )
    , customer as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
    )
    , orders_with_sk as ( 
        select 
            orders.order_id
            ,employees.employee_sk = employee_fk
            ,customers.customer_sk = customer_fk
            ,shippers.shipper_id = shipper_fk            
            ,orders.ship_region	
            ,orders.shipped_date
            ,orders.ship_country	
            ,orders.ship_name
            ,orders.order_date		
            ,orders.ship_postal_code	
            ,orders.ship_city	
            ,orders.freight	
            ,orders.required_date
            ,orders.ship_address 

        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
        left join employees on orders.employee_id = employees.employee_id
        left join customers on orders.customer_id = customers.customer_id
        left join shippers on orders.shipper_id = shippers.shipper_id
    )

select from orders_with_sk;


2021-05-15 17:07:41.072320 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/b9c77c12-8024-459b-a05a-7f523d8756b9?maxResults=0&location=US&prettyPrint=false: Syntax error: Unexpected keyword SELECT at [7:5]')
2021-05-15 17:07:42.549988 (Thread-1): finished collecting timing info
2021-05-15 17:07:42.549988 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Syntax error: Unexpected keyword SELECT at [7:5]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/7bdec46b-831a-4bfb-affe-770e287c264c?maxResults=0&location=US&prettyPrint=false: Syntax error: Unexpected keyword SELECT at [7:5]

(job ID: 7bdec46b-831a-4bfb-affe-770e287c264c)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */
   2:
   3:
   4:  create or replace view `northwind1-313400`.`dbt_arthur`.`fact_order_details`
   5:  OPTIONS()
   6:  as with 
   7:    select customers as (
   8:        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
   9:    )
  10:    , suppliers as (
  11:        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
  12:    )
  13:    , shippers as (
  14:        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
  15:    )
  16:    , products as (
  17:        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
  18:    )
  19:    , customer as (
  20:        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
  21:    )
  22:    , orders_with_sk as ( 
  23:        select 
  24:            orders.order_id
  25:            ,employees.employee_sk = employee_fk
  26:            ,customers.customer_sk = customer_fk
  27:            ,shippers.shipper_id = shipper_fk            
  28:            ,orders.ship_region	
  29:            ,orders.shipped_date
  30:            ,orders.ship_country	
  31:            ,orders.ship_name
  32:            ,orders.order_date		
  33:            ,orders.ship_postal_code	
  34:            ,orders.ship_city	
  35:            ,orders.freight	
  36:            ,orders.required_date
  37:            ,orders.ship_address 
  38:
  39:        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
  40:        left join employees on orders.employee_id = employees.employee_id
  41:        left join customers on orders.customer_id = customers.customer_id
  42:        left join shippers on orders.shipper_id = shippers.shipper_id
  43:    )
  44:
  45:select from orders_with_sk;
  46:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Syntax error: Unexpected keyword SELECT at [7:5]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-05-15 17:07:42.565295 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b94b728-c6aa-4aeb-b30e-233727989cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8ED7D7EC8>]}
2021-05-15 17:07:42.565295 (Thread-1): 14:07:42 | 1 of 1 ERROR creating view model dbt_arthur.fact_order_details....... [ERROR in 3.16s]
2021-05-15 17:07:42.565295 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-05-15 17:07:42.658347 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 17:07:42.658347 (MainThread): 14:07:42 | 
2021-05-15 17:07:42.658347 (MainThread): 14:07:42 | Finished running 1 view model in 6.09s.
2021-05-15 17:07:42.658347 (MainThread): Connection 'master' was properly closed.
2021-05-15 17:07:42.658347 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 17:07:42.658347 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 17:07:42.658347 (MainThread): Connection 'model.northwind_shop.fact_order_details' was properly closed.
2021-05-15 17:07:42.658347 (MainThread): unclosed <socket.socket fd=960, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60943), raddr=('172.217.162.106', 443)>
2021-05-15 17:07:42.666157 (MainThread): unclosed <socket.socket fd=740, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60945), raddr=('142.250.79.202', 443)>
2021-05-15 17:07:42.666157 (MainThread): unclosed <socket.socket fd=868, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60960), raddr=('142.250.79.202', 443)>
2021-05-15 17:07:42.666157 (MainThread): unclosed <socket.socket fd=916, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60959), raddr=('172.217.162.106', 443)>
2021-05-15 17:07:42.666157 (MainThread): unclosed <socket.socket fd=824, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60963), raddr=('172.217.162.106', 443)>
2021-05-15 17:07:42.666157 (MainThread): unclosed <socket.socket fd=716, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60964), raddr=('142.250.79.202', 443)>
2021-05-15 17:07:42.716626 (MainThread): 
2021-05-15 17:07:42.716626 (MainThread): Completed with 1 error and 0 warnings:
2021-05-15 17:07:42.716626 (MainThread): 
2021-05-15 17:07:42.716626 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-05-15 17:07:42.724576 (MainThread):   Syntax error: Unexpected keyword SELECT at [7:5]
2021-05-15 17:07:42.724576 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-05-15 17:07:42.724576 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-15 17:07:42.724576 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8E9C067C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8E9C06648>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8E9C06A08>]}
2021-05-15 17:07:42.728472 (MainThread): Flushing usage events
2021-05-15 17:08:33.846414 (MainThread): Running with dbt=0.19.1
2021-05-15 17:08:34.164942 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 17:08:34.172939 (MainThread): Tracking: tracking
2021-05-15 17:08:34.172939 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E2943FCC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E29448548>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E29448188>]}
2021-05-15 17:08:34.180936 (MainThread): Partial parsing not enabled
2021-05-15 17:08:34.180936 (MainThread): Parsing macros\adapters.sql
2021-05-15 17:08:34.196929 (MainThread): Parsing macros\catalog.sql
2021-05-15 17:08:34.204925 (MainThread): Parsing macros\etc.sql
2021-05-15 17:08:34.204925 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 17:08:34.204925 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 17:08:34.220918 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 17:08:34.220918 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 17:08:34.220918 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 17:08:34.236912 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 17:08:34.236912 (MainThread): Parsing macros\core.sql
2021-05-15 17:08:34.244909 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 17:08:34.276895 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 17:08:34.284892 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 17:08:34.292888 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 17:08:34.292888 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 17:08:34.292888 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 17:08:34.292888 (MainThread): Parsing macros\etc\query.sql
2021-05-15 17:08:34.292888 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 17:08:34.300886 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 17:08:34.316879 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 17:08:34.316879 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 17:08:34.324875 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 17:08:34.348866 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 17:08:34.372855 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 17:08:34.380852 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 17:08:34.396846 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 17:08:34.396846 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 17:08:34.404842 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 17:08:34.412839 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 17:08:34.412839 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 17:08:34.412839 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 17:08:34.412839 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 17:08:34.420835 (MainThread): Partial parsing not enabled
2021-05-15 17:08:34.444825 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 17:08:34.452822 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 17:08:34.452822 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 17:08:34.460819 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 17:08:34.460819 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 17:08:34.468922 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 17:08:34.477422 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 17:08:34.477422 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 17:08:34.477422 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 17:08:34.485420 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 17:08:34.485420 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 17:08:34.493416 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 17:08:34.493416 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 17:08:34.565386 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 17:08:34.573693 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4a362dd-b63f-4ddb-b5a0-8e786fe5029c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E2CFEEC48>]}
2021-05-15 17:08:34.581732 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4a362dd-b63f-4ddb-b5a0-8e786fe5029c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E2CEE4908>]}
2021-05-15 17:08:34.581732 (MainThread): Found 13 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 17:08:34.583949 (MainThread): 
2021-05-15 17:08:34.583949 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 17:08:34.583949 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 17:08:34.583949 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 17:08:36.973771 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 17:08:36.973771 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 17:08:36.981767 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 17:08:38.713795 (MainThread): 14:08:38 | Concurrency: 1 threads (target='dev')
2021-05-15 17:08:38.714932 (MainThread): 14:08:38 | 
2021-05-15 17:08:38.719957 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-05-15 17:08:38.719957 (Thread-1): 14:08:38 | 1 of 1 START view model dbt_arthur.fact_order_details................ [RUN]
2021-05-15 17:08:38.722060 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 17:08:38.722060 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-05-15 17:08:38.729351 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 17:08:38.730393 (Thread-1): finished collecting timing info
2021-05-15 17:08:38.760608 (Thread-1): Writing runtime SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 17:08:38.760608 (Thread-1): Opening a new connection, currently in state init
2021-05-15 17:08:38.768610 (Thread-1): On model.northwind_shop.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`fact_order_details`
  OPTIONS()
  as with 
    customers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
    )
    , suppliers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
    )
    , shippers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
    )
    , products as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
    )
    , customer as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
    )
    , orders_with_sk as ( 
        select orders.order_id
            ,employees.employee_sk = employee_fk
            ,customers.customer_sk = customer_fk
            ,shippers.shipper_id = shipper_fk            
            ,orders.ship_region	
            ,orders.shipped_date
            ,orders.ship_country	
            ,orders.ship_name
            ,orders.order_date		
            ,orders.ship_postal_code	
            ,orders.ship_city	
            ,orders.freight	
            ,orders.required_date
            ,orders.ship_address 

        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
        left join employees on orders.employee_id = employees.employee_id
        left join customers on orders.customer_id = customers.customer_id
        left join shippers on orders.shipper_id = shippers.shipper_id
    )

select * from orders_with_sk;


2021-05-15 17:08:40.757955 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/8875d8b4-45a1-42d4-ae86-0f024b0a9dfc?maxResults=0&location=US&prettyPrint=false: Table name "employees" missing dataset while no default dataset is set in the request.')
2021-05-15 17:08:42.229757 (Thread-1): finished collecting timing info
2021-05-15 17:08:42.237399 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Table name "employees" missing dataset while no default dataset is set in the request.
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/93138547-1e4a-44e5-9a41-57e1eb29c921?maxResults=0&location=US&prettyPrint=false: Table name "employees" missing dataset while no default dataset is set in the request.

(job ID: 93138547-1e4a-44e5-9a41-57e1eb29c921)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */
   2:
   3:
   4:  create or replace view `northwind1-313400`.`dbt_arthur`.`fact_order_details`
   5:  OPTIONS()
   6:  as with 
   7:    customers as (
   8:        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
   9:    )
  10:    , suppliers as (
  11:        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
  12:    )
  13:    , shippers as (
  14:        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
  15:    )
  16:    , products as (
  17:        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
  18:    )
  19:    , customer as (
  20:        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
  21:    )
  22:    , orders_with_sk as ( 
  23:        select orders.order_id
  24:            ,employees.employee_sk = employee_fk
  25:            ,customers.customer_sk = customer_fk
  26:            ,shippers.shipper_id = shipper_fk            
  27:            ,orders.ship_region	
  28:            ,orders.shipped_date
  29:            ,orders.ship_country	
  30:            ,orders.ship_name
  31:            ,orders.order_date		
  32:            ,orders.ship_postal_code	
  33:            ,orders.ship_city	
  34:            ,orders.freight	
  35:            ,orders.required_date
  36:            ,orders.ship_address 
  37:
  38:        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
  39:        left join employees on orders.employee_id = employees.employee_id
  40:        left join customers on orders.customer_id = customers.customer_id
  41:        left join shippers on orders.shipper_id = shippers.shipper_id
  42:    )
  43:
  44:select * from orders_with_sk;
  45:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Table name "employees" missing dataset while no default dataset is set in the request.
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-05-15 17:08:42.245396 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4a362dd-b63f-4ddb-b5a0-8e786fe5029c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E2CFB79C8>]}
2021-05-15 17:08:42.245396 (Thread-1): 14:08:42 | 1 of 1 ERROR creating view model dbt_arthur.fact_order_details....... [ERROR in 3.52s]
2021-05-15 17:08:42.245396 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-05-15 17:08:42.310354 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 17:08:42.310354 (MainThread): 14:08:42 | 
2021-05-15 17:08:42.310354 (MainThread): 14:08:42 | Finished running 1 view model in 7.73s.
2021-05-15 17:08:42.310354 (MainThread): Connection 'master' was properly closed.
2021-05-15 17:08:42.310354 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 17:08:42.310354 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 17:08:42.310354 (MainThread): Connection 'model.northwind_shop.fact_order_details' was properly closed.
2021-05-15 17:08:42.318001 (MainThread): unclosed <socket.socket fd=980, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60984), raddr=('172.217.162.106', 443)>
2021-05-15 17:08:42.318001 (MainThread): unclosed <socket.socket fd=996, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60985), raddr=('142.250.79.202', 443)>
2021-05-15 17:08:42.318001 (MainThread): unclosed <socket.socket fd=828, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60987), raddr=('142.250.79.202', 443)>
2021-05-15 17:08:42.318001 (MainThread): unclosed <socket.socket fd=764, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60986), raddr=('172.217.162.106', 443)>
2021-05-15 17:08:42.318001 (MainThread): unclosed <socket.socket fd=644, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60988), raddr=('172.217.162.106', 443)>
2021-05-15 17:08:42.318001 (MainThread): unclosed <socket.socket fd=1152, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 60989), raddr=('142.250.79.202', 443)>
2021-05-15 17:08:42.366709 (MainThread): 
2021-05-15 17:08:42.366709 (MainThread): Completed with 1 error and 0 warnings:
2021-05-15 17:08:42.366709 (MainThread): 
2021-05-15 17:08:42.366709 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-05-15 17:08:42.366709 (MainThread):   Table name "employees" missing dataset while no default dataset is set in the request.
2021-05-15 17:08:42.366709 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-05-15 17:08:42.366709 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-15 17:08:42.374664 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E293E6488>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E293E6308>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E293E6D88>]}
2021-05-15 17:08:42.374664 (MainThread): Flushing usage events
2021-05-15 17:09:53.640711 (MainThread): Running with dbt=0.19.1
2021-05-15 17:09:54.008065 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 17:09:54.008065 (MainThread): Tracking: tracking
2021-05-15 17:09:54.008065 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002756FC7F748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027571EDEC08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002756FC63708>]}
2021-05-15 17:09:54.016063 (MainThread): Partial parsing not enabled
2021-05-15 17:09:54.024058 (MainThread): Parsing macros\adapters.sql
2021-05-15 17:09:54.040051 (MainThread): Parsing macros\catalog.sql
2021-05-15 17:09:54.040051 (MainThread): Parsing macros\etc.sql
2021-05-15 17:09:54.048049 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 17:09:54.048049 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 17:09:54.064041 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 17:09:54.064041 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 17:09:54.064041 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 17:09:54.072039 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 17:09:54.080035 (MainThread): Parsing macros\core.sql
2021-05-15 17:09:54.080035 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 17:09:54.120018 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 17:09:54.128015 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 17:09:54.128015 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 17:09:54.128015 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 17:09:54.136012 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 17:09:54.136012 (MainThread): Parsing macros\etc\query.sql
2021-05-15 17:09:54.136012 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 17:09:54.144010 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 17:09:54.160001 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 17:09:54.160001 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 17:09:54.167999 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 17:09:54.183991 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 17:09:54.215978 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 17:09:54.215978 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 17:09:54.231971 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 17:09:54.239968 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 17:09:54.239968 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 17:09:54.247966 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 17:09:54.247966 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 17:09:54.255962 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 17:09:54.255962 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 17:09:54.263960 (MainThread): Partial parsing not enabled
2021-05-15 17:09:54.279954 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 17:09:54.287950 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 17:09:54.295947 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 17:09:54.295947 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 17:09:54.295947 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 17:09:54.303944 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 17:09:54.311941 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 17:09:54.311941 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 17:09:54.311941 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 17:09:54.319937 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 17:09:54.319937 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 17:09:54.327934 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 17:09:54.327934 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 17:09:54.392535 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275738C6E48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275738C6E88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275738C6F48>]}
2021-05-15 17:09:54.392535 (MainThread): Flushing usage events
2021-05-15 17:09:56.124086 (MainThread): Connection 'model.northwind_shop.stg_suppliers' was properly closed.
2021-05-15 17:09:56.124086 (MainThread): Encountered an error:
2021-05-15 17:09:56.124086 (MainThread): Compilation Error in model fact_order_details (models\marts\fact_order_details.sql)
  Model 'model.northwind_shop.fact_order_details' (models\marts\fact_order_details.sql) depends on a node named 'dim_emplyees' which was not found
2021-05-15 17:09:56.132030 (MainThread): Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 444, in load_all
    manifest = loader.create_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 422, in create_manifest
    self.process_manifest(manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 388, in process_manifest
    process_refs(manifest, project_name)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 758, in process_refs
    _process_refs_for_node(manifest, current_project, node)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 742, in _process_refs_for_node
    disabled=(isinstance(target_model, Disabled))
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 487, in invalid_ref_fail_unless_test
    disabled=disabled,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 566, in ref_target_not_found
    raise_compiler_error(msg, model)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model fact_order_details (models\marts\fact_order_details.sql)
  Model 'model.northwind_shop.fact_order_details' (models\marts\fact_order_details.sql) depends on a node named 'dim_emplyees' which was not found

2021-05-15 17:10:19.663522 (MainThread): Running with dbt=0.19.1
2021-05-15 17:10:19.972432 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 17:10:19.972432 (MainThread): Tracking: tracking
2021-05-15 17:10:19.972432 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA83433FC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA83432BC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA8344FD48>]}
2021-05-15 17:10:19.980429 (MainThread): Partial parsing not enabled
2021-05-15 17:10:19.980429 (MainThread): Parsing macros\adapters.sql
2021-05-15 17:10:19.996422 (MainThread): Parsing macros\catalog.sql
2021-05-15 17:10:20.004418 (MainThread): Parsing macros\etc.sql
2021-05-15 17:10:20.004418 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 17:10:20.012415 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 17:10:20.020413 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 17:10:20.020413 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 17:10:20.028408 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 17:10:20.036406 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 17:10:20.036406 (MainThread): Parsing macros\core.sql
2021-05-15 17:10:20.044402 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 17:10:20.084385 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 17:10:20.092382 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 17:10:20.092382 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 17:10:20.092382 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 17:10:20.092382 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 17:10:20.100379 (MainThread): Parsing macros\etc\query.sql
2021-05-15 17:10:20.100379 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 17:10:20.108375 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 17:10:20.116372 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 17:10:20.124368 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 17:10:20.124368 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 17:10:20.148358 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 17:10:20.180345 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 17:10:20.180345 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 17:10:20.196338 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 17:10:20.204335 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 17:10:20.204335 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 17:10:20.212332 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 17:10:20.212332 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 17:10:20.212332 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 17:10:20.220329 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 17:10:20.220329 (MainThread): Partial parsing not enabled
2021-05-15 17:10:20.244319 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 17:10:20.252315 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 17:10:20.260312 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 17:10:20.260312 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 17:10:20.260312 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 17:10:20.268309 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 17:10:20.276306 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 17:10:20.276306 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 17:10:20.276306 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 17:10:20.284302 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 17:10:20.284302 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 17:10:20.292299 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 17:10:20.292299 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 17:10:20.365259 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 17:10:20.374757 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '087972bd-1abe-44bd-87fa-82fae55de0f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA837BA948>]}
2021-05-15 17:10:20.382903 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '087972bd-1abe-44bd-87fa-82fae55de0f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA83650508>]}
2021-05-15 17:10:20.382903 (MainThread): Found 13 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 17:10:20.382903 (MainThread): 
2021-05-15 17:10:20.382903 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 17:10:20.390961 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 17:10:20.390961 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 17:10:23.060345 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 17:10:23.060345 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 17:10:23.068313 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 17:10:24.900502 (MainThread): 14:10:24 | Concurrency: 1 threads (target='dev')
2021-05-15 17:10:24.900502 (MainThread): 14:10:24 | 
2021-05-15 17:10:24.906614 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-05-15 17:10:24.906614 (Thread-1): 14:10:24 | 1 of 1 START view model dbt_arthur.fact_order_details................ [RUN]
2021-05-15 17:10:24.906614 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 17:10:24.906614 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-05-15 17:10:24.914641 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 17:10:24.914641 (Thread-1): finished collecting timing info
2021-05-15 17:10:24.946701 (Thread-1): Writing runtime SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 17:10:24.946701 (Thread-1): Opening a new connection, currently in state init
2021-05-15 17:10:24.954672 (Thread-1): On model.northwind_shop.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`fact_order_details`
  OPTIONS()
  as with 
    customers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
    )
    , suppliers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
    )
    , shippers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
    )
    , products as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
    )
    , employees as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_employees`
    )
    , orders_with_sk as ( 
        select orders.order_id
            ,employees.employee_sk = employee_fk
            ,customers.customer_sk = customer_fk
            ,shippers.shipper_id = shipper_fk            
            ,orders.ship_region	
            ,orders.shipped_date
            ,orders.ship_country	
            ,orders.ship_name
            ,orders.order_date		
            ,orders.ship_postal_code	
            ,orders.ship_city	
            ,orders.freight	
            ,orders.required_date
            ,orders.ship_address 

        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
        left join employees on orders.employee_id = employees.employee_id
        left join customers on orders.customer_id = customers.customer_id
        left join shippers on orders.shipper_id = shippers.shipper_id
    )

select * from orders_with_sk;


2021-05-15 17:10:26.747664 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/9e0a2205-cfb5-4aaf-b79c-441e1c30ffa3?maxResults=0&location=US&prettyPrint=false: Name shipper_id not found inside orders at [41:38]')
2021-05-15 17:10:28.729520 (Thread-1): finished collecting timing info
2021-05-15 17:10:28.729520 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Name shipper_id not found inside orders at [41:38]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/650a1847-c2ad-40ef-81ef-d8702a24c811?maxResults=0&location=US&prettyPrint=false: Name shipper_id not found inside orders at [41:38]

(job ID: 650a1847-c2ad-40ef-81ef-d8702a24c811)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */
   2:
   3:
   4:  create or replace view `northwind1-313400`.`dbt_arthur`.`fact_order_details`
   5:  OPTIONS()
   6:  as with 
   7:    customers as (
   8:        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
   9:    )
  10:    , suppliers as (
  11:        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
  12:    )
  13:    , shippers as (
  14:        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
  15:    )
  16:    , products as (
  17:        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
  18:    )
  19:    , employees as (
  20:        select * from `northwind1-313400`.`dbt_arthur`.`dim_employees`
  21:    )
  22:    , orders_with_sk as ( 
  23:        select orders.order_id
  24:            ,employees.employee_sk = employee_fk
  25:            ,customers.customer_sk = customer_fk
  26:            ,shippers.shipper_id = shipper_fk            
  27:            ,orders.ship_region	
  28:            ,orders.shipped_date
  29:            ,orders.ship_country	
  30:            ,orders.ship_name
  31:            ,orders.order_date		
  32:            ,orders.ship_postal_code	
  33:            ,orders.ship_city	
  34:            ,orders.freight	
  35:            ,orders.required_date
  36:            ,orders.ship_address 
  37:
  38:        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
  39:        left join employees on orders.employee_id = employees.employee_id
  40:        left join customers on orders.customer_id = customers.customer_id
  41:        left join shippers on orders.shipper_id = shippers.shipper_id
  42:    )
  43:
  44:select * from orders_with_sk;
  45:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Name shipper_id not found inside orders at [41:38]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-05-15 17:10:28.737160 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '087972bd-1abe-44bd-87fa-82fae55de0f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA836482C8>]}
2021-05-15 17:10:28.737160 (Thread-1): 14:10:28 | 1 of 1 ERROR creating view model dbt_arthur.fact_order_details....... [ERROR in 3.83s]
2021-05-15 17:10:28.745159 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-05-15 17:10:28.826095 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 17:10:28.826095 (MainThread): 14:10:28 | 
2021-05-15 17:10:28.827180 (MainThread): 14:10:28 | Finished running 1 view model in 8.44s.
2021-05-15 17:10:28.858759 (MainThread): Connection 'master' was properly closed.
2021-05-15 17:10:28.858759 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 17:10:28.858759 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 17:10:28.858759 (MainThread): Connection 'model.northwind_shop.fact_order_details' was properly closed.
2021-05-15 17:10:28.858759 (MainThread): unclosed <socket.socket fd=428, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61017), raddr=('172.217.162.106', 443)>
2021-05-15 17:10:28.858759 (MainThread): unclosed <socket.socket fd=992, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61018), raddr=('142.250.79.202', 443)>
2021-05-15 17:10:28.858759 (MainThread): unclosed <socket.socket fd=784, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61020), raddr=('142.250.79.202', 443)>
2021-05-15 17:10:28.858759 (MainThread): unclosed <socket.socket fd=724, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61019), raddr=('172.217.162.106', 443)>
2021-05-15 17:10:28.858759 (MainThread): unclosed <socket.socket fd=1080, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61021), raddr=('172.217.162.106', 443)>
2021-05-15 17:10:28.858759 (MainThread): unclosed <socket.socket fd=1004, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61022), raddr=('142.250.79.202', 443)>
2021-05-15 17:10:28.906758 (MainThread): 
2021-05-15 17:10:28.906758 (MainThread): Completed with 1 error and 0 warnings:
2021-05-15 17:10:28.906758 (MainThread): 
2021-05-15 17:10:28.912632 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-05-15 17:10:28.912632 (MainThread):   Name shipper_id not found inside orders at [41:38]
2021-05-15 17:10:28.912632 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-05-15 17:10:28.912632 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-15 17:10:28.912632 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA833F7688>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA833F7508>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA833F7A48>]}
2021-05-15 17:10:28.912632 (MainThread): Flushing usage events
2021-05-15 17:13:50.504297 (MainThread): Running with dbt=0.19.1
2021-05-15 17:13:50.824741 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 17:13:50.824741 (MainThread): Tracking: tracking
2021-05-15 17:13:50.824741 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB47E1FC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB480FD08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB480FBC8>]}
2021-05-15 17:13:50.840737 (MainThread): Partial parsing not enabled
2021-05-15 17:13:50.840737 (MainThread): Parsing macros\adapters.sql
2021-05-15 17:13:50.856727 (MainThread): Parsing macros\catalog.sql
2021-05-15 17:13:50.864726 (MainThread): Parsing macros\etc.sql
2021-05-15 17:13:50.864726 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 17:13:50.872720 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 17:13:50.880717 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 17:13:50.888714 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 17:13:50.888714 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 17:13:50.896729 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 17:13:50.904709 (MainThread): Parsing macros\core.sql
2021-05-15 17:13:50.904709 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 17:13:50.944691 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 17:13:50.952688 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 17:13:50.952688 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 17:13:50.960684 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 17:13:50.960684 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 17:13:50.960684 (MainThread): Parsing macros\etc\query.sql
2021-05-15 17:13:50.960684 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 17:13:50.968681 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 17:13:50.984673 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 17:13:50.984673 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 17:13:50.992670 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 17:13:51.008711 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 17:13:51.047650 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 17:13:51.049701 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 17:13:51.067817 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 17:13:51.075577 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 17:13:51.079995 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 17:13:51.081003 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 17:13:51.089008 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 17:13:51.089008 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 17:13:51.089008 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 17:13:51.097007 (MainThread): Partial parsing not enabled
2021-05-15 17:13:51.113000 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 17:13:51.128994 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 17:13:51.128994 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 17:13:51.128994 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 17:13:51.136990 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 17:13:51.136990 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 17:13:51.144987 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 17:13:51.144987 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 17:13:51.152984 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 17:13:51.152984 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 17:13:51.160981 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 17:13:51.160981 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 17:13:51.168977 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 17:13:51.243186 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 17:13:51.246734 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '908152f0-3b88-4c51-8315-8c48f63a8dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB842BA88>]}
2021-05-15 17:13:51.246734 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '908152f0-3b88-4c51-8315-8c48f63a8dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB82EC248>]}
2021-05-15 17:13:51.246734 (MainThread): Found 13 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 17:13:51.254770 (MainThread): 
2021-05-15 17:13:51.254770 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 17:13:51.254770 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 17:13:51.254770 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 17:13:52.982693 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 17:13:52.983302 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 17:13:52.991323 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 17:13:55.536402 (MainThread): 14:13:55 | Concurrency: 1 threads (target='dev')
2021-05-15 17:13:55.536402 (MainThread): 14:13:55 | 
2021-05-15 17:13:55.536402 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-05-15 17:13:55.536402 (Thread-1): 14:13:55 | 1 of 1 START view model dbt_arthur.fact_order_details................ [RUN]
2021-05-15 17:13:55.544395 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 17:13:55.544395 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-05-15 17:13:55.552830 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 17:13:55.552830 (Thread-1): finished collecting timing info
2021-05-15 17:13:55.584889 (Thread-1): Writing runtime SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 17:13:55.584889 (Thread-1): Opening a new connection, currently in state init
2021-05-15 17:13:55.592137 (Thread-1): On model.northwind_shop.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`fact_order_details`
  OPTIONS()
  as with 
    customers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
    )
    , suppliers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
    )
    , shippers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
    )
    , products as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
    )
    , employees as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_employees`
    )
    , orders_with_sk as ( 
        select orders.order_id
            ,employees.employee_sk = employee_fk
            ,customers.customer_sk = customer_fk
            ,shippers.ship_id = shipper_fk            
            ,orders.ship_region	
            ,orders.shipped_date
            ,orders.ship_country	
            ,orders.ship_name
            ,orders.order_date		
            ,orders.ship_postal_code	
            ,orders.ship_city	
            ,orders.freight	
            ,orders.required_date
            ,orders.ship_address 

        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
        left join employees on orders.employee_id = employees.employee_id
        left join customers on orders.customer_id = customers.customer_id
        left join shippers on orders.shipper_id = shippers.shipper_id
    )

select * from orders_with_sk;


2021-05-15 17:13:58.951622 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/7754fdb2-c6fd-4acb-88dd-f113e91ea098?maxResults=0&location=US&prettyPrint=false: Name shipper_id not found inside orders at [41:38]')
2021-05-15 17:14:00.247912 (Thread-1): finished collecting timing info
2021-05-15 17:14:00.247912 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Name shipper_id not found inside orders at [41:38]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/829a7e9a-86a1-494e-a451-163262149207?maxResults=0&location=US&prettyPrint=false: Name shipper_id not found inside orders at [41:38]

(job ID: 829a7e9a-86a1-494e-a451-163262149207)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */
   2:
   3:
   4:  create or replace view `northwind1-313400`.`dbt_arthur`.`fact_order_details`
   5:  OPTIONS()
   6:  as with 
   7:    customers as (
   8:        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
   9:    )
  10:    , suppliers as (
  11:        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
  12:    )
  13:    , shippers as (
  14:        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
  15:    )
  16:    , products as (
  17:        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
  18:    )
  19:    , employees as (
  20:        select * from `northwind1-313400`.`dbt_arthur`.`dim_employees`
  21:    )
  22:    , orders_with_sk as ( 
  23:        select orders.order_id
  24:            ,employees.employee_sk = employee_fk
  25:            ,customers.customer_sk = customer_fk
  26:            ,shippers.ship_id = shipper_fk            
  27:            ,orders.ship_region	
  28:            ,orders.shipped_date
  29:            ,orders.ship_country	
  30:            ,orders.ship_name
  31:            ,orders.order_date		
  32:            ,orders.ship_postal_code	
  33:            ,orders.ship_city	
  34:            ,orders.freight	
  35:            ,orders.required_date
  36:            ,orders.ship_address 
  37:
  38:        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
  39:        left join employees on orders.employee_id = employees.employee_id
  40:        left join customers on orders.customer_id = customers.customer_id
  41:        left join shippers on orders.shipper_id = shippers.shipper_id
  42:    )
  43:
  44:select * from orders_with_sk;
  45:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Name shipper_id not found inside orders at [41:38]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-05-15 17:14:00.255915 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '908152f0-3b88-4c51-8315-8c48f63a8dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB8383048>]}
2021-05-15 17:14:00.255915 (Thread-1): 14:14:00 | 1 of 1 ERROR creating view model dbt_arthur.fact_order_details....... [ERROR in 4.71s]
2021-05-15 17:14:00.263912 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-05-15 17:14:00.327595 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 17:14:00.327595 (MainThread): 14:14:00 | 
2021-05-15 17:14:00.327595 (MainThread): 14:14:00 | Finished running 1 view model in 9.07s.
2021-05-15 17:14:00.331013 (MainThread): Connection 'master' was properly closed.
2021-05-15 17:14:00.331421 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 17:14:00.331421 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 17:14:00.331421 (MainThread): Connection 'model.northwind_shop.fact_order_details' was properly closed.
2021-05-15 17:14:00.331421 (MainThread): unclosed <socket.socket fd=948, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61035), raddr=('216.58.202.170', 443)>
2021-05-15 17:14:00.331421 (MainThread): unclosed <socket.socket fd=1012, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61036), raddr=('142.250.79.202', 443)>
2021-05-15 17:14:00.331421 (MainThread): unclosed <socket.socket fd=784, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61038), raddr=('142.250.79.202', 443)>
2021-05-15 17:14:00.331421 (MainThread): unclosed <socket.socket fd=1080, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61037), raddr=('216.58.202.170', 443)>
2021-05-15 17:14:00.331421 (MainThread): unclosed <socket.socket fd=440, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61039), raddr=('216.58.202.170', 443)>
2021-05-15 17:14:00.331421 (MainThread): unclosed <socket.socket fd=436, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61040), raddr=('142.250.79.202', 443)>
2021-05-15 17:14:00.382949 (MainThread): 
2021-05-15 17:14:00.382949 (MainThread): Completed with 1 error and 0 warnings:
2021-05-15 17:14:00.382949 (MainThread): 
2021-05-15 17:14:00.382949 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-05-15 17:14:00.382949 (MainThread):   Name shipper_id not found inside orders at [41:38]
2021-05-15 17:14:00.382949 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-05-15 17:14:00.382949 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-15 17:14:00.389521 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB47B6708>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB47B6588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB47B6A08>]}
2021-05-15 17:14:00.389584 (MainThread): Flushing usage events
2021-05-15 17:15:14.930356 (MainThread): Running with dbt=0.19.1
2021-05-15 17:15:15.290160 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 17:15:15.290160 (MainThread): Tracking: tracking
2021-05-15 17:15:15.290160 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002034BD82E48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002034BDB13C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002034BDB8148>]}
2021-05-15 17:15:15.298157 (MainThread): Partial parsing not enabled
2021-05-15 17:15:15.298157 (MainThread): Parsing macros\adapters.sql
2021-05-15 17:15:15.314150 (MainThread): Parsing macros\catalog.sql
2021-05-15 17:15:15.322146 (MainThread): Parsing macros\etc.sql
2021-05-15 17:15:15.322146 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 17:15:15.330143 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 17:15:15.338140 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 17:15:15.338140 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 17:15:15.346136 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 17:15:15.354133 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 17:15:15.362130 (MainThread): Parsing macros\core.sql
2021-05-15 17:15:15.362130 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 17:15:15.402112 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 17:15:15.410110 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 17:15:15.410110 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 17:15:15.410110 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 17:15:15.418106 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 17:15:15.418106 (MainThread): Parsing macros\etc\query.sql
2021-05-15 17:15:15.418106 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 17:15:15.426102 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 17:15:15.442096 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 17:15:15.442096 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 17:15:15.450093 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 17:15:15.466086 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 17:15:15.498073 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 17:15:15.498073 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 17:15:15.514066 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 17:15:15.522063 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 17:15:15.522063 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 17:15:15.530059 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 17:15:15.530059 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 17:15:15.539971 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 17:15:15.543824 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 17:15:15.553799 (MainThread): Partial parsing not enabled
2021-05-15 17:15:15.574244 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 17:15:15.583575 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 17:15:15.585596 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 17:15:15.585596 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 17:15:15.593690 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 17:15:15.593690 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 17:15:15.601749 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 17:15:15.609746 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 17:15:15.609746 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 17:15:15.609746 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 17:15:15.617742 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 17:15:15.617742 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 17:15:15.625739 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 17:15:15.711026 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 17:15:15.716318 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '496b21c9-2d36-42f6-b5da-5d89a8d3e9eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002034F90AA08>]}
2021-05-15 17:15:15.716318 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '496b21c9-2d36-42f6-b5da-5d89a8d3e9eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002034F7EF488>]}
2021-05-15 17:15:15.716318 (MainThread): Found 13 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 17:15:15.724493 (MainThread): 
2021-05-15 17:15:15.724493 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 17:15:15.724493 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 17:15:15.724493 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 17:15:18.778091 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 17:15:18.778091 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 17:15:18.786090 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 17:15:20.259272 (MainThread): 14:15:20 | Concurrency: 1 threads (target='dev')
2021-05-15 17:15:20.259272 (MainThread): 14:15:20 | 
2021-05-15 17:15:20.267761 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-05-15 17:15:20.267761 (Thread-1): 14:15:20 | 1 of 1 START view model dbt_arthur.fact_order_details................ [RUN]
2021-05-15 17:15:20.267761 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 17:15:20.267761 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-05-15 17:15:20.275764 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 17:15:20.281266 (Thread-1): finished collecting timing info
2021-05-15 17:15:20.313300 (Thread-1): Writing runtime SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 17:15:20.313300 (Thread-1): Opening a new connection, currently in state init
2021-05-15 17:15:20.313300 (Thread-1): On model.northwind_shop.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`fact_order_details`
  OPTIONS()
  as with 
    customers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
    )
    , suppliers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
    )
    , shippers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
    )
    , products as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
    )
    , employees as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_employees`
    )
    , orders_with_sk as ( 
        select orders.order_id
            ,employees.employee_sk = employee_fk
            ,customers.customer_sk = customer_fk
            ,shippers.ship_id = shipper_fk            
            ,orders.ship_region	
            ,orders.shipped_date
            ,orders.ship_country	
            ,orders.ship_name
            ,orders.order_date		
            ,orders.ship_postal_code	
            ,orders.ship_city	
            ,orders.freight	
            ,orders.required_date
            ,orders.ship_address 

        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
        left join employees on orders.employee_id = employees.employee_id
        left join customers on orders.customer_id = customers.customer_id
        left join shippers on orders.ship_id = shippers.shipper_id
    )

select * from orders_with_sk;


2021-05-15 17:15:23.495306 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/1adfdfbb-174c-430b-a871-0c7561fab90f?maxResults=0&location=US&prettyPrint=false: Unrecognized name: employee_fk; Did you mean employee_sk? at [24:38]')
2021-05-15 17:15:25.483404 (Thread-1): finished collecting timing info
2021-05-15 17:15:25.483404 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Unrecognized name: employee_fk; Did you mean employee_sk? at [24:38]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/3d392275-a97b-4cce-917e-efdbf5ec474c?maxResults=0&location=US&prettyPrint=false: Unrecognized name: employee_fk; Did you mean employee_sk? at [24:38]

(job ID: 3d392275-a97b-4cce-917e-efdbf5ec474c)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */
   2:
   3:
   4:  create or replace view `northwind1-313400`.`dbt_arthur`.`fact_order_details`
   5:  OPTIONS()
   6:  as with 
   7:    customers as (
   8:        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
   9:    )
  10:    , suppliers as (
  11:        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
  12:    )
  13:    , shippers as (
  14:        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
  15:    )
  16:    , products as (
  17:        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
  18:    )
  19:    , employees as (
  20:        select * from `northwind1-313400`.`dbt_arthur`.`dim_employees`
  21:    )
  22:    , orders_with_sk as ( 
  23:        select orders.order_id
  24:            ,employees.employee_sk = employee_fk
  25:            ,customers.customer_sk = customer_fk
  26:            ,shippers.ship_id = shipper_fk            
  27:            ,orders.ship_region	
  28:            ,orders.shipped_date
  29:            ,orders.ship_country	
  30:            ,orders.ship_name
  31:            ,orders.order_date		
  32:            ,orders.ship_postal_code	
  33:            ,orders.ship_city	
  34:            ,orders.freight	
  35:            ,orders.required_date
  36:            ,orders.ship_address 
  37:
  38:        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
  39:        left join employees on orders.employee_id = employees.employee_id
  40:        left join customers on orders.customer_id = customers.customer_id
  41:        left join shippers on orders.ship_id = shippers.shipper_id
  42:    )
  43:
  44:select * from orders_with_sk;
  45:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Unrecognized name: employee_fk; Did you mean employee_sk? at [24:38]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-05-15 17:15:25.491408 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '496b21c9-2d36-42f6-b5da-5d89a8d3e9eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002034F89ABC8>]}
2021-05-15 17:15:25.491408 (Thread-1): 14:15:25 | 1 of 1 ERROR creating view model dbt_arthur.fact_order_details....... [ERROR in 5.22s]
2021-05-15 17:15:25.499404 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-05-15 17:15:25.573091 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 17:15:25.574118 (MainThread): 14:15:25 | 
2021-05-15 17:15:25.574118 (MainThread): 14:15:25 | Finished running 1 view model in 9.85s.
2021-05-15 17:15:25.575743 (MainThread): Connection 'master' was properly closed.
2021-05-15 17:15:25.575743 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 17:15:25.576241 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 17:15:25.576241 (MainThread): Connection 'model.northwind_shop.fact_order_details' was properly closed.
2021-05-15 17:15:25.578853 (MainThread): unclosed <socket.socket fd=1012, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61052), raddr=('216.58.202.170', 443)>
2021-05-15 17:15:25.579906 (MainThread): unclosed <socket.socket fd=664, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61053), raddr=('142.250.79.202', 443)>
2021-05-15 17:15:25.580135 (MainThread): unclosed <socket.socket fd=980, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61055), raddr=('142.250.79.202', 443)>
2021-05-15 17:15:25.580135 (MainThread): unclosed <socket.socket fd=760, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61054), raddr=('216.58.202.170', 443)>
2021-05-15 17:15:25.580135 (MainThread): unclosed <socket.socket fd=920, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61056), raddr=('216.58.202.170', 443)>
2021-05-15 17:15:25.581138 (MainThread): unclosed <socket.socket fd=852, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61057), raddr=('142.250.79.202', 443)>
2021-05-15 17:15:25.622079 (MainThread): 
2021-05-15 17:15:25.622079 (MainThread): Completed with 1 error and 0 warnings:
2021-05-15 17:15:25.622079 (MainThread): 
2021-05-15 17:15:25.622079 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-05-15 17:15:25.622079 (MainThread):   Unrecognized name: employee_fk; Did you mean employee_sk? at [24:38]
2021-05-15 17:15:25.630756 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-05-15 17:15:25.631255 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-15 17:15:25.633014 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002034BD61F48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002034BD61F08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002034BD61B88>]}
2021-05-15 17:15:25.633536 (MainThread): Flushing usage events
2021-05-15 17:19:22.670877 (MainThread): Running with dbt=0.19.1
2021-05-15 17:19:23.003954 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_employees'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 17:19:23.003954 (MainThread): Tracking: tracking
2021-05-15 17:19:23.003954 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B48883D08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B488530C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B47F5CA48>]}
2021-05-15 17:19:23.011951 (MainThread): Partial parsing not enabled
2021-05-15 17:19:23.011951 (MainThread): Parsing macros\adapters.sql
2021-05-15 17:19:23.035941 (MainThread): Parsing macros\catalog.sql
2021-05-15 17:19:23.035941 (MainThread): Parsing macros\etc.sql
2021-05-15 17:19:23.043938 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 17:19:23.043938 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 17:19:23.051934 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 17:19:23.059931 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 17:19:23.059931 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 17:19:23.067928 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 17:19:23.075925 (MainThread): Parsing macros\core.sql
2021-05-15 17:19:23.075925 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 17:19:23.120185 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 17:19:23.129447 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 17:19:23.130467 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 17:19:23.132505 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 17:19:23.134555 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 17:19:23.135574 (MainThread): Parsing macros\etc\query.sql
2021-05-15 17:19:23.136592 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 17:19:23.143709 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 17:19:23.151710 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 17:19:23.159708 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 17:19:23.159708 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 17:19:23.183697 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 17:19:23.207687 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 17:19:23.215683 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 17:19:23.231676 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 17:19:23.231676 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 17:19:23.239675 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 17:19:23.248771 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 17:19:23.248771 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 17:19:23.248771 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 17:19:23.248771 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 17:19:23.256773 (MainThread): Partial parsing not enabled
2021-05-15 17:19:23.280765 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 17:19:23.288760 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 17:19:23.296757 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 17:19:23.296757 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 17:19:23.296757 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 17:19:23.304754 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 17:19:23.312750 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 17:19:23.312750 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 17:19:23.312750 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 17:19:23.320747 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 17:19:23.320747 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 17:19:23.328744 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 17:19:23.328744 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 17:19:23.400713 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 17:19:23.409639 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0d26a89-0e58-4978-ac70-c5797bf69b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B4C49BA48>]}
2021-05-15 17:19:23.409639 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0d26a89-0e58-4978-ac70-c5797bf69b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B4C3426C8>]}
2021-05-15 17:19:23.409639 (MainThread): Found 13 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 17:19:23.417856 (MainThread): 
2021-05-15 17:19:23.417856 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 17:19:23.417856 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 17:19:23.417856 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 17:19:25.711782 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 17:19:25.711782 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 17:19:25.726946 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 17:19:27.923369 (MainThread): 14:19:27 | Concurrency: 1 threads (target='dev')
2021-05-15 17:19:27.923369 (MainThread): 14:19:27 | 
2021-05-15 17:19:27.928955 (Thread-1): Began running node model.northwind_shop.dim_employees
2021-05-15 17:19:27.928955 (Thread-1): 14:19:27 | 1 of 1 START view model dbt_arthur.dim_employees..................... [RUN]
2021-05-15 17:19:27.928955 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 17:19:27.928955 (Thread-1): Compiling model.northwind_shop.dim_employees
2021-05-15 17:19:27.936969 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_employees"
2021-05-15 17:19:27.938207 (Thread-1): finished collecting timing info
2021-05-15 17:19:27.970754 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_employees"
2021-05-15 17:19:27.970754 (Thread-1): Opening a new connection, currently in state init
2021-05-15 17:19:27.970754 (Thread-1): On model.northwind_shop.dim_employees: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.dim_employees"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`dim_employees`
  OPTIONS()
  as with
    selected as (
        select 
           /*primary key*/
            employee_id	
            ,country	
            ,city	
            ,postal_code
            ,hire_date	
            ,extension	
            ,address	
            ,birth_date	
            ,region	
            ,photo_path	
            ,last_name	
            ,first_name	
            ,title	
            ,title_of_courtesy	
            ,notes	
            ,home_phone	
            ,reports_to	
        from `northwind1-313400`.`dbt_arthur`.`stg_employees`
    )
    , transformed as (
        select 
        row_number() over (order by employee_id) as employee_sk
        , *
        from selected
    )

select * from transformed;


2021-05-15 17:19:31.923585 (Thread-1): finished collecting timing info
2021-05-15 17:19:31.923585 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0d26a89-0e58-4978-ac70-c5797bf69b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B4C3E07C8>]}
2021-05-15 17:19:31.923585 (Thread-1): 14:19:31 | 1 of 1 OK created view model dbt_arthur.dim_employees................ [OK in 3.99s]
2021-05-15 17:19:31.923585 (Thread-1): Finished running node model.northwind_shop.dim_employees
2021-05-15 17:19:31.999375 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 17:19:32.000430 (MainThread): 14:19:31 | 
2021-05-15 17:19:32.000454 (MainThread): 14:19:32 | Finished running 1 view model in 8.58s.
2021-05-15 17:19:32.001480 (MainThread): Connection 'master' was properly closed.
2021-05-15 17:19:32.002254 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 17:19:32.002793 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 17:19:32.002793 (MainThread): Connection 'model.northwind_shop.dim_employees' was properly closed.
2021-05-15 17:19:32.004333 (MainThread): unclosed <socket.socket fd=1040, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61074), raddr=('142.250.79.202', 443)>
2021-05-15 17:19:32.004333 (MainThread): unclosed <socket.socket fd=1068, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61075), raddr=('142.250.79.202', 443)>
2021-05-15 17:19:32.004333 (MainThread): unclosed <socket.socket fd=1124, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61077), raddr=('142.250.79.202', 443)>
2021-05-15 17:19:32.004333 (MainThread): unclosed <socket.socket fd=792, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61076), raddr=('142.250.79.202', 443)>
2021-05-15 17:19:32.004333 (MainThread): unclosed <socket.socket fd=800, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61078), raddr=('142.250.79.202', 443)>
2021-05-15 17:19:32.004333 (MainThread): unclosed <socket.socket fd=1196, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61079), raddr=('142.250.79.202', 443)>
2021-05-15 17:19:32.044328 (MainThread): 
2021-05-15 17:19:32.044328 (MainThread): Completed successfully
2021-05-15 17:19:32.052320 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-15 17:19:32.052320 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B48830F88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B48830F08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B48830508>]}
2021-05-15 17:19:32.054399 (MainThread): Flushing usage events
2021-05-15 17:23:45.790255 (MainThread): Running with dbt=0.19.1
2021-05-15 17:23:46.176901 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 17:23:46.176901 (MainThread): Tracking: tracking
2021-05-15 17:23:46.176901 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020634A3FC88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020634A3FE88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020634A46488>]}
2021-05-15 17:23:46.184897 (MainThread): Partial parsing not enabled
2021-05-15 17:23:46.184897 (MainThread): Parsing macros\adapters.sql
2021-05-15 17:23:46.208886 (MainThread): Parsing macros\catalog.sql
2021-05-15 17:23:46.208886 (MainThread): Parsing macros\etc.sql
2021-05-15 17:23:46.216883 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 17:23:46.216883 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 17:23:46.232876 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 17:23:46.232876 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 17:23:46.232876 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 17:23:46.240873 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 17:23:46.248869 (MainThread): Parsing macros\core.sql
2021-05-15 17:23:46.248869 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 17:23:46.288852 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 17:23:46.296850 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 17:23:46.296850 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 17:23:46.296850 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 17:23:46.304846 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 17:23:46.304846 (MainThread): Parsing macros\etc\query.sql
2021-05-15 17:23:46.304846 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 17:23:46.312842 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 17:23:46.328837 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 17:23:46.328837 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 17:23:46.336833 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 17:23:46.360823 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 17:23:46.386760 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 17:23:46.386760 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 17:23:46.402753 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 17:23:46.410750 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 17:23:46.418747 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 17:23:46.426743 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 17:23:46.426743 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 17:23:46.426743 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 17:23:46.426743 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 17:23:46.434740 (MainThread): Partial parsing not enabled
2021-05-15 17:23:46.458730 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 17:23:46.466727 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 17:23:46.474724 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 17:23:46.474724 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 17:23:46.482721 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 17:23:46.482721 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 17:23:46.490718 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 17:23:46.490718 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 17:23:46.498714 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 17:23:46.498714 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 17:23:46.506711 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 17:23:46.506711 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 17:23:46.514708 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 17:23:46.610667 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 17:23:46.614656 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fe0bcc9-1599-4b31-b489-18776d0598fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020638681D48>]}
2021-05-15 17:23:46.622074 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fe0bcc9-1599-4b31-b489-18776d0598fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206384F4D88>]}
2021-05-15 17:23:46.622074 (MainThread): Found 13 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 17:23:46.625856 (MainThread): 
2021-05-15 17:23:46.629138 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 17:23:46.629138 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 17:23:46.629138 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 17:23:48.410665 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 17:23:48.411163 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 17:23:48.417750 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 17:23:49.634337 (MainThread): 14:23:49 | Concurrency: 1 threads (target='dev')
2021-05-15 17:23:49.635681 (MainThread): 14:23:49 | 
2021-05-15 17:23:49.641413 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-05-15 17:23:49.642494 (Thread-1): 14:23:49 | 1 of 1 START view model dbt_arthur.fact_order_details................ [RUN]
2021-05-15 17:23:49.644580 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 17:23:49.644580 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-05-15 17:23:49.651358 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 17:23:49.652688 (Thread-1): finished collecting timing info
2021-05-15 17:23:49.697743 (Thread-1): Writing runtime SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 17:23:49.703253 (Thread-1): Opening a new connection, currently in state init
2021-05-15 17:23:49.703253 (Thread-1): On model.northwind_shop.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`fact_order_details`
  OPTIONS()
  as with 
    customers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
    )
    , suppliers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
    )
    , shippers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
    )
    , products as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
    )
    , employees as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_employees`
    )
    , orders_with_sk as ( 
        select orders.order_id
            ,employees.employee_sk = employee_fk
            ,customers.customer_sk = customer_fk
            ,shippers.ship_id = shipper_fk            
            ,orders.ship_region	
            ,orders.shipped_date
            ,orders.ship_country	
            ,orders.ship_name
            ,orders.order_date		
            ,orders.ship_postal_code	
            ,orders.ship_city	
            ,orders.freight	
            ,orders.required_date
            ,orders.ship_address 

        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
        left join employees on orders.employee_id = employees.employee_id
        left join customers on orders.customer_id = customers.customer_id
        left join shippers on orders.ship_id = shippers.shipper_id
    )

select * from orders_with_sk;


2021-05-15 17:23:51.452866 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/b9c819d4-5b1d-435c-bb6c-f5544a12a394?maxResults=0&location=US&prettyPrint=false: Unrecognized name: employee_fk; Did you mean employee_sk? at [24:38]')
2021-05-15 17:23:53.477454 (Thread-1): finished collecting timing info
2021-05-15 17:23:53.477560 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Unrecognized name: employee_fk; Did you mean employee_sk? at [24:38]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/ef38369e-062c-4a62-ba0e-b62f9e95bbae?maxResults=0&location=US&prettyPrint=false: Unrecognized name: employee_fk; Did you mean employee_sk? at [24:38]

(job ID: ef38369e-062c-4a62-ba0e-b62f9e95bbae)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */
   2:
   3:
   4:  create or replace view `northwind1-313400`.`dbt_arthur`.`fact_order_details`
   5:  OPTIONS()
   6:  as with 
   7:    customers as (
   8:        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
   9:    )
  10:    , suppliers as (
  11:        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
  12:    )
  13:    , shippers as (
  14:        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
  15:    )
  16:    , products as (
  17:        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
  18:    )
  19:    , employees as (
  20:        select * from `northwind1-313400`.`dbt_arthur`.`dim_employees`
  21:    )
  22:    , orders_with_sk as ( 
  23:        select orders.order_id
  24:            ,employees.employee_sk = employee_fk
  25:            ,customers.customer_sk = customer_fk
  26:            ,shippers.ship_id = shipper_fk            
  27:            ,orders.ship_region	
  28:            ,orders.shipped_date
  29:            ,orders.ship_country	
  30:            ,orders.ship_name
  31:            ,orders.order_date		
  32:            ,orders.ship_postal_code	
  33:            ,orders.ship_city	
  34:            ,orders.freight	
  35:            ,orders.required_date
  36:            ,orders.ship_address 
  37:
  38:        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
  39:        left join employees on orders.employee_id = employees.employee_id
  40:        left join customers on orders.customer_id = customers.customer_id
  41:        left join shippers on orders.ship_id = shippers.shipper_id
  42:    )
  43:
  44:select * from orders_with_sk;
  45:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Unrecognized name: employee_fk; Did you mean employee_sk? at [24:38]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-05-15 17:23:53.483953 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fe0bcc9-1599-4b31-b489-18776d0598fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206384DF1C8>]}
2021-05-15 17:23:53.483953 (Thread-1): 14:23:53 | 1 of 1 ERROR creating view model dbt_arthur.fact_order_details....... [ERROR in 3.84s]
2021-05-15 17:23:53.486202 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-05-15 17:23:53.543447 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 17:23:53.543447 (MainThread): 14:23:53 | 
2021-05-15 17:23:53.543447 (MainThread): 14:23:53 | Finished running 1 view model in 6.92s.
2021-05-15 17:23:53.543447 (MainThread): Connection 'master' was properly closed.
2021-05-15 17:23:53.543447 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 17:23:53.543447 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 17:23:53.543447 (MainThread): Connection 'model.northwind_shop.fact_order_details' was properly closed.
2021-05-15 17:23:53.543447 (MainThread): unclosed <socket.socket fd=1008, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61136), raddr=('142.250.79.202', 443)>
2021-05-15 17:23:53.543447 (MainThread): unclosed <socket.socket fd=452, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61137), raddr=('142.250.79.202', 443)>
2021-05-15 17:23:53.543447 (MainThread): unclosed <socket.socket fd=1072, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61139), raddr=('142.250.79.202', 443)>
2021-05-15 17:23:53.543447 (MainThread): unclosed <socket.socket fd=1060, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61138), raddr=('142.250.79.202', 443)>
2021-05-15 17:23:53.543447 (MainThread): unclosed <socket.socket fd=1156, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61141), raddr=('142.250.79.202', 443)>
2021-05-15 17:23:53.543447 (MainThread): unclosed <socket.socket fd=992, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61142), raddr=('142.250.79.202', 443)>
2021-05-15 17:23:53.607524 (MainThread): 
2021-05-15 17:23:53.608496 (MainThread): Completed with 1 error and 0 warnings:
2021-05-15 17:23:53.609556 (MainThread): 
2021-05-15 17:23:53.609556 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-05-15 17:23:53.609556 (MainThread):   Unrecognized name: employee_fk; Did you mean employee_sk? at [24:38]
2021-05-15 17:23:53.611818 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-05-15 17:23:53.612316 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-15 17:23:53.613936 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206349E5748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206349E5708>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206349E5A88>]}
2021-05-15 17:23:53.613936 (MainThread): Flushing usage events
2021-05-15 17:27:44.393463 (MainThread): Running with dbt=0.19.1
2021-05-15 17:27:44.727895 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 17:27:44.727895 (MainThread): Tracking: tracking
2021-05-15 17:27:44.727895 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC365DFDC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC365DF048>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC365E65C8>]}
2021-05-15 17:27:44.735634 (MainThread): Partial parsing not enabled
2021-05-15 17:27:44.735634 (MainThread): Parsing macros\adapters.sql
2021-05-15 17:27:44.759531 (MainThread): Parsing macros\catalog.sql
2021-05-15 17:27:44.767570 (MainThread): Parsing macros\etc.sql
2021-05-15 17:27:44.767570 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 17:27:44.767570 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 17:27:44.783122 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 17:27:44.783122 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 17:27:44.791170 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 17:27:44.799167 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 17:27:44.799167 (MainThread): Parsing macros\core.sql
2021-05-15 17:27:44.807164 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 17:27:44.847153 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 17:27:44.855150 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 17:27:44.855150 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 17:27:44.855150 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 17:27:44.855150 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 17:27:44.863144 (MainThread): Parsing macros\etc\query.sql
2021-05-15 17:27:44.863144 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 17:27:44.871144 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 17:27:44.887131 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 17:27:44.887131 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 17:27:44.895127 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 17:27:44.911119 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 17:27:44.943106 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 17:27:44.943106 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 17:27:44.959099 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 17:27:44.967096 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 17:27:44.975093 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 17:27:44.975093 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 17:27:44.983090 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 17:27:44.983090 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 17:27:44.983090 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 17:27:44.991086 (MainThread): Partial parsing not enabled
2021-05-15 17:27:45.007081 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 17:27:45.023300 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 17:27:45.023300 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 17:27:45.031297 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 17:27:45.031297 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 17:27:45.031297 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 17:27:45.039293 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 17:27:45.039293 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 17:27:45.047290 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 17:27:45.047290 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 17:27:45.055286 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 17:27:45.055286 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 17:27:45.063283 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 17:27:45.135178 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 17:27:45.142103 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9de4ae5a-63b2-4c5a-9d72-025064d91cbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC3A16FD08>]}
2021-05-15 17:27:45.142103 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9de4ae5a-63b2-4c5a-9d72-025064d91cbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC3A0847C8>]}
2021-05-15 17:27:45.142103 (MainThread): Found 13 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 17:27:45.151381 (MainThread): 
2021-05-15 17:27:45.151381 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 17:27:45.151381 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 17:27:45.151381 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 17:27:49.687045 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 17:27:49.687045 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 17:27:49.705003 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 17:27:51.115903 (MainThread): 14:27:51 | Concurrency: 1 threads (target='dev')
2021-05-15 17:27:51.115903 (MainThread): 14:27:51 | 
2021-05-15 17:27:51.123907 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-05-15 17:27:51.123907 (Thread-1): 14:27:51 | 1 of 1 START view model dbt_arthur.fact_order_details................ [RUN]
2021-05-15 17:27:51.123907 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 17:27:51.123907 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-05-15 17:27:51.131903 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 17:27:51.131903 (Thread-1): finished collecting timing info
2021-05-15 17:27:51.163942 (Thread-1): Writing runtime SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 17:27:51.163942 (Thread-1): Opening a new connection, currently in state init
2021-05-15 17:27:51.171921 (Thread-1): On model.northwind_shop.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`fact_order_details`
  OPTIONS()
  as with 
    customers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
    )
    , suppliers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
    )
    , shippers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
    )
    , products as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
    )
    , employees as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_employees`
    )
    , orders_with_sk as ( 
        select 
            orders.order_id
            ,employees.employee_sk = employee_fk
            ,customers.customer_sk = customer_fk
            ,shippers.ship_id = shipper_fk            
            ,orders.ship_region	
            ,orders.shipped_date
            ,orders.ship_country	
            ,orders.ship_name
            ,orders.order_date		
            ,orders.ship_postal_code	
            ,orders.ship_city	
            ,orders.freight	
            ,orders.required_date
            ,orders.ship_address 

        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
        left join employees on orders.employee_id = employees.employee_id
        left join customers on orders.customer_id = customers.customer_id
        left join shippers on orders.ship_id = shippers.shipper_id
    )

select * from orders_with_sk;


2021-05-15 17:27:52.993299 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/e0b84370-528c-469d-bc02-201ad19ae173?maxResults=0&location=US&prettyPrint=false: Unrecognized name: employee_fk; Did you mean employee_sk? at [25:38]')
2021-05-15 17:27:54.904784 (Thread-1): finished collecting timing info
2021-05-15 17:27:54.904784 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Unrecognized name: employee_fk; Did you mean employee_sk? at [25:38]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/c4bb6df6-c66a-4cf5-8c80-1acd71797396?maxResults=0&location=US&prettyPrint=false: Unrecognized name: employee_fk; Did you mean employee_sk? at [25:38]

(job ID: c4bb6df6-c66a-4cf5-8c80-1acd71797396)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */
   2:
   3:
   4:  create or replace view `northwind1-313400`.`dbt_arthur`.`fact_order_details`
   5:  OPTIONS()
   6:  as with 
   7:    customers as (
   8:        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
   9:    )
  10:    , suppliers as (
  11:        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
  12:    )
  13:    , shippers as (
  14:        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
  15:    )
  16:    , products as (
  17:        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
  18:    )
  19:    , employees as (
  20:        select * from `northwind1-313400`.`dbt_arthur`.`dim_employees`
  21:    )
  22:    , orders_with_sk as ( 
  23:        select 
  24:            orders.order_id
  25:            ,employees.employee_sk = employee_fk
  26:            ,customers.customer_sk = customer_fk
  27:            ,shippers.ship_id = shipper_fk            
  28:            ,orders.ship_region	
  29:            ,orders.shipped_date
  30:            ,orders.ship_country	
  31:            ,orders.ship_name
  32:            ,orders.order_date		
  33:            ,orders.ship_postal_code	
  34:            ,orders.ship_city	
  35:            ,orders.freight	
  36:            ,orders.required_date
  37:            ,orders.ship_address 
  38:
  39:        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
  40:        left join employees on orders.employee_id = employees.employee_id
  41:        left join customers on orders.customer_id = customers.customer_id
  42:        left join shippers on orders.ship_id = shippers.shipper_id
  43:    )
  44:
  45:select * from orders_with_sk;
  46:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Unrecognized name: employee_fk; Did you mean employee_sk? at [25:38]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-05-15 17:27:54.913918 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9de4ae5a-63b2-4c5a-9d72-025064d91cbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC3A0F0E48>]}
2021-05-15 17:27:54.914935 (Thread-1): 14:27:54 | 1 of 1 ERROR creating view model dbt_arthur.fact_order_details....... [ERROR in 3.79s]
2021-05-15 17:27:54.916020 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-05-15 17:27:55.002975 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 17:27:55.002975 (MainThread): 14:27:55 | 
2021-05-15 17:27:55.002975 (MainThread): 14:27:55 | Finished running 1 view model in 9.85s.
2021-05-15 17:27:55.006766 (MainThread): Connection 'master' was properly closed.
2021-05-15 17:27:55.006766 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 17:27:55.006766 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 17:27:55.006766 (MainThread): Connection 'model.northwind_shop.fact_order_details' was properly closed.
2021-05-15 17:27:55.006766 (MainThread): unclosed <socket.socket fd=988, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61176), raddr=('172.217.162.202', 443)>
2021-05-15 17:27:55.006766 (MainThread): unclosed <socket.socket fd=808, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61178), raddr=('142.250.79.202', 443)>
2021-05-15 17:27:55.006766 (MainThread): unclosed <socket.socket fd=1048, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61181), raddr=('142.250.79.202', 443)>
2021-05-15 17:27:55.006766 (MainThread): unclosed <socket.socket fd=1040, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61180), raddr=('172.217.162.202', 443)>
2021-05-15 17:27:55.006766 (MainThread): unclosed <socket.socket fd=700, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61182), raddr=('172.217.162.202', 443)>
2021-05-15 17:27:55.006766 (MainThread): unclosed <socket.socket fd=1084, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61183), raddr=('142.250.79.202', 443)>
2021-05-15 17:27:55.056423 (MainThread): 
2021-05-15 17:27:55.056423 (MainThread): Completed with 1 error and 0 warnings:
2021-05-15 17:27:55.056423 (MainThread): 
2021-05-15 17:27:55.060526 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-05-15 17:27:55.060526 (MainThread):   Unrecognized name: employee_fk; Did you mean employee_sk? at [25:38]
2021-05-15 17:27:55.060526 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-05-15 17:27:55.060526 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-15 17:27:55.060526 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC365875C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC36587688>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC36587C08>]}
2021-05-15 17:27:55.064865 (MainThread): Flushing usage events
2021-05-15 17:31:26.949955 (MainThread): Running with dbt=0.19.1
2021-05-15 17:31:27.259665 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 17:31:27.259665 (MainThread): Tracking: tracking
2021-05-15 17:31:27.259665 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FCD850F08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FCD873C88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FCD873B48>]}
2021-05-15 17:31:27.267663 (MainThread): Partial parsing not enabled
2021-05-15 17:31:27.267663 (MainThread): Parsing macros\adapters.sql
2021-05-15 17:31:27.283655 (MainThread): Parsing macros\catalog.sql
2021-05-15 17:31:27.291651 (MainThread): Parsing macros\etc.sql
2021-05-15 17:31:27.291651 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 17:31:27.299648 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 17:31:27.307645 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 17:31:27.315642 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 17:31:27.315642 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 17:31:27.323639 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 17:31:27.331635 (MainThread): Parsing macros\core.sql
2021-05-15 17:31:27.331635 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 17:31:27.371618 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 17:31:27.379615 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 17:31:27.379615 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 17:31:27.379615 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 17:31:27.387612 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 17:31:27.387612 (MainThread): Parsing macros\etc\query.sql
2021-05-15 17:31:27.387612 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 17:31:27.395609 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 17:31:27.411601 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 17:31:27.411601 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 17:31:27.419599 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 17:31:27.435591 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 17:31:27.467578 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 17:31:27.467578 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 17:31:27.483571 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 17:31:27.491569 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 17:31:27.491569 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 17:31:27.499565 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 17:31:27.507561 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 17:31:27.507561 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 17:31:27.507561 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 17:31:27.515559 (MainThread): Partial parsing not enabled
2021-05-15 17:31:27.531552 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 17:31:27.539548 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 17:31:27.547546 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 17:31:27.547546 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 17:31:27.555543 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 17:31:27.555543 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 17:31:27.572876 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 17:31:27.578662 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 17:31:27.583923 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 17:31:27.588314 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 17:31:27.592722 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 17:31:27.595946 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 17:31:27.600182 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 17:31:27.669071 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 17:31:27.673676 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b87cf7d-923e-4395-9196-39db681648cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FD148B088>]}
2021-05-15 17:31:27.673676 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b87cf7d-923e-4395-9196-39db681648cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FD13143C8>]}
2021-05-15 17:31:27.673676 (MainThread): Found 13 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 17:31:27.681713 (MainThread): 
2021-05-15 17:31:27.681713 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 17:31:27.681713 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 17:31:27.681713 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 17:31:29.535558 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 17:31:29.535558 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 17:31:29.543683 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 17:31:31.579119 (MainThread): 14:31:31 | Concurrency: 1 threads (target='dev')
2021-05-15 17:31:31.579119 (MainThread): 14:31:31 | 
2021-05-15 17:31:31.587164 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-05-15 17:31:31.587164 (Thread-1): 14:31:31 | 1 of 1 START view model dbt_arthur.fact_order_details................ [RUN]
2021-05-15 17:31:31.587164 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 17:31:31.587164 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-05-15 17:31:31.595125 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 17:31:31.595125 (Thread-1): finished collecting timing info
2021-05-15 17:31:31.627140 (Thread-1): Writing runtime SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 17:31:31.627140 (Thread-1): Opening a new connection, currently in state init
2021-05-15 17:31:31.635148 (Thread-1): On model.northwind_shop.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`fact_order_details`
  OPTIONS()
  as with 
    customers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
    )
    , suppliers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
    )
    , shippers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
    )
    , products as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
    )
    
    , orders_with_sk as ( 
        select 
            orders.order_id
            ,customers.customer_sk = customer_fk
            ,shippers.ship_id = shipper_fk            
            ,orders.ship_region	
            ,orders.shipped_date
            ,orders.ship_country	
            ,orders.ship_name
            ,orders.order_date		
            ,orders.ship_postal_code	
            ,orders.ship_city	
            ,orders.freight	
            ,orders.required_date
            ,orders.ship_address 

        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
        left join customers on orders.customer_id = customers.customer_id
        left join shippers on orders.ship_id = shippers.shipper_id
    )

select * from orders_with_sk;


2021-05-15 17:31:33.938638 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/19bbeca2-adb4-4b8f-a370-42f96997b4cf?maxResults=0&location=US&prettyPrint=false: Unrecognized name: customer_fk; Did you mean customer_sk? at [23:38]')
2021-05-15 17:31:35.060859 (Thread-1): finished collecting timing info
2021-05-15 17:31:35.060859 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Unrecognized name: customer_fk; Did you mean customer_sk? at [23:38]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/5c419524-fcae-4ccb-b9df-a6f85a76a223?maxResults=0&location=US&prettyPrint=false: Unrecognized name: customer_fk; Did you mean customer_sk? at [23:38]

(job ID: 5c419524-fcae-4ccb-b9df-a6f85a76a223)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */
   2:
   3:
   4:  create or replace view `northwind1-313400`.`dbt_arthur`.`fact_order_details`
   5:  OPTIONS()
   6:  as with 
   7:    customers as (
   8:        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
   9:    )
  10:    , suppliers as (
  11:        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
  12:    )
  13:    , shippers as (
  14:        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
  15:    )
  16:    , products as (
  17:        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
  18:    )
  19:    
  20:    , orders_with_sk as ( 
  21:        select 
  22:            orders.order_id
  23:            ,customers.customer_sk = customer_fk
  24:            ,shippers.ship_id = shipper_fk            
  25:            ,orders.ship_region	
  26:            ,orders.shipped_date
  27:            ,orders.ship_country	
  28:            ,orders.ship_name
  29:            ,orders.order_date		
  30:            ,orders.ship_postal_code	
  31:            ,orders.ship_city	
  32:            ,orders.freight	
  33:            ,orders.required_date
  34:            ,orders.ship_address 
  35:
  36:        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
  37:        left join customers on orders.customer_id = customers.customer_id
  38:        left join shippers on orders.ship_id = shippers.shipper_id
  39:    )
  40:
  41:select * from orders_with_sk;
  42:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Unrecognized name: customer_fk; Did you mean customer_sk? at [23:38]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-05-15 17:31:35.068778 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b87cf7d-923e-4395-9196-39db681648cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FD13CD708>]}
2021-05-15 17:31:35.068778 (Thread-1): 14:31:35 | 1 of 1 ERROR creating view model dbt_arthur.fact_order_details....... [ERROR in 3.48s]
2021-05-15 17:31:35.076785 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-05-15 17:31:35.157094 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 17:31:35.157094 (MainThread): 14:31:35 | 
2021-05-15 17:31:35.157094 (MainThread): 14:31:35 | Finished running 1 view model in 7.48s.
2021-05-15 17:31:35.157094 (MainThread): Connection 'master' was properly closed.
2021-05-15 17:31:35.157094 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 17:31:35.157094 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 17:31:35.157094 (MainThread): Connection 'model.northwind_shop.fact_order_details' was properly closed.
2021-05-15 17:31:35.157094 (MainThread): unclosed <socket.socket fd=980, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61218), raddr=('172.217.162.202', 443)>
2021-05-15 17:31:35.164810 (MainThread): unclosed <socket.socket fd=908, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61219), raddr=('142.250.79.202', 443)>
2021-05-15 17:31:35.164810 (MainThread): unclosed <socket.socket fd=1016, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61221), raddr=('142.250.79.202', 443)>
2021-05-15 17:31:35.164810 (MainThread): unclosed <socket.socket fd=848, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61220), raddr=('172.217.162.202', 443)>
2021-05-15 17:31:35.164810 (MainThread): unclosed <socket.socket fd=1068, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61222), raddr=('172.217.162.202', 443)>
2021-05-15 17:31:35.164810 (MainThread): unclosed <socket.socket fd=1080, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61223), raddr=('142.250.79.202', 443)>
2021-05-15 17:31:35.204763 (MainThread): 
2021-05-15 17:31:35.204763 (MainThread): Completed with 1 error and 0 warnings:
2021-05-15 17:31:35.204763 (MainThread): 
2021-05-15 17:31:35.212724 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-05-15 17:31:35.212724 (MainThread):   Unrecognized name: customer_fk; Did you mean customer_sk? at [23:38]
2021-05-15 17:31:35.212724 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-05-15 17:31:35.212724 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-15 17:31:35.215615 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FCD817748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FCD817508>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FCD817E48>]}
2021-05-15 17:31:35.216561 (MainThread): Flushing usage events
2021-05-15 17:32:14.229151 (MainThread): Running with dbt=0.19.1
2021-05-15 17:32:14.538961 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 17:32:14.538961 (MainThread): Tracking: tracking
2021-05-15 17:32:14.538961 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024105FA1F08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024105FA1B88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024105FA6748>]}
2021-05-15 17:32:14.546958 (MainThread): Partial parsing not enabled
2021-05-15 17:32:14.554955 (MainThread): Parsing macros\adapters.sql
2021-05-15 17:32:14.570948 (MainThread): Parsing macros\catalog.sql
2021-05-15 17:32:14.578944 (MainThread): Parsing macros\etc.sql
2021-05-15 17:32:14.578944 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 17:32:14.586941 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 17:32:14.594938 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 17:32:14.594938 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 17:32:14.602934 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 17:32:14.610932 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 17:32:14.618928 (MainThread): Parsing macros\core.sql
2021-05-15 17:32:14.626925 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 17:32:14.674960 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 17:32:14.682954 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 17:32:14.682954 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 17:32:14.682954 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 17:32:14.682954 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 17:32:14.682954 (MainThread): Parsing macros\etc\query.sql
2021-05-15 17:32:14.682954 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 17:32:14.690948 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 17:32:14.706946 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 17:32:14.706946 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 17:32:14.714939 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 17:32:14.730932 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 17:32:14.762912 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 17:32:14.762912 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 17:32:14.778906 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 17:32:14.786902 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 17:32:14.786902 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 17:32:14.794901 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 17:32:14.802897 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 17:32:14.802897 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 17:32:14.802897 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 17:32:14.810896 (MainThread): Partial parsing not enabled
2021-05-15 17:32:14.826844 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 17:32:14.834839 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 17:32:14.842880 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 17:32:14.842880 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 17:32:14.850876 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 17:32:14.850876 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 17:32:14.858874 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 17:32:14.858874 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 17:32:14.866870 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 17:32:14.866870 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 17:32:14.866870 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 17:32:14.874885 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 17:32:14.874885 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 17:32:14.970782 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 17:32:14.974741 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3b3afe9-7783-40d8-987b-dbe30a7e6ea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024109B7BFC8>]}
2021-05-15 17:32:14.974741 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3b3afe9-7783-40d8-987b-dbe30a7e6ea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024109A43AC8>]}
2021-05-15 17:32:14.974741 (MainThread): Found 13 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 17:32:14.982745 (MainThread): 
2021-05-15 17:32:14.982745 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 17:32:14.982745 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 17:32:14.982745 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 17:32:17.767274 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 17:32:17.767274 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 17:32:17.775277 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 17:32:19.830127 (MainThread): 14:32:19 | Concurrency: 1 threads (target='dev')
2021-05-15 17:32:19.830127 (MainThread): 14:32:19 | 
2021-05-15 17:32:19.830127 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-05-15 17:32:19.838136 (Thread-1): 14:32:19 | 1 of 1 START view model dbt_arthur.fact_order_details................ [RUN]
2021-05-15 17:32:19.838136 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 17:32:19.838136 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-05-15 17:32:19.846195 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 17:32:19.846195 (Thread-1): finished collecting timing info
2021-05-15 17:32:19.870169 (Thread-1): Writing runtime SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 17:32:19.870169 (Thread-1): Opening a new connection, currently in state init
2021-05-15 17:32:19.878156 (Thread-1): On model.northwind_shop.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`fact_order_details`
  OPTIONS()
  as with 
    customers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
    )
    , suppliers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
    )
    , shippers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
    )
    , products as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
    )
    
    , orders_with_sk as ( 
        select 
            orders.order_id
            ,customers.customer_sk = customer_fk
            ,shippers.ship_id = shipper_fk            
            ,orders.ship_region	
            ,orders.shipped_date
            ,orders.ship_country	
            ,orders.ship_name
            ,orders.order_date		
            ,orders.ship_postal_code	
            ,orders.ship_city	
            ,orders.freight	
            ,orders.required_date
            ,orders.ship_address 

        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
        left join customers on orders.customer_id = customers.customer_sk
        left join shippers on orders.ship_id = shippers.shipper_id
    )

select * from orders_with_sk;


2021-05-15 17:32:22.412331 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/e3bd4e86-a678-4aad-b347-20460f333d7e?maxResults=0&location=US&prettyPrint=false: No matching signature for operator = for argument types: STRING, INT64. Supported signature: ANY = ANY at [37:32]')
2021-05-15 17:32:24.110405 (Thread-1): finished collecting timing info
2021-05-15 17:32:24.110405 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  No matching signature for operator = for argument types: STRING, INT64. Supported signature: ANY = ANY at [37:32]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/86cfecf8-9e59-4716-82b3-93f0182ec9b2?maxResults=0&location=US&prettyPrint=false: No matching signature for operator = for argument types: STRING, INT64. Supported signature: ANY = ANY at [37:32]

(job ID: 86cfecf8-9e59-4716-82b3-93f0182ec9b2)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */
   2:
   3:
   4:  create or replace view `northwind1-313400`.`dbt_arthur`.`fact_order_details`
   5:  OPTIONS()
   6:  as with 
   7:    customers as (
   8:        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
   9:    )
  10:    , suppliers as (
  11:        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
  12:    )
  13:    , shippers as (
  14:        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
  15:    )
  16:    , products as (
  17:        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
  18:    )
  19:    
  20:    , orders_with_sk as ( 
  21:        select 
  22:            orders.order_id
  23:            ,customers.customer_sk = customer_fk
  24:            ,shippers.ship_id = shipper_fk            
  25:            ,orders.ship_region	
  26:            ,orders.shipped_date
  27:            ,orders.ship_country	
  28:            ,orders.ship_name
  29:            ,orders.order_date		
  30:            ,orders.ship_postal_code	
  31:            ,orders.ship_city	
  32:            ,orders.freight	
  33:            ,orders.required_date
  34:            ,orders.ship_address 
  35:
  36:        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
  37:        left join customers on orders.customer_id = customers.customer_sk
  38:        left join shippers on orders.ship_id = shippers.shipper_id
  39:    )
  40:
  41:select * from orders_with_sk;
  42:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  No matching signature for operator = for argument types: STRING, INT64. Supported signature: ANY = ANY at [37:32]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-05-15 17:32:24.118408 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3b3afe9-7783-40d8-987b-dbe30a7e6ea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024109ACA548>]}
2021-05-15 17:32:24.118408 (Thread-1): 14:32:24 | 1 of 1 ERROR creating view model dbt_arthur.fact_order_details....... [ERROR in 4.28s]
2021-05-15 17:32:24.118408 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-05-15 17:32:24.207634 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 17:32:24.207634 (MainThread): 14:32:24 | 
2021-05-15 17:32:24.207634 (MainThread): 14:32:24 | Finished running 1 view model in 9.22s.
2021-05-15 17:32:24.207634 (MainThread): Connection 'master' was properly closed.
2021-05-15 17:32:24.211362 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 17:32:24.211362 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 17:32:24.211362 (MainThread): Connection 'model.northwind_shop.fact_order_details' was properly closed.
2021-05-15 17:32:24.211362 (MainThread): unclosed <socket.socket fd=504, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61230), raddr=('172.217.173.74', 443)>
2021-05-15 17:32:24.211362 (MainThread): unclosed <socket.socket fd=988, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61231), raddr=('142.250.79.202', 443)>
2021-05-15 17:32:24.211362 (MainThread): unclosed <socket.socket fd=1008, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61233), raddr=('142.250.79.202', 443)>
2021-05-15 17:32:24.211362 (MainThread): unclosed <socket.socket fd=964, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61232), raddr=('172.217.173.74', 443)>
2021-05-15 17:32:24.211362 (MainThread): unclosed <socket.socket fd=476, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61234), raddr=('172.217.173.74', 443)>
2021-05-15 17:32:24.211362 (MainThread): unclosed <socket.socket fd=904, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61235), raddr=('142.250.79.202', 443)>
2021-05-15 17:32:24.259393 (MainThread): 
2021-05-15 17:32:24.259393 (MainThread): Completed with 1 error and 0 warnings:
2021-05-15 17:32:24.259393 (MainThread): 
2021-05-15 17:32:24.259393 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-05-15 17:32:24.263330 (MainThread):   No matching signature for operator = for argument types: STRING, INT64. Supported signature: ANY = ANY at [37:32]
2021-05-15 17:32:24.263330 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-05-15 17:32:24.265465 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-15 17:32:24.265465 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024105F457C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024105F456C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024105F45A48>]}
2021-05-15 17:32:24.265465 (MainThread): Flushing usage events
2021-05-15 17:32:34.281973 (MainThread): The 'warn' method is deprecated, use 'warning' instead
2021-05-15 17:32:34.281973 (MainThread): Error sending message, disabling tracking
2021-05-15 17:33:13.172488 (MainThread): Running with dbt=0.19.1
2021-05-15 17:33:13.487392 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 17:33:13.487392 (MainThread): Tracking: tracking
2021-05-15 17:33:13.487392 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F78FE8BC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F791045C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F79104C48>]}
2021-05-15 17:33:13.503372 (MainThread): Partial parsing not enabled
2021-05-15 17:33:13.503372 (MainThread): Parsing macros\adapters.sql
2021-05-15 17:33:13.519395 (MainThread): Parsing macros\catalog.sql
2021-05-15 17:33:13.527742 (MainThread): Parsing macros\etc.sql
2021-05-15 17:33:13.527742 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 17:33:13.535910 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 17:33:13.543905 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 17:33:13.543905 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 17:33:13.543905 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 17:33:13.559961 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 17:33:13.559961 (MainThread): Parsing macros\core.sql
2021-05-15 17:33:13.567961 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 17:33:13.599928 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 17:33:13.615927 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 17:33:13.615927 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 17:33:13.615927 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 17:33:13.615927 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 17:33:13.615927 (MainThread): Parsing macros\etc\query.sql
2021-05-15 17:33:13.615927 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 17:33:13.623922 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 17:33:13.639912 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 17:33:13.639912 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 17:33:13.647918 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 17:33:13.671885 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 17:33:13.703886 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 17:33:13.703886 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 17:33:13.719881 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 17:33:13.727879 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 17:33:13.727879 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 17:33:13.735890 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 17:33:13.735890 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 17:33:13.743885 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 17:33:13.743885 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 17:33:13.751885 (MainThread): Partial parsing not enabled
2021-05-15 17:33:13.767874 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 17:33:13.775867 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 17:33:13.783871 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 17:33:13.783871 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 17:33:13.791854 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 17:33:13.791854 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 17:33:13.799853 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 17:33:13.799853 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 17:33:13.799853 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 17:33:13.807851 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 17:33:13.807851 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 17:33:13.815851 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 17:33:13.815851 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 17:33:13.887822 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 17:33:13.896702 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9840a4e3-fd3b-448e-8aa4-8ef32c828c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F7CCF37C8>]}
2021-05-15 17:33:13.896702 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9840a4e3-fd3b-448e-8aa4-8ef32c828c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F7CBDED48>]}
2021-05-15 17:33:13.896702 (MainThread): Found 13 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 17:33:13.896702 (MainThread): 
2021-05-15 17:33:13.904990 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 17:33:13.904990 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 17:33:13.904990 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 17:33:16.169272 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 17:33:16.169272 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 17:33:16.189401 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 17:33:17.053617 (MainThread): 14:33:17 | Concurrency: 1 threads (target='dev')
2021-05-15 17:33:17.053617 (MainThread): 14:33:17 | 
2021-05-15 17:33:17.061620 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-05-15 17:33:17.061620 (Thread-1): 14:33:17 | 1 of 1 START view model dbt_arthur.fact_order_details................ [RUN]
2021-05-15 17:33:17.061620 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 17:33:17.067473 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-05-15 17:33:17.067473 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 17:33:17.067473 (Thread-1): finished collecting timing info
2021-05-15 17:33:17.100802 (Thread-1): Writing runtime SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 17:33:17.100802 (Thread-1): Opening a new connection, currently in state init
2021-05-15 17:33:17.108820 (Thread-1): On model.northwind_shop.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`fact_order_details`
  OPTIONS()
  as with 
    customers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
    )
    , suppliers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
    )
    , shippers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
    )
    , products as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
    )
    
    , orders_with_sk as ( 
        select 
            orders.order_id
            ,customers.customer_sk as customer_fk
            ,shippers.ship_id as shipper_fk            
            ,orders.ship_region	
            ,orders.shipped_date
            ,orders.ship_country	
            ,orders.ship_name
            ,orders.order_date		
            ,orders.ship_postal_code	
            ,orders.ship_city	
            ,orders.freight	
            ,orders.required_date
            ,orders.ship_address 

        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
        left join customers on orders.customer_id = customers.customer_id
        left join shippers on orders.ship_id = shippers.shipper_id
    )

select * from orders_with_sk;


2021-05-15 17:33:19.372280 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/f03e1767-6e56-491e-8b9e-e8d269f2f41f?maxResults=0&location=US&prettyPrint=false: Name ship_id not found inside shippers at [24:23]')
2021-05-15 17:33:21.557911 (Thread-1): finished collecting timing info
2021-05-15 17:33:21.557911 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Name ship_id not found inside shippers at [24:23]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/15301eb7-2162-40fe-a132-fb6b27bf0e28?maxResults=0&location=US&prettyPrint=false: Name ship_id not found inside shippers at [24:23]

(job ID: 15301eb7-2162-40fe-a132-fb6b27bf0e28)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */
   2:
   3:
   4:  create or replace view `northwind1-313400`.`dbt_arthur`.`fact_order_details`
   5:  OPTIONS()
   6:  as with 
   7:    customers as (
   8:        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
   9:    )
  10:    , suppliers as (
  11:        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
  12:    )
  13:    , shippers as (
  14:        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
  15:    )
  16:    , products as (
  17:        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
  18:    )
  19:    
  20:    , orders_with_sk as ( 
  21:        select 
  22:            orders.order_id
  23:            ,customers.customer_sk as customer_fk
  24:            ,shippers.ship_id as shipper_fk            
  25:            ,orders.ship_region	
  26:            ,orders.shipped_date
  27:            ,orders.ship_country	
  28:            ,orders.ship_name
  29:            ,orders.order_date		
  30:            ,orders.ship_postal_code	
  31:            ,orders.ship_city	
  32:            ,orders.freight	
  33:            ,orders.required_date
  34:            ,orders.ship_address 
  35:
  36:        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
  37:        left join customers on orders.customer_id = customers.customer_id
  38:        left join shippers on orders.ship_id = shippers.shipper_id
  39:    )
  40:
  41:select * from orders_with_sk;
  42:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Name ship_id not found inside shippers at [24:23]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-05-15 17:33:21.565908 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9840a4e3-fd3b-448e-8aa4-8ef32c828c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F7CC80BC8>]}
2021-05-15 17:33:21.565908 (Thread-1): 14:33:21 | 1 of 1 ERROR creating view model dbt_arthur.fact_order_details....... [ERROR in 4.50s]
2021-05-15 17:33:21.565908 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-05-15 17:33:21.624352 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 17:33:21.624352 (MainThread): 14:33:21 | 
2021-05-15 17:33:21.624352 (MainThread): 14:33:21 | Finished running 1 view model in 7.72s.
2021-05-15 17:33:21.627010 (MainThread): Connection 'master' was properly closed.
2021-05-15 17:33:21.627010 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 17:33:21.627010 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 17:33:21.627010 (MainThread): Connection 'model.northwind_shop.fact_order_details' was properly closed.
2021-05-15 17:33:21.627010 (MainThread): unclosed <socket.socket fd=1056, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61242), raddr=('172.217.173.74', 443)>
2021-05-15 17:33:21.627010 (MainThread): unclosed <socket.socket fd=952, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61243), raddr=('142.250.79.202', 443)>
2021-05-15 17:33:21.627010 (MainThread): unclosed <socket.socket fd=148, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61246), raddr=('142.250.79.202', 443)>
2021-05-15 17:33:21.627010 (MainThread): unclosed <socket.socket fd=1136, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61245), raddr=('172.217.173.74', 443)>
2021-05-15 17:33:21.627010 (MainThread): unclosed <socket.socket fd=1128, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61247), raddr=('172.217.173.74', 443)>
2021-05-15 17:33:21.627010 (MainThread): unclosed <socket.socket fd=436, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61248), raddr=('142.250.79.202', 443)>
2021-05-15 17:33:21.676201 (MainThread): 
2021-05-15 17:33:21.677308 (MainThread): Completed with 1 error and 0 warnings:
2021-05-15 17:33:21.677308 (MainThread): 
2021-05-15 17:33:21.677308 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-05-15 17:33:21.677308 (MainThread):   Name ship_id not found inside shippers at [24:23]
2021-05-15 17:33:21.677308 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-05-15 17:33:21.677308 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-15 17:33:21.683191 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F790A66C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F790A6788>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F790A6A88>]}
2021-05-15 17:33:21.683831 (MainThread): Flushing usage events
2021-05-15 17:33:31.733550 (MainThread): The 'warn' method is deprecated, use 'warning' instead
2021-05-15 17:33:31.733550 (MainThread): Error sending message, disabling tracking
2021-05-15 17:33:57.737773 (MainThread): Running with dbt=0.19.1
2021-05-15 17:33:58.052244 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 17:33:58.052244 (MainThread): Tracking: tracking
2021-05-15 17:33:58.052244 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9DA801D48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9DA8011C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9DA808188>]}
2021-05-15 17:33:58.060242 (MainThread): Partial parsing not enabled
2021-05-15 17:33:58.068240 (MainThread): Parsing macros\adapters.sql
2021-05-15 17:33:58.084231 (MainThread): Parsing macros\catalog.sql
2021-05-15 17:33:58.084231 (MainThread): Parsing macros\etc.sql
2021-05-15 17:33:58.092228 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 17:33:58.092228 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 17:33:58.108221 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 17:33:58.108221 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 17:33:58.108221 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 17:33:58.116218 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 17:33:58.124214 (MainThread): Parsing macros\core.sql
2021-05-15 17:33:58.124214 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 17:33:58.164197 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 17:33:58.172194 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 17:33:58.172194 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 17:33:58.172194 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 17:33:58.180191 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 17:33:58.180191 (MainThread): Parsing macros\etc\query.sql
2021-05-15 17:33:58.180191 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 17:33:58.188188 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 17:33:58.196184 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 17:33:58.204181 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 17:33:58.204181 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 17:33:58.228170 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 17:33:58.252160 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 17:33:58.260157 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 17:33:58.276150 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 17:33:58.276150 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 17:33:58.284148 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 17:33:58.292144 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 17:33:58.292144 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 17:33:58.292144 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 17:33:58.292144 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 17:33:58.300141 (MainThread): Partial parsing not enabled
2021-05-15 17:33:58.324132 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 17:33:58.332129 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 17:33:58.332129 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 17:33:58.340126 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 17:33:58.340126 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 17:33:58.348123 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 17:33:58.348123 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 17:33:58.356120 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 17:33:58.356120 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 17:33:58.364115 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 17:33:58.364115 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 17:33:58.372114 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 17:33:58.372114 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 17:33:58.444083 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 17:33:58.448380 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee4c1b0f-21fc-4ac2-9997-f04b25ae7bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9DE35CC88>]}
2021-05-15 17:33:58.448380 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee4c1b0f-21fc-4ac2-9997-f04b25ae7bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9DE202648>]}
2021-05-15 17:33:58.448380 (MainThread): Found 13 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 17:33:58.456473 (MainThread): 
2021-05-15 17:33:58.456473 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 17:33:58.456473 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 17:33:58.456473 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 17:34:00.955483 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 17:34:00.955483 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 17:34:00.963482 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 17:34:02.970866 (MainThread): 14:34:02 | Concurrency: 1 threads (target='dev')
2021-05-15 17:34:02.970866 (MainThread): 14:34:02 | 
2021-05-15 17:34:02.978912 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-05-15 17:34:02.978912 (Thread-1): 14:34:02 | 1 of 1 START view model dbt_arthur.fact_order_details................ [RUN]
2021-05-15 17:34:02.978912 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 17:34:02.978912 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-05-15 17:34:02.986856 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 17:34:02.986856 (Thread-1): finished collecting timing info
2021-05-15 17:34:03.018842 (Thread-1): Writing runtime SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 17:34:03.018842 (Thread-1): Opening a new connection, currently in state init
2021-05-15 17:34:03.026844 (Thread-1): On model.northwind_shop.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`fact_order_details`
  OPTIONS()
  as with 
    customers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
    )
    , suppliers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
    )
    , shippers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
    )
    , products as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
    )
    
    , orders_with_sk as ( 
        select 
            orders.order_id
            ,customers.customer_sk as customer_fk
            ,shippers.shipper_id as shipper_fk            
            ,orders.ship_region	
            ,orders.shipped_date
            ,orders.ship_country	
            ,orders.ship_name
            ,orders.order_date		
            ,orders.ship_postal_code	
            ,orders.ship_city	
            ,orders.freight	
            ,orders.required_date
            ,orders.ship_address 

        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
        left join customers on orders.customer_id = customers.customer_id
        left join shippers on orders.shipper_id = shippers.shipper_id
    )

select * from orders_with_sk;


2021-05-15 17:34:04.767113 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/8e3143b7-736b-4c9d-85cb-fcadaca4a6b9?maxResults=0&location=US&prettyPrint=false: Name shipper_id not found inside orders at [38:38]')
2021-05-15 17:34:06.921241 (Thread-1): finished collecting timing info
2021-05-15 17:34:06.924557 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Name shipper_id not found inside orders at [38:38]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/26a4d672-e6c5-4747-98a9-1ee4b7952300?maxResults=0&location=US&prettyPrint=false: Name shipper_id not found inside orders at [38:38]

(job ID: 26a4d672-e6c5-4747-98a9-1ee4b7952300)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */
   2:
   3:
   4:  create or replace view `northwind1-313400`.`dbt_arthur`.`fact_order_details`
   5:  OPTIONS()
   6:  as with 
   7:    customers as (
   8:        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
   9:    )
  10:    , suppliers as (
  11:        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
  12:    )
  13:    , shippers as (
  14:        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
  15:    )
  16:    , products as (
  17:        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
  18:    )
  19:    
  20:    , orders_with_sk as ( 
  21:        select 
  22:            orders.order_id
  23:            ,customers.customer_sk as customer_fk
  24:            ,shippers.shipper_id as shipper_fk            
  25:            ,orders.ship_region	
  26:            ,orders.shipped_date
  27:            ,orders.ship_country	
  28:            ,orders.ship_name
  29:            ,orders.order_date		
  30:            ,orders.ship_postal_code	
  31:            ,orders.ship_city	
  32:            ,orders.freight	
  33:            ,orders.required_date
  34:            ,orders.ship_address 
  35:
  36:        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
  37:        left join customers on orders.customer_id = customers.customer_id
  38:        left join shippers on orders.shipper_id = shippers.shipper_id
  39:    )
  40:
  41:select * from orders_with_sk;
  42:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Name shipper_id not found inside orders at [38:38]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-05-15 17:34:06.924557 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee4c1b0f-21fc-4ac2-9997-f04b25ae7bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9DE2C0148>]}
2021-05-15 17:34:06.924557 (Thread-1): 14:34:06 | 1 of 1 ERROR creating view model dbt_arthur.fact_order_details....... [ERROR in 3.95s]
2021-05-15 17:34:06.924557 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-05-15 17:34:06.990501 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 17:34:06.990501 (MainThread): 14:34:06 | 
2021-05-15 17:34:06.990501 (MainThread): 14:34:06 | Finished running 1 view model in 8.53s.
2021-05-15 17:34:06.990501 (MainThread): Connection 'master' was properly closed.
2021-05-15 17:34:06.994551 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 17:34:06.994551 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 17:34:06.994551 (MainThread): Connection 'model.northwind_shop.fact_order_details' was properly closed.
2021-05-15 17:34:06.994551 (MainThread): unclosed <socket.socket fd=740, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61258), raddr=('172.217.173.74', 443)>
2021-05-15 17:34:06.994551 (MainThread): unclosed <socket.socket fd=764, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61259), raddr=('142.250.79.202', 443)>
2021-05-15 17:34:06.994551 (MainThread): unclosed <socket.socket fd=832, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61261), raddr=('142.250.79.202', 443)>
2021-05-15 17:34:06.994551 (MainThread): unclosed <socket.socket fd=984, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61260), raddr=('172.217.173.74', 443)>
2021-05-15 17:34:06.994551 (MainThread): unclosed <socket.socket fd=1052, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61262), raddr=('172.217.173.74', 443)>
2021-05-15 17:34:06.994551 (MainThread): unclosed <socket.socket fd=1056, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61263), raddr=('142.250.79.202', 443)>
2021-05-15 17:34:07.034622 (MainThread): 
2021-05-15 17:34:07.042617 (MainThread): Completed with 1 error and 0 warnings:
2021-05-15 17:34:07.042617 (MainThread): 
2021-05-15 17:34:07.042617 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-05-15 17:34:07.042617 (MainThread):   Name shipper_id not found inside orders at [38:38]
2021-05-15 17:34:07.042617 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-05-15 17:34:07.045978 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-15 17:34:07.046760 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9DA7A6588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9DA7A6408>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9DA7A6BC8>]}
2021-05-15 17:34:07.047454 (MainThread): Flushing usage events
2021-05-15 17:34:17.064000 (MainThread): The 'warn' method is deprecated, use 'warning' instead
2021-05-15 17:34:17.064000 (MainThread): Error sending message, disabling tracking
2021-05-15 17:34:36.904958 (MainThread): Running with dbt=0.19.1
2021-05-15 17:34:37.213206 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 17:34:37.213206 (MainThread): Tracking: tracking
2021-05-15 17:34:37.213206 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224C303DA08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224C303F9C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224C3046788>]}
2021-05-15 17:34:37.228828 (MainThread): Partial parsing not enabled
2021-05-15 17:34:37.228828 (MainThread): Parsing macros\adapters.sql
2021-05-15 17:34:37.244455 (MainThread): Parsing macros\catalog.sql
2021-05-15 17:34:37.260074 (MainThread): Parsing macros\etc.sql
2021-05-15 17:34:37.260074 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 17:34:37.260074 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 17:34:37.275701 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 17:34:37.275701 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 17:34:37.275701 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 17:34:37.291323 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 17:34:37.291323 (MainThread): Parsing macros\core.sql
2021-05-15 17:34:37.291323 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 17:34:37.343261 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 17:34:37.343261 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 17:34:37.343261 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 17:34:37.343261 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 17:34:37.343261 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 17:34:37.343261 (MainThread): Parsing macros\etc\query.sql
2021-05-15 17:34:37.360469 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 17:34:37.368470 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 17:34:37.376466 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 17:34:37.376466 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 17:34:37.384462 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 17:34:37.408451 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 17:34:37.432441 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 17:34:37.440438 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 17:34:37.448435 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 17:34:37.456432 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 17:34:37.464428 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 17:34:37.472425 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 17:34:37.472425 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 17:34:37.472425 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 17:34:37.472425 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 17:34:37.480422 (MainThread): Partial parsing not enabled
2021-05-15 17:34:37.496415 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 17:34:37.512410 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 17:34:37.512410 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 17:34:37.512410 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 17:34:37.520408 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 17:34:37.520408 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 17:34:37.528404 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 17:34:37.528404 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 17:34:37.536402 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 17:34:37.536402 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 17:34:37.536402 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 17:34:37.544398 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 17:34:37.544398 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 17:34:37.616367 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 17:34:37.616367 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aacb6094-fff8-47ec-a60e-56657f48d57b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224C6C1BA88>]}
2021-05-15 17:34:37.632358 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aacb6094-fff8-47ec-a60e-56657f48d57b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224C6B199C8>]}
2021-05-15 17:34:37.632358 (MainThread): Found 13 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 17:34:37.632358 (MainThread): 
2021-05-15 17:34:37.632358 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 17:34:37.640394 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 17:34:37.640394 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 17:34:39.115130 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 17:34:39.117911 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 17:34:39.125731 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 17:34:41.116805 (MainThread): 14:34:41 | Concurrency: 1 threads (target='dev')
2021-05-15 17:34:41.116805 (MainThread): 14:34:41 | 
2021-05-15 17:34:41.124814 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-05-15 17:34:41.124814 (Thread-1): 14:34:41 | 1 of 1 START view model dbt_arthur.fact_order_details................ [RUN]
2021-05-15 17:34:41.124814 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 17:34:41.124814 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-05-15 17:34:41.132847 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 17:34:41.132847 (Thread-1): finished collecting timing info
2021-05-15 17:34:41.164840 (Thread-1): Writing runtime SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 17:34:41.164840 (Thread-1): Opening a new connection, currently in state init
2021-05-15 17:34:41.172822 (Thread-1): On model.northwind_shop.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`fact_order_details`
  OPTIONS()
  as with 
    customers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
    )
    , suppliers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
    )
    , shippers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
    )
    , products as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
    )
    
    , orders_with_sk as ( 
        select 
            orders.order_id
            ,customers.customer_sk as customer_fk
            ,shippers.shipper_sk as shipper_fk            
            ,orders.ship_region	
            ,orders.shipped_date
            ,orders.ship_country	
            ,orders.ship_name
            ,orders.order_date		
            ,orders.ship_postal_code	
            ,orders.ship_city	
            ,orders.freight	
            ,orders.required_date
            ,orders.ship_address 

        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
        left join customers on orders.customer_id = customers.customer_id
        left join shippers on orders.shipper_id = shippers.shipper_id
    )

select * from orders_with_sk;


2021-05-15 17:34:43.158643 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/bdd6f80a-48d8-4700-9abb-1bf7ab8d9266?maxResults=0&location=US&prettyPrint=false: Name shipper_id not found inside orders at [38:38]')
2021-05-15 17:34:44.543345 (Thread-1): finished collecting timing info
2021-05-15 17:34:44.543345 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Name shipper_id not found inside orders at [38:38]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/31e67fa9-e578-404d-9ac0-3d1c22a04a6d?maxResults=0&location=US&prettyPrint=false: Name shipper_id not found inside orders at [38:38]

(job ID: 31e67fa9-e578-404d-9ac0-3d1c22a04a6d)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */
   2:
   3:
   4:  create or replace view `northwind1-313400`.`dbt_arthur`.`fact_order_details`
   5:  OPTIONS()
   6:  as with 
   7:    customers as (
   8:        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
   9:    )
  10:    , suppliers as (
  11:        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
  12:    )
  13:    , shippers as (
  14:        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
  15:    )
  16:    , products as (
  17:        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
  18:    )
  19:    
  20:    , orders_with_sk as ( 
  21:        select 
  22:            orders.order_id
  23:            ,customers.customer_sk as customer_fk
  24:            ,shippers.shipper_sk as shipper_fk            
  25:            ,orders.ship_region	
  26:            ,orders.shipped_date
  27:            ,orders.ship_country	
  28:            ,orders.ship_name
  29:            ,orders.order_date		
  30:            ,orders.ship_postal_code	
  31:            ,orders.ship_city	
  32:            ,orders.freight	
  33:            ,orders.required_date
  34:            ,orders.ship_address 
  35:
  36:        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
  37:        left join customers on orders.customer_id = customers.customer_id
  38:        left join shippers on orders.shipper_id = shippers.shipper_id
  39:    )
  40:
  41:select * from orders_with_sk;
  42:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Name shipper_id not found inside orders at [38:38]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-05-15 17:34:44.551353 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aacb6094-fff8-47ec-a60e-56657f48d57b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224C6B0C388>]}
2021-05-15 17:34:44.551353 (Thread-1): 14:34:44 | 1 of 1 ERROR creating view model dbt_arthur.fact_order_details....... [ERROR in 3.43s]
2021-05-15 17:34:44.551353 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-05-15 17:34:44.647111 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 17:34:44.647111 (MainThread): 14:34:44 | 
2021-05-15 17:34:44.647111 (MainThread): 14:34:44 | Finished running 1 view model in 7.01s.
2021-05-15 17:34:44.647111 (MainThread): Connection 'master' was properly closed.
2021-05-15 17:34:44.647111 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 17:34:44.647111 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 17:34:44.647111 (MainThread): Connection 'model.northwind_shop.fact_order_details' was properly closed.
2021-05-15 17:34:44.647111 (MainThread): unclosed <socket.socket fd=924, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61270), raddr=('172.217.173.74', 443)>
2021-05-15 17:34:44.654804 (MainThread): unclosed <socket.socket fd=996, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61271), raddr=('142.250.79.202', 443)>
2021-05-15 17:34:44.654804 (MainThread): unclosed <socket.socket fd=844, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61273), raddr=('142.250.79.202', 443)>
2021-05-15 17:34:44.654804 (MainThread): unclosed <socket.socket fd=1060, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61272), raddr=('172.217.173.74', 443)>
2021-05-15 17:34:44.654804 (MainThread): unclosed <socket.socket fd=856, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61274), raddr=('172.217.173.74', 443)>
2021-05-15 17:34:44.654804 (MainThread): unclosed <socket.socket fd=1144, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61275), raddr=('142.250.79.202', 443)>
2021-05-15 17:34:44.696231 (MainThread): 
2021-05-15 17:34:44.696231 (MainThread): Completed with 1 error and 0 warnings:
2021-05-15 17:34:44.704193 (MainThread): 
2021-05-15 17:34:44.705116 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-05-15 17:34:44.705116 (MainThread):   Name shipper_id not found inside orders at [38:38]
2021-05-15 17:34:44.705116 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-05-15 17:34:44.705116 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-15 17:34:44.705116 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224C2FE5748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224C2FE5808>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224C2FE5B48>]}
2021-05-15 17:34:44.705116 (MainThread): Flushing usage events
2021-05-15 17:34:54.761224 (MainThread): The 'warn' method is deprecated, use 'warning' instead
2021-05-15 17:34:54.761224 (MainThread): Error sending message, disabling tracking
2021-05-15 17:40:27.519098 (MainThread): Running with dbt=0.19.1
2021-05-15 17:40:27.826459 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 17:40:27.826459 (MainThread): Tracking: tracking
2021-05-15 17:40:27.826459 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E6F441D48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E6F441908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E6F448788>]}
2021-05-15 17:40:27.834456 (MainThread): Partial parsing not enabled
2021-05-15 17:40:27.842454 (MainThread): Parsing macros\adapters.sql
2021-05-15 17:40:27.858445 (MainThread): Parsing macros\catalog.sql
2021-05-15 17:40:27.866442 (MainThread): Parsing macros\etc.sql
2021-05-15 17:40:27.866442 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 17:40:27.866442 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 17:40:27.882434 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 17:40:27.882434 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 17:40:27.882434 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 17:40:27.890432 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 17:40:27.898428 (MainThread): Parsing macros\core.sql
2021-05-15 17:40:27.898428 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 17:40:27.938411 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 17:40:27.946408 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 17:40:27.946408 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 17:40:27.954405 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 17:40:27.954405 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 17:40:27.954405 (MainThread): Parsing macros\etc\query.sql
2021-05-15 17:40:27.954405 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 17:40:27.962402 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 17:40:27.978394 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 17:40:27.978394 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 17:40:27.986392 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 17:40:28.002385 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 17:40:28.042367 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 17:40:28.042367 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 17:40:28.066358 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 17:40:28.066358 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 17:40:28.074355 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 17:40:28.082352 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 17:40:28.082352 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 17:40:28.082352 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 17:40:28.090350 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 17:40:28.090350 (MainThread): Partial parsing not enabled
2021-05-15 17:40:28.114341 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 17:40:28.122336 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 17:40:28.122336 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 17:40:28.130334 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 17:40:28.130334 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 17:40:28.138331 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 17:40:28.146325 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 17:40:28.146325 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 17:40:28.154369 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 17:40:28.154369 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 17:40:28.154369 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 17:40:28.162367 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 17:40:28.162367 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 17:40:28.234339 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 17:40:28.240742 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41197e8f-f308-49f0-854c-711bb90fd3ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E73027688>]}
2021-05-15 17:40:28.248915 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41197e8f-f308-49f0-854c-711bb90fd3ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E72F0F188>]}
2021-05-15 17:40:28.248915 (MainThread): Found 13 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 17:40:28.248915 (MainThread): 
2021-05-15 17:40:28.248915 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 17:40:28.248915 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 17:40:28.248915 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 17:40:30.410509 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 17:40:30.411006 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 17:40:30.414745 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 17:40:32.766820 (MainThread): 14:40:32 | Concurrency: 1 threads (target='dev')
2021-05-15 17:40:32.766820 (MainThread): 14:40:32 | 
2021-05-15 17:40:32.769599 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-05-15 17:40:32.769599 (Thread-1): 14:40:32 | 1 of 1 START view model dbt_arthur.fact_order_details................ [RUN]
2021-05-15 17:40:32.769599 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 17:40:32.769599 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-05-15 17:40:32.778974 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 17:40:32.778974 (Thread-1): finished collecting timing info
2021-05-15 17:40:32.810978 (Thread-1): Writing runtime SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 17:40:32.810978 (Thread-1): Opening a new connection, currently in state init
2021-05-15 17:40:32.819021 (Thread-1): On model.northwind_shop.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`fact_order_details`
  OPTIONS()
  as with 
    customers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
    )
    , suppliers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
    )
    , shippers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
    )
    , products as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
    )
    
    , orders_with_sk as ( 
        select 
            orders.order_id
            ,customers.customer_sk as customer_fk
            ,shippers.shipper_sk as shipper_fk            
            ,orders.ship_region	
            ,orders.shipped_date
            ,orders.ship_country	
            ,orders.ship_name
            ,orders.order_date		
            ,orders.ship_postal_code	
            ,orders.ship_city	
            ,orders.freight	
            ,orders.required_date
            ,orders.ship_address 

        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
        left join customers on orders.customer_id = customers.customer_id
        left join shippers on orders.shipper_id = shippers.shipper_id
    )

select * from orders_with_sk;


2021-05-15 17:40:35.577184 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/93590ec3-d38f-43f3-8ec4-0ccd275d8dcb?maxResults=0&location=US&prettyPrint=false: Name shipper_id not found inside orders at [38:38]')
2021-05-15 17:40:37.576841 (Thread-1): finished collecting timing info
2021-05-15 17:40:37.576841 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Name shipper_id not found inside orders at [38:38]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/23fdba55-23a6-4dc1-b989-acb730a67d2b?maxResults=0&location=US&prettyPrint=false: Name shipper_id not found inside orders at [38:38]

(job ID: 23fdba55-23a6-4dc1-b989-acb730a67d2b)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */
   2:
   3:
   4:  create or replace view `northwind1-313400`.`dbt_arthur`.`fact_order_details`
   5:  OPTIONS()
   6:  as with 
   7:    customers as (
   8:        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
   9:    )
  10:    , suppliers as (
  11:        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
  12:    )
  13:    , shippers as (
  14:        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
  15:    )
  16:    , products as (
  17:        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
  18:    )
  19:    
  20:    , orders_with_sk as ( 
  21:        select 
  22:            orders.order_id
  23:            ,customers.customer_sk as customer_fk
  24:            ,shippers.shipper_sk as shipper_fk            
  25:            ,orders.ship_region	
  26:            ,orders.shipped_date
  27:            ,orders.ship_country	
  28:            ,orders.ship_name
  29:            ,orders.order_date		
  30:            ,orders.ship_postal_code	
  31:            ,orders.ship_city	
  32:            ,orders.freight	
  33:            ,orders.required_date
  34:            ,orders.ship_address 
  35:
  36:        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
  37:        left join customers on orders.customer_id = customers.customer_id
  38:        left join shippers on orders.shipper_id = shippers.shipper_id
  39:    )
  40:
  41:select * from orders_with_sk;
  42:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Name shipper_id not found inside orders at [38:38]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-05-15 17:40:37.584844 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41197e8f-f308-49f0-854c-711bb90fd3ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E72EF66C8>]}
2021-05-15 17:40:37.584844 (Thread-1): 14:40:37 | 1 of 1 ERROR creating view model dbt_arthur.fact_order_details....... [ERROR in 4.82s]
2021-05-15 17:40:37.584844 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-05-15 17:40:37.694121 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 17:40:37.694121 (MainThread): 14:40:37 | 
2021-05-15 17:40:37.694121 (MainThread): 14:40:37 | Finished running 1 view model in 9.45s.
2021-05-15 17:40:37.694121 (MainThread): Connection 'master' was properly closed.
2021-05-15 17:40:37.694121 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 17:40:37.694121 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 17:40:37.694121 (MainThread): Connection 'model.northwind_shop.fact_order_details' was properly closed.
2021-05-15 17:40:37.694121 (MainThread): unclosed <socket.socket fd=880, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61304), raddr=('142.250.219.10', 443)>
2021-05-15 17:40:37.701948 (MainThread): unclosed <socket.socket fd=1028, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61305), raddr=('142.250.219.10', 443)>
2021-05-15 17:40:37.701948 (MainThread): unclosed <socket.socket fd=1060, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61307), raddr=('142.250.219.10', 443)>
2021-05-15 17:40:37.701948 (MainThread): unclosed <socket.socket fd=1048, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61306), raddr=('142.250.219.10', 443)>
2021-05-15 17:40:37.701948 (MainThread): unclosed <socket.socket fd=1036, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61308), raddr=('142.250.219.10', 443)>
2021-05-15 17:40:37.701948 (MainThread): unclosed <socket.socket fd=1128, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61309), raddr=('142.250.219.10', 443)>
2021-05-15 17:40:37.741960 (MainThread): 
2021-05-15 17:40:37.749888 (MainThread): Completed with 1 error and 0 warnings:
2021-05-15 17:40:37.749888 (MainThread): 
2021-05-15 17:40:37.749888 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-05-15 17:40:37.749888 (MainThread):   Name shipper_id not found inside orders at [38:38]
2021-05-15 17:40:37.749888 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-05-15 17:40:37.749888 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-15 17:40:37.749888 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E6F3F1BC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E6F3F1F48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E6F3F1B48>]}
2021-05-15 17:40:37.749888 (MainThread): Flushing usage events
2021-05-15 17:43:27.451177 (MainThread): Running with dbt=0.19.1
2021-05-15 17:43:27.748391 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 17:43:27.748391 (MainThread): Tracking: tracking
2021-05-15 17:43:27.748391 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028500201CC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028500201DC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028500206B88>]}
2021-05-15 17:43:27.764385 (MainThread): Partial parsing not enabled
2021-05-15 17:43:27.764385 (MainThread): Parsing macros\adapters.sql
2021-05-15 17:43:27.780375 (MainThread): Parsing macros\catalog.sql
2021-05-15 17:43:27.788374 (MainThread): Parsing macros\etc.sql
2021-05-15 17:43:27.788374 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 17:43:27.788374 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 17:43:27.804367 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 17:43:27.804367 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 17:43:27.804367 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 17:43:27.820360 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 17:43:27.820360 (MainThread): Parsing macros\core.sql
2021-05-15 17:43:27.828359 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 17:43:27.860343 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 17:43:27.868340 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 17:43:27.876337 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 17:43:27.876337 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 17:43:27.876337 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 17:43:27.876337 (MainThread): Parsing macros\etc\query.sql
2021-05-15 17:43:27.876337 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 17:43:27.884334 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 17:43:27.900327 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 17:43:27.900327 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 17:43:27.908324 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 17:43:27.924316 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 17:43:27.956303 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 17:43:27.956303 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 17:43:27.972297 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 17:43:27.980294 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 17:43:27.988290 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 17:43:27.988290 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 17:43:27.996287 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 17:43:27.996287 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 17:43:27.996287 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 17:43:28.004285 (MainThread): Partial parsing not enabled
2021-05-15 17:43:28.028276 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 17:43:28.036273 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 17:43:28.036273 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 17:43:28.044271 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 17:43:28.044271 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 17:43:28.044271 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 17:43:28.052267 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 17:43:28.052267 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 17:43:28.060264 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 17:43:28.060264 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 17:43:28.068261 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 17:43:28.068261 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 17:43:28.068261 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 17:43:28.140228 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 17:43:28.148222 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2113f43c-c7f4-40e1-9cfa-bd5c74e6df20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028503E1CEC8>]}
2021-05-15 17:43:28.156219 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2113f43c-c7f4-40e1-9cfa-bd5c74e6df20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028503CB48C8>]}
2021-05-15 17:43:28.156219 (MainThread): Found 13 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 17:43:28.156219 (MainThread): 
2021-05-15 17:43:28.156219 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 17:43:28.156219 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 17:43:28.156219 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 17:43:29.711966 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 17:43:29.711966 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 17:43:29.721034 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 17:43:31.039038 (MainThread): 14:43:31 | Concurrency: 1 threads (target='dev')
2021-05-15 17:43:31.039038 (MainThread): 14:43:31 | 
2021-05-15 17:43:31.039038 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-05-15 17:43:31.039038 (Thread-1): 14:43:31 | 1 of 1 START view model dbt_arthur.fact_order_details................ [RUN]
2021-05-15 17:43:31.039038 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 17:43:31.039038 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-05-15 17:43:31.047024 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 17:43:31.047024 (Thread-1): finished collecting timing info
2021-05-15 17:43:31.079020 (Thread-1): Writing runtime SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 17:43:31.087025 (Thread-1): Opening a new connection, currently in state init
2021-05-15 17:43:31.087025 (Thread-1): On model.northwind_shop.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`fact_order_details`
  OPTIONS()
  as with 
    customers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
    )
    , suppliers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
    )
    , shippers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
    )
    , products as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
    )
    
    , orders_with_sk as ( 
        select 
            orders.order_id
            ,customers.customer_sk as customer_fk
            ,shippers.shipper_sk as shipper_fk            
            ,orders.ship_region	
            ,orders.shipped_date
            ,orders.ship_country	
            ,orders.ship_name
            ,orders.order_date		
            ,orders.ship_postal_code	
            ,orders.ship_city	
            ,orders.freight	
            ,orders.required_date
            ,orders.ship_address 

        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
        left join customers on orders.customer_id = customers.customer_id
        left join shippers on orders.shipper_id = shippers.shipper_id
    )

select * from orders_with_sk;


2021-05-15 17:43:33.331547 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/31f39843-33d2-44e3-8657-6148c2a1788e?maxResults=0&location=US&prettyPrint=false: Name shipper_id not found inside orders at [38:38]')
2021-05-15 17:43:35.251167 (Thread-1): finished collecting timing info
2021-05-15 17:43:35.251167 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Name shipper_id not found inside orders at [38:38]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/ee6600dc-3f7c-49b5-bde5-8122841046c3?maxResults=0&location=US&prettyPrint=false: Name shipper_id not found inside orders at [38:38]

(job ID: ee6600dc-3f7c-49b5-bde5-8122841046c3)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */
   2:
   3:
   4:  create or replace view `northwind1-313400`.`dbt_arthur`.`fact_order_details`
   5:  OPTIONS()
   6:  as with 
   7:    customers as (
   8:        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
   9:    )
  10:    , suppliers as (
  11:        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
  12:    )
  13:    , shippers as (
  14:        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
  15:    )
  16:    , products as (
  17:        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
  18:    )
  19:    
  20:    , orders_with_sk as ( 
  21:        select 
  22:            orders.order_id
  23:            ,customers.customer_sk as customer_fk
  24:            ,shippers.shipper_sk as shipper_fk            
  25:            ,orders.ship_region	
  26:            ,orders.shipped_date
  27:            ,orders.ship_country	
  28:            ,orders.ship_name
  29:            ,orders.order_date		
  30:            ,orders.ship_postal_code	
  31:            ,orders.ship_city	
  32:            ,orders.freight	
  33:            ,orders.required_date
  34:            ,orders.ship_address 
  35:
  36:        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
  37:        left join customers on orders.customer_id = customers.customer_id
  38:        left join shippers on orders.shipper_id = shippers.shipper_id
  39:    )
  40:
  41:select * from orders_with_sk;
  42:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Name shipper_id not found inside orders at [38:38]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-05-15 17:43:35.258812 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2113f43c-c7f4-40e1-9cfa-bd5c74e6df20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028503D8F748>]}
2021-05-15 17:43:35.258812 (Thread-1): 14:43:35 | 1 of 1 ERROR creating view model dbt_arthur.fact_order_details....... [ERROR in 4.22s]
2021-05-15 17:43:35.266803 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-05-15 17:43:35.291149 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 17:43:35.291149 (MainThread): 14:43:35 | 
2021-05-15 17:43:35.291149 (MainThread): 14:43:35 | Finished running 1 view model in 7.13s.
2021-05-15 17:43:35.291149 (MainThread): Connection 'master' was properly closed.
2021-05-15 17:43:35.294064 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 17:43:35.294064 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 17:43:35.294064 (MainThread): Connection 'model.northwind_shop.fact_order_details' was properly closed.
2021-05-15 17:43:35.294064 (MainThread): unclosed <socket.socket fd=1116, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61331), raddr=('216.58.202.170', 443)>
2021-05-15 17:43:35.294064 (MainThread): unclosed <socket.socket fd=936, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61332), raddr=('142.250.219.10', 443)>
2021-05-15 17:43:35.294064 (MainThread): unclosed <socket.socket fd=668, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61335), raddr=('142.250.219.10', 443)>
2021-05-15 17:43:35.294064 (MainThread): unclosed <socket.socket fd=928, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61334), raddr=('216.58.202.170', 443)>
2021-05-15 17:43:35.294064 (MainThread): unclosed <socket.socket fd=1136, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61336), raddr=('216.58.202.170', 443)>
2021-05-15 17:43:35.294064 (MainThread): unclosed <socket.socket fd=1060, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61337), raddr=('142.250.219.10', 443)>
2021-05-15 17:43:35.342504 (MainThread): 
2021-05-15 17:43:35.342504 (MainThread): Completed with 1 error and 0 warnings:
2021-05-15 17:43:35.342504 (MainThread): 
2021-05-15 17:43:35.342504 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-05-15 17:43:35.342504 (MainThread):   Name shipper_id not found inside orders at [38:38]
2021-05-15 17:43:35.342504 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-05-15 17:43:35.342504 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-15 17:43:35.350532 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285001B2AC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285001B2888>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285001B2788>]}
2021-05-15 17:43:35.350969 (MainThread): Flushing usage events
2021-05-15 17:44:48.251357 (MainThread): Running with dbt=0.19.1
2021-05-15 17:44:48.551204 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['stg_orders'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 17:44:48.551204 (MainThread): Tracking: tracking
2021-05-15 17:44:48.551204 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A80C20F6C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A80C20FB08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A80C20FC48>]}
2021-05-15 17:44:48.559200 (MainThread): Partial parsing not enabled
2021-05-15 17:44:48.567194 (MainThread): Parsing macros\adapters.sql
2021-05-15 17:44:48.583194 (MainThread): Parsing macros\catalog.sql
2021-05-15 17:44:48.591188 (MainThread): Parsing macros\etc.sql
2021-05-15 17:44:48.591188 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 17:44:48.591188 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 17:44:48.607187 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 17:44:48.607187 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 17:44:48.607187 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 17:44:48.615171 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 17:44:48.623174 (MainThread): Parsing macros\core.sql
2021-05-15 17:44:48.623174 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 17:44:48.664906 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 17:44:48.680954 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 17:44:48.680954 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 17:44:48.680954 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 17:44:48.680954 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 17:44:48.680954 (MainThread): Parsing macros\etc\query.sql
2021-05-15 17:44:48.680954 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 17:44:48.688949 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 17:44:48.704949 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 17:44:48.704949 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 17:44:48.712946 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 17:44:48.728937 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 17:44:48.760919 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 17:44:48.768925 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 17:44:48.784916 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 17:44:48.784916 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 17:44:48.792928 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 17:44:48.800908 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 17:44:48.800908 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 17:44:48.800908 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 17:44:48.800908 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 17:44:48.808896 (MainThread): Partial parsing not enabled
2021-05-15 17:44:48.832931 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 17:44:48.840892 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 17:44:48.840892 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 17:44:48.848890 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 17:44:48.848890 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 17:44:48.848890 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 17:44:48.856883 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 17:44:48.856883 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 17:44:48.864878 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 17:44:48.864878 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 17:44:48.872876 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 17:44:48.872876 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 17:44:48.872876 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 17:44:48.944843 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 17:44:48.954302 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49cdcf51-f6cd-4961-9321-bc4b79d4dd4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A80FDEB9C8>]}
2021-05-15 17:44:48.954302 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49cdcf51-f6cd-4961-9321-bc4b79d4dd4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A80FCC4048>]}
2021-05-15 17:44:48.954302 (MainThread): Found 13 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 17:44:48.962395 (MainThread): 
2021-05-15 17:44:48.962395 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 17:44:48.962395 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 17:44:48.962395 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 17:44:51.426095 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 17:44:51.426095 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 17:44:51.442093 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 17:44:53.309909 (MainThread): 14:44:53 | Concurrency: 1 threads (target='dev')
2021-05-15 17:44:53.309909 (MainThread): 14:44:53 | 
2021-05-15 17:44:53.311749 (Thread-1): Began running node model.northwind_shop.stg_orders
2021-05-15 17:44:53.311749 (Thread-1): 14:44:53 | 1 of 1 START view model dbt_arthur.stg_orders........................ [RUN]
2021-05-15 17:44:53.311749 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 17:44:53.311749 (Thread-1): Compiling model.northwind_shop.stg_orders
2021-05-15 17:44:53.322087 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_orders"
2021-05-15 17:44:53.323638 (Thread-1): finished collecting timing info
2021-05-15 17:44:53.359606 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_orders"
2021-05-15 17:44:53.360628 (Thread-1): Opening a new connection, currently in state init
2021-05-15 17:44:53.364791 (Thread-1): On model.northwind_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_orders"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_orders`
  OPTIONS()
  as with
    source as (
        select 
          /*Primary key*/ 
            order_id
          /*Foreign Key*/
            ,employee_id
            ,customer_id
            ,ship_region	
            ,shipped_date
            ,ship_country	
            ,ship_name
            ,order_date		
            ,ship_postal_code	
            ,ship_city	
            ,freight	
            ,ship_via as shipper_id
            ,required_date
            ,ship_address
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`orders`
    )
select * from source;


2021-05-15 17:44:55.932023 (Thread-1): finished collecting timing info
2021-05-15 17:44:55.932023 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49cdcf51-f6cd-4961-9321-bc4b79d4dd4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A80FD15AC8>]}
2021-05-15 17:44:55.940021 (Thread-1): 14:44:55 | 1 of 1 OK created view model dbt_arthur.stg_orders................... [OK in 2.62s]
2021-05-15 17:44:55.940021 (Thread-1): Finished running node model.northwind_shop.stg_orders
2021-05-15 17:44:56.022564 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 17:44:56.022564 (MainThread): 14:44:56 | 
2021-05-15 17:44:56.022564 (MainThread): 14:44:56 | Finished running 1 view model in 7.06s.
2021-05-15 17:44:56.022564 (MainThread): Connection 'master' was properly closed.
2021-05-15 17:44:56.022564 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 17:44:56.022564 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 17:44:56.022564 (MainThread): Connection 'model.northwind_shop.stg_orders' was properly closed.
2021-05-15 17:44:56.022564 (MainThread): unclosed <socket.socket fd=892, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61349), raddr=('216.58.202.170', 443)>
2021-05-15 17:44:56.022564 (MainThread): unclosed <socket.socket fd=1068, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61350), raddr=('142.250.219.10', 443)>
2021-05-15 17:44:56.030353 (MainThread): unclosed <socket.socket fd=1080, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61352), raddr=('142.250.219.10', 443)>
2021-05-15 17:44:56.030353 (MainThread): unclosed <socket.socket fd=1076, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61351), raddr=('216.58.202.170', 443)>
2021-05-15 17:44:56.030353 (MainThread): unclosed <socket.socket fd=932, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61353), raddr=('216.58.202.170', 443)>
2021-05-15 17:44:56.030353 (MainThread): unclosed <socket.socket fd=356, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61355), raddr=('142.250.219.10', 443)>
2021-05-15 17:44:56.076139 (MainThread): 
2021-05-15 17:44:56.076139 (MainThread): Completed successfully
2021-05-15 17:44:56.078274 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-15 17:44:56.079311 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A80C1B6E88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A80C1B6B48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A80C1B6D88>]}
2021-05-15 17:44:56.080331 (MainThread): Flushing usage events
2021-05-15 17:45:06.351667 (MainThread): The 'warn' method is deprecated, use 'warning' instead
2021-05-15 17:45:06.352170 (MainThread): Error sending message, disabling tracking
2021-05-15 17:46:10.326778 (MainThread): Running with dbt=0.19.1
2021-05-15 17:46:10.681261 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 17:46:10.681261 (MainThread): Tracking: tracking
2021-05-15 17:46:10.681261 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A9B562388>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A9B584F48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A9B586888>]}
2021-05-15 17:46:10.689261 (MainThread): Partial parsing not enabled
2021-05-15 17:46:10.689261 (MainThread): Parsing macros\adapters.sql
2021-05-15 17:46:10.713248 (MainThread): Parsing macros\catalog.sql
2021-05-15 17:46:10.721212 (MainThread): Parsing macros\etc.sql
2021-05-15 17:46:10.721212 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 17:46:10.721212 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 17:46:10.737240 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 17:46:10.737240 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 17:46:10.737240 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 17:46:10.745236 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 17:46:10.753235 (MainThread): Parsing macros\core.sql
2021-05-15 17:46:10.753235 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 17:46:10.793221 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 17:46:10.801216 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 17:46:10.801216 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 17:46:10.809214 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 17:46:10.809214 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 17:46:10.809214 (MainThread): Parsing macros\etc\query.sql
2021-05-15 17:46:10.809214 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 17:46:10.817209 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 17:46:10.833161 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 17:46:10.841158 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 17:46:10.841158 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 17:46:10.865147 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 17:46:10.905176 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 17:46:10.905176 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 17:46:10.921128 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 17:46:10.929123 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 17:46:10.937157 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 17:46:10.937157 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 17:46:10.945152 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 17:46:10.945152 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 17:46:10.945152 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 17:46:10.953154 (MainThread): Partial parsing not enabled
2021-05-15 17:46:10.969159 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 17:46:10.977139 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 17:46:10.985137 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 17:46:10.985137 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 17:46:10.993129 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 17:46:10.993129 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 17:46:10.998767 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 17:46:11.006834 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 17:46:11.006834 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 17:46:11.006834 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 17:46:11.014820 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 17:46:11.014820 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 17:46:11.022824 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 17:46:11.094882 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 17:46:11.103207 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '861403ac-a9d3-4c7a-9a65-2c0ced8a8882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A9F1D4D08>]}
2021-05-15 17:46:11.103207 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '861403ac-a9d3-4c7a-9a65-2c0ced8a8882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A9F039548>]}
2021-05-15 17:46:11.103207 (MainThread): Found 13 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 17:46:11.103207 (MainThread): 
2021-05-15 17:46:11.111278 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 17:46:11.111278 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 17:46:11.111278 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 17:46:12.557984 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 17:46:12.558478 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 17:46:12.563832 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 17:46:14.542892 (MainThread): 14:46:14 | Concurrency: 1 threads (target='dev')
2021-05-15 17:46:14.542892 (MainThread): 14:46:14 | 
2021-05-15 17:46:14.542892 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-05-15 17:46:14.542892 (Thread-1): 14:46:14 | 1 of 1 START view model dbt_arthur.fact_order_details................ [RUN]
2021-05-15 17:46:14.550889 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 17:46:14.550889 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-05-15 17:46:14.550889 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 17:46:14.550889 (Thread-1): finished collecting timing info
2021-05-15 17:46:14.590934 (Thread-1): Writing runtime SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 17:46:14.590934 (Thread-1): Opening a new connection, currently in state init
2021-05-15 17:46:14.590934 (Thread-1): On model.northwind_shop.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`fact_order_details`
  OPTIONS()
  as with 
    customers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
    )
    , suppliers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
    )
    , shippers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
    )
    , products as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
    )
    
    , orders_with_sk as ( 
        select 
            orders.order_id
            ,customers.customer_sk as customer_fk
            ,shippers.shipper_sk as shipper_fk            
            ,orders.ship_region	
            ,orders.shipped_date
            ,orders.ship_country	
            ,orders.ship_name
            ,orders.order_date		
            ,orders.ship_postal_code	
            ,orders.ship_city	
            ,orders.freight	
            ,orders.required_date
            ,orders.ship_address 

        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
        left join customers on orders.customer_id = customers.customer_id
        left join shippers on orders.shipper_id = shippers.shipper_id
    )

select * from orders_with_sk;


2021-05-15 17:46:16.411558 (Thread-1): finished collecting timing info
2021-05-15 17:46:16.411558 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '861403ac-a9d3-4c7a-9a65-2c0ced8a8882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A9F112D88>]}
2021-05-15 17:46:16.411558 (Thread-1): 14:46:16 | 1 of 1 OK created view model dbt_arthur.fact_order_details........... [OK in 1.87s]
2021-05-15 17:46:16.411558 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-05-15 17:46:16.488549 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 17:46:16.488549 (MainThread): 14:46:16 | 
2021-05-15 17:46:16.488549 (MainThread): 14:46:16 | Finished running 1 view model in 5.38s.
2021-05-15 17:46:16.488549 (MainThread): Connection 'master' was properly closed.
2021-05-15 17:46:16.491416 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 17:46:16.491416 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 17:46:16.491416 (MainThread): Connection 'model.northwind_shop.fact_order_details' was properly closed.
2021-05-15 17:46:16.491416 (MainThread): unclosed <socket.socket fd=500, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61396), raddr=('172.217.173.106', 443)>
2021-05-15 17:46:16.491416 (MainThread): unclosed <socket.socket fd=720, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61397), raddr=('142.250.219.10', 443)>
2021-05-15 17:46:16.491416 (MainThread): unclosed <socket.socket fd=1040, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61399), raddr=('142.250.219.10', 443)>
2021-05-15 17:46:16.491416 (MainThread): unclosed <socket.socket fd=812, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61398), raddr=('172.217.173.106', 443)>
2021-05-15 17:46:16.491416 (MainThread): unclosed <socket.socket fd=768, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61401), raddr=('172.217.173.106', 443)>
2021-05-15 17:46:16.491416 (MainThread): unclosed <socket.socket fd=1068, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61402), raddr=('142.250.219.10', 443)>
2021-05-15 17:46:16.539441 (MainThread): 
2021-05-15 17:46:16.539441 (MainThread): Completed successfully
2021-05-15 17:46:16.539441 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-15 17:46:16.539441 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A9B525908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A9B525808>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A9B525708>]}
2021-05-15 17:46:16.539441 (MainThread): Flushing usage events
2021-05-15 17:46:21.852737 (MainThread): The 'warn' method is deprecated, use 'warning' instead
2021-05-15 17:46:21.852737 (MainThread): Error sending message, disabling tracking
2021-05-15 18:14:18.802264 (MainThread): Running with dbt=0.19.1
2021-05-15 18:14:19.289957 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['final'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 18:14:19.290954 (MainThread): Tracking: tracking
2021-05-15 18:14:19.291950 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B66E830D08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B66E836C48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B66E8367C8>]}
2021-05-15 18:14:19.300920 (MainThread): Partial parsing not enabled
2021-05-15 18:14:19.302914 (MainThread): Parsing macros\adapters.sql
2021-05-15 18:14:19.322847 (MainThread): Parsing macros\catalog.sql
2021-05-15 18:14:19.329824 (MainThread): Parsing macros\etc.sql
2021-05-15 18:14:19.331817 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 18:14:19.336800 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 18:14:19.350764 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 18:14:19.353744 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 18:14:19.356734 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 18:14:19.365704 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 18:14:19.373677 (MainThread): Parsing macros\core.sql
2021-05-15 18:14:19.377664 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 18:14:19.421552 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 18:14:19.430522 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 18:14:19.431517 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 18:14:19.433510 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 18:14:19.436503 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 18:14:19.437497 (MainThread): Parsing macros\etc\query.sql
2021-05-15 18:14:19.439490 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 18:14:19.449457 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 18:14:19.467106 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 18:14:19.470096 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 18:14:19.477072 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 18:14:19.499996 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 18:14:19.534523 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 18:14:19.537650 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 18:14:19.554592 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 18:14:19.562092 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 18:14:19.567077 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 18:14:19.574075 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 18:14:19.577067 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 18:14:19.578063 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 18:14:19.580057 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 18:14:19.587488 (MainThread): Partial parsing not enabled
2021-05-15 18:14:19.609090 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 18:14:19.619603 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 18:14:19.623422 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 18:14:19.627411 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 18:14:19.631399 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 18:14:19.636381 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 18:14:19.643360 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 18:14:19.651462 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 18:14:19.655449 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 18:14:19.660458 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 18:14:19.664565 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 18:14:19.667555 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 18:14:19.671542 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 18:14:19.751316 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 18:14:19.754769 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a585ab9b-6882-4cba-ac64-1fadf56c3187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B67240AC48>]}
2021-05-15 18:14:19.760766 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a585ab9b-6882-4cba-ac64-1fadf56c3187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B67230F348>]}
2021-05-15 18:14:19.761766 (MainThread): Found 13 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 18:14:19.761766 (MainThread): The selector 'final' does not match any nodes and will be ignored
2021-05-15 18:14:19.763704 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2021-05-15 18:14:19.764748 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B67230F208>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B67230F188>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B672380D08>]}
2021-05-15 18:14:19.764748 (MainThread): Flushing usage events
2021-05-15 18:14:20.472010 (MainThread): Connection 'model.northwind_shop.stg_suppliers' was properly closed.
2021-05-15 18:18:22.400152 (MainThread): Running with dbt=0.19.1
2021-05-15 18:18:22.709133 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 18:18:22.709706 (MainThread): Tracking: tracking
2021-05-15 18:18:22.710634 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022228550CC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002222857EB48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222285885C8>]}
2021-05-15 18:18:22.719111 (MainThread): Partial parsing not enabled
2021-05-15 18:18:22.721105 (MainThread): Parsing macros\adapters.sql
2021-05-15 18:18:22.739045 (MainThread): Parsing macros\catalog.sql
2021-05-15 18:18:22.746021 (MainThread): Parsing macros\etc.sql
2021-05-15 18:18:22.748015 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 18:18:22.752001 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 18:18:22.764958 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 18:18:22.767948 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 18:18:22.769942 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 18:18:22.778911 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 18:18:22.784891 (MainThread): Parsing macros\core.sql
2021-05-15 18:18:22.788878 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 18:18:22.829741 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 18:18:22.837714 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 18:18:22.839708 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 18:18:22.840705 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 18:18:22.842698 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 18:18:22.844691 (MainThread): Parsing macros\etc\query.sql
2021-05-15 18:18:22.845688 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 18:18:22.855654 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 18:18:22.868611 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 18:18:22.870605 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 18:18:22.876584 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 18:18:22.897515 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 18:18:22.929408 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 18:18:22.931401 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 18:18:22.948344 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 18:18:22.955321 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 18:18:22.960387 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 18:18:22.966585 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 18:18:22.969575 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 18:18:22.970571 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 18:18:22.972565 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 18:18:22.979542 (MainThread): Partial parsing not enabled
2021-05-15 18:18:23.000472 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 18:18:23.009441 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 18:18:23.013428 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 18:18:23.016418 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 18:18:23.020405 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 18:18:23.024391 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 18:18:23.029375 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 18:18:23.032365 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 18:18:23.036351 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 18:18:23.040338 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 18:18:23.043328 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 18:18:23.047315 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 18:18:23.050305 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 18:18:23.127048 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-05-15 18:18:23.129923 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd822429-19b1-41b6-9ee7-2dede5a4bec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002222C15B588>]}
2021-05-15 18:18:23.137940 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd822429-19b1-41b6-9ee7-2dede5a4bec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002222C063948>]}
2021-05-15 18:18:23.137940 (MainThread): Found 13 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 18:18:23.139932 (MainThread): 
2021-05-15 18:18:23.140935 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 18:18:23.141925 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 18:18:23.142924 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 18:18:24.480651 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 18:18:24.481650 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 18:18:24.486291 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 18:18:25.629391 (MainThread): 15:18:25 | Concurrency: 1 threads (target='dev')
2021-05-15 18:18:25.630395 (MainThread): 15:18:25 | 
2021-05-15 18:18:25.645050 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-05-15 18:18:25.645050 (Thread-1): 15:18:25 | 1 of 1 START view model dbt_arthur.fact_order_details................ [RUN]
2021-05-15 18:18:25.645891 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 18:18:25.646892 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-05-15 18:18:25.652963 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 18:18:25.654675 (Thread-1): finished collecting timing info
2021-05-15 18:18:25.683625 (Thread-1): Writing runtime SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 18:18:25.684931 (Thread-1): Opening a new connection, currently in state init
2021-05-15 18:18:25.688919 (Thread-1): On model.northwind_shop.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`fact_order_details`
  OPTIONS()
  as with 
    customers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
    )
    , suppliers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
    )
    , shippers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
    )
    , products as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
    )
    
    , orders_with_sk as ( 
        select 
            orders.order_id
            ,customers.customer_sk as customer_fk
            ,shippers.shipper_sk as shipper_fk            
            ,orders.ship_region	
            ,orders.shipped_date
            ,orders.ship_country	
            ,orders.ship_name
            ,orders.order_date		
            ,orders.ship_postal_code	
            ,orders.ship_city	
            ,orders.freight	
            ,orders.required_date
            ,orders.ship_address 

        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
        left join customers on orders.customer_id = customers.customer_id
        left join shippers on orders.shipper_id = shippers.shipper_id
    )
    , orders_details_with_sk as (
        select 
            order_details.order_id
            ,products.product_sk as product_fk	
            ,order_details.is_discountinued	
            ,order_details.unit_price	
            ,order_details.quantity	
        from `northwind1-313400`.`dbt_arthur`.`stg_orderdetail` as order_details
        left join products on order_details.product_id = products.product_id
    )
    , final as (
        select 
            orders_details_with_sk.order_id
            ,orders_with_sk.customer_fk
            ,orders_with_sk.shipper_fk            
            ,orders_with_sk.ship_region	
            ,orders_with_sk.shipped_date
            ,orders_with_sk.ship_country	
            ,orders_with_sk.ship_name
            ,orders_with_sk.order_date		
            ,orders_with_sk.ship_postal_code	
            ,orders_with_sk.ship_city	
            ,orders_with_sk.freight	
            ,orders_with_sk.required_date
            ,orders_with_sk.ship_address
            ,orders_details_with_sk.product_fk	
            ,orders_details_with_sk.is_discountinued	
            ,orders_details_with_sk.unit_price	
            ,orders_details_with_sk.quantity	
        from orders_with_sk
        left join orders_details_with_sk on orders_with_sk.order_id = orders_details_with_sk.order_id
     )
select * from final;


2021-05-15 18:18:28.128208 (Thread-1): finished collecting timing info
2021-05-15 18:18:28.129205 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd822429-19b1-41b6-9ee7-2dede5a4bec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002222C0D52C8>]}
2021-05-15 18:18:28.129205 (Thread-1): 15:18:28 | 1 of 1 OK created view model dbt_arthur.fact_order_details........... [OK in 2.48s]
2021-05-15 18:18:28.131412 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-05-15 18:18:28.153593 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 18:18:28.153593 (MainThread): 15:18:28 | 
2021-05-15 18:18:28.154645 (MainThread): 15:18:28 | Finished running 1 view model in 5.01s.
2021-05-15 18:18:28.154645 (MainThread): Connection 'master' was properly closed.
2021-05-15 18:18:28.154645 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 18:18:28.155645 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 18:18:28.155645 (MainThread): Connection 'model.northwind_shop.fact_order_details' was properly closed.
2021-05-15 18:18:28.156642 (MainThread): unclosed <socket.socket fd=72, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61811), raddr=('172.217.173.74', 443)>
2021-05-15 18:18:28.157640 (MainThread): unclosed <socket.socket fd=1020, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61812), raddr=('142.250.219.10', 443)>
2021-05-15 18:18:28.157640 (MainThread): unclosed <socket.socket fd=980, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61814), raddr=('142.250.219.10', 443)>
2021-05-15 18:18:28.157640 (MainThread): unclosed <socket.socket fd=984, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61813), raddr=('172.217.173.74', 443)>
2021-05-15 18:18:28.157640 (MainThread): unclosed <socket.socket fd=1108, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61815), raddr=('172.217.173.74', 443)>
2021-05-15 18:18:28.158635 (MainThread): unclosed <socket.socket fd=1172, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 61816), raddr=('142.250.219.10', 443)>
2021-05-15 18:18:28.207956 (MainThread): 
2021-05-15 18:18:28.209133 (MainThread): Completed successfully
2021-05-15 18:18:28.209708 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-15 18:18:28.210711 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222285263C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022228526248>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022228526688>]}
2021-05-15 18:18:28.211705 (MainThread): Flushing usage events
2021-05-15 18:18:38.431439 (MainThread): The 'warn' method is deprecated, use 'warning' instead
2021-05-15 18:18:38.432443 (MainThread): Error sending message, disabling tracking
2021-05-15 18:42:49.116463 (MainThread): Running with dbt=0.19.1
2021-05-15 18:42:49.970186 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 18:42:49.972179 (MainThread): Tracking: tracking
2021-05-15 18:42:49.973178 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF12D40748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF12D40CC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF12D40B88>]}
2021-05-15 18:42:49.987130 (MainThread): Partial parsing not enabled
2021-05-15 18:42:49.989123 (MainThread): Parsing macros\adapters.sql
2021-05-15 18:42:50.018028 (MainThread): Parsing macros\catalog.sql
2021-05-15 18:42:50.026021 (MainThread): Parsing macros\etc.sql
2021-05-15 18:42:50.033975 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 18:42:50.039952 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 18:42:50.057892 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 18:42:50.064871 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 18:42:50.067861 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 18:42:50.084803 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 18:42:50.093776 (MainThread): Parsing macros\core.sql
2021-05-15 18:42:50.101885 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 18:42:50.166615 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 18:42:50.181671 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 18:42:50.183657 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 18:42:50.185657 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 18:42:50.188646 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 18:42:50.189645 (MainThread): Parsing macros\etc\query.sql
2021-05-15 18:42:50.191650 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 18:42:50.204593 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 18:42:50.225299 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 18:42:50.232278 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 18:42:50.240250 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 18:42:50.271146 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 18:42:50.319715 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 18:42:50.322697 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 18:42:50.350622 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 18:42:50.359575 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 18:42:50.368551 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 18:42:50.376131 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 18:42:50.382114 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 18:42:50.384107 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 18:42:50.386100 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 18:42:50.397066 (MainThread): Partial parsing not enabled
2021-05-15 18:42:50.430722 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 18:42:50.441679 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 18:42:50.449652 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 18:42:50.454636 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 18:42:50.459621 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 18:42:50.467592 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 18:42:50.475565 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 18:42:50.483539 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 18:42:50.488525 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 18:42:50.493509 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 18:42:50.501479 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 18:42:50.506463 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 18:42:50.514947 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 18:42:50.647329 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c19e3d7-8719-4e8f-ac19-e05ed9e88e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF168EEA08>]}
2021-05-15 18:42:50.654333 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c19e3d7-8719-4e8f-ac19-e05ed9e88e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF16893188>]}
2021-05-15 18:42:50.654333 (MainThread): Found 13 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 18:42:50.656328 (MainThread): 
2021-05-15 18:42:50.657315 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 18:42:50.660312 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 18:42:50.661321 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 18:42:51.954002 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 18:42:51.954002 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 18:42:51.962453 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 18:42:53.161679 (MainThread): 15:42:53 | Concurrency: 1 threads (target='dev')
2021-05-15 18:42:53.162675 (MainThread): 15:42:53 | 
2021-05-15 18:42:53.165669 (Thread-1): Began running node model.northwind_shop.stg_customers
2021-05-15 18:42:53.166667 (Thread-1): 15:42:53 | 1 of 13 START view model dbt_arthur.stg_customers.................... [RUN]
2021-05-15 18:42:53.166667 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 18:42:53.167666 (Thread-1): Compiling model.northwind_shop.stg_customers
2021-05-15 18:42:53.169657 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_customers"
2021-05-15 18:42:53.171645 (Thread-1): finished collecting timing info
2021-05-15 18:42:53.218093 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_customers"
2021-05-15 18:42:53.220085 (Thread-1): Opening a new connection, currently in state init
2021-05-15 18:42:53.227064 (Thread-1): On model.northwind_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_customers"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_customers`
  OPTIONS()
  as with
    source as (
        select 
           /*primary key*/
            customer_id
            ,country	
            ,city	
            ,fax	
            ,postal_code	
            ,address	
            ,region	
            ,contact_name		
            ,phone	
            ,company_name	
            ,contact_title
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`customers`
    )
select * from source;


2021-05-15 18:42:55.636517 (Thread-1): finished collecting timing info
2021-05-15 18:42:55.637514 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c19e3d7-8719-4e8f-ac19-e05ed9e88e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF1682F0C8>]}
2021-05-15 18:42:55.638513 (Thread-1): 15:42:55 | 1 of 13 OK created view model dbt_arthur.stg_customers............... [OK in 2.47s]
2021-05-15 18:42:55.640535 (Thread-1): Finished running node model.northwind_shop.stg_customers
2021-05-15 18:42:55.641033 (Thread-1): Began running node model.northwind_shop.stg_products
2021-05-15 18:42:55.641033 (Thread-1): 15:42:55 | 2 of 13 START view model dbt_arthur.stg_products..................... [RUN]
2021-05-15 18:42:55.642043 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 18:42:55.642043 (Thread-1): Compiling model.northwind_shop.stg_products
2021-05-15 18:42:55.643039 (Thread-1): unclosed <socket.socket fd=788, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62324), raddr=('172.217.30.170', 443)>
2021-05-15 18:42:55.644041 (Thread-1): unclosed <socket.socket fd=992, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62325), raddr=('142.250.79.202', 443)>
2021-05-15 18:42:55.647043 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_products"
2021-05-15 18:42:55.649020 (Thread-1): finished collecting timing info
2021-05-15 18:42:55.694716 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_products"
2021-05-15 18:42:55.695713 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 18:42:55.704680 (Thread-1): On model.northwind_shop.stg_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_products`
  OPTIONS()
  as with
    source as (
        select 
            /* Primary key */
               product_id

            /*Foreign key */
            , category_id
            , supplier_id

            , units_in_stock           	
            , unit_price	
            , product_name	
            , quantity_per_unit	
            	
            , reorder_level	
            , units_on_order	
            , 
                case
                 when discontinued = 1 then True
                 else False
                end as is_discontinued 
            /* Stitich Columns*/
            , _sdc_table_version
            , _sdc_sequence
            , _sdc_batched_at	
            , _sdc_extracted_at	
            , _sdc_received_at

        from `northwind1-313400`.`northwind_etl`.`products`
    )
select * from source;


2021-05-15 18:42:58.027704 (Thread-1): finished collecting timing info
2021-05-15 18:42:58.028717 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c19e3d7-8719-4e8f-ac19-e05ed9e88e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF12CF5988>]}
2021-05-15 18:42:58.028717 (Thread-1): 15:42:58 | 2 of 13 OK created view model dbt_arthur.stg_products................ [OK in 2.39s]
2021-05-15 18:42:58.029639 (Thread-1): Finished running node model.northwind_shop.stg_products
2021-05-15 18:42:58.030635 (Thread-1): Began running node model.northwind_shop.stg_shippers
2021-05-15 18:42:58.030635 (Thread-1): 15:42:58 | 3 of 13 START view model dbt_arthur.stg_shippers..................... [RUN]
2021-05-15 18:42:58.031635 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 18:42:58.031635 (Thread-1): Compiling model.northwind_shop.stg_shippers
2021-05-15 18:42:58.036162 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_shippers"
2021-05-15 18:42:58.038166 (Thread-1): finished collecting timing info
2021-05-15 18:42:58.040158 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_shippers"
2021-05-15 18:42:58.041155 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 18:42:58.046136 (Thread-1): On model.northwind_shop.stg_shippers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_shippers"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_shippers`
  OPTIONS()
  as with
    source as (
        select 
           /*primary key*/
            shipper_id
            ,phone	
            ,company_name
	
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`shippers`
    )
select * from source;


2021-05-15 18:43:00.341029 (Thread-1): finished collecting timing info
2021-05-15 18:43:00.342025 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c19e3d7-8719-4e8f-ac19-e05ed9e88e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF12D5EF08>]}
2021-05-15 18:43:00.342025 (Thread-1): 15:43:00 | 3 of 13 OK created view model dbt_arthur.stg_shippers................ [OK in 2.31s]
2021-05-15 18:43:00.343026 (Thread-1): Finished running node model.northwind_shop.stg_shippers
2021-05-15 18:43:00.344020 (Thread-1): Began running node model.northwind_shop.stg_suppliers
2021-05-15 18:43:00.344020 (Thread-1): 15:43:00 | 4 of 13 START view model dbt_arthur.stg_suppliers.................... [RUN]
2021-05-15 18:43:00.345075 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 18:43:00.345075 (Thread-1): Compiling model.northwind_shop.stg_suppliers
2021-05-15 18:43:00.346013 (Thread-1): unclosed <socket.socket fd=956, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62329), raddr=('172.217.30.170', 443)>
2021-05-15 18:43:00.347009 (Thread-1): unclosed <socket.socket fd=1140, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62330), raddr=('142.250.79.202', 443)>
2021-05-15 18:43:00.350041 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_suppliers"
2021-05-15 18:43:00.352315 (Thread-1): finished collecting timing info
2021-05-15 18:43:00.354317 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_suppliers"
2021-05-15 18:43:00.355313 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 18:43:00.362875 (Thread-1): On model.northwind_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_suppliers"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_suppliers`
  OPTIONS()
  as with
    source as (
        select 
           /*primary key*/
            supplier_id
            ,country
            ,city	
            ,fax	
            ,postal_code
            ,homepage
            ,address	
            ,region	
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`suppliers`
    )
select * from source;


2021-05-15 18:43:02.651862 (Thread-1): finished collecting timing info
2021-05-15 18:43:02.652865 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c19e3d7-8719-4e8f-ac19-e05ed9e88e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF125D8108>]}
2021-05-15 18:43:02.652865 (Thread-1): 15:43:02 | 4 of 13 OK created view model dbt_arthur.stg_suppliers............... [OK in 2.31s]
2021-05-15 18:43:02.653871 (Thread-1): Finished running node model.northwind_shop.stg_suppliers
2021-05-15 18:43:02.654854 (Thread-1): Began running node model.northwind_shop.stg_employees
2021-05-15 18:43:02.654854 (Thread-1): 15:43:02 | 5 of 13 START view model dbt_arthur.stg_employees.................... [RUN]
2021-05-15 18:43:02.655849 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 18:43:02.655849 (Thread-1): Compiling model.northwind_shop.stg_employees
2021-05-15 18:43:02.656846 (Thread-1): unclosed <socket.socket fd=1124, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62332), raddr=('172.217.30.170', 443)>
2021-05-15 18:43:02.656846 (Thread-1): unclosed <socket.socket fd=1128, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62333), raddr=('142.250.79.202', 443)>
2021-05-15 18:43:02.659837 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_employees"
2021-05-15 18:43:02.661836 (Thread-1): finished collecting timing info
2021-05-15 18:43:02.664823 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_employees"
2021-05-15 18:43:02.668766 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 18:43:02.673759 (Thread-1): On model.northwind_shop.stg_employees: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_employees"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_employees`
  OPTIONS()
  as with
    source as (
        select 
           /*primary key*/
            employee_id	
            ,country	
            ,city	
            ,postal_code
            ,hire_date	
            ,extension	
            ,address	
            ,birth_date	
            ,region	
            ,photo_path	
            ,last_name	
            ,first_name	
            ,title	
            ,title_of_courtesy	
            ,notes	
            ,home_phone	
            ,reports_to	
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`employees`
    )
select * from source;


2021-05-15 18:43:04.934066 (Thread-1): finished collecting timing info
2021-05-15 18:43:04.935063 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c19e3d7-8719-4e8f-ac19-e05ed9e88e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF12D78E48>]}
2021-05-15 18:43:04.935063 (Thread-1): 15:43:04 | 5 of 13 OK created view model dbt_arthur.stg_employees............... [OK in 2.28s]
2021-05-15 18:43:04.936060 (Thread-1): Finished running node model.northwind_shop.stg_employees
2021-05-15 18:43:04.936060 (Thread-1): Began running node model.northwind_shop.stg_orderdetail
2021-05-15 18:43:04.937123 (Thread-1): 15:43:04 | 6 of 13 START view model dbt_arthur.stg_orderdetail.................. [RUN]
2021-05-15 18:43:04.938240 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 18:43:04.938240 (Thread-1): Compiling model.northwind_shop.stg_orderdetail
2021-05-15 18:43:04.943304 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_orderdetail"
2021-05-15 18:43:04.944222 (Thread-1): finished collecting timing info
2021-05-15 18:43:04.949927 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_orderdetail"
2021-05-15 18:43:04.950921 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 18:43:04.955959 (Thread-1): On model.northwind_shop.stg_orderdetail: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_orderdetail"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_orderdetail`
  OPTIONS()
  as with
    source as (
        select 
           /*primary key*/
            order_id
            ,product_id		
            , 
               case
                  when discount = 1 then True
                  else False
               end as is_discountinued	
            ,unit_price	
            ,quantity	
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`order_details`
)
select * from source;


2021-05-15 18:43:07.130344 (Thread-1): finished collecting timing info
2021-05-15 18:43:07.131363 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c19e3d7-8719-4e8f-ac19-e05ed9e88e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF168CA688>]}
2021-05-15 18:43:07.131363 (Thread-1): 15:43:07 | 6 of 13 OK created view model dbt_arthur.stg_orderdetail............. [OK in 2.19s]
2021-05-15 18:43:07.132337 (Thread-1): Finished running node model.northwind_shop.stg_orderdetail
2021-05-15 18:43:07.132337 (Thread-1): Began running node model.northwind_shop.stg_orders
2021-05-15 18:43:07.133335 (Thread-1): 15:43:07 | 7 of 13 START view model dbt_arthur.stg_orders....................... [RUN]
2021-05-15 18:43:07.134342 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 18:43:07.134342 (Thread-1): Compiling model.northwind_shop.stg_orders
2021-05-15 18:43:07.138320 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_orders"
2021-05-15 18:43:07.140313 (Thread-1): finished collecting timing info
2021-05-15 18:43:07.143519 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_orders"
2021-05-15 18:43:07.147420 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 18:43:07.152135 (Thread-1): On model.northwind_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.stg_orders"} */


  create or replace view `northwind1-313400`.`dbt_arthur`.`stg_orders`
  OPTIONS()
  as with
    source as (
        select 
          /*Primary key*/ 
            order_id
          /*Foreign Key*/
            ,employee_id
            ,customer_id
            ,ship_region	
            ,shipped_date
            ,ship_country	
            ,ship_name
            ,order_date		
            ,ship_postal_code	
            ,ship_city	
            ,freight	
            ,ship_via as shipper_id
            ,required_date
            ,ship_address
            /*Stitch Columns*/	
            ,_sdc_batched_at		
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence

        from `northwind1-313400`.`northwind_etl`.`orders`
    )
select * from source;


2021-05-15 18:43:07.157117 (Thread-1): unclosed <socket.socket fd=736, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62326), raddr=('172.217.30.170', 443)>
2021-05-15 18:43:07.157117 (Thread-1): unclosed <socket.socket fd=440, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62327), raddr=('142.250.79.202', 443)>
2021-05-15 18:43:07.164103 (Thread-1): unclosed <socket.socket fd=1204, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62334), raddr=('172.217.30.170', 443)>
2021-05-15 18:43:07.164103 (Thread-1): unclosed <socket.socket fd=1200, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62335), raddr=('142.250.79.202', 443)>
2021-05-15 18:43:07.164103 (Thread-1): unclosed <socket.socket fd=1244, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62336), raddr=('172.217.30.170', 443)>
2021-05-15 18:43:07.165090 (Thread-1): unclosed <socket.socket fd=1256, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62337), raddr=('142.250.79.202', 443)>
2021-05-15 18:43:09.499649 (Thread-1): finished collecting timing info
2021-05-15 18:43:09.500658 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c19e3d7-8719-4e8f-ac19-e05ed9e88e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF1681CBC8>]}
2021-05-15 18:43:09.501647 (Thread-1): 15:43:09 | 7 of 13 OK created view model dbt_arthur.stg_orders.................. [OK in 2.37s]
2021-05-15 18:43:09.503579 (Thread-1): Finished running node model.northwind_shop.stg_orders
2021-05-15 18:43:09.503579 (Thread-1): Began running node model.northwind_shop.dim_customers
2021-05-15 18:43:09.503579 (Thread-1): 15:43:09 | 8 of 13 START table model dbt_arthur.dim_customers................... [RUN]
2021-05-15 18:43:09.504623 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 18:43:09.505572 (Thread-1): Compiling model.northwind_shop.dim_customers
2021-05-15 18:43:09.511551 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_customers"
2021-05-15 18:43:09.516598 (Thread-1): finished collecting timing info
2021-05-15 18:43:09.539074 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 18:43:09.545062 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 18:43:10.144803 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 18:43:10.770538 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_customers"
2021-05-15 18:43:10.772481 (Thread-1): On model.northwind_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.dim_customers"} */


  create or replace table `northwind1-313400`.`dbt_arthur`.`dim_customers`
  
  
  OPTIONS()
  as (
    with
    selected as (
        select 
           /*primary key*/
            customer_id
            ,country	
            ,city	
            ,fax	
            ,postal_code	
            ,address	
            ,region	
            ,contact_name		
            ,phone	
            ,company_name	
            ,contact_title


        from `northwind1-313400`.`dbt_arthur`.`stg_customers`
    )
    , transformed as (
        select 
        row_number() over (order by customer_id) as customer_sk
        , *
        from selected
    )

select * from transformed
  );
    
2021-05-15 18:43:14.200558 (Thread-1): finished collecting timing info
2021-05-15 18:43:14.200558 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c19e3d7-8719-4e8f-ac19-e05ed9e88e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF1678F8C8>]}
2021-05-15 18:43:14.201613 (Thread-1): 15:43:14 | 8 of 13 OK created table model dbt_arthur.dim_customers.............. [CREATE TABLE (91.0 rows, 12.0 KB processed) in 4.70s]
2021-05-15 18:43:14.203584 (Thread-1): Finished running node model.northwind_shop.dim_customers
2021-05-15 18:43:14.204584 (Thread-1): Began running node model.northwind_shop.dim_products
2021-05-15 18:43:14.206842 (Thread-1): 15:43:14 | 9 of 13 START table model dbt_arthur.dim_products.................... [RUN]
2021-05-15 18:43:14.207839 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 18:43:14.207839 (Thread-1): Compiling model.northwind_shop.dim_products
2021-05-15 18:43:14.211886 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_products"
2021-05-15 18:43:14.212901 (Thread-1): finished collecting timing info
2021-05-15 18:43:14.214890 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 18:43:14.221788 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 18:43:15.422313 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 18:43:16.292922 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_products"
2021-05-15 18:43:16.294958 (Thread-1): On model.northwind_shop.dim_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.dim_products"} */


  create or replace table `northwind1-313400`.`dbt_arthur`.`dim_products`
  
  
  OPTIONS()
  as (
    with
    selected as (
        select 
            /* Primary key */
               product_id

            /*Foreign key */
            , category_id
            , supplier_id

            , units_in_stock           	
            , unit_price	
            , product_name	
            , quantity_per_unit	
            	
            , reorder_level	
            , units_on_order	
            , is_discontinued

        from `northwind1-313400`.`dbt_arthur`.`stg_products`
    )
    , transformed as (
        select 
        row_number() over (order by product_id) as product_sk
        , *
        from selected
    )

select * from transformed
  );
    
2021-05-15 18:43:19.091276 (Thread-1): finished collecting timing info
2021-05-15 18:43:19.091276 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c19e3d7-8719-4e8f-ac19-e05ed9e88e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF166E7108>]}
2021-05-15 18:43:19.091276 (Thread-1): 15:43:19 | 9 of 13 OK created table model dbt_arthur.dim_products............... [CREATE TABLE (77.0 rows, 7.5 KB processed) in 4.88s]
2021-05-15 18:43:19.093289 (Thread-1): Finished running node model.northwind_shop.dim_products
2021-05-15 18:43:19.094267 (Thread-1): Began running node model.northwind_shop.dim_shippers
2021-05-15 18:43:19.094267 (Thread-1): 15:43:19 | 10 of 13 START table model dbt_arthur.dim_shippers................... [RUN]
2021-05-15 18:43:19.096263 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 18:43:19.096263 (Thread-1): Compiling model.northwind_shop.dim_shippers
2021-05-15 18:43:19.101332 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_shippers"
2021-05-15 18:43:19.109849 (Thread-1): finished collecting timing info
2021-05-15 18:43:19.111898 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 18:43:19.120806 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 18:43:20.306552 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 18:43:20.573933 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_shippers"
2021-05-15 18:43:20.574929 (Thread-1): On model.northwind_shop.dim_shippers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.dim_shippers"} */


  create or replace table `northwind1-313400`.`dbt_arthur`.`dim_shippers`
  
  
  OPTIONS()
  as (
    with
    selected as (
        select 
           /*primary key*/
            shipper_id
            ,phone	
            ,company_name
	

        from `northwind1-313400`.`dbt_arthur`.`stg_shippers`
    ), transformed as (
       select 
         row_number() over (order by shipper_id) as shipper_sk
         , *
       from selected
    )
select * from transformed
  );
    
2021-05-15 18:43:23.956538 (Thread-1): finished collecting timing info
2021-05-15 18:43:23.956538 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c19e3d7-8719-4e8f-ac19-e05ed9e88e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF1678E048>]}
2021-05-15 18:43:23.957597 (Thread-1): 15:43:23 | 10 of 13 OK created table model dbt_arthur.dim_shippers.............. [CREATE TABLE (6.0 rows, 223.0 Bytes processed) in 4.86s]
2021-05-15 18:43:23.958535 (Thread-1): Finished running node model.northwind_shop.dim_shippers
2021-05-15 18:43:23.958535 (Thread-1): Began running node model.northwind_shop.dim_suppliers
2021-05-15 18:43:23.960172 (Thread-1): 15:43:23 | 11 of 13 START table model dbt_arthur.dim_suppliers.................. [RUN]
2021-05-15 18:43:23.962165 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 18:43:23.963730 (Thread-1): Compiling model.northwind_shop.dim_suppliers
2021-05-15 18:43:23.967342 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_suppliers"
2021-05-15 18:43:23.976992 (Thread-1): finished collecting timing info
2021-05-15 18:43:23.980411 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 18:43:23.986435 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 18:43:25.153521 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 18:43:25.414009 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_suppliers"
2021-05-15 18:43:25.415981 (Thread-1): On model.northwind_shop.dim_suppliers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.dim_suppliers"} */


  create or replace table `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
  
  
  OPTIONS()
  as (
    with
    selected as (
        select 
          /*primary key*/
            supplier_id
            ,country
            ,city	
            ,fax	
            ,postal_code
            ,homepage
            ,address	
            ,region	

        from `northwind1-313400`.`dbt_arthur`.`stg_suppliers`
    )
    , transformed as (
        select 
        row_number() over (order by supplier_id) as supplier_sk
        , *
        from selected
    )

select * from transformed
  );
    
2021-05-15 18:43:28.626951 (Thread-1): finished collecting timing info
2021-05-15 18:43:28.628020 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c19e3d7-8719-4e8f-ac19-e05ed9e88e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF16A11148>]}
2021-05-15 18:43:28.628020 (Thread-1): 15:43:28 | 11 of 13 OK created table model dbt_arthur.dim_suppliers............. [CREATE TABLE (29.0 rows, 2.1 KB processed) in 4.67s]
2021-05-15 18:43:28.629973 (Thread-1): Finished running node model.northwind_shop.dim_suppliers
2021-05-15 18:43:28.629973 (Thread-1): Began running node model.northwind_shop.dim_employees
2021-05-15 18:43:28.629973 (Thread-1): 15:43:28 | 12 of 13 START table model dbt_arthur.dim_employees.................. [RUN]
2021-05-15 18:43:28.631959 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 18:43:28.631959 (Thread-1): Compiling model.northwind_shop.dim_employees
2021-05-15 18:43:28.635957 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_employees"
2021-05-15 18:43:28.645189 (Thread-1): finished collecting timing info
2021-05-15 18:43:28.647241 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 18:43:28.656154 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 18:43:28.659178 (Thread-1): unclosed <socket.socket fd=1280, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62341), raddr=('142.250.79.202', 443)>
2021-05-15 18:43:28.660184 (Thread-1): unclosed <socket.socket fd=1316, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62340), raddr=('172.217.30.170', 443)>
2021-05-15 18:43:28.660184 (Thread-1): unclosed <socket.socket fd=1356, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62346), raddr=('142.250.79.202', 443)>
2021-05-15 18:43:28.660184 (Thread-1): unclosed <socket.socket fd=1332, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62345), raddr=('172.217.30.170', 443)>
2021-05-15 18:43:28.660184 (Thread-1): unclosed <socket.socket fd=1408, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62349), raddr=('142.250.79.202', 443)>
2021-05-15 18:43:28.660184 (Thread-1): unclosed <socket.socket fd=1412, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62348), raddr=('172.217.30.170', 443)>
2021-05-15 18:43:28.661177 (Thread-1): unclosed <socket.socket fd=1064, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62351), raddr=('142.250.79.202', 443)>
2021-05-15 18:43:28.661177 (Thread-1): unclosed <socket.socket fd=1436, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62350), raddr=('172.217.30.170', 443)>
2021-05-15 18:43:29.889965 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 18:43:30.197422 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_employees"
2021-05-15 18:43:30.206925 (Thread-1): On model.northwind_shop.dim_employees: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.dim_employees"} */


  create or replace table `northwind1-313400`.`dbt_arthur`.`dim_employees`
  
  
  OPTIONS()
  as (
    with
    selected as (
        select 
            employee_id	
            ,country	
            ,city	
            ,postal_code
            ,hire_date	
            ,extension	
            ,address	
            ,birth_date	
            ,region	
            ,photo_path	
            ,last_name	
            ,first_name	
            ,title	
            ,title_of_courtesy	
            ,notes	
            ,home_phone	
            ,reports_to	
        from `northwind1-313400`.`dbt_arthur`.`stg_employees`
    )
    , transformed as (
        select 
        row_number() over (order by employee_id) as employee_sk
        , *
        from selected
    )

select * from transformed
  );
    
2021-05-15 18:43:33.425092 (Thread-1): finished collecting timing info
2021-05-15 18:43:33.426089 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c19e3d7-8719-4e8f-ac19-e05ed9e88e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF16A16688>]}
2021-05-15 18:43:33.427086 (Thread-1): 15:43:33 | 12 of 13 OK created table model dbt_arthur.dim_employees............. [CREATE TABLE (9.0 rows, 3.9 KB processed) in 4.80s]
2021-05-15 18:43:33.428500 (Thread-1): Finished running node model.northwind_shop.dim_employees
2021-05-15 18:43:33.428500 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-05-15 18:43:33.429538 (Thread-1): 15:43:33 | 13 of 13 START table model dbt_arthur.fact_order_details............. [RUN]
2021-05-15 18:43:33.430538 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 18:43:33.430538 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-05-15 18:43:33.438381 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 18:43:33.447353 (Thread-1): finished collecting timing info
2021-05-15 18:43:33.449346 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 18:43:33.459392 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 18:43:34.669175 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 18:43:34.940603 (Thread-1): Writing runtime SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 18:43:34.950772 (Thread-1): On model.northwind_shop.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */


  create or replace table `northwind1-313400`.`dbt_arthur`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with 
    customers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_customers`
    )
    , suppliers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
    )
    , shippers as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
    )
    , products as (
        select * from `northwind1-313400`.`dbt_arthur`.`dim_products`
    )
    
    , orders_with_sk as ( 
        select 
            orders.order_id
            ,customers.customer_sk as customer_fk
            ,shippers.shipper_sk as shipper_fk            
            ,orders.ship_region	
            ,orders.shipped_date
            ,orders.ship_country	
            ,orders.ship_name
            ,orders.order_date		
            ,orders.ship_postal_code	
            ,orders.ship_city	
            ,orders.freight	
            ,orders.required_date
            ,orders.ship_address 

        from `northwind1-313400`.`dbt_arthur`.`stg_orders` as orders
        left join customers on orders.customer_id = customers.customer_id
        left join shippers on orders.shipper_id = shippers.shipper_id
    )
    , orders_details_with_sk as (
        select 
            order_details.order_id
            ,products.product_sk as product_fk	
            ,order_details.is_discountinued	
            ,order_details.unit_price	
            ,order_details.quantity	
        from `northwind1-313400`.`dbt_arthur`.`stg_orderdetail` as order_details
        left join products on order_details.product_id = products.product_id
    )
    , final as (
        select 
            orders_details_with_sk.order_id
            ,orders_with_sk.customer_fk
            ,orders_with_sk.shipper_fk            
            ,orders_with_sk.ship_region	
            ,orders_with_sk.shipped_date
            ,orders_with_sk.ship_country	
            ,orders_with_sk.ship_name
            ,orders_with_sk.order_date		
            ,orders_with_sk.ship_postal_code	
            ,orders_with_sk.ship_city	
            ,orders_with_sk.freight	
            ,orders_with_sk.required_date
            ,orders_with_sk.ship_address
            ,orders_details_with_sk.product_fk	
            ,orders_details_with_sk.is_discountinued	
            ,orders_details_with_sk.unit_price	
            ,orders_details_with_sk.quantity	
        from orders_with_sk
        left join orders_details_with_sk on orders_with_sk.order_id = orders_details_with_sk.order_id
     )
select * from final
  );
    
2021-05-15 18:43:38.435532 (Thread-1): finished collecting timing info
2021-05-15 18:43:38.436548 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c19e3d7-8719-4e8f-ac19-e05ed9e88e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF16864948>]}
2021-05-15 18:43:38.437554 (Thread-1): 15:43:38 | 13 of 13 OK created table model dbt_arthur.fact_order_details........ [CREATE TABLE (2.2k rows, 186.5 KB processed) in 5.01s]
2021-05-15 18:43:38.438516 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-05-15 18:43:38.531531 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 18:43:38.532541 (MainThread): 15:43:38 | 
2021-05-15 18:43:38.533554 (MainThread): 15:43:38 | Finished running 7 view models, 6 table models in 47.88s.
2021-05-15 18:43:38.534538 (MainThread): Connection 'master' was properly closed.
2021-05-15 18:43:38.534538 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 18:43:38.535535 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 18:43:38.535535 (MainThread): Connection 'model.northwind_shop.fact_order_details' was properly closed.
2021-05-15 18:43:38.547534 (MainThread): 
2021-05-15 18:43:38.548828 (MainThread): Completed successfully
2021-05-15 18:43:38.549823 (MainThread): 
Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
2021-05-15 18:43:38.550743 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF1683E588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF16906748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF12D7B148>]}
2021-05-15 18:43:38.550743 (MainThread): Flushing usage events
2021-05-15 19:19:05.717420 (MainThread): Running with dbt=0.19.1
2021-05-15 19:19:06.207465 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-05-15 19:19:06.208462 (MainThread): Tracking: tracking
2021-05-15 19:19:06.208462 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D010958BC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D010AF0B48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D010AF0EC8>]}
2021-05-15 19:19:06.218429 (MainThread): Partial parsing not enabled
2021-05-15 19:19:06.221850 (MainThread): Parsing macros\adapters.sql
2021-05-15 19:19:06.243180 (MainThread): Parsing macros\catalog.sql
2021-05-15 19:19:06.251134 (MainThread): Parsing macros\etc.sql
2021-05-15 19:19:06.254124 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 19:19:06.259107 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 19:19:06.271349 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 19:19:06.274339 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 19:19:06.276333 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 19:19:06.286300 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 19:19:06.292279 (MainThread): Parsing macros\core.sql
2021-05-15 19:19:06.297287 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 19:19:06.340119 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 19:19:06.350086 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 19:19:06.352089 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 19:19:06.354045 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 19:19:06.356040 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 19:19:06.358033 (MainThread): Parsing macros\etc\query.sql
2021-05-15 19:19:06.359030 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 19:19:06.368997 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 19:19:06.383976 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 19:19:06.386937 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 19:19:06.393913 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 19:19:06.414836 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 19:19:06.449135 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 19:19:06.451129 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 19:19:06.472942 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 19:19:06.482098 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 19:19:06.489542 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 19:19:06.496839 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 19:19:06.500826 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 19:19:06.502819 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 19:19:06.504825 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 19:19:06.511795 (MainThread): Partial parsing not enabled
2021-05-15 19:19:06.535713 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 19:19:06.553334 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 19:19:06.558389 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 19:19:06.563379 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 19:19:06.567365 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 19:19:06.572368 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 19:19:06.580322 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 19:19:06.584309 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 19:19:06.588300 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 19:19:06.593279 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 19:19:06.598384 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 19:19:06.602372 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 19:19:06.606358 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 19:19:06.697984 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '030d9b8d-42f5-41b7-8cf1-f52487d852e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D014602B48>]}
2021-05-15 19:19:06.703964 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '030d9b8d-42f5-41b7-8cf1-f52487d852e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D01453F988>]}
2021-05-15 19:19:06.703964 (MainThread): Found 13 models, 4 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 19:19:06.706955 (MainThread): 
2021-05-15 19:19:06.706955 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 19:19:06.709946 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 19:19:06.710943 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 19:19:06.719911 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 19:19:08.031554 (MainThread): 16:19:08 | Concurrency: 1 threads (target='dev')
2021-05-15 19:19:08.032549 (MainThread): 16:19:08 | 
2021-05-15 19:19:08.036097 (Thread-1): Began running node test.northwind_shop.not_null_dim_customers_customers_sk
2021-05-15 19:19:08.036593 (Thread-1): 16:19:08 | 1 of 4 START test not_null_dim_customers_customers_sk................ [RUN]
2021-05-15 19:19:08.037674 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.not_null_dim_customers_customers_sk".
2021-05-15 19:19:08.037674 (Thread-1): Compiling test.northwind_shop.not_null_dim_customers_customers_sk
2021-05-15 19:19:08.050685 (Thread-1): Writing injected SQL for node "test.northwind_shop.not_null_dim_customers_customers_sk"
2021-05-15 19:19:08.053676 (Thread-1): finished collecting timing info
2021-05-15 19:19:08.053676 (Thread-1): Opening a new connection, currently in state init
2021-05-15 19:19:08.059470 (Thread-1): On test.northwind_shop.not_null_dim_customers_customers_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "test.northwind_shop.not_null_dim_customers_customers_sk"} */

    
    



select count(*) as validation_errors
from `northwind1-313400`.`dbt_arthur`.`dim_customers`
where customers_sk is null



2021-05-15 19:19:10.046434 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/51c79831-8f33-41ec-ab2a-692ae56d4cb5?maxResults=0&location=US&prettyPrint=false: Unrecognized name: customers_sk; Did you mean customer_sk? at [10:7]')
2021-05-15 19:19:11.503615 (Thread-1): finished collecting timing info
2021-05-15 19:19:11.503615 (Thread-1): Database Error in test not_null_dim_customers_customers_sk (models\marts\dim_customers.yml)
  Unrecognized name: customers_sk; Did you mean customer_sk? at [10:7]
  compiled SQL at target\compiled\northwind_shop\models\marts\dim_customers.yml\schema_test\not_null_dim_customers_customers_sk.sql
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/45f59841-089f-4711-a2cd-9a356a77658f?maxResults=0&location=US&prettyPrint=false: Unrecognized name: customers_sk; Did you mean customer_sk? at [10:7]

(job ID: 45f59841-089f-4711-a2cd-9a356a77658f)

                                                                        -----Query Job SQL Follows-----                                                                         

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "test.northwind_shop.not_null_dim_customers_customers_sk"} */
   2:
   3:    
   4:    
   5:
   6:
   7:
   8:select count(*) as validation_errors
   9:from `northwind1-313400`.`dbt_arthur`.`dim_customers`
  10:where customers_sk is null
  11:
  12:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\test.py", line 85, in execute
    failed_rows = self.execute_schema_test(test)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\test.py", line 65, in execute_schema_test
    fetch=True,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in test not_null_dim_customers_customers_sk (models\marts\dim_customers.yml)
  Unrecognized name: customers_sk; Did you mean customer_sk? at [10:7]
  compiled SQL at target\compiled\northwind_shop\models\marts\dim_customers.yml\schema_test\not_null_dim_customers_customers_sk.sql
2021-05-15 19:19:11.528875 (Thread-1): 16:19:11 | 1 of 4 ERROR not_null_dim_customers_customers_sk..................... [ERROR in 3.49s]
2021-05-15 19:19:11.530709 (Thread-1): Finished running node test.northwind_shop.not_null_dim_customers_customers_sk
2021-05-15 19:19:11.530709 (Thread-1): Began running node test.northwind_shop.source_not_null_northwind_etl_orders_order_id
2021-05-15 19:19:11.531711 (Thread-1): 16:19:11 | 2 of 4 START test source_not_null_northwind_etl_orders_order_id...... [RUN]
2021-05-15 19:19:11.532706 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.source_not_null_northwind_etl_orders_order_id".
2021-05-15 19:19:11.532706 (Thread-1): Compiling test.northwind_shop.source_not_null_northwind_etl_orders_order_id
2021-05-15 19:19:11.536693 (Thread-1): Writing injected SQL for node "test.northwind_shop.source_not_null_northwind_etl_orders_order_id"
2021-05-15 19:19:11.541046 (Thread-1): finished collecting timing info
2021-05-15 19:19:11.541976 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 19:19:11.546958 (Thread-1): On test.northwind_shop.source_not_null_northwind_etl_orders_order_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "test.northwind_shop.source_not_null_northwind_etl_orders_order_id"} */

    
    



select count(*) as validation_errors
from `northwind1-313400`.`northwind_etl`.`orders`
where order_id is null



2021-05-15 19:19:13.791579 (Thread-1): finished collecting timing info
2021-05-15 19:19:13.792576 (Thread-1): 16:19:13 | 2 of 4 PASS source_not_null_northwind_etl_orders_order_id............ [PASS in 2.26s]
2021-05-15 19:19:13.794570 (Thread-1): Finished running node test.northwind_shop.source_not_null_northwind_etl_orders_order_id
2021-05-15 19:19:13.794570 (Thread-1): Began running node test.northwind_shop.source_unique_northwind_etl_orders_order_id
2021-05-15 19:19:13.794570 (Thread-1): 16:19:13 | 3 of 4 START test source_unique_northwind_etl_orders_order_id........ [RUN]
2021-05-15 19:19:13.795578 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.source_unique_northwind_etl_orders_order_id".
2021-05-15 19:19:13.795578 (Thread-1): Compiling test.northwind_shop.source_unique_northwind_etl_orders_order_id
2021-05-15 19:19:13.796629 (Thread-1): unclosed <socket.socket fd=1108, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62673), raddr=('142.250.219.10', 443)>
2021-05-15 19:19:13.796629 (Thread-1): unclosed <socket.socket fd=1132, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62674), raddr=('142.250.219.10', 443)>
2021-05-15 19:19:13.815898 (Thread-1): Writing injected SQL for node "test.northwind_shop.source_unique_northwind_etl_orders_order_id"
2021-05-15 19:19:13.817250 (Thread-1): finished collecting timing info
2021-05-15 19:19:13.817250 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 19:19:13.824232 (Thread-1): On test.northwind_shop.source_unique_northwind_etl_orders_order_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "test.northwind_shop.source_unique_northwind_etl_orders_order_id"} */

    
    



select count(*) as validation_errors
from (

    select
        order_id

    from `northwind1-313400`.`northwind_etl`.`orders`
    where order_id is not null
    group by order_id
    having count(*) > 1

) validation_errors



2021-05-15 19:19:13.826224 (Thread-1): unclosed <socket.socket fd=1052, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62671), raddr=('142.250.219.10', 443)>
2021-05-15 19:19:13.827254 (Thread-1): unclosed <socket.socket fd=1056, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62672), raddr=('142.250.219.10', 443)>
2021-05-15 19:19:16.369060 (Thread-1): finished collecting timing info
2021-05-15 19:19:16.369060 (Thread-1): 16:19:16 | 3 of 4 PASS source_unique_northwind_etl_orders_order_id.............. [PASS in 2.57s]
2021-05-15 19:19:16.372009 (Thread-1): Finished running node test.northwind_shop.source_unique_northwind_etl_orders_order_id
2021-05-15 19:19:16.372009 (Thread-1): Began running node test.northwind_shop.unique_dim_customers_customers_sk
2021-05-15 19:19:16.372009 (Thread-1): 16:19:16 | 4 of 4 START test unique_dim_customers_customers_sk.................. [RUN]
2021-05-15 19:19:16.374003 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.unique_dim_customers_customers_sk".
2021-05-15 19:19:16.374003 (Thread-1): Compiling test.northwind_shop.unique_dim_customers_customers_sk
2021-05-15 19:19:16.410936 (Thread-1): unclosed <socket.socket fd=992, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62676), raddr=('142.250.219.10', 443)>
2021-05-15 19:19:16.410936 (Thread-1): unclosed <socket.socket fd=904, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62677), raddr=('142.250.219.10', 443)>
2021-05-15 19:19:16.414915 (Thread-1): Writing injected SQL for node "test.northwind_shop.unique_dim_customers_customers_sk"
2021-05-15 19:19:16.415861 (Thread-1): finished collecting timing info
2021-05-15 19:19:16.415861 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 19:19:16.420880 (Thread-1): On test.northwind_shop.unique_dim_customers_customers_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "test.northwind_shop.unique_dim_customers_customers_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        customers_sk

    from `northwind1-313400`.`dbt_arthur`.`dim_customers`
    where customers_sk is not null
    group by customers_sk
    having count(*) > 1

) validation_errors



2021-05-15 19:19:17.965869 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/cc426496-d70e-4543-b53f-71b1415e25fe?maxResults=0&location=US&prettyPrint=false: Unrecognized name: customers_sk; Did you mean customer_sk? at [15:11]')
2021-05-15 19:19:19.845626 (Thread-1): finished collecting timing info
2021-05-15 19:19:19.845626 (Thread-1): Database Error in test unique_dim_customers_customers_sk (models\marts\dim_customers.yml)
  Unrecognized name: customers_sk; Did you mean customer_sk? at [15:11]
  compiled SQL at target\compiled\northwind_shop\models\marts\dim_customers.yml\schema_test\unique_dim_customers_customers_sk.sql
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/3c5c9cb9-2376-4625-b3b6-54fad11d6ce8?maxResults=0&location=US&prettyPrint=false: Unrecognized name: customers_sk; Did you mean customer_sk? at [15:11]

(job ID: 3c5c9cb9-2376-4625-b3b6-54fad11d6ce8)

                                                                       -----Query Job SQL Follows-----                                                                        

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "test.northwind_shop.unique_dim_customers_customers_sk"} */
   2:
   3:    
   4:    
   5:
   6:
   7:
   8:select count(*) as validation_errors
   9:from (
  10:
  11:    select
  12:        customers_sk
  13:
  14:    from `northwind1-313400`.`dbt_arthur`.`dim_customers`
  15:    where customers_sk is not null
  16:    group by customers_sk
  17:    having count(*) > 1
  18:
  19:) validation_errors
  20:
  21:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\test.py", line 85, in execute
    failed_rows = self.execute_schema_test(test)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\test.py", line 65, in execute_schema_test
    fetch=True,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in test unique_dim_customers_customers_sk (models\marts\dim_customers.yml)
  Unrecognized name: customers_sk; Did you mean customer_sk? at [15:11]
  compiled SQL at target\compiled\northwind_shop\models\marts\dim_customers.yml\schema_test\unique_dim_customers_customers_sk.sql
2021-05-15 19:19:19.845626 (Thread-1): 16:19:19 | 4 of 4 ERROR unique_dim_customers_customers_sk....................... [ERROR in 3.47s]
2021-05-15 19:19:19.845626 (Thread-1): Finished running node test.northwind_shop.unique_dim_customers_customers_sk
2021-05-15 19:19:19.932014 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 19:19:19.932014 (MainThread): 16:19:19 | 
2021-05-15 19:19:19.932014 (MainThread): 16:19:19 | Finished running 4 tests in 13.23s.
2021-05-15 19:19:19.932014 (MainThread): Connection 'master' was properly closed.
2021-05-15 19:19:19.932014 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 19:19:19.935843 (MainThread): Connection 'test.northwind_shop.unique_dim_customers_customers_sk' was properly closed.
2021-05-15 19:19:19.944562 (MainThread): 
2021-05-15 19:19:19.945483 (MainThread): Completed with 2 errors and 0 warnings:
2021-05-15 19:19:19.946484 (MainThread): 
2021-05-15 19:19:19.946484 (MainThread): Database Error in test not_null_dim_customers_customers_sk (models\marts\dim_customers.yml)
2021-05-15 19:19:19.948476 (MainThread):   Unrecognized name: customers_sk; Did you mean customer_sk? at [10:7]
2021-05-15 19:19:19.949474 (MainThread):   compiled SQL at target\compiled\northwind_shop\models\marts\dim_customers.yml\schema_test\not_null_dim_customers_customers_sk.sql
2021-05-15 19:19:19.950473 (MainThread): 
2021-05-15 19:19:19.951466 (MainThread): Database Error in test unique_dim_customers_customers_sk (models\marts\dim_customers.yml)
2021-05-15 19:19:19.952463 (MainThread):   Unrecognized name: customers_sk; Did you mean customer_sk? at [15:11]
2021-05-15 19:19:19.953463 (MainThread):   compiled SQL at target\compiled\northwind_shop\models\marts\dim_customers.yml\schema_test\unique_dim_customers_customers_sk.sql
2021-05-15 19:19:19.954556 (MainThread): 
Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
2021-05-15 19:19:19.955530 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D012A39908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D012A39988>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D01454F348>]}
2021-05-15 19:19:19.957363 (MainThread): Flushing usage events
2021-05-15 19:23:04.883666 (MainThread): Running with dbt=0.19.1
2021-05-15 19:23:05.195840 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-05-15 19:23:05.195840 (MainThread): Tracking: tracking
2021-05-15 19:23:05.195840 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000134BEA18B88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000134BEB30F88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000134BEB30E08>]}
2021-05-15 19:23:05.211523 (MainThread): Partial parsing not enabled
2021-05-15 19:23:05.211523 (MainThread): Parsing macros\adapters.sql
2021-05-15 19:23:05.227091 (MainThread): Parsing macros\catalog.sql
2021-05-15 19:23:05.227091 (MainThread): Parsing macros\etc.sql
2021-05-15 19:23:05.227091 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 19:23:05.242714 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 19:23:05.258337 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 19:23:05.258337 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 19:23:05.258337 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 19:23:05.258337 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 19:23:05.273960 (MainThread): Parsing macros\core.sql
2021-05-15 19:23:05.273960 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 19:23:05.325689 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 19:23:05.327884 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 19:23:05.327884 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 19:23:05.327884 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 19:23:05.327884 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 19:23:05.327884 (MainThread): Parsing macros\etc\query.sql
2021-05-15 19:23:05.327884 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 19:23:05.344830 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 19:23:05.367191 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 19:23:05.369178 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 19:23:05.376166 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 19:23:05.393339 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 19:23:05.432329 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 19:23:05.434283 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 19:23:05.460458 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 19:23:05.470499 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 19:23:05.485340 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 19:23:05.502548 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 19:23:05.505541 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 19:23:05.507534 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 19:23:05.509530 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 19:23:05.521489 (MainThread): Partial parsing not enabled
2021-05-15 19:23:05.553411 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 19:23:05.568378 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 19:23:05.572364 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 19:23:05.576351 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 19:23:05.583338 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 19:23:05.587316 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 19:23:05.593294 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 19:23:05.599276 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 19:23:05.603262 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 19:23:05.607248 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 19:23:05.613231 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 19:23:05.618993 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 19:23:05.623976 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 19:23:05.785422 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '015013cb-97a4-465a-ab21-06e7f18992eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000134C26F38C8>]}
2021-05-15 19:23:05.792398 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '015013cb-97a4-465a-ab21-06e7f18992eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000134C25D8088>]}
2021-05-15 19:23:05.792398 (MainThread): Found 13 models, 6 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 19:23:05.796425 (MainThread): 
2021-05-15 19:23:05.797421 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 19:23:05.800411 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 19:23:05.800411 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 19:23:05.806394 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 19:23:07.004853 (MainThread): 16:23:07 | Concurrency: 1 threads (target='dev')
2021-05-15 19:23:07.005356 (MainThread): 16:23:07 | 
2021-05-15 19:23:07.009847 (Thread-1): Began running node test.northwind_shop.not_null_dim_customers_customer_sk
2021-05-15 19:23:07.010336 (Thread-1): 16:23:07 | 1 of 6 START test not_null_dim_customers_customer_sk................. [RUN]
2021-05-15 19:23:07.011520 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.not_null_dim_customers_customer_sk".
2021-05-15 19:23:07.011520 (Thread-1): Compiling test.northwind_shop.not_null_dim_customers_customer_sk
2021-05-15 19:23:07.029626 (Thread-1): Writing injected SQL for node "test.northwind_shop.not_null_dim_customers_customer_sk"
2021-05-15 19:23:07.032286 (Thread-1): finished collecting timing info
2021-05-15 19:23:07.032286 (Thread-1): Opening a new connection, currently in state init
2021-05-15 19:23:07.039835 (Thread-1): On test.northwind_shop.not_null_dim_customers_customer_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "test.northwind_shop.not_null_dim_customers_customer_sk"} */

    
    



select count(*) as validation_errors
from `northwind1-313400`.`dbt_arthur`.`dim_customers`
where customer_sk is null



2021-05-15 19:23:09.322171 (Thread-1): finished collecting timing info
2021-05-15 19:23:09.323076 (Thread-1): 16:23:09 | 1 of 6 PASS not_null_dim_customers_customer_sk....................... [PASS in 2.31s]
2021-05-15 19:23:09.325021 (Thread-1): Finished running node test.northwind_shop.not_null_dim_customers_customer_sk
2021-05-15 19:23:09.325021 (Thread-1): Began running node test.northwind_shop.not_null_dim_products_products_sk
2021-05-15 19:23:09.325021 (Thread-1): 16:23:09 | 2 of 6 START test not_null_dim_products_products_sk.................. [RUN]
2021-05-15 19:23:09.326058 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.not_null_dim_products_products_sk".
2021-05-15 19:23:09.327063 (Thread-1): Compiling test.northwind_shop.not_null_dim_products_products_sk
2021-05-15 19:23:09.328011 (Thread-1): unclosed <socket.socket fd=1132, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62697), raddr=('142.250.219.10', 443)>
2021-05-15 19:23:09.329006 (Thread-1): unclosed <socket.socket fd=1140, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62698), raddr=('142.250.219.10', 443)>
2021-05-15 19:23:09.333036 (Thread-1): Writing injected SQL for node "test.northwind_shop.not_null_dim_products_products_sk"
2021-05-15 19:23:09.334044 (Thread-1): finished collecting timing info
2021-05-15 19:23:09.334044 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 19:23:09.338973 (Thread-1): On test.northwind_shop.not_null_dim_products_products_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "test.northwind_shop.not_null_dim_products_products_sk"} */

    
    



select count(*) as validation_errors
from `northwind1-313400`.`dbt_arthur`.`dim_products`
where products_sk is null



2021-05-15 19:23:10.917018 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/2632277a-1058-40a8-b987-c767b2e6e62f?maxResults=0&location=US&prettyPrint=false: Unrecognized name: products_sk; Did you mean product_sk? at [10:7]')
2021-05-15 19:23:12.807151 (Thread-1): finished collecting timing info
2021-05-15 19:23:12.808317 (Thread-1): Database Error in test not_null_dim_products_products_sk (models\marts\dim_products.yml)
  Unrecognized name: products_sk; Did you mean product_sk? at [10:7]
  compiled SQL at target\compiled\northwind_shop\models\marts\dim_products.yml\schema_test\not_null_dim_products_products_sk.sql
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/8ae171cc-7ecd-43b1-93b5-2dd604e01530?maxResults=0&location=US&prettyPrint=false: Unrecognized name: products_sk; Did you mean product_sk? at [10:7]

(job ID: 8ae171cc-7ecd-43b1-93b5-2dd604e01530)

                                                                       -----Query Job SQL Follows-----                                                                        

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "test.northwind_shop.not_null_dim_products_products_sk"} */
   2:
   3:    
   4:    
   5:
   6:
   7:
   8:select count(*) as validation_errors
   9:from `northwind1-313400`.`dbt_arthur`.`dim_products`
  10:where products_sk is null
  11:
  12:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\test.py", line 85, in execute
    failed_rows = self.execute_schema_test(test)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\test.py", line 65, in execute_schema_test
    fetch=True,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in test not_null_dim_products_products_sk (models\marts\dim_products.yml)
  Unrecognized name: products_sk; Did you mean product_sk? at [10:7]
  compiled SQL at target\compiled\northwind_shop\models\marts\dim_products.yml\schema_test\not_null_dim_products_products_sk.sql
2021-05-15 19:23:12.813162 (Thread-1): 16:23:12 | 2 of 6 ERROR not_null_dim_products_products_sk....................... [ERROR in 3.49s]
2021-05-15 19:23:12.814084 (Thread-1): Finished running node test.northwind_shop.not_null_dim_products_products_sk
2021-05-15 19:23:12.814084 (Thread-1): Began running node test.northwind_shop.source_not_null_northwind_etl_orders_order_id
2021-05-15 19:23:12.814084 (Thread-1): 16:23:12 | 3 of 6 START test source_not_null_northwind_etl_orders_order_id...... [RUN]
2021-05-15 19:23:12.815228 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.source_not_null_northwind_etl_orders_order_id".
2021-05-15 19:23:12.815228 (Thread-1): Compiling test.northwind_shop.source_not_null_northwind_etl_orders_order_id
2021-05-15 19:23:12.849966 (Thread-1): unclosed <socket.socket fd=1176, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62700), raddr=('142.250.219.10', 443)>
2021-05-15 19:23:12.849966 (Thread-1): unclosed <socket.socket fd=1140, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62701), raddr=('142.250.219.10', 443)>
2021-05-15 19:23:12.852957 (Thread-1): Writing injected SQL for node "test.northwind_shop.source_not_null_northwind_etl_orders_order_id"
2021-05-15 19:23:12.853954 (Thread-1): finished collecting timing info
2021-05-15 19:23:12.853954 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 19:23:12.858936 (Thread-1): On test.northwind_shop.source_not_null_northwind_etl_orders_order_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "test.northwind_shop.source_not_null_northwind_etl_orders_order_id"} */

    
    



select count(*) as validation_errors
from `northwind1-313400`.`northwind_etl`.`orders`
where order_id is null



2021-05-15 19:23:15.723235 (Thread-1): finished collecting timing info
2021-05-15 19:23:15.724268 (Thread-1): 16:23:15 | 3 of 6 PASS source_not_null_northwind_etl_orders_order_id............ [PASS in 2.91s]
2021-05-15 19:23:15.725233 (Thread-1): Finished running node test.northwind_shop.source_not_null_northwind_etl_orders_order_id
2021-05-15 19:23:15.725233 (Thread-1): Began running node test.northwind_shop.source_unique_northwind_etl_orders_order_id
2021-05-15 19:23:15.726223 (Thread-1): 16:23:15 | 4 of 6 START test source_unique_northwind_etl_orders_order_id........ [RUN]
2021-05-15 19:23:15.727220 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.source_unique_northwind_etl_orders_order_id".
2021-05-15 19:23:15.727220 (Thread-1): Compiling test.northwind_shop.source_unique_northwind_etl_orders_order_id
2021-05-15 19:23:15.735249 (Thread-1): Writing injected SQL for node "test.northwind_shop.source_unique_northwind_etl_orders_order_id"
2021-05-15 19:23:15.736246 (Thread-1): finished collecting timing info
2021-05-15 19:23:15.736246 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 19:23:15.742219 (Thread-1): On test.northwind_shop.source_unique_northwind_etl_orders_order_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "test.northwind_shop.source_unique_northwind_etl_orders_order_id"} */

    
    



select count(*) as validation_errors
from (

    select
        order_id

    from `northwind1-313400`.`northwind_etl`.`orders`
    where order_id is not null
    group by order_id
    having count(*) > 1

) validation_errors



2021-05-15 19:23:18.008473 (Thread-1): finished collecting timing info
2021-05-15 19:23:18.009293 (Thread-1): 16:23:18 | 4 of 6 PASS source_unique_northwind_etl_orders_order_id.............. [PASS in 2.28s]
2021-05-15 19:23:18.011042 (Thread-1): Finished running node test.northwind_shop.source_unique_northwind_etl_orders_order_id
2021-05-15 19:23:18.011042 (Thread-1): Began running node test.northwind_shop.unique_dim_customers_customer_sk
2021-05-15 19:23:18.011042 (Thread-1): 16:23:18 | 5 of 6 START test unique_dim_customers_customer_sk................... [RUN]
2021-05-15 19:23:18.012041 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.unique_dim_customers_customer_sk".
2021-05-15 19:23:18.012041 (Thread-1): Compiling test.northwind_shop.unique_dim_customers_customer_sk
2021-05-15 19:23:18.013038 (Thread-1): unclosed <socket.socket fd=1104, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62705), raddr=('142.250.219.10', 443)>
2021-05-15 19:23:18.014075 (Thread-1): unclosed <socket.socket fd=1132, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62706), raddr=('142.250.219.10', 443)>
2021-05-15 19:23:18.019027 (Thread-1): Writing injected SQL for node "test.northwind_shop.unique_dim_customers_customer_sk"
2021-05-15 19:23:18.021011 (Thread-1): finished collecting timing info
2021-05-15 19:23:18.021011 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 19:23:18.025045 (Thread-1): On test.northwind_shop.unique_dim_customers_customer_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "test.northwind_shop.unique_dim_customers_customer_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        customer_sk

    from `northwind1-313400`.`dbt_arthur`.`dim_customers`
    where customer_sk is not null
    group by customer_sk
    having count(*) > 1

) validation_errors



2021-05-15 19:23:21.176996 (Thread-1): finished collecting timing info
2021-05-15 19:23:21.177938 (Thread-1): 16:23:21 | 5 of 6 PASS unique_dim_customers_customer_sk......................... [PASS in 3.17s]
2021-05-15 19:23:21.178880 (Thread-1): Finished running node test.northwind_shop.unique_dim_customers_customer_sk
2021-05-15 19:23:21.179882 (Thread-1): Began running node test.northwind_shop.unique_dim_products_products_sk
2021-05-15 19:23:21.179882 (Thread-1): 16:23:21 | 6 of 6 START test unique_dim_products_products_sk.................... [RUN]
2021-05-15 19:23:21.181870 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.unique_dim_products_products_sk".
2021-05-15 19:23:21.181870 (Thread-1): Compiling test.northwind_shop.unique_dim_products_products_sk
2021-05-15 19:23:21.188845 (Thread-1): Writing injected SQL for node "test.northwind_shop.unique_dim_products_products_sk"
2021-05-15 19:23:21.190849 (Thread-1): finished collecting timing info
2021-05-15 19:23:21.190849 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 19:23:21.196832 (Thread-1): On test.northwind_shop.unique_dim_products_products_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "test.northwind_shop.unique_dim_products_products_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        products_sk

    from `northwind1-313400`.`dbt_arthur`.`dim_products`
    where products_sk is not null
    group by products_sk
    having count(*) > 1

) validation_errors



2021-05-15 19:23:22.806685 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/3fe5b268-5d5a-487c-8d0f-3c9508c2b712?maxResults=0&location=US&prettyPrint=false: Unrecognized name: products_sk; Did you mean product_sk? at [15:11]')
2021-05-15 19:23:24.445915 (Thread-1): finished collecting timing info
2021-05-15 19:23:24.446912 (Thread-1): Database Error in test unique_dim_products_products_sk (models\marts\dim_products.yml)
  Unrecognized name: products_sk; Did you mean product_sk? at [15:11]
  compiled SQL at target\compiled\northwind_shop\models\marts\dim_products.yml\schema_test\unique_dim_products_products_sk.sql
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/0cff0151-2a73-4dd0-87fb-f40ff13dd851?maxResults=0&location=US&prettyPrint=false: Unrecognized name: products_sk; Did you mean product_sk? at [15:11]

(job ID: 0cff0151-2a73-4dd0-87fb-f40ff13dd851)

                                                                      -----Query Job SQL Follows-----                                                                       

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "test.northwind_shop.unique_dim_products_products_sk"} */
   2:
   3:    
   4:    
   5:
   6:
   7:
   8:select count(*) as validation_errors
   9:from (
  10:
  11:    select
  12:        products_sk
  13:
  14:    from `northwind1-313400`.`dbt_arthur`.`dim_products`
  15:    where products_sk is not null
  16:    group by products_sk
  17:    having count(*) > 1
  18:
  19:) validation_errors
  20:
  21:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\test.py", line 85, in execute
    failed_rows = self.execute_schema_test(test)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\test.py", line 65, in execute_schema_test
    fetch=True,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in test unique_dim_products_products_sk (models\marts\dim_products.yml)
  Unrecognized name: products_sk; Did you mean product_sk? at [15:11]
  compiled SQL at target\compiled\northwind_shop\models\marts\dim_products.yml\schema_test\unique_dim_products_products_sk.sql
2021-05-15 19:23:24.448904 (Thread-1): 16:23:24 | 6 of 6 ERROR unique_dim_products_products_sk......................... [ERROR in 3.27s]
2021-05-15 19:23:24.450483 (Thread-1): Finished running node test.northwind_shop.unique_dim_products_products_sk
2021-05-15 19:23:24.459454 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 19:23:24.459454 (MainThread): 16:23:24 | 
2021-05-15 19:23:24.460512 (MainThread): 16:23:24 | Finished running 6 tests in 18.66s.
2021-05-15 19:23:24.461489 (MainThread): Connection 'master' was properly closed.
2021-05-15 19:23:24.461489 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 19:23:24.462443 (MainThread): Connection 'test.northwind_shop.unique_dim_products_products_sk' was properly closed.
2021-05-15 19:23:24.469464 (MainThread): 
2021-05-15 19:23:24.470414 (MainThread): Completed with 2 errors and 0 warnings:
2021-05-15 19:23:24.471412 (MainThread): 
2021-05-15 19:23:24.471412 (MainThread): Database Error in test not_null_dim_products_products_sk (models\marts\dim_products.yml)
2021-05-15 19:23:24.472410 (MainThread):   Unrecognized name: products_sk; Did you mean product_sk? at [10:7]
2021-05-15 19:23:24.473408 (MainThread):   compiled SQL at target\compiled\northwind_shop\models\marts\dim_products.yml\schema_test\not_null_dim_products_products_sk.sql
2021-05-15 19:23:24.473408 (MainThread): 
2021-05-15 19:23:24.474404 (MainThread): Database Error in test unique_dim_products_products_sk (models\marts\dim_products.yml)
2021-05-15 19:23:24.475399 (MainThread):   Unrecognized name: products_sk; Did you mean product_sk? at [15:11]
2021-05-15 19:23:24.476400 (MainThread):   compiled SQL at target\compiled\northwind_shop\models\marts\dim_products.yml\schema_test\unique_dim_products_products_sk.sql
2021-05-15 19:23:24.477746 (MainThread): 
Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
2021-05-15 19:23:24.478565 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000134C261E148>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000134C288DD08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000134C2622088>]}
2021-05-15 19:23:24.479741 (MainThread): Flushing usage events
2021-05-15 19:23:31.030721 (MainThread): Running with dbt=0.19.1
2021-05-15 19:23:31.324863 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-05-15 19:23:31.324863 (MainThread): Tracking: tracking
2021-05-15 19:23:31.325860 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BB14E8B88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BB15E9B88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BB1600E08>]}
2021-05-15 19:23:31.333879 (MainThread): Partial parsing not enabled
2021-05-15 19:23:31.335826 (MainThread): Parsing macros\adapters.sql
2021-05-15 19:23:31.353774 (MainThread): Parsing macros\catalog.sql
2021-05-15 19:23:31.359754 (MainThread): Parsing macros\etc.sql
2021-05-15 19:23:31.361747 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 19:23:31.365734 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 19:23:31.377694 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 19:23:31.379687 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 19:23:31.381681 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 19:23:31.390651 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 19:23:31.395634 (MainThread): Parsing macros\core.sql
2021-05-15 19:23:31.399621 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 19:23:31.441481 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 19:23:31.449454 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 19:23:31.450451 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 19:23:31.452444 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 19:23:31.454437 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 19:23:31.455434 (MainThread): Parsing macros\etc\query.sql
2021-05-15 19:23:31.456431 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 19:23:31.465401 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 19:23:31.479354 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 19:23:31.481347 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 19:23:31.487327 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 19:23:31.509199 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 19:23:31.546328 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 19:23:31.549309 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 19:23:31.573233 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 19:23:31.582905 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 19:23:31.588168 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 19:23:31.596561 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 19:23:31.599923 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 19:23:31.601916 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 19:23:31.604914 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 19:23:31.612882 (MainThread): Partial parsing not enabled
2021-05-15 19:23:31.636804 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 19:23:31.646772 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 19:23:31.650759 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 19:23:31.654744 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 19:23:31.658732 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 19:23:31.662720 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 19:23:31.669695 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 19:23:31.673677 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 19:23:31.677668 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 19:23:31.681655 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 19:23:31.685643 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 19:23:31.689628 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 19:23:31.693616 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 19:23:31.796326 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ca5b492-5f2b-4702-a1aa-1c7fde272bcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BB51AFA48>]}
2021-05-15 19:23:31.802306 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ca5b492-5f2b-4702-a1aa-1c7fde272bcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BB50DF288>]}
2021-05-15 19:23:31.802306 (MainThread): Found 13 models, 6 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 19:23:31.805236 (MainThread): 
2021-05-15 19:23:31.805236 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 19:23:31.809226 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 19:23:31.809226 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 19:23:31.815261 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 19:23:32.365865 (MainThread): 16:23:32 | Concurrency: 1 threads (target='dev')
2021-05-15 19:23:32.366362 (MainThread): 16:23:32 | 
2021-05-15 19:23:32.371073 (Thread-1): Began running node test.northwind_shop.not_null_dim_customers_customer_sk
2021-05-15 19:23:32.371073 (Thread-1): 16:23:32 | 1 of 6 START test not_null_dim_customers_customer_sk................. [RUN]
2021-05-15 19:23:32.372627 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.not_null_dim_customers_customer_sk".
2021-05-15 19:23:32.372627 (Thread-1): Compiling test.northwind_shop.not_null_dim_customers_customer_sk
2021-05-15 19:23:32.387027 (Thread-1): Writing injected SQL for node "test.northwind_shop.not_null_dim_customers_customer_sk"
2021-05-15 19:23:32.388235 (Thread-1): finished collecting timing info
2021-05-15 19:23:32.388732 (Thread-1): Opening a new connection, currently in state init
2021-05-15 19:23:32.396384 (Thread-1): On test.northwind_shop.not_null_dim_customers_customer_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "test.northwind_shop.not_null_dim_customers_customer_sk"} */

    
    



select count(*) as validation_errors
from `northwind1-313400`.`dbt_arthur`.`dim_customers`
where customer_sk is null



2021-05-15 19:23:35.160263 (Thread-1): finished collecting timing info
2021-05-15 19:23:35.160263 (Thread-1): 16:23:35 | 1 of 6 PASS not_null_dim_customers_customer_sk....................... [PASS in 2.79s]
2021-05-15 19:23:35.162209 (Thread-1): Finished running node test.northwind_shop.not_null_dim_customers_customer_sk
2021-05-15 19:23:35.163204 (Thread-1): Began running node test.northwind_shop.not_null_dim_products_product_sk
2021-05-15 19:23:35.163491 (Thread-1): 16:23:35 | 2 of 6 START test not_null_dim_products_product_sk................... [RUN]
2021-05-15 19:23:35.163491 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.not_null_dim_products_product_sk".
2021-05-15 19:23:35.163491 (Thread-1): Compiling test.northwind_shop.not_null_dim_products_product_sk
2021-05-15 19:23:35.164696 (Thread-1): unclosed <socket.socket fd=1136, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62716), raddr=('142.250.219.10', 443)>
2021-05-15 19:23:35.165637 (Thread-1): unclosed <socket.socket fd=764, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62717), raddr=('142.250.219.10', 443)>
2021-05-15 19:23:35.170622 (Thread-1): Writing injected SQL for node "test.northwind_shop.not_null_dim_products_product_sk"
2021-05-15 19:23:35.179710 (Thread-1): finished collecting timing info
2021-05-15 19:23:35.179710 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 19:23:35.185619 (Thread-1): On test.northwind_shop.not_null_dim_products_product_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "test.northwind_shop.not_null_dim_products_product_sk"} */

    
    



select count(*) as validation_errors
from `northwind1-313400`.`dbt_arthur`.`dim_products`
where product_sk is null



2021-05-15 19:23:37.418912 (Thread-1): finished collecting timing info
2021-05-15 19:23:37.419906 (Thread-1): 16:23:37 | 2 of 6 PASS not_null_dim_products_product_sk......................... [PASS in 2.26s]
2021-05-15 19:23:37.421879 (Thread-1): Finished running node test.northwind_shop.not_null_dim_products_product_sk
2021-05-15 19:23:37.422901 (Thread-1): Began running node test.northwind_shop.source_not_null_northwind_etl_orders_order_id
2021-05-15 19:23:37.422901 (Thread-1): 16:23:37 | 3 of 6 START test source_not_null_northwind_etl_orders_order_id...... [RUN]
2021-05-15 19:23:37.423854 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.source_not_null_northwind_etl_orders_order_id".
2021-05-15 19:23:37.424863 (Thread-1): Compiling test.northwind_shop.source_not_null_northwind_etl_orders_order_id
2021-05-15 19:23:37.430886 (Thread-1): Writing injected SQL for node "test.northwind_shop.source_not_null_northwind_etl_orders_order_id"
2021-05-15 19:23:37.431826 (Thread-1): finished collecting timing info
2021-05-15 19:23:37.431826 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 19:23:37.437856 (Thread-1): On test.northwind_shop.source_not_null_northwind_etl_orders_order_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "test.northwind_shop.source_not_null_northwind_etl_orders_order_id"} */

    
    



select count(*) as validation_errors
from `northwind1-313400`.`northwind_etl`.`orders`
where order_id is null



2021-05-15 19:23:37.471011 (Thread-1): unclosed <socket.socket fd=1196, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62718), raddr=('142.250.219.10', 443)>
2021-05-15 19:23:37.471011 (Thread-1): unclosed <socket.socket fd=1200, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62719), raddr=('142.250.219.10', 443)>
2021-05-15 19:23:40.145372 (Thread-1): finished collecting timing info
2021-05-15 19:23:40.146364 (Thread-1): 16:23:40 | 3 of 6 PASS source_not_null_northwind_etl_orders_order_id............ [PASS in 2.72s]
2021-05-15 19:23:40.147313 (Thread-1): Finished running node test.northwind_shop.source_not_null_northwind_etl_orders_order_id
2021-05-15 19:23:40.147313 (Thread-1): Began running node test.northwind_shop.source_unique_northwind_etl_orders_order_id
2021-05-15 19:23:40.148323 (Thread-1): 16:23:40 | 4 of 6 START test source_unique_northwind_etl_orders_order_id........ [RUN]
2021-05-15 19:23:40.149456 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.source_unique_northwind_etl_orders_order_id".
2021-05-15 19:23:40.149456 (Thread-1): Compiling test.northwind_shop.source_unique_northwind_etl_orders_order_id
2021-05-15 19:23:40.157472 (Thread-1): Writing injected SQL for node "test.northwind_shop.source_unique_northwind_etl_orders_order_id"
2021-05-15 19:23:40.159420 (Thread-1): finished collecting timing info
2021-05-15 19:23:40.159420 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 19:23:40.165441 (Thread-1): On test.northwind_shop.source_unique_northwind_etl_orders_order_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "test.northwind_shop.source_unique_northwind_etl_orders_order_id"} */

    
    



select count(*) as validation_errors
from (

    select
        order_id

    from `northwind1-313400`.`northwind_etl`.`orders`
    where order_id is not null
    group by order_id
    having count(*) > 1

) validation_errors



2021-05-15 19:23:42.878201 (Thread-1): finished collecting timing info
2021-05-15 19:23:42.878201 (Thread-1): 16:23:42 | 4 of 6 PASS source_unique_northwind_etl_orders_order_id.............. [PASS in 2.73s]
2021-05-15 19:23:42.880187 (Thread-1): Finished running node test.northwind_shop.source_unique_northwind_etl_orders_order_id
2021-05-15 19:23:42.881185 (Thread-1): Began running node test.northwind_shop.unique_dim_customers_customer_sk
2021-05-15 19:23:42.881185 (Thread-1): 16:23:42 | 5 of 6 START test unique_dim_customers_customer_sk................... [RUN]
2021-05-15 19:23:42.882215 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.unique_dim_customers_customer_sk".
2021-05-15 19:23:42.883178 (Thread-1): Compiling test.northwind_shop.unique_dim_customers_customer_sk
2021-05-15 19:23:42.888205 (Thread-1): Writing injected SQL for node "test.northwind_shop.unique_dim_customers_customer_sk"
2021-05-15 19:23:42.888205 (Thread-1): finished collecting timing info
2021-05-15 19:23:42.889227 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 19:23:42.894141 (Thread-1): On test.northwind_shop.unique_dim_customers_customer_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "test.northwind_shop.unique_dim_customers_customer_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        customer_sk

    from `northwind1-313400`.`dbt_arthur`.`dim_customers`
    where customer_sk is not null
    group by customer_sk
    having count(*) > 1

) validation_errors



2021-05-15 19:23:45.097095 (Thread-1): finished collecting timing info
2021-05-15 19:23:45.098085 (Thread-1): 16:23:45 | 5 of 6 PASS unique_dim_customers_customer_sk......................... [PASS in 2.22s]
2021-05-15 19:23:45.100042 (Thread-1): Finished running node test.northwind_shop.unique_dim_customers_customer_sk
2021-05-15 19:23:45.101038 (Thread-1): Began running node test.northwind_shop.unique_dim_products_product_sk
2021-05-15 19:23:45.101038 (Thread-1): 16:23:45 | 6 of 6 START test unique_dim_products_product_sk..................... [RUN]
2021-05-15 19:23:45.102034 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.unique_dim_products_product_sk".
2021-05-15 19:23:45.103026 (Thread-1): Compiling test.northwind_shop.unique_dim_products_product_sk
2021-05-15 19:23:45.105071 (Thread-1): unclosed <socket.socket fd=668, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62724), raddr=('142.250.219.10', 443)>
2021-05-15 19:23:45.105071 (Thread-1): unclosed <socket.socket fd=376, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62725), raddr=('142.250.219.10', 443)>
2021-05-15 19:23:45.109008 (Thread-1): Writing injected SQL for node "test.northwind_shop.unique_dim_products_product_sk"
2021-05-15 19:23:45.112008 (Thread-1): finished collecting timing info
2021-05-15 19:23:45.112008 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 19:23:45.118012 (Thread-1): On test.northwind_shop.unique_dim_products_product_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "test.northwind_shop.unique_dim_products_product_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        product_sk

    from `northwind1-313400`.`dbt_arthur`.`dim_products`
    where product_sk is not null
    group by product_sk
    having count(*) > 1

) validation_errors



2021-05-15 19:23:48.103421 (Thread-1): finished collecting timing info
2021-05-15 19:23:48.104426 (Thread-1): 16:23:48 | 6 of 6 PASS unique_dim_products_product_sk........................... [PASS in 3.00s]
2021-05-15 19:23:48.106038 (Thread-1): Finished running node test.northwind_shop.unique_dim_products_product_sk
2021-05-15 19:23:48.155727 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 19:23:48.156714 (MainThread): 16:23:48 | 
2021-05-15 19:23:48.157711 (MainThread): 16:23:48 | Finished running 6 tests in 16.35s.
2021-05-15 19:23:48.157711 (MainThread): Connection 'master' was properly closed.
2021-05-15 19:23:48.157711 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 19:23:48.157711 (MainThread): Connection 'test.northwind_shop.unique_dim_products_product_sk' was properly closed.
2021-05-15 19:23:48.164733 (MainThread): 
2021-05-15 19:23:48.165276 (MainThread): Completed successfully
2021-05-15 19:23:48.166276 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-05-15 19:23:48.167273 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BB5112E48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BB4CBF948>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BB5200388>]}
2021-05-15 19:23:48.168272 (MainThread): Flushing usage events
2021-05-15 19:39:35.348286 (MainThread): Running with dbt=0.19.1
2021-05-15 19:39:35.721903 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-05-15 19:39:35.722890 (MainThread): Tracking: tracking
2021-05-15 19:39:35.722890 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029424180AC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029424188E08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029424188808>]}
2021-05-15 19:39:35.733853 (MainThread): Partial parsing not enabled
2021-05-15 19:39:35.734850 (MainThread): Parsing macros\adapters.sql
2021-05-15 19:39:35.754783 (MainThread): Parsing macros\catalog.sql
2021-05-15 19:39:35.761760 (MainThread): Parsing macros\etc.sql
2021-05-15 19:39:35.765749 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 19:39:35.770732 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 19:39:35.786447 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 19:39:35.789943 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 19:39:35.792780 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 19:39:35.803742 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 19:39:35.809722 (MainThread): Parsing macros\core.sql
2021-05-15 19:39:35.813709 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 19:39:35.858730 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 19:39:35.866814 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 19:39:35.868807 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 19:39:35.870890 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 19:39:35.872883 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 19:39:35.874876 (MainThread): Parsing macros\etc\query.sql
2021-05-15 19:39:35.875873 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 19:39:35.885839 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 19:39:35.900890 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 19:39:35.902883 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 19:39:35.909882 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 19:39:35.931786 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 19:39:35.964778 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 19:39:35.966771 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 19:39:35.984800 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 19:39:35.991776 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 19:39:35.997757 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 19:39:36.003820 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 19:39:36.006810 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 19:39:36.008803 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 19:39:36.010797 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 19:39:36.018770 (MainThread): Partial parsing not enabled
2021-05-15 19:39:36.041812 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 19:39:36.052776 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 19:39:36.056762 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 19:39:36.061745 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 19:39:36.064736 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 19:39:36.069301 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 19:39:36.075806 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 19:39:36.080789 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 19:39:36.084775 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 19:39:36.087765 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 19:39:36.092860 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 19:39:36.096847 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 19:39:36.100834 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 19:39:36.141850 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029427C943C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029427C94448>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029427C944C8>]}
2021-05-15 19:39:36.142847 (MainThread): Flushing usage events
2021-05-15 19:39:36.766809 (MainThread): Connection 'model.northwind_shop.stg_suppliers' was properly closed.
2021-05-15 19:39:36.767306 (MainThread): Encountered an error:
2021-05-15 19:39:36.767939 (MainThread): Compilation Error
  Error reading northwind_shop: marts\fact_order_details.yml - Runtime Error
    Syntax error near line 20
    ------------------------------
    17 |               to: ref('dim_shippers')
    18 |               field: shipper_sk
    19 | 
    20 |         - name: customer_fk
    21 |         tests:
    22 |           - relationships:
    23 |               to: ref('dim_customers')
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 14, column 9
    did not find expected key
      in "<unicode string>", line 20, column 9
2021-05-15 19:39:36.782057 (MainThread): Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 65, in load_yaml_text
    return safe_load(contents)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 60, in safe_load
    return yaml.load(contents, Loader=SafeLoader)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\yaml\__init__.py", line 114, in load
    return loader.get_single_data()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\yaml\constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml\_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml\_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 851, in yaml._yaml.CParser._compose_sequence_node
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 851, in yaml._yaml.CParser._compose_sequence_node
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 892, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.parser.ParserError: while parsing a block mapping
  in "<unicode string>", line 14, column 9
did not find expected key
  in "<unicode string>", line 20, column 9

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 247, in _yaml_from_file
    return load_yaml_text(source_file.contents)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 72, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 20
  ------------------------------
  17 |               to: ref('dim_shippers')
  18 |               field: shipper_sk
  19 | 
  20 |         - name: customer_fk
  21 |         tests:
  22 |           - relationships:
  23 |               to: ref('dim_customers')
  
  Raw Error:
  ------------------------------
  while parsing a block mapping
    in "<unicode string>", line 14, column 9
  did not find expected key
    in "<unicode string>", line 20, column 9

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 442, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 290, in load
    self.parse_project(project, macro_manifest, old_results)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 237, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 188, in parse_with_cache
    parser.parse_file(block)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 624, in parse_file
    dct = self._yaml_from_file(block.file)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 252, in _yaml_from_file
    .format(self.project.project_name, path, reason)
dbt.exceptions.CompilationException: Compilation Error
  Error reading northwind_shop: marts\fact_order_details.yml - Runtime Error
    Syntax error near line 20
    ------------------------------
    17 |               to: ref('dim_shippers')
    18 |               field: shipper_sk
    19 | 
    20 |         - name: customer_fk
    21 |         tests:
    22 |           - relationships:
    23 |               to: ref('dim_customers')
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 14, column 9
    did not find expected key
      in "<unicode string>", line 20, column 9

2021-05-15 19:42:28.782902 (MainThread): Running with dbt=0.19.1
2021-05-15 19:42:29.380224 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-05-15 19:42:29.380224 (MainThread): Tracking: tracking
2021-05-15 19:42:29.381221 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBB8300C08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBA55ECC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBB82FDC48>]}
2021-05-15 19:42:29.398143 (MainThread): Partial parsing not enabled
2021-05-15 19:42:29.401137 (MainThread): Parsing macros\adapters.sql
2021-05-15 19:42:29.434555 (MainThread): Parsing macros\catalog.sql
2021-05-15 19:42:29.446490 (MainThread): Parsing macros\etc.sql
2021-05-15 19:42:29.449476 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 19:42:29.456457 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 19:42:29.478306 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 19:42:29.482285 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 19:42:29.484279 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 19:42:29.502039 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 19:42:29.511862 (MainThread): Parsing macros\core.sql
2021-05-15 19:42:29.516846 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 19:42:29.584401 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 19:42:29.605919 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 19:42:29.611141 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 19:42:29.613633 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 19:42:29.615626 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 19:42:29.618935 (MainThread): Parsing macros\etc\query.sql
2021-05-15 19:42:29.622884 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 19:42:29.636102 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 19:42:29.660652 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 19:42:29.662642 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 19:42:29.670630 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 19:42:29.707623 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 19:42:29.794308 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 19:42:29.797297 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 19:42:29.830755 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 19:42:29.845627 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 19:42:29.854603 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 19:42:29.876895 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 19:42:29.882876 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 19:42:29.886860 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 19:42:29.894684 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 19:42:29.915614 (MainThread): Partial parsing not enabled
2021-05-15 19:42:29.968942 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 19:42:29.984883 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 19:42:29.992863 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 19:42:30.001542 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 19:42:30.013881 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 19:42:30.018873 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 19:42:30.032342 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 19:42:30.039405 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 19:42:30.047379 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 19:42:30.052641 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 19:42:30.060956 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 19:42:30.065991 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 19:42:30.074061 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 19:42:30.138941 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBBE143C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBBE14408>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBBE144C8>]}
2021-05-15 19:42:30.140943 (MainThread): Flushing usage events
2021-05-15 19:42:30.800483 (MainThread): Connection 'model.northwind_shop.stg_suppliers' was properly closed.
2021-05-15 19:42:30.800483 (MainThread): Encountered an error:
2021-05-15 19:42:30.800483 (MainThread): Compilation Error
  Error reading northwind_shop: marts\fact_order_details.yml - Runtime Error
    Syntax error near line 20
    ------------------------------
    17 |               to: ref('dim_shippers')
    18 |               field: shipper_sk
    19 | 
    20 |         - name: customer_fk
    21 |         tests:
    22 |           - relationships:
    23 |               to: ref('dim_customers')
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 14, column 9
    did not find expected key
      in "<unicode string>", line 20, column 9
2021-05-15 19:42:30.812423 (MainThread): Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 65, in load_yaml_text
    return safe_load(contents)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 60, in safe_load
    return yaml.load(contents, Loader=SafeLoader)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\yaml\__init__.py", line 114, in load
    return loader.get_single_data()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\yaml\constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml\_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml\_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 851, in yaml._yaml.CParser._compose_sequence_node
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 851, in yaml._yaml.CParser._compose_sequence_node
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 892, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.parser.ParserError: while parsing a block mapping
  in "<unicode string>", line 14, column 9
did not find expected key
  in "<unicode string>", line 20, column 9

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 247, in _yaml_from_file
    return load_yaml_text(source_file.contents)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 72, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 20
  ------------------------------
  17 |               to: ref('dim_shippers')
  18 |               field: shipper_sk
  19 | 
  20 |         - name: customer_fk
  21 |         tests:
  22 |           - relationships:
  23 |               to: ref('dim_customers')
  
  Raw Error:
  ------------------------------
  while parsing a block mapping
    in "<unicode string>", line 14, column 9
  did not find expected key
    in "<unicode string>", line 20, column 9

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 442, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 290, in load
    self.parse_project(project, macro_manifest, old_results)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 237, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 188, in parse_with_cache
    parser.parse_file(block)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 624, in parse_file
    dct = self._yaml_from_file(block.file)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 252, in _yaml_from_file
    .format(self.project.project_name, path, reason)
dbt.exceptions.CompilationException: Compilation Error
  Error reading northwind_shop: marts\fact_order_details.yml - Runtime Error
    Syntax error near line 20
    ------------------------------
    17 |               to: ref('dim_shippers')
    18 |               field: shipper_sk
    19 | 
    20 |         - name: customer_fk
    21 |         tests:
    22 |           - relationships:
    23 |               to: ref('dim_customers')
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 14, column 9
    did not find expected key
      in "<unicode string>", line 20, column 9

2021-05-15 19:49:16.118806 (MainThread): Running with dbt=0.19.1
2021-05-15 19:49:16.445999 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-05-15 19:49:16.446996 (MainThread): Tracking: tracking
2021-05-15 19:49:16.446996 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4B30F7C48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4B3213FC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4B3213F88>]}
2021-05-15 19:49:16.456965 (MainThread): Partial parsing not enabled
2021-05-15 19:49:16.457962 (MainThread): Parsing macros\adapters.sql
2021-05-15 19:49:16.478106 (MainThread): Parsing macros\catalog.sql
2021-05-15 19:49:16.484085 (MainThread): Parsing macros\etc.sql
2021-05-15 19:49:16.487076 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 19:49:16.491062 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 19:49:16.503026 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 19:49:16.507007 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 19:49:16.509001 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 19:49:16.519265 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 19:49:16.525246 (MainThread): Parsing macros\core.sql
2021-05-15 19:49:16.529290 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 19:49:16.578174 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 19:49:16.587092 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 19:49:16.588094 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 19:49:16.590082 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 19:49:16.593074 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 19:49:16.596263 (MainThread): Parsing macros\etc\query.sql
2021-05-15 19:49:16.597073 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 19:49:16.607025 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 19:49:16.623968 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 19:49:16.626902 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 19:49:16.633936 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 19:49:16.660070 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 19:49:16.694670 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 19:49:16.696664 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 19:49:16.715419 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 19:49:16.722396 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 19:49:16.727379 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 19:49:16.733359 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 19:49:16.736407 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 19:49:16.737421 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 19:49:16.739406 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 19:49:16.746383 (MainThread): Partial parsing not enabled
2021-05-15 19:49:16.768317 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 19:49:16.780262 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 19:49:16.784253 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 19:49:16.788239 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 19:49:16.792517 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 19:49:16.797522 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 19:49:16.803502 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 19:49:16.807491 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 19:49:16.812472 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 19:49:16.816452 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 19:49:16.820429 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 19:49:16.824416 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 19:49:16.827406 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 19:49:16.868290 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4B6D225C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4B6D22648>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4B6D226C8>]}
2021-05-15 19:49:16.868290 (MainThread): Flushing usage events
2021-05-15 19:49:17.489643 (MainThread): Connection 'model.northwind_shop.stg_suppliers' was properly closed.
2021-05-15 19:49:17.489655 (MainThread): Encountered an error:
2021-05-15 19:49:17.489655 (MainThread): Compilation Error
  Error reading northwind_shop: marts\fact_order_details.yml - Runtime Error
    Syntax error near line 22
    ------------------------------
    19 |               to: ref('dim_shippers')
    20 |               field: shipper_sk
    21 | 
    22 |         - name: customer_fk
    23 |         tests:
    24 |           - relationships:
    25 |               to: ref('dim_customers')
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 16, column 9
    did not find expected key
      in "<unicode string>", line 22, column 9
2021-05-15 19:49:17.501228 (MainThread): Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 65, in load_yaml_text
    return safe_load(contents)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 60, in safe_load
    return yaml.load(contents, Loader=SafeLoader)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\yaml\__init__.py", line 114, in load
    return loader.get_single_data()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\yaml\constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml\_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml\_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 851, in yaml._yaml.CParser._compose_sequence_node
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 851, in yaml._yaml.CParser._compose_sequence_node
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 892, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.parser.ParserError: while parsing a block mapping
  in "<unicode string>", line 16, column 9
did not find expected key
  in "<unicode string>", line 22, column 9

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 247, in _yaml_from_file
    return load_yaml_text(source_file.contents)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 72, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 22
  ------------------------------
  19 |               to: ref('dim_shippers')
  20 |               field: shipper_sk
  21 | 
  22 |         - name: customer_fk
  23 |         tests:
  24 |           - relationships:
  25 |               to: ref('dim_customers')
  
  Raw Error:
  ------------------------------
  while parsing a block mapping
    in "<unicode string>", line 16, column 9
  did not find expected key
    in "<unicode string>", line 22, column 9

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 442, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 290, in load
    self.parse_project(project, macro_manifest, old_results)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 237, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 188, in parse_with_cache
    parser.parse_file(block)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 624, in parse_file
    dct = self._yaml_from_file(block.file)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 252, in _yaml_from_file
    .format(self.project.project_name, path, reason)
dbt.exceptions.CompilationException: Compilation Error
  Error reading northwind_shop: marts\fact_order_details.yml - Runtime Error
    Syntax error near line 22
    ------------------------------
    19 |               to: ref('dim_shippers')
    20 |               field: shipper_sk
    21 | 
    22 |         - name: customer_fk
    23 |         tests:
    24 |           - relationships:
    25 |               to: ref('dim_customers')
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 16, column 9
    did not find expected key
      in "<unicode string>", line 22, column 9

2021-05-15 19:51:44.426505 (MainThread): Running with dbt=0.19.1
2021-05-15 19:51:44.756625 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-05-15 19:51:44.756625 (MainThread): Tracking: tracking
2021-05-15 19:51:44.757623 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E60F0F08C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E60F0F6E48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E60F0F6F48>]}
2021-05-15 19:51:44.766592 (MainThread): Partial parsing not enabled
2021-05-15 19:51:44.767589 (MainThread): Parsing macros\adapters.sql
2021-05-15 19:51:44.785528 (MainThread): Parsing macros\catalog.sql
2021-05-15 19:51:44.791509 (MainThread): Parsing macros\etc.sql
2021-05-15 19:51:44.793502 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 19:51:44.798485 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 19:51:44.809448 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 19:51:44.812438 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 19:51:44.814432 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 19:51:44.823402 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 19:51:44.828385 (MainThread): Parsing macros\core.sql
2021-05-15 19:51:44.832372 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 19:51:44.871242 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 19:51:44.880212 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 19:51:44.881209 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 19:51:44.882206 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 19:51:44.884199 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 19:51:44.886192 (MainThread): Parsing macros\etc\query.sql
2021-05-15 19:51:44.887189 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 19:51:44.896158 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 19:51:44.909115 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 19:51:44.911109 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 19:51:44.917088 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 19:51:44.936025 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 19:51:44.966921 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 19:51:44.968915 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 19:51:44.984861 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 19:51:44.991838 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 19:51:44.995825 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 19:51:45.002802 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 19:51:45.005792 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 19:51:45.007786 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 19:51:45.009779 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 19:51:45.017752 (MainThread): Partial parsing not enabled
2021-05-15 19:51:45.037685 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 19:51:45.046656 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 19:51:45.050642 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 19:51:45.054629 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 19:51:45.057619 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 19:51:45.061606 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 19:51:45.066589 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 19:51:45.070576 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 19:51:45.074562 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 19:51:45.077552 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 19:51:45.081539 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 19:51:45.085526 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 19:51:45.089513 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 19:51:45.217085 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'beffa45b-1f6f-402a-ae90-bbb2bb3bb0e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E612DD9388>]}
2021-05-15 19:51:45.224062 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'beffa45b-1f6f-402a-ae90-bbb2bb3bb0e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E612DD9F08>]}
2021-05-15 19:51:45.225059 (MainThread): Found 13 models, 14 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 19:51:45.228098 (MainThread): 
2021-05-15 19:51:45.229045 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 19:51:45.233033 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 19:51:45.234028 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 19:51:45.239071 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 19:51:46.514093 (MainThread): 16:51:46 | Concurrency: 1 threads (target='dev')
2021-05-15 19:51:46.514093 (MainThread): 16:51:46 | 
2021-05-15 19:51:46.576203 (Thread-1): Began running node test.northwind_shop.not_null_fact_order_details_order_id
2021-05-15 19:51:46.576203 (Thread-1): 16:51:46 | 1 of 4 START test not_null_fact_order_details_order_id............... [RUN]
2021-05-15 19:51:46.577199 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.not_null_fact_order_details_order_id".
2021-05-15 19:51:46.578162 (Thread-1): Compiling test.northwind_shop.not_null_fact_order_details_order_id
2021-05-15 19:51:46.585354 (Thread-1): Writing injected SQL for node "test.northwind_shop.not_null_fact_order_details_order_id"
2021-05-15 19:51:46.587347 (Thread-1): finished collecting timing info
2021-05-15 19:51:46.587347 (Thread-1): Opening a new connection, currently in state init
2021-05-15 19:51:46.593976 (Thread-1): On test.northwind_shop.not_null_fact_order_details_order_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "test.northwind_shop.not_null_fact_order_details_order_id"} */

    
    



select count(*) as validation_errors
from `northwind1-313400`.`dbt_arthur`.`fact_order_details`
where order_id is null



2021-05-15 19:51:49.300388 (Thread-1): finished collecting timing info
2021-05-15 19:51:49.301434 (Thread-1): 16:51:49 | 1 of 4 PASS not_null_fact_order_details_order_id..................... [PASS in 2.72s]
2021-05-15 19:51:49.302689 (Thread-1): Finished running node test.northwind_shop.not_null_fact_order_details_order_id
2021-05-15 19:51:49.303735 (Thread-1): Began running node test.northwind_shop.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_
2021-05-15 19:51:49.303735 (Thread-1): 16:51:49 | 2 of 4 START test relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_ [RUN]
2021-05-15 19:51:49.305684 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_".
2021-05-15 19:51:49.305684 (Thread-1): Compiling test.northwind_shop.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_
2021-05-15 19:51:49.306681 (Thread-1): unclosed <socket.socket fd=1152, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62879), raddr=('142.250.218.170', 443)>
2021-05-15 19:51:49.307676 (Thread-1): unclosed <socket.socket fd=1168, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62880), raddr=('142.250.219.10', 443)>
2021-05-15 19:51:49.316645 (Thread-1): Writing injected SQL for node "test.northwind_shop.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_"
2021-05-15 19:51:49.326394 (Thread-1): finished collecting timing info
2021-05-15 19:51:49.326394 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 19:51:49.331412 (Thread-1): On test.northwind_shop.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "test.northwind_shop.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_"} */

    
    




select count(*) as validation_errors
from (
    select customer_fk as id from `northwind1-313400`.`dbt_arthur`.`fact_order_details`
) as child
left join (
    select customer_sk as id from `northwind1-313400`.`dbt_arthur`.`dim_customers`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-05-15 19:51:52.246641 (Thread-1): finished collecting timing info
2021-05-15 19:51:52.247639 (Thread-1): 16:51:52 | 2 of 4 PASS relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_ [PASS in 2.94s]
2021-05-15 19:51:52.249201 (Thread-1): Finished running node test.northwind_shop.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_
2021-05-15 19:51:52.250198 (Thread-1): Began running node test.northwind_shop.relationships_fact_order_details_product_fk__product_sk__ref_dim_products_
2021-05-15 19:51:52.250198 (Thread-1): 16:51:52 | 3 of 4 START test relationships_fact_order_details_product_fk__product_sk__ref_dim_products_ [RUN]
2021-05-15 19:51:52.251233 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.relationships_fact_order_details_product_fk__product_sk__ref_dim_products_".
2021-05-15 19:51:52.252188 (Thread-1): Compiling test.northwind_shop.relationships_fact_order_details_product_fk__product_sk__ref_dim_products_
2021-05-15 19:51:52.254180 (Thread-1): unclosed <socket.socket fd=784, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62881), raddr=('142.250.218.170', 443)>
2021-05-15 19:51:52.254180 (Thread-1): unclosed <socket.socket fd=1212, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62882), raddr=('142.250.219.10', 443)>
2021-05-15 19:51:52.259164 (Thread-1): Writing injected SQL for node "test.northwind_shop.relationships_fact_order_details_product_fk__product_sk__ref_dim_products_"
2021-05-15 19:51:52.261160 (Thread-1): finished collecting timing info
2021-05-15 19:51:52.261160 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 19:51:52.265190 (Thread-1): On test.northwind_shop.relationships_fact_order_details_product_fk__product_sk__ref_dim_products_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "test.northwind_shop.relationships_fact_order_details_product_fk__product_sk__ref_dim_products_"} */

    
    




select count(*) as validation_errors
from (
    select product_fk as id from `northwind1-313400`.`dbt_arthur`.`fact_order_details`
) as child
left join (
    select product_sk as id from `northwind1-313400`.`dbt_arthur`.`dim_products`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-05-15 19:51:55.277386 (Thread-1): finished collecting timing info
2021-05-15 19:51:55.278382 (Thread-1): 16:51:55 | 3 of 4 PASS relationships_fact_order_details_product_fk__product_sk__ref_dim_products_ [PASS in 3.03s]
2021-05-15 19:51:55.280388 (Thread-1): Finished running node test.northwind_shop.relationships_fact_order_details_product_fk__product_sk__ref_dim_products_
2021-05-15 19:51:55.281373 (Thread-1): Began running node test.northwind_shop.relationships_fact_order_details_shipper_fk__shipper_sk__ref_dim_shippers_
2021-05-15 19:51:55.281373 (Thread-1): 16:51:55 | 4 of 4 START test relationships_fact_order_details_shipper_fk__shipper_sk__ref_dim_shippers_ [RUN]
2021-05-15 19:51:55.282539 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.relationships_fact_order_details_shipper_fk__shipper_sk__ref_dim_shippers_".
2021-05-15 19:51:55.283038 (Thread-1): Compiling test.northwind_shop.relationships_fact_order_details_shipper_fk__shipper_sk__ref_dim_shippers_
2021-05-15 19:51:55.288236 (Thread-1): Writing injected SQL for node "test.northwind_shop.relationships_fact_order_details_shipper_fk__shipper_sk__ref_dim_shippers_"
2021-05-15 19:51:55.289232 (Thread-1): finished collecting timing info
2021-05-15 19:51:55.289232 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 19:51:55.293269 (Thread-1): On test.northwind_shop.relationships_fact_order_details_shipper_fk__shipper_sk__ref_dim_shippers_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "test.northwind_shop.relationships_fact_order_details_shipper_fk__shipper_sk__ref_dim_shippers_"} */

    
    




select count(*) as validation_errors
from (
    select shipper_fk as id from `northwind1-313400`.`dbt_arthur`.`fact_order_details`
) as child
left join (
    select shipper_sk as id from `northwind1-313400`.`dbt_arthur`.`dim_shippers`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-05-15 19:51:58.239293 (Thread-1): finished collecting timing info
2021-05-15 19:51:58.240340 (Thread-1): 16:51:58 | 4 of 4 PASS relationships_fact_order_details_shipper_fk__shipper_sk__ref_dim_shippers_ [PASS in 2.96s]
2021-05-15 19:51:58.242288 (Thread-1): Finished running node test.northwind_shop.relationships_fact_order_details_shipper_fk__shipper_sk__ref_dim_shippers_
2021-05-15 19:51:58.260619 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 19:51:58.260619 (MainThread): 16:51:58 | 
2021-05-15 19:51:58.261612 (MainThread): 16:51:58 | Finished running 4 tests in 13.03s.
2021-05-15 19:51:58.262606 (MainThread): Connection 'master' was properly closed.
2021-05-15 19:51:58.262606 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 19:51:58.262606 (MainThread): Connection 'test.northwind_shop.relationships_fact_order_details_shipper_fk__shipper_sk__ref_dim_shippers_' was properly closed.
2021-05-15 19:51:58.264600 (MainThread): unclosed <socket.socket fd=1072, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62885), raddr=('142.250.218.170', 443)>
2021-05-15 19:51:58.265597 (MainThread): unclosed <socket.socket fd=1272, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 62886), raddr=('142.250.219.10', 443)>
2021-05-15 19:51:58.272599 (MainThread): 
2021-05-15 19:51:58.273279 (MainThread): Completed successfully
2021-05-15 19:51:58.274283 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-05-15 19:51:58.275277 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E60F0BED48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E60F100108>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E61106FC48>]}
2021-05-15 19:51:58.276276 (MainThread): Flushing usage events
2021-05-15 21:37:09.248967 (MainThread): Running with dbt=0.19.1
2021-05-15 21:37:10.176706 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['test_sum_qty'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-05-15 21:37:10.180733 (MainThread): Tracking: tracking
2021-05-15 21:37:10.181729 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E83758D08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E83750B48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E83750F08>]}
2021-05-15 21:37:10.197678 (MainThread): Partial parsing not enabled
2021-05-15 21:37:10.200670 (MainThread): Parsing macros\adapters.sql
2021-05-15 21:37:10.227575 (MainThread): Parsing macros\catalog.sql
2021-05-15 21:37:10.237540 (MainThread): Parsing macros\etc.sql
2021-05-15 21:37:10.240532 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 21:37:10.250562 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 21:37:10.269499 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 21:37:10.272489 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 21:37:10.275480 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 21:37:10.289435 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 21:37:10.303395 (MainThread): Parsing macros\core.sql
2021-05-15 21:37:10.309368 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 21:37:10.380201 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 21:37:10.391155 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 21:37:10.396135 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 21:37:10.399124 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 21:37:10.401122 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 21:37:10.403123 (MainThread): Parsing macros\etc\query.sql
2021-05-15 21:37:10.405109 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 21:37:10.418065 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 21:37:10.437001 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 21:37:10.439996 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 21:37:10.450967 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 21:37:10.478902 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 21:37:10.519758 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 21:37:10.522747 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 21:37:10.546668 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 21:37:10.554154 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 21:37:10.562129 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 21:37:10.570109 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 21:37:10.573092 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 21:37:10.576127 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 21:37:10.582219 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 21:37:10.589183 (MainThread): Partial parsing not enabled
2021-05-15 21:37:10.620069 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 21:37:10.635019 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 21:37:10.641008 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 21:37:10.648974 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 21:37:10.654327 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 21:37:10.661294 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 21:37:10.671236 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 21:37:10.676230 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 21:37:10.683212 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 21:37:10.688180 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 21:37:10.696456 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 21:37:10.701439 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 21:37:10.707406 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 21:37:10.724357 (MainThread): Acquiring new bigquery connection "test.northwind_shop.test_sum_qty".
2021-05-15 21:37:10.732614 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E83992C88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E83992A88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E83992D48>]}
2021-05-15 21:37:10.732614 (MainThread): Flushing usage events
2021-05-15 21:37:11.524137 (MainThread): Connection 'test.northwind_shop.test_sum_qty' was properly closed.
2021-05-15 21:37:11.524346 (MainThread): Encountered an error:
2021-05-15 21:37:11.525876 (MainThread): Compilation Error in test test_sum_qty (tests\test_sum_qty.sql)
  The name argument to ref() must be a string, got <class 'dbt.clients.jinja.create_undefined.<locals>.Undefined'>
2021-05-15 21:37:11.542495 (MainThread): Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 442, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 290, in load
    self.parse_project(project, macro_manifest, old_results)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 237, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 188, in parse_with_cache
    parser.parse_file(block)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\base.py", line 432, in parse_file
    self.parse_node(file_block)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\base.py", line 405, in parse_node
    self.render_update(node, config)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\base.py", line 380, in render_update
    self.render_with_context(node, config)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\base.py", line 294, in render_with_context
    parsed_node.raw_sql, context, parsed_node, capture_macros=True
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 533, in render_template
    return template.render(ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\environment.py", line 1090, in render
    self.environment.handle_exception()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 4, in top-level template code
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\context\providers.py", line 230, in __call__
    self.validate_args(name, package)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\context\providers.py", line 210, in validate_args
    f'The name argument to ref() must be a string, got '
dbt.exceptions.CompilationException: Compilation Error in test test_sum_qty (tests\test_sum_qty.sql)
  The name argument to ref() must be a string, got <class 'dbt.clients.jinja.create_undefined.<locals>.Undefined'>

2021-05-15 21:38:47.173557 (MainThread): Running with dbt=0.19.1
2021-05-15 21:38:47.475614 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['test_sum_qty'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-05-15 21:38:47.475614 (MainThread): Tracking: tracking
2021-05-15 21:38:47.476611 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212548C1588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212548F0FC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212548F0DC8>]}
2021-05-15 21:38:47.484584 (MainThread): Partial parsing not enabled
2021-05-15 21:38:47.486578 (MainThread): Parsing macros\adapters.sql
2021-05-15 21:38:47.505514 (MainThread): Parsing macros\catalog.sql
2021-05-15 21:38:47.511494 (MainThread): Parsing macros\etc.sql
2021-05-15 21:38:47.513487 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 21:38:47.517474 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 21:38:47.529434 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 21:38:47.532424 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 21:38:47.534418 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 21:38:47.543387 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 21:38:47.549367 (MainThread): Parsing macros\core.sql
2021-05-15 21:38:47.553354 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 21:38:47.594217 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 21:38:47.604184 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 21:38:47.605181 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 21:38:47.607174 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 21:38:47.610166 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 21:38:47.612159 (MainThread): Parsing macros\etc\query.sql
2021-05-15 21:38:47.615423 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 21:38:47.624383 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 21:38:47.639336 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 21:38:47.641330 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 21:38:47.647310 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 21:38:47.677254 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 21:38:47.718118 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 21:38:47.721114 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 21:38:47.741041 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 21:38:47.750012 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 21:38:47.756030 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 21:38:47.764014 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 21:38:47.767001 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 21:38:47.769113 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 21:38:47.771168 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 21:38:47.778153 (MainThread): Partial parsing not enabled
2021-05-15 21:38:47.802069 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 21:38:47.813032 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 21:38:47.818345 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 21:38:47.822332 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 21:38:47.827828 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 21:38:47.832811 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 21:38:47.840785 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 21:38:47.845767 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 21:38:47.850751 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 21:38:47.855735 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 21:38:47.860717 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 21:38:47.866698 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 21:38:47.871681 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 21:38:47.885632 (MainThread): Acquiring new bigquery connection "test.northwind_shop.test_sum_qty".
2021-05-15 21:38:48.023205 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8caf33ed-e424-48ef-8bc3-c106c5f5806a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021258402A88>]}
2021-05-15 21:38:48.054454 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8caf33ed-e424-48ef-8bc3-c106c5f5806a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212568C9A08>]}
2021-05-15 21:38:48.054454 (MainThread): Found 13 models, 15 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 21:38:48.065285 (MainThread): 
2021-05-15 21:38:48.066280 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 21:38:48.070598 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 21:38:48.070598 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 21:38:48.077583 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 21:38:49.233371 (MainThread): 18:38:49 | Concurrency: 1 threads (target='dev')
2021-05-15 21:38:49.234368 (MainThread): 18:38:49 | 
2021-05-15 21:38:49.239975 (Thread-1): Began running node test.northwind_shop.test_sum_qty
2021-05-15 21:38:49.239975 (Thread-1): 18:38:49 | 1 of 1 START test test_sum_qty....................................... [RUN]
2021-05-15 21:38:49.242143 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.test_sum_qty".
2021-05-15 21:38:49.242813 (Thread-1): Compiling test.northwind_shop.test_sum_qty
2021-05-15 21:38:49.259525 (Thread-1): Writing injected SQL for node "test.northwind_shop.test_sum_qty"
2021-05-15 21:38:49.261518 (Thread-1): finished collecting timing info
2021-05-15 21:38:49.261518 (Thread-1): Opening a new connection, currently in state init
2021-05-15 21:38:49.269019 (Thread-1): On test.northwind_shop.test_sum_qty: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "test.northwind_shop.test_sum_qty"} */

with dbt__CTE__INTERNAL_test as (
with 
    validation as (
        select sum(quantity) as sum_val
        from `northwind1-313400`.`dbt_arthur`.`fact_order_details`
    )
select * from validation where sum_val != 51317
)select count(*) from dbt__CTE__INTERNAL_test
2021-05-15 21:38:52.387855 (Thread-1): finished collecting timing info
2021-05-15 21:38:52.387855 (Thread-1): 18:38:52 | 1 of 1 PASS test_sum_qty............................................. [PASS in 3.15s]
2021-05-15 21:38:52.387855 (Thread-1): Finished running node test.northwind_shop.test_sum_qty
2021-05-15 21:38:52.491283 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 21:38:52.491283 (MainThread): 18:38:52 | 
2021-05-15 21:38:52.491283 (MainThread): 18:38:52 | Finished running 1 test in 4.43s.
2021-05-15 21:38:52.491283 (MainThread): Connection 'master' was properly closed.
2021-05-15 21:38:52.495055 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 21:38:52.495055 (MainThread): Connection 'test.northwind_shop.test_sum_qty' was properly closed.
2021-05-15 21:38:52.512488 (MainThread): 
2021-05-15 21:38:52.512488 (MainThread): Completed successfully
2021-05-15 21:38:52.514315 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-15 21:38:52.516311 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212549119C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021254911448>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212548AB5C8>]}
2021-05-15 21:38:52.516311 (MainThread): Flushing usage events
2021-05-15 21:45:11.932394 (MainThread): Running with dbt=0.19.1
2021-05-15 21:45:12.274470 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['test_sum_qty'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-05-15 21:45:12.275492 (MainThread): Tracking: tracking
2021-05-15 21:45:12.275492 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BB3460F88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BB3466F48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BB3466D08>]}
2021-05-15 21:45:12.290464 (MainThread): Partial parsing not enabled
2021-05-15 21:45:12.292561 (MainThread): Parsing macros\adapters.sql
2021-05-15 21:45:12.321127 (MainThread): Parsing macros\catalog.sql
2021-05-15 21:45:12.330122 (MainThread): Parsing macros\etc.sql
2021-05-15 21:45:12.333860 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 21:45:12.340453 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 21:45:12.359157 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 21:45:12.364032 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 21:45:12.366882 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 21:45:12.382607 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 21:45:12.388880 (MainThread): Parsing macros\core.sql
2021-05-15 21:45:12.393865 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 21:45:12.436714 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 21:45:12.447681 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 21:45:12.448692 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 21:45:12.450673 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 21:45:12.452667 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 21:45:12.454661 (MainThread): Parsing macros\etc\query.sql
2021-05-15 21:45:12.455657 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 21:45:12.465623 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 21:45:12.481617 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 21:45:12.483614 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 21:45:12.490590 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 21:45:12.512519 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 21:45:12.548395 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 21:45:12.551334 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 21:45:12.569336 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 21:45:12.576315 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 21:45:12.581287 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 21:45:12.588271 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 21:45:12.591274 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 21:45:12.592269 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 21:45:12.594254 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 21:45:12.601227 (MainThread): Partial parsing not enabled
2021-05-15 21:45:12.626161 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 21:45:12.637524 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 21:45:12.641615 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 21:45:12.646568 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 21:45:12.650552 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 21:45:12.654559 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 21:45:12.660530 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 21:45:12.664511 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 21:45:12.669490 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 21:45:12.673476 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 21:45:12.677461 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 21:45:12.681452 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 21:45:12.686450 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 21:45:12.698065 (MainThread): Acquiring new bigquery connection "test.northwind_shop.test_sum_qty".
2021-05-15 21:45:12.836283 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00e28f24-27ca-4a0c-b786-99f149cdab31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BB6F85988>]}
2021-05-15 21:45:12.877156 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00e28f24-27ca-4a0c-b786-99f149cdab31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BB5439C48>]}
2021-05-15 21:45:12.877156 (MainThread): Found 13 models, 15 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 21:45:12.880082 (MainThread): 
2021-05-15 21:45:12.881077 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 21:45:12.885122 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 21:45:12.885122 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 21:45:12.892041 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 21:45:14.144020 (MainThread): 18:45:14 | Concurrency: 1 threads (target='dev')
2021-05-15 21:45:14.144577 (MainThread): 18:45:14 | 
2021-05-15 21:45:14.146816 (Thread-1): Began running node test.northwind_shop.test_sum_qty
2021-05-15 21:45:14.148093 (Thread-1): 18:45:14 | 1 of 1 START test test_sum_qty....................................... [RUN]
2021-05-15 21:45:14.149189 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.test_sum_qty".
2021-05-15 21:45:14.149685 (Thread-1): Compiling test.northwind_shop.test_sum_qty
2021-05-15 21:45:14.167008 (Thread-1): Writing injected SQL for node "test.northwind_shop.test_sum_qty"
2021-05-15 21:45:14.167902 (Thread-1): finished collecting timing info
2021-05-15 21:45:14.168397 (Thread-1): Opening a new connection, currently in state init
2021-05-15 21:45:14.176968 (Thread-1): On test.northwind_shop.test_sum_qty: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "test.northwind_shop.test_sum_qty"} */

with dbt__CTE__INTERNAL_test as (
with 
    validation as (
        select sum(quantity) as sum_val
        from `northwind1-313400`.`dbt_arthur`.`fact_order_details`
        where order_date between '1998/03/01' and '1998/03/31'
    )
select * from validation where sum_val != 4065
)select count(*) from dbt__CTE__INTERNAL_test
2021-05-15 21:45:15.911967 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/5f7ff3ba-7336-41c7-9aaa-95fb0346f765?maxResults=0&location=US&prettyPrint=false: Could not cast literal "1998/03/01" to type TIMESTAMP at [8:34]')
2021-05-15 21:45:17.757233 (Thread-1): finished collecting timing info
2021-05-15 21:45:17.757233 (Thread-1): Database Error in test test_sum_qty (tests\test_sum_qty.sql)
  Could not cast literal "1998/03/01" to type TIMESTAMP at [8:34]
  compiled SQL at target\compiled\northwind_shop\tests\test_sum_qty.sql
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/45f3ae99-3917-43b9-9758-e54eeffece50?maxResults=0&location=US&prettyPrint=false: Could not cast literal "1998/03/01" to type TIMESTAMP at [8:34]

(job ID: 45f3ae99-3917-43b9-9758-e54eeffece50)

                                                             -----Query Job SQL Follows-----                                                             

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "test.northwind_shop.test_sum_qty"} */
   2:
   3:with dbt__CTE__INTERNAL_test as (
   4:with 
   5:    validation as (
   6:        select sum(quantity) as sum_val
   7:        from `northwind1-313400`.`dbt_arthur`.`fact_order_details`
   8:        where order_date between '1998/03/01' and '1998/03/31'
   9:    )
  10:select * from validation where sum_val != 4065
  11:)select count(*) from dbt__CTE__INTERNAL_test
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\test.py", line 83, in execute
    failed_rows = self.execute_data_test(test)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\test.py", line 46, in execute_data_test
    test.compiled_sql, auto_begin=True, fetch=True
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in test test_sum_qty (tests\test_sum_qty.sql)
  Could not cast literal "1998/03/01" to type TIMESTAMP at [8:34]
  compiled SQL at target\compiled\northwind_shop\tests\test_sum_qty.sql
2021-05-15 21:45:17.784563 (Thread-1): 18:45:17 | 1 of 1 ERROR test_sum_qty............................................ [ERROR in 3.64s]
2021-05-15 21:45:17.785729 (Thread-1): Finished running node test.northwind_shop.test_sum_qty
2021-05-15 21:45:17.859557 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 21:45:17.860604 (MainThread): 18:45:17 | 
2021-05-15 21:45:17.861558 (MainThread): 18:45:17 | Finished running 1 test in 4.98s.
2021-05-15 21:45:17.861558 (MainThread): Connection 'master' was properly closed.
2021-05-15 21:45:17.862553 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 21:45:17.862553 (MainThread): Connection 'test.northwind_shop.test_sum_qty' was properly closed.
2021-05-15 21:45:17.872518 (MainThread): 
2021-05-15 21:45:17.873516 (MainThread): Completed with 1 error and 0 warnings:
2021-05-15 21:45:17.873516 (MainThread): 
2021-05-15 21:45:17.874515 (MainThread): Database Error in test test_sum_qty (tests\test_sum_qty.sql)
2021-05-15 21:45:17.874515 (MainThread):   Could not cast literal "1998/03/01" to type TIMESTAMP at [8:34]
2021-05-15 21:45:17.875510 (MainThread):   compiled SQL at target\compiled\northwind_shop\tests\test_sum_qty.sql
2021-05-15 21:45:17.875510 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-15 21:45:17.876507 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BB344C708>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BB33FE908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BB34A5608>]}
2021-05-15 21:45:17.876507 (MainThread): Flushing usage events
2021-05-15 21:46:18.849044 (MainThread): Running with dbt=0.19.1
2021-05-15 21:46:19.178637 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['test_sum_qty'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-05-15 21:46:19.178637 (MainThread): Tracking: tracking
2021-05-15 21:46:19.179634 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021434EC1DC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021434EC4C88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021434EC4C48>]}
2021-05-15 21:46:19.188604 (MainThread): Partial parsing not enabled
2021-05-15 21:46:19.189601 (MainThread): Parsing macros\adapters.sql
2021-05-15 21:46:19.207541 (MainThread): Parsing macros\catalog.sql
2021-05-15 21:46:19.213521 (MainThread): Parsing macros\etc.sql
2021-05-15 21:46:19.216511 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 21:46:19.221002 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 21:46:19.232961 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 21:46:19.234955 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 21:46:19.236948 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 21:46:19.246919 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 21:46:19.251898 (MainThread): Parsing macros\core.sql
2021-05-15 21:46:19.255885 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 21:46:19.296748 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 21:46:19.305718 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 21:46:19.306715 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 21:46:19.308708 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 21:46:19.310703 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 21:46:19.312695 (MainThread): Parsing macros\etc\query.sql
2021-05-15 21:46:19.313692 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 21:46:19.322661 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 21:46:19.336615 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 21:46:19.338608 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 21:46:19.344588 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 21:46:19.364521 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 21:46:19.397412 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 21:46:19.399405 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 21:46:19.416348 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 21:46:19.423325 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 21:46:19.429305 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 21:46:19.435285 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 21:46:19.438275 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 21:46:19.440268 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 21:46:19.442261 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 21:46:19.449238 (MainThread): Partial parsing not enabled
2021-05-15 21:46:19.470168 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 21:46:19.480135 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 21:46:19.484122 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 21:46:19.488113 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 21:46:19.491103 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 21:46:19.495090 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 21:46:19.500075 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 21:46:19.503064 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 21:46:19.507050 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 21:46:19.510041 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 21:46:19.514027 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 21:46:19.517017 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 21:46:19.521004 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 21:46:19.529973 (MainThread): Acquiring new bigquery connection "test.northwind_shop.test_sum_qty".
2021-05-15 21:46:19.638605 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41168328-092a-4e44-b3c7-e7693a3f3644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021434F75788>]}
2021-05-15 21:46:19.676479 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41168328-092a-4e44-b3c7-e7693a3f3644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021436E9B108>]}
2021-05-15 21:46:19.677475 (MainThread): Found 13 models, 15 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 21:46:19.681463 (MainThread): 
2021-05-15 21:46:19.682460 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 21:46:19.686445 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 21:46:19.686445 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 21:46:19.694105 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 21:46:20.832769 (MainThread): 18:46:20 | Concurrency: 1 threads (target='dev')
2021-05-15 21:46:20.833853 (MainThread): 18:46:20 | 
2021-05-15 21:46:20.836503 (Thread-1): Began running node test.northwind_shop.test_sum_qty
2021-05-15 21:46:20.837508 (Thread-1): 18:46:20 | 1 of 1 START test test_sum_qty....................................... [RUN]
2021-05-15 21:46:20.838778 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.test_sum_qty".
2021-05-15 21:46:20.839274 (Thread-1): Compiling test.northwind_shop.test_sum_qty
2021-05-15 21:46:20.859099 (Thread-1): Writing injected SQL for node "test.northwind_shop.test_sum_qty"
2021-05-15 21:46:20.860094 (Thread-1): finished collecting timing info
2021-05-15 21:46:20.860094 (Thread-1): Opening a new connection, currently in state init
2021-05-15 21:46:20.866573 (Thread-1): On test.northwind_shop.test_sum_qty: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "test.northwind_shop.test_sum_qty"} */

with dbt__CTE__INTERNAL_test as (
with 
    validation as (
        select sum(quantity) as sum_val
        from `northwind1-313400`.`dbt_arthur`.`fact_order_details`
        where order_date between '1998-03-01' and '1998-03-31'
    )
select * from validation where sum_val != 4065
)select count(*) from dbt__CTE__INTERNAL_test
2021-05-15 21:46:23.710252 (Thread-1): finished collecting timing info
2021-05-15 21:46:23.711258 (Thread-1): 18:46:23 | 1 of 1 PASS test_sum_qty............................................. [PASS in 2.87s]
2021-05-15 21:46:23.713201 (Thread-1): Finished running node test.northwind_shop.test_sum_qty
2021-05-15 21:46:23.789542 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 21:46:23.789542 (MainThread): 18:46:23 | 
2021-05-15 21:46:23.790535 (MainThread): 18:46:23 | Finished running 1 test in 4.11s.
2021-05-15 21:46:23.791531 (MainThread): Connection 'master' was properly closed.
2021-05-15 21:46:23.791531 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 21:46:23.792487 (MainThread): Connection 'test.northwind_shop.test_sum_qty' was properly closed.
2021-05-15 21:46:23.801518 (MainThread): 
2021-05-15 21:46:23.802513 (MainThread): Completed successfully
2021-05-15 21:46:23.803454 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-15 21:46:23.805446 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021434E82D08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021434E821C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021434F24D48>]}
2021-05-15 21:46:23.805446 (MainThread): Flushing usage events
2021-05-15 22:17:01.811090 (MainThread): Running with dbt=0.19.1
2021-05-15 22:17:02.372230 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['dim_suppliers'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-05-15 22:17:02.373235 (MainThread): Tracking: tracking
2021-05-15 22:17:02.373235 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BEC3CFFC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BEC3F4C08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BEC3F4EC8>]}
2021-05-15 22:17:02.391360 (MainThread): Partial parsing not enabled
2021-05-15 22:17:02.393352 (MainThread): Parsing macros\adapters.sql
2021-05-15 22:17:02.423781 (MainThread): Parsing macros\catalog.sql
2021-05-15 22:17:02.431762 (MainThread): Parsing macros\etc.sql
2021-05-15 22:17:02.436749 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 22:17:02.443721 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 22:17:02.460976 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 22:17:02.464964 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 22:17:02.470944 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 22:17:02.482948 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 22:17:02.492878 (MainThread): Parsing macros\core.sql
2021-05-15 22:17:02.498862 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 22:17:02.557012 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 22:17:02.566982 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 22:17:02.573012 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 22:17:02.576211 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 22:17:02.579204 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 22:17:02.581200 (MainThread): Parsing macros\etc\query.sql
2021-05-15 22:17:02.582194 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 22:17:02.595150 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 22:17:02.622720 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 22:17:02.625709 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 22:17:02.633685 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 22:17:02.672842 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 22:17:02.724430 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 22:17:02.726422 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 22:17:02.756117 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 22:17:02.764090 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 22:17:02.774813 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 22:17:02.781789 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 22:17:02.788911 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 22:17:02.792887 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 22:17:02.796280 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 22:17:02.815598 (MainThread): Partial parsing not enabled
2021-05-15 22:17:02.875722 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 22:17:02.892674 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 22:17:02.897652 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 22:17:02.906621 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 22:17:02.911626 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 22:17:02.919592 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 22:17:02.927549 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 22:17:02.933550 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 22:17:02.941502 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 22:17:02.946486 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 22:17:02.954975 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 22:17:02.959956 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 22:17:02.964944 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 22:17:02.983877 (MainThread): Acquiring new bigquery connection "test.northwind_shop.test_sum_qty".
2021-05-15 22:17:03.179536 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4b15d96-9ec0-447b-809d-8847a921aa6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BEC48C808>]}
2021-05-15 22:17:03.258963 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4b15d96-9ec0-447b-809d-8847a921aa6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BEE3D9B48>]}
2021-05-15 22:17:03.259439 (MainThread): Found 13 models, 15 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-05-15 22:17:03.264800 (MainThread): 
2021-05-15 22:17:03.268707 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 22:17:03.277466 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 22:17:03.278465 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 22:17:03.286249 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 22:17:04.607049 (MainThread): 19:17:04 | Concurrency: 1 threads (target='dev')
2021-05-15 22:17:04.607049 (MainThread): 19:17:04 | 
2021-05-15 22:17:04.610890 (Thread-1): Began running node test.northwind_shop.not_null_dim_suppliers_supplier_sk
2021-05-15 22:17:04.610890 (Thread-1): 19:17:04 | 1 of 2 START test not_null_dim_suppliers_supplier_sk................. [RUN]
2021-05-15 22:17:04.612511 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.not_null_dim_suppliers_supplier_sk".
2021-05-15 22:17:04.612511 (Thread-1): Compiling test.northwind_shop.not_null_dim_suppliers_supplier_sk
2021-05-15 22:17:04.628451 (Thread-1): Writing injected SQL for node "test.northwind_shop.not_null_dim_suppliers_supplier_sk"
2021-05-15 22:17:04.634801 (Thread-1): finished collecting timing info
2021-05-15 22:17:04.635297 (Thread-1): Opening a new connection, currently in state init
2021-05-15 22:17:04.642545 (Thread-1): On test.northwind_shop.not_null_dim_suppliers_supplier_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "test.northwind_shop.not_null_dim_suppliers_supplier_sk"} */

    
    



select count(*) as validation_errors
from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
where supplier_sk is null



2021-05-15 22:17:08.042037 (Thread-1): finished collecting timing info
2021-05-15 22:17:08.043060 (Thread-1): 19:17:08 | 1 of 2 PASS not_null_dim_suppliers_supplier_sk....................... [PASS in 3.43s]
2021-05-15 22:17:08.044704 (Thread-1): Finished running node test.northwind_shop.not_null_dim_suppliers_supplier_sk
2021-05-15 22:17:08.045461 (Thread-1): Began running node test.northwind_shop.unique_dim_suppliers_supplier_sk
2021-05-15 22:17:08.045461 (Thread-1): 19:17:08 | 2 of 2 START test unique_dim_suppliers_supplier_sk................... [RUN]
2021-05-15 22:17:08.046471 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.unique_dim_suppliers_supplier_sk".
2021-05-15 22:17:08.047256 (Thread-1): Compiling test.northwind_shop.unique_dim_suppliers_supplier_sk
2021-05-15 22:17:08.060284 (Thread-1): Writing injected SQL for node "test.northwind_shop.unique_dim_suppliers_supplier_sk"
2021-05-15 22:17:08.061848 (Thread-1): finished collecting timing info
2021-05-15 22:17:08.062347 (Thread-1): Opening a new connection, currently in state closed
2021-05-15 22:17:08.067404 (Thread-1): On test.northwind_shop.unique_dim_suppliers_supplier_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "test.northwind_shop.unique_dim_suppliers_supplier_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        supplier_sk

    from `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
    where supplier_sk is not null
    group by supplier_sk
    having count(*) > 1

) validation_errors



2021-05-15 22:17:10.914471 (Thread-1): finished collecting timing info
2021-05-15 22:17:10.915493 (Thread-1): 19:17:10 | 2 of 2 PASS unique_dim_suppliers_supplier_sk......................... [PASS in 2.87s]
2021-05-15 22:17:10.917417 (Thread-1): Finished running node test.northwind_shop.unique_dim_suppliers_supplier_sk
2021-05-15 22:17:11.023737 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 22:17:11.023737 (MainThread): 19:17:11 | 
2021-05-15 22:17:11.024731 (MainThread): 19:17:11 | Finished running 2 tests in 7.76s.
2021-05-15 22:17:11.026260 (MainThread): Connection 'master' was properly closed.
2021-05-15 22:17:11.026260 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 22:17:11.026260 (MainThread): Connection 'test.northwind_shop.unique_dim_suppliers_supplier_sk' was properly closed.
2021-05-15 22:17:11.028690 (MainThread): unclosed <socket.socket fd=1164, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 63885), raddr=('142.250.218.170', 443)>
2021-05-15 22:17:11.029684 (MainThread): unclosed <socket.socket fd=1176, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.101', 63886), raddr=('142.250.79.202', 443)>
2021-05-15 22:17:11.045849 (MainThread): 
2021-05-15 22:17:11.046851 (MainThread): Completed successfully
2021-05-15 22:17:11.047841 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-05-15 22:17:11.048838 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BEC42F708>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BEC42FAC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BEC3A1488>]}
2021-05-15 22:17:11.048838 (MainThread): Flushing usage events
2021-05-15 22:32:01.031942 (MainThread): Running with dbt=0.19.1
2021-05-15 22:32:01.402928 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', selector_name=None, show=False, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-05-15 22:32:01.403980 (MainThread): Tracking: tracking
2021-05-15 22:32:01.404993 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207166D0B88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207166D7B48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207166D7808>]}
2021-05-15 22:32:01.414951 (MainThread): Partial parsing not enabled
2021-05-15 22:32:01.416882 (MainThread): Parsing macros\adapters.sql
2021-05-15 22:32:01.439851 (MainThread): Parsing macros\catalog.sql
2021-05-15 22:32:01.446839 (MainThread): Parsing macros\etc.sql
2021-05-15 22:32:01.449833 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 22:32:01.454811 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 22:32:01.469708 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 22:32:01.472767 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 22:32:01.474750 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 22:32:01.486699 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 22:32:01.492708 (MainThread): Parsing macros\core.sql
2021-05-15 22:32:01.497679 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 22:32:01.545494 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 22:32:01.555467 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 22:32:01.557460 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 22:32:01.560402 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 22:32:01.563434 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 22:32:01.565442 (MainThread): Parsing macros\etc\query.sql
2021-05-15 22:32:01.567441 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 22:32:01.578815 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 22:32:01.595800 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 22:32:01.597795 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 22:32:01.605817 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 22:32:01.632061 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 22:32:01.671628 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 22:32:01.674619 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 22:32:01.694873 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 22:32:01.704066 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 22:32:01.710115 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 22:32:01.717100 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 22:32:01.720148 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 22:32:01.722144 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 22:32:01.725131 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 22:32:01.732174 (MainThread): Partial parsing not enabled
2021-05-15 22:32:01.756819 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 22:32:01.771165 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 22:32:01.778100 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 22:32:01.782062 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 22:32:01.786049 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 22:32:01.791032 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 22:32:01.799930 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 22:32:01.804911 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 22:32:01.809914 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 22:32:01.814878 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 22:32:01.817869 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002071A18C1C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002071A18C208>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002071A18C2C8>]}
2021-05-15 22:32:01.818883 (MainThread): Flushing usage events
2021-05-15 22:32:02.642269 (MainThread): Connection 'model.northwind_shop.stg_orderdetail' was properly closed.
2021-05-15 22:32:02.642764 (MainThread): Encountered an error:
2021-05-15 22:32:02.643483 (MainThread): Compilation Error
  dbt found two resources with the name "stg_orderdetail". Since these resources have the same name,
  dbt will be unable to find the correct resource when ref("stg_orderdetail") is used. To fix this,
  change the name of one of these resources:
  - model.northwind_shop.stg_orderdetail (models\staging\stg_orderdetail.sql)
  - model.northwind_shop.stg_orderdetail (models\marts\stg_orderdetail.sql)
2021-05-15 22:32:02.653369 (MainThread): Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 442, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 290, in load
    self.parse_project(project, macro_manifest, old_results)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 237, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 188, in parse_with_cache
    parser.parse_file(block)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\base.py", line 432, in parse_file
    self.parse_node(file_block)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\base.py", line 407, in parse_node
    self.add_result_node(block, result)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\base.py", line 389, in add_result_node
    self.results.add_node(block.file, node)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\results.py", line 103, in add_node
    self.add_node_nofile(node)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\results.py", line 99, in add_node_nofile
    _check_duplicates(node, self.nodes)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\results.py", line 45, in _check_duplicates
    raise_duplicate_resource_name(value, src[value.unique_id])
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 787, in raise_duplicate_resource_name
    node_2.unique_id, node_2.original_file_path))
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  dbt found two resources with the name "stg_orderdetail". Since these resources have the same name,
  dbt will be unable to find the correct resource when ref("stg_orderdetail") is used. To fix this,
  change the name of one of these resources:
  - model.northwind_shop.stg_orderdetail (models\staging\stg_orderdetail.sql)
  - model.northwind_shop.stg_orderdetail (models\marts\stg_orderdetail.sql)

2021-05-15 22:34:10.643269 (MainThread): Running with dbt=0.19.1
2021-05-15 22:34:10.999806 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', selector_name=None, show=False, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-05-15 22:34:11.000732 (MainThread): Tracking: tracking
2021-05-15 22:34:11.000732 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256D5E61F48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256D5E90D48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256D5E97648>]}
2021-05-15 22:34:11.010697 (MainThread): Partial parsing not enabled
2021-05-15 22:34:11.011693 (MainThread): Parsing macros\adapters.sql
2021-05-15 22:34:11.032552 (MainThread): Parsing macros\catalog.sql
2021-05-15 22:34:11.038531 (MainThread): Parsing macros\etc.sql
2021-05-15 22:34:11.041522 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 22:34:11.046505 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 22:34:11.059830 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 22:34:11.062819 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 22:34:11.064813 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 22:34:11.075805 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 22:34:11.081764 (MainThread): Parsing macros\core.sql
2021-05-15 22:34:11.085743 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 22:34:11.129597 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 22:34:11.139563 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 22:34:11.140559 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 22:34:11.141556 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 22:34:11.144568 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 22:34:11.146539 (MainThread): Parsing macros\etc\query.sql
2021-05-15 22:34:11.147536 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 22:34:11.157503 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 22:34:11.172453 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 22:34:11.174446 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 22:34:11.180426 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 22:34:11.203349 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 22:34:11.242665 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 22:34:11.245652 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 22:34:11.263592 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 22:34:11.271565 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 22:34:11.277545 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 22:34:11.283525 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 22:34:11.286515 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 22:34:11.287512 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 22:34:11.289505 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 22:34:11.296482 (MainThread): Partial parsing not enabled
2021-05-15 22:34:11.318409 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 22:34:11.328591 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 22:34:11.332578 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 22:34:11.335568 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 22:34:11.339554 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 22:34:11.343541 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 22:34:11.348525 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 22:34:11.352511 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 22:34:11.356498 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 22:34:11.359488 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 22:34:11.362478 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256D993C1C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256D993C208>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256D993C2C8>]}
2021-05-15 22:34:11.362478 (MainThread): Flushing usage events
2021-05-15 22:34:11.988353 (MainThread): Connection 'model.northwind_shop.stg_orderdetail' was properly closed.
2021-05-15 22:34:11.988353 (MainThread): Encountered an error:
2021-05-15 22:34:11.988353 (MainThread): Compilation Error
  dbt found two resources with the name "stg_orderdetail". Since these resources have the same name,
  dbt will be unable to find the correct resource when ref("stg_orderdetail") is used. To fix this,
  change the name of one of these resources:
  - model.northwind_shop.stg_orderdetail (models\staging\stg_orderdetail.sql)
  - model.northwind_shop.stg_orderdetail (models\marts\stg_orderdetail.sql)
2021-05-15 22:34:11.994389 (MainThread): Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 442, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 290, in load
    self.parse_project(project, macro_manifest, old_results)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 237, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 188, in parse_with_cache
    parser.parse_file(block)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\base.py", line 432, in parse_file
    self.parse_node(file_block)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\base.py", line 407, in parse_node
    self.add_result_node(block, result)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\base.py", line 389, in add_result_node
    self.results.add_node(block.file, node)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\results.py", line 103, in add_node
    self.add_node_nofile(node)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\results.py", line 99, in add_node_nofile
    _check_duplicates(node, self.nodes)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\results.py", line 45, in _check_duplicates
    raise_duplicate_resource_name(value, src[value.unique_id])
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 787, in raise_duplicate_resource_name
    node_2.unique_id, node_2.original_file_path))
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  dbt found two resources with the name "stg_orderdetail". Since these resources have the same name,
  dbt will be unable to find the correct resource when ref("stg_orderdetail") is used. To fix this,
  change the name of one of these resources:
  - model.northwind_shop.stg_orderdetail (models\staging\stg_orderdetail.sql)
  - model.northwind_shop.stg_orderdetail (models\marts\stg_orderdetail.sql)

2021-05-15 22:36:23.985545 (MainThread): Running with dbt=0.19.1
2021-05-15 22:36:24.435338 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', selector_name=None, show=False, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-05-15 22:36:24.436347 (MainThread): Tracking: tracking
2021-05-15 22:36:24.437356 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DB7B20E08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DB7B207C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DB7B20BC8>]}
2021-05-15 22:36:24.448238 (MainThread): Partial parsing not enabled
2021-05-15 22:36:24.450309 (MainThread): Parsing macros\adapters.sql
2021-05-15 22:36:24.471222 (MainThread): Parsing macros\catalog.sql
2021-05-15 22:36:24.478195 (MainThread): Parsing macros\etc.sql
2021-05-15 22:36:24.481129 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 22:36:24.486173 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 22:36:24.500126 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 22:36:24.504110 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 22:36:24.506104 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 22:36:24.517078 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 22:36:24.523060 (MainThread): Parsing macros\core.sql
2021-05-15 22:36:24.527040 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 22:36:24.574886 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 22:36:24.584840 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 22:36:24.586832 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 22:36:24.587833 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 22:36:24.590828 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 22:36:24.591831 (MainThread): Parsing macros\etc\query.sql
2021-05-15 22:36:24.593834 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 22:36:24.603777 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 22:36:24.623107 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 22:36:24.626109 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 22:36:24.637077 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 22:36:24.660010 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 22:36:24.697876 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 22:36:24.699884 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 22:36:24.719812 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 22:36:24.729819 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 22:36:24.734752 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 22:36:24.742736 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 22:36:24.746438 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 22:36:24.748389 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 22:36:24.750385 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 22:36:24.758357 (MainThread): Partial parsing not enabled
2021-05-15 22:36:24.785250 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 22:36:24.799206 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 22:36:24.804207 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 22:36:24.808129 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 22:36:24.814172 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 22:36:24.818156 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 22:36:24.826131 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 22:36:24.831134 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 22:36:24.836112 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 22:36:24.840027 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 22:36:24.843072 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DBB5B2148>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DBB5B2188>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DBB5B2248>]}
2021-05-15 22:36:24.844068 (MainThread): Flushing usage events
2021-05-15 22:36:25.505077 (MainThread): Connection 'model.northwind_shop.stg_orderdetail' was properly closed.
2021-05-15 22:36:25.505575 (MainThread): Encountered an error:
2021-05-15 22:36:25.506071 (MainThread): Compilation Error
  dbt found two resources with the name "stg_orderdetail". Since these resources have the same name,
  dbt will be unable to find the correct resource when ref("stg_orderdetail") is used. To fix this,
  change the name of one of these resources:
  - model.northwind_shop.stg_orderdetail (models\staging\stg_orderdetail.sql)
  - model.northwind_shop.stg_orderdetail (models\marts\stg_orderdetail.sql)
2021-05-15 22:36:25.510264 (MainThread): Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 442, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 290, in load
    self.parse_project(project, macro_manifest, old_results)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 237, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 188, in parse_with_cache
    parser.parse_file(block)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\base.py", line 432, in parse_file
    self.parse_node(file_block)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\base.py", line 407, in parse_node
    self.add_result_node(block, result)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\base.py", line 389, in add_result_node
    self.results.add_node(block.file, node)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\results.py", line 103, in add_node
    self.add_node_nofile(node)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\results.py", line 99, in add_node_nofile
    _check_duplicates(node, self.nodes)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\results.py", line 45, in _check_duplicates
    raise_duplicate_resource_name(value, src[value.unique_id])
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 787, in raise_duplicate_resource_name
    node_2.unique_id, node_2.original_file_path))
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  dbt found two resources with the name "stg_orderdetail". Since these resources have the same name,
  dbt will be unable to find the correct resource when ref("stg_orderdetail") is used. To fix this,
  change the name of one of these resources:
  - model.northwind_shop.stg_orderdetail (models\staging\stg_orderdetail.sql)
  - model.northwind_shop.stg_orderdetail (models\marts\stg_orderdetail.sql)

2021-05-15 22:38:45.151164 (MainThread): Running with dbt=0.19.1
2021-05-15 22:38:45.627467 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', selector_name=None, show=False, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-05-15 22:38:45.629454 (MainThread): Tracking: tracking
2021-05-15 22:38:45.629454 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E41C3E1B08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E41C3E1888>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E41C3BFC48>]}
2021-05-15 22:38:45.642412 (MainThread): Partial parsing not enabled
2021-05-15 22:38:45.646402 (MainThread): Parsing macros\adapters.sql
2021-05-15 22:38:45.671312 (MainThread): Parsing macros\catalog.sql
2021-05-15 22:38:45.682275 (MainThread): Parsing macros\etc.sql
2021-05-15 22:38:45.684269 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 22:38:45.690253 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 22:38:45.707193 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 22:38:45.713173 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 22:38:45.716162 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 22:38:45.745112 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 22:38:45.763969 (MainThread): Parsing macros\core.sql
2021-05-15 22:38:45.770946 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 22:38:45.835130 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 22:38:45.852633 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 22:38:45.853629 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 22:38:45.857009 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 22:38:45.863605 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 22:38:45.865766 (MainThread): Parsing macros\etc\query.sql
2021-05-15 22:38:45.867592 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 22:38:45.886518 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 22:38:45.911232 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 22:38:45.914199 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 22:38:45.923163 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 22:38:45.954540 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 22:38:46.003744 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 22:38:46.006735 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 22:38:46.043744 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 22:38:46.055692 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 22:38:46.067896 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 22:38:46.075871 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 22:38:46.083850 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 22:38:46.085840 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 22:38:46.087837 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 22:38:46.099794 (MainThread): Partial parsing not enabled
2021-05-15 22:38:46.152621 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 22:38:46.168574 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 22:38:46.173489 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 22:38:46.182957 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 22:38:46.188754 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 22:38:46.203377 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 22:38:46.221283 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 22:38:46.250586 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 22:38:46.256542 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 22:38:46.268758 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 22:38:46.280847 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 22:38:46.285810 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 22:38:46.296773 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 22:38:46.330591 (MainThread): Acquiring new bigquery connection "test.northwind_shop.test_sum_qty".
2021-05-15 22:38:46.580077 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ee34f1e-8acf-4f53-845d-ba2ed26f324e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E41FE64488>]}
2021-05-15 22:38:46.636317 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ee34f1e-8acf-4f53-845d-ba2ed26f324e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E41E3B9E08>]}
2021-05-15 22:38:46.637319 (MainThread): Found 13 models, 15 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 1 seed file, 7 sources, 0 exposures
2021-05-15 22:38:46.643617 (MainThread): 
2021-05-15 22:38:46.645552 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 22:38:46.647076 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 22:38:46.647076 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 22:38:47.995490 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 22:38:47.995611 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 22:38:48.002686 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 22:38:49.208867 (MainThread): 19:38:49 | Concurrency: 1 threads (target='dev')
2021-05-15 22:38:49.208867 (MainThread): 19:38:49 | 
2021-05-15 22:38:49.214225 (Thread-1): Began running node seed.northwind_shop.seed_suppliers_divisions
2021-05-15 22:38:49.214225 (Thread-1): 19:38:49 | 1 of 1 START seed file dbt_arthur.seed_suppliers_divisions........... [RUN]
2021-05-15 22:38:49.215254 (Thread-1): Acquiring new bigquery connection "seed.northwind_shop.seed_suppliers_divisions".
2021-05-15 22:38:49.216019 (Thread-1): finished collecting timing info
2021-05-15 22:38:49.260595 (Thread-1): Opening a new connection, currently in state init
2021-05-15 22:38:49.265578 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 22:38:49.770005 (Thread-1): finished collecting timing info
2021-05-15 22:38:49.772012 (Thread-1): Unhandled error while executing seed.northwind_shop.seed_suppliers_divisions
400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/northwind1-313400/jobs?uploadType=resumable: Invalid field name "North America". Fields must contain only letters, numbers, and underscores, start with a letter or underscore, and be at most 300 characters long.
2021-05-15 22:38:49.774987 (Thread-1): 
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 2083, in load_table_from_file
    file_obj, job_resource, num_retries, timeout
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 2416, in _do_resumable_upload
    stream, metadata, num_retries, timeout
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 2467, in _initiate_resumable_upload
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\resumable_media\requests\upload.py", line 413, in initiate
    self._process_initiate_response(response)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\resumable_media\_upload.py", line 506, in _process_initiate_response
    callback=self._make_invalid,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\resumable_media\_helpers.py", line 104, in require_status_code
    *status_codes
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>, <HTTPStatus.CREATED: 201>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 89, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 24, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\impl.py", line 735, in load_dataframe
    job_config=load_config)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 2090, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/northwind1-313400/jobs?uploadType=resumable: Invalid field name "North America". Fields must contain only letters, numbers, and underscores, start with a letter or underscore, and be at most 300 characters long.
2021-05-15 22:38:49.792188 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ee34f1e-8acf-4f53-845d-ba2ed26f324e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E41DE15A48>]}
2021-05-15 22:38:49.793178 (Thread-1): 19:38:49 | 1 of 1 ERROR loading seed file dbt_arthur.seed_suppliers_divisions... [ERROR in 0.58s]
2021-05-15 22:38:49.794240 (Thread-1): Finished running node seed.northwind_shop.seed_suppliers_divisions
2021-05-15 22:38:49.864364 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 22:38:49.864364 (MainThread): 19:38:49 | 
2021-05-15 22:38:49.865360 (MainThread): 19:38:49 | Finished running 1 seed in 3.22s.
2021-05-15 22:38:49.865360 (MainThread): Connection 'master' was properly closed.
2021-05-15 22:38:49.865360 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 22:38:49.866363 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 22:38:49.866363 (MainThread): Connection 'seed.northwind_shop.seed_suppliers_divisions' was properly closed.
2021-05-15 22:38:49.875809 (MainThread): 
2021-05-15 22:38:49.876802 (MainThread): Completed with 1 error and 0 warnings:
2021-05-15 22:38:49.877798 (MainThread): 
2021-05-15 22:38:49.877798 (MainThread): 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/northwind1-313400/jobs?uploadType=resumable: Invalid field name "North America". Fields must contain only letters, numbers, and underscores, start with a letter or underscore, and be at most 300 characters long.
2021-05-15 22:38:49.880120 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-15 22:38:49.880120 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E41C40AB08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E41C3BE048>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E41C391D88>]}
2021-05-15 22:38:49.880120 (MainThread): Flushing usage events
2021-05-15 22:39:21.232406 (MainThread): Running with dbt=0.19.1
2021-05-15 22:39:21.561735 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', selector_name=None, show=False, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-05-15 22:39:21.563009 (MainThread): Tracking: tracking
2021-05-15 22:39:21.564004 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAF1BE0A08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAF1BE0C08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAF1BE6108>]}
2021-05-15 22:39:21.572974 (MainThread): Partial parsing not enabled
2021-05-15 22:39:21.573971 (MainThread): Parsing macros\adapters.sql
2021-05-15 22:39:21.591910 (MainThread): Parsing macros\catalog.sql
2021-05-15 22:39:21.597891 (MainThread): Parsing macros\etc.sql
2021-05-15 22:39:21.599884 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 22:39:21.604867 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 22:39:21.619028 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 22:39:21.622017 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 22:39:21.623014 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 22:39:21.632980 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 22:39:21.637964 (MainThread): Parsing macros\core.sql
2021-05-15 22:39:21.641951 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 22:39:21.683810 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 22:39:21.692780 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 22:39:21.693778 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 22:39:21.695770 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 22:39:21.697764 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 22:39:21.698761 (MainThread): Parsing macros\etc\query.sql
2021-05-15 22:39:21.699757 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 22:39:21.708727 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 22:39:21.723677 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 22:39:21.724674 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 22:39:21.731650 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 22:39:21.752580 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 22:39:21.790475 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 22:39:21.792447 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 22:39:21.810388 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 22:39:21.856919 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 22:39:21.879644 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 22:39:21.891263 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 22:39:21.897262 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 22:39:21.900227 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 22:39:21.902220 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 22:39:21.914182 (MainThread): Partial parsing not enabled
2021-05-15 22:39:21.942087 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 22:39:21.985517 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 22:39:22.001379 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 22:39:22.015596 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 22:39:22.020558 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 22:39:22.036738 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 22:39:22.078472 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 22:39:22.095533 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 22:39:22.104239 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 22:39:22.113608 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 22:39:22.119588 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 22:39:22.130551 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 22:39:22.140237 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 22:39:22.165752 (MainThread): Acquiring new bigquery connection "test.northwind_shop.test_sum_qty".
2021-05-15 22:39:22.387209 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '800f7229-bada-4c72-b67e-fdd505cface9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAF5817E88>]}
2021-05-15 22:39:22.445528 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '800f7229-bada-4c72-b67e-fdd505cface9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAF3AF8908>]}
2021-05-15 22:39:22.445528 (MainThread): Found 13 models, 15 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 1 seed file, 7 sources, 0 exposures
2021-05-15 22:39:22.449514 (MainThread): 
2021-05-15 22:39:22.449514 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 22:39:22.451513 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 22:39:22.451513 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 22:39:23.602891 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 22:39:23.603885 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 22:39:23.611969 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 22:39:24.749910 (MainThread): 19:39:24 | Concurrency: 1 threads (target='dev')
2021-05-15 22:39:24.750901 (MainThread): 19:39:24 | 
2021-05-15 22:39:24.757375 (Thread-1): Began running node seed.northwind_shop.seed_suppliers_divisions
2021-05-15 22:39:24.757375 (Thread-1): 19:39:24 | 1 of 1 START seed file dbt_arthur.seed_suppliers_divisions........... [RUN]
2021-05-15 22:39:24.758368 (Thread-1): Acquiring new bigquery connection "seed.northwind_shop.seed_suppliers_divisions".
2021-05-15 22:39:24.759365 (Thread-1): finished collecting timing info
2021-05-15 22:39:24.796289 (Thread-1): Opening a new connection, currently in state init
2021-05-15 22:39:24.801282 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 22:39:29.420644 (Thread-1): Unhandled error while running:
LOAD TABLE
2021-05-15 22:39:29.420644 (Thread-1): Runtime Error
  Error while reading data, error message: CSV table references column position 1, but line starting at position:30 contains only 1 columns.
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 1; errors: 1; max bad: 0; error percent: 0
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
2021-05-15 22:39:29.420644 (Thread-1): finished collecting timing info
2021-05-15 22:39:29.421646 (Thread-1): Runtime Error in seed seed_suppliers_divisions (data\seed_suppliers_divisions.csv)
  Error while reading data, error message: CSV table references column position 1, but line starting at position:30 contains only 1 columns.
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 1; errors: 1; max bad: 0; error percent: 0
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 89, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 24, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\impl.py", line 739, in load_dataframe
    self.poll_until_job_completes(job, timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\impl.py", line 462, in poll_until_job_completes
    raise dbt.exceptions.RuntimeException(message)
dbt.exceptions.RuntimeException: Runtime Error in seed seed_suppliers_divisions (data\seed_suppliers_divisions.csv)
  Error while reading data, error message: CSV table references column position 1, but line starting at position:30 contains only 1 columns.
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 1; errors: 1; max bad: 0; error percent: 0
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
2021-05-15 22:39:29.424634 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '800f7229-bada-4c72-b67e-fdd505cface9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAF1B90508>]}
2021-05-15 22:39:29.425631 (Thread-1): 19:39:29 | 1 of 1 ERROR loading seed file dbt_arthur.seed_suppliers_divisions... [ERROR in 4.67s]
2021-05-15 22:39:29.426623 (Thread-1): Finished running node seed.northwind_shop.seed_suppliers_divisions
2021-05-15 22:39:29.438661 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 22:39:29.439580 (MainThread): 19:39:29 | 
2021-05-15 22:39:29.439580 (MainThread): 19:39:29 | Finished running 1 seed in 6.99s.
2021-05-15 22:39:29.440588 (MainThread): Connection 'master' was properly closed.
2021-05-15 22:39:29.440588 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 22:39:29.440588 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 22:39:29.440588 (MainThread): Connection 'seed.northwind_shop.seed_suppliers_divisions' was properly closed.
2021-05-15 22:39:29.446556 (MainThread): 
2021-05-15 22:39:29.446556 (MainThread): Completed with 1 error and 0 warnings:
2021-05-15 22:39:29.447815 (MainThread): 
2021-05-15 22:39:29.448335 (MainThread): Runtime Error in seed seed_suppliers_divisions (data\seed_suppliers_divisions.csv)
2021-05-15 22:39:29.452960 (MainThread):   Error while reading data, error message: CSV table references column position 1, but line starting at position:30 contains only 1 columns.
2021-05-15 22:39:29.453915 (MainThread):   Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 1; errors: 1; max bad: 0; error percent: 0
2021-05-15 22:39:29.454229 (MainThread):   You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
2021-05-15 22:39:29.455222 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-15 22:39:29.456234 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAF5426988>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAF54265C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAF5413D88>]}
2021-05-15 22:39:29.456234 (MainThread): Flushing usage events
2021-05-15 22:41:12.730324 (MainThread): Running with dbt=0.19.1
2021-05-15 22:41:13.079849 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', selector_name=None, show=False, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-05-15 22:41:13.079849 (MainThread): Tracking: tracking
2021-05-15 22:41:13.080863 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B8C0D6FC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B8C102CC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B8C102B08>]}
2021-05-15 22:41:13.090818 (MainThread): Partial parsing not enabled
2021-05-15 22:41:13.092804 (MainThread): Parsing macros\adapters.sql
2021-05-15 22:41:13.113733 (MainThread): Parsing macros\catalog.sql
2021-05-15 22:41:13.120728 (MainThread): Parsing macros\etc.sql
2021-05-15 22:41:13.122687 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 22:41:13.127690 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 22:41:13.141638 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 22:41:13.144627 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 22:41:13.146636 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 22:41:13.156593 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 22:41:13.162569 (MainThread): Parsing macros\core.sql
2021-05-15 22:41:13.167552 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 22:41:13.211640 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 22:41:13.220625 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 22:41:13.222603 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 22:41:13.223616 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 22:41:13.226595 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 22:41:13.227586 (MainThread): Parsing macros\etc\query.sql
2021-05-15 22:41:13.229591 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 22:41:13.239561 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 22:41:13.254514 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 22:41:13.256493 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 22:41:13.263466 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 22:41:13.285396 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 22:41:13.320278 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 22:41:13.322271 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 22:41:13.340217 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 22:41:13.348185 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 22:41:13.353172 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 22:41:13.361142 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 22:41:13.364129 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 22:41:13.365132 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 22:41:13.368117 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 22:41:13.375096 (MainThread): Partial parsing not enabled
2021-05-15 22:41:13.399017 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 22:41:13.409978 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 22:41:13.413964 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 22:41:13.418972 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 22:41:13.422933 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 22:41:13.427934 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 22:41:13.433899 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 22:41:13.437886 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 22:41:13.442870 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 22:41:13.446856 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 22:41:13.450856 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 22:41:13.455842 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 22:41:13.459812 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 22:41:13.471032 (MainThread): Acquiring new bigquery connection "test.northwind_shop.test_sum_qty".
2021-05-15 22:41:13.612046 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50a71a22-54db-4275-b6b3-72aa1e5493f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B8FB844C8>]}
2021-05-15 22:41:13.649943 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50a71a22-54db-4275-b6b3-72aa1e5493f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B8E0D8A88>]}
2021-05-15 22:41:13.649943 (MainThread): Found 13 models, 15 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 1 seed file, 7 sources, 0 exposures
2021-05-15 22:41:13.652953 (MainThread): 
2021-05-15 22:41:13.653892 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 22:41:13.655886 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 22:41:13.656883 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 22:41:14.756960 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 22:41:14.756960 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 22:41:14.766929 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 22:41:15.917297 (MainThread): 19:41:15 | Concurrency: 1 threads (target='dev')
2021-05-15 22:41:15.917297 (MainThread): 19:41:15 | 
2021-05-15 22:41:15.921972 (Thread-1): Began running node seed.northwind_shop.seed_suppliers_divisions
2021-05-15 22:41:15.921972 (Thread-1): 19:41:15 | 1 of 1 START seed file dbt_arthur.seed_suppliers_divisions........... [RUN]
2021-05-15 22:41:15.922969 (Thread-1): Acquiring new bigquery connection "seed.northwind_shop.seed_suppliers_divisions".
2021-05-15 22:41:15.924025 (Thread-1): finished collecting timing info
2021-05-15 22:41:15.970811 (Thread-1): Opening a new connection, currently in state init
2021-05-15 22:41:15.975793 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 22:41:20.325888 (Thread-1): Unhandled error while running:
LOAD TABLE
2021-05-15 22:41:20.326685 (Thread-1): Runtime Error
  Error while reading data, error message: CSV table references column position 1, but line starting at position:48 contains only 1 columns.
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 2; errors: 1; max bad: 0; error percent: 0
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
2021-05-15 22:41:20.326685 (Thread-1): finished collecting timing info
2021-05-15 22:41:20.326685 (Thread-1): Runtime Error in seed seed_suppliers_divisions (data\seed_suppliers_divisions.csv)
  Error while reading data, error message: CSV table references column position 1, but line starting at position:48 contains only 1 columns.
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 2; errors: 1; max bad: 0; error percent: 0
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 89, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 24, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\impl.py", line 739, in load_dataframe
    self.poll_until_job_completes(job, timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\impl.py", line 462, in poll_until_job_completes
    raise dbt.exceptions.RuntimeException(message)
dbt.exceptions.RuntimeException: Runtime Error in seed seed_suppliers_divisions (data\seed_suppliers_divisions.csv)
  Error while reading data, error message: CSV table references column position 1, but line starting at position:48 contains only 1 columns.
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 2; errors: 1; max bad: 0; error percent: 0
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
2021-05-15 22:41:20.328677 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50a71a22-54db-4275-b6b3-72aa1e5493f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B8C0D83C8>]}
2021-05-15 22:41:20.328677 (Thread-1): 19:41:20 | 1 of 1 ERROR loading seed file dbt_arthur.seed_suppliers_divisions... [ERROR in 4.41s]
2021-05-15 22:41:20.330649 (Thread-1): Finished running node seed.northwind_shop.seed_suppliers_divisions
2021-05-15 22:41:20.400376 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 22:41:20.400376 (MainThread): 19:41:20 | 
2021-05-15 22:41:20.401688 (MainThread): 19:41:20 | Finished running 1 seed in 6.75s.
2021-05-15 22:41:20.402690 (MainThread): Connection 'master' was properly closed.
2021-05-15 22:41:20.402690 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 22:41:20.402690 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 22:41:20.402690 (MainThread): Connection 'seed.northwind_shop.seed_suppliers_divisions' was properly closed.
2021-05-15 22:41:20.413652 (MainThread): 
2021-05-15 22:41:20.414664 (MainThread): Completed with 1 error and 0 warnings:
2021-05-15 22:41:20.415645 (MainThread): 
2021-05-15 22:41:20.416643 (MainThread): Runtime Error in seed seed_suppliers_divisions (data\seed_suppliers_divisions.csv)
2021-05-15 22:41:20.417641 (MainThread):   Error while reading data, error message: CSV table references column position 1, but line starting at position:48 contains only 1 columns.
2021-05-15 22:41:20.417641 (MainThread):   Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 2; errors: 1; max bad: 0; error percent: 0
2021-05-15 22:41:20.418635 (MainThread):   You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
2021-05-15 22:41:20.419634 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-15 22:41:20.420628 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B8C0D8AC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B8C0D8B48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B892D7388>]}
2021-05-15 22:41:20.420628 (MainThread): Flushing usage events
2021-05-15 22:47:58.327974 (MainThread): Running with dbt=0.19.1
2021-05-15 22:47:59.011171 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', selector_name=None, show=False, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-05-15 22:47:59.012162 (MainThread): Tracking: tracking
2021-05-15 22:47:59.013159 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188B9F50BC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188B9F57808>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188B9F573C8>]}
2021-05-15 22:47:59.028940 (MainThread): Partial parsing not enabled
2021-05-15 22:47:59.030947 (MainThread): Parsing macros\adapters.sql
2021-05-15 22:47:59.063662 (MainThread): Parsing macros\catalog.sql
2021-05-15 22:47:59.072632 (MainThread): Parsing macros\etc.sql
2021-05-15 22:47:59.075622 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 22:47:59.081603 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 22:47:59.098546 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 22:47:59.105528 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 22:47:59.107519 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 22:47:59.123466 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 22:47:59.130437 (MainThread): Parsing macros\core.sql
2021-05-15 22:47:59.139408 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 22:47:59.199619 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 22:47:59.211543 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 22:47:59.213533 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 22:47:59.217949 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 22:47:59.221927 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 22:47:59.223920 (MainThread): Parsing macros\etc\query.sql
2021-05-15 22:47:59.224917 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 22:47:59.238871 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 22:47:59.261799 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 22:47:59.264792 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 22:47:59.274756 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 22:47:59.309382 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 22:47:59.359854 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 22:47:59.362846 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 22:47:59.390748 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 22:47:59.402710 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 22:47:59.409539 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 22:47:59.421620 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 22:47:59.425788 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 22:47:59.429350 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 22:47:59.438586 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 22:47:59.461606 (MainThread): Partial parsing not enabled
2021-05-15 22:47:59.541162 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 22:47:59.572782 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 22:47:59.577771 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 22:47:59.587531 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 22:47:59.592514 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 22:47:59.598390 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 22:47:59.610643 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 22:47:59.619493 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 22:47:59.624476 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 22:47:59.629460 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 22:47:59.639315 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 22:47:59.643297 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 22:47:59.651052 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 22:47:59.668963 (MainThread): Acquiring new bigquery connection "test.northwind_shop.test_sum_qty".
2021-05-15 22:47:59.878046 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d15af6d-8a2a-466b-9c36-bc24c9cfd8e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188BD9FB808>]}
2021-05-15 22:47:59.943579 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d15af6d-8a2a-466b-9c36-bc24c9cfd8e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188BBF28D48>]}
2021-05-15 22:47:59.944083 (MainThread): Found 13 models, 15 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 1 seed file, 7 sources, 0 exposures
2021-05-15 22:47:59.948989 (MainThread): 
2021-05-15 22:47:59.950456 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 22:47:59.954262 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 22:47:59.955331 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 22:48:01.287676 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 22:48:01.288482 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 22:48:01.294276 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 22:48:02.401881 (MainThread): 19:48:02 | Concurrency: 1 threads (target='dev')
2021-05-15 22:48:02.403280 (MainThread): 19:48:02 | 
2021-05-15 22:48:02.417317 (Thread-1): Began running node seed.northwind_shop.seed2
2021-05-15 22:48:02.417317 (Thread-1): 19:48:02 | 1 of 1 START seed file dbt_arthur.seed2.............................. [RUN]
2021-05-15 22:48:02.418233 (Thread-1): Acquiring new bigquery connection "seed.northwind_shop.seed2".
2021-05-15 22:48:02.419229 (Thread-1): finished collecting timing info
2021-05-15 22:48:02.459470 (Thread-1): Opening a new connection, currently in state init
2021-05-15 22:48:02.467448 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 22:48:07.869936 (Thread-1): Writing runtime SQL for node "seed.northwind_shop.seed2"
2021-05-15 22:48:07.881650 (Thread-1): finished collecting timing info
2021-05-15 22:48:07.882647 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d15af6d-8a2a-466b-9c36-bc24c9cfd8e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188B9F6A488>]}
2021-05-15 22:48:07.882647 (Thread-1): 19:48:07 | 1 of 1 OK loaded seed file dbt_arthur.seed2.......................... [INSERT 16 in 5.46s]
2021-05-15 22:48:07.883638 (Thread-1): Finished running node seed.northwind_shop.seed2
2021-05-15 22:48:07.954550 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 22:48:07.954550 (MainThread): 19:48:07 | 
2021-05-15 22:48:07.955566 (MainThread): 19:48:07 | Finished running 1 seed in 8.00s.
2021-05-15 22:48:07.956943 (MainThread): Connection 'master' was properly closed.
2021-05-15 22:48:07.957792 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 22:48:07.958293 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 22:48:07.958293 (MainThread): Connection 'seed.northwind_shop.seed2' was properly closed.
2021-05-15 22:48:07.969291 (MainThread): 
2021-05-15 22:48:07.969291 (MainThread): Completed successfully
2021-05-15 22:48:07.970288 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-15 22:48:07.972289 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188B9F8BB88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188B9F25C88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188B9F9E348>]}
2021-05-15 22:48:07.972289 (MainThread): Flushing usage events
2021-05-15 22:54:00.643276 (MainThread): Running with dbt=0.19.1
2021-05-15 22:54:01.122788 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_suppliers'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 22:54:01.123790 (MainThread): Tracking: tracking
2021-05-15 22:54:01.123790 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C00F370688>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C00F370CC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C00F370C08>]}
2021-05-15 22:54:01.137743 (MainThread): Partial parsing not enabled
2021-05-15 22:54:01.138740 (MainThread): Parsing macros\adapters.sql
2021-05-15 22:54:01.168563 (MainThread): Parsing macros\catalog.sql
2021-05-15 22:54:01.174544 (MainThread): Parsing macros\etc.sql
2021-05-15 22:54:01.182518 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 22:54:01.187965 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 22:54:01.205683 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 22:54:01.208673 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 22:54:01.212998 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 22:54:01.225075 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 22:54:01.235876 (MainThread): Parsing macros\core.sql
2021-05-15 22:54:01.239866 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 22:54:01.308277 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 22:54:01.323166 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 22:54:01.324160 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 22:54:01.326153 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 22:54:01.330145 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 22:54:01.333129 (MainThread): Parsing macros\etc\query.sql
2021-05-15 22:54:01.334126 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 22:54:01.350076 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 22:54:01.372982 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 22:54:01.374975 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 22:54:01.389960 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 22:54:01.432414 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 22:54:01.485958 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 22:54:01.487954 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 22:54:01.516021 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 22:54:01.525993 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 22:54:01.537948 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 22:54:01.552698 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 22:54:01.555687 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 22:54:01.557681 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 22:54:01.561521 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 22:54:01.572829 (MainThread): Partial parsing not enabled
2021-05-15 22:54:01.604729 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 22:54:01.619615 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 22:54:01.624903 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 22:54:01.634586 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 22:54:01.642142 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 22:54:01.651154 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 22:54:01.657129 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 22:54:01.664107 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 22:54:01.668094 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 22:54:01.672081 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 22:54:01.677064 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 22:54:01.685037 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 22:54:01.689024 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 22:54:01.704062 (MainThread): Acquiring new bigquery connection "test.northwind_shop.test_sum_qty".
2021-05-15 22:54:01.904826 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6fc35cad-9e66-45da-b46c-b33706c3c310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C012DF45C8>]}
2021-05-15 22:54:01.954692 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6fc35cad-9e66-45da-b46c-b33706c3c310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C011347E88>]}
2021-05-15 22:54:01.956812 (MainThread): Found 13 models, 15 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 1 seed file, 7 sources, 0 exposures
2021-05-15 22:54:01.963205 (MainThread): 
2021-05-15 22:54:01.964504 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 22:54:01.965499 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 22:54:01.966498 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 22:54:03.247542 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 22:54:03.247542 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 22:54:03.255112 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 22:54:04.364336 (MainThread): 19:54:04 | Concurrency: 1 threads (target='dev')
2021-05-15 22:54:04.365337 (MainThread): 19:54:04 | 
2021-05-15 22:54:04.369683 (Thread-1): Began running node model.northwind_shop.dim_suppliers
2021-05-15 22:54:04.369683 (Thread-1): 19:54:04 | 1 of 1 START table model dbt_arthur.dim_suppliers.................... [RUN]
2021-05-15 22:54:04.370731 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 22:54:04.370731 (Thread-1): Compiling model.northwind_shop.dim_suppliers
2021-05-15 22:54:04.373330 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_suppliers"
2021-05-15 22:54:04.383394 (Thread-1): finished collecting timing info
2021-05-15 22:54:04.405743 (Thread-1): Opening a new connection, currently in state init
2021-05-15 22:54:04.411669 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 22:54:05.588146 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_suppliers"
2021-05-15 22:54:05.595771 (Thread-1): On model.northwind_shop.dim_suppliers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.dim_suppliers"} */


  create or replace table `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
  
  
  OPTIONS()
  as (
    with
    selected as (
        select 
          /*primary key*/
            supplier_id
            ,country
            ,city	
            ,fax	
            ,postal_code
            ,homepage
            ,address	
            ,region	

        from `northwind1-313400`.`dbt_arthur`.`stg_suppliers`
    )
    , divisions as ( 
        select *
        from `northwind1-313400`.`dbt_arthur`.`seed2`
    )
    , transformed as (
        select 
        row_number() over (order by supplier_id) as supplier_sk
        , suppliers.supplier_id
            ,suppliers.country
            ,suppliers.city	
            ,suppliers.fax	
            ,suppliers.postal_code
            ,suppliers.homepage
            ,suppliers.address	
            ,suppliers.region
            ,divisions.division
            , case
                when supplier.country = ('France', 'Germany') then 'Europe'
                when supplier.country = ('USA', 'Canada') then 'North America'
                when supplier.country = 'Brazil' then 'LATAM'
                else 'Other'
              end division 
        from selected
        left join divisons on suppliers.country = divisions.country
    )

select * from transformed
  );
    
2021-05-15 22:54:07.013032 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/ab3ac36d-d1f9-4df4-99a9-00f2ee8b1da6?maxResults=0&location=US&prettyPrint=false: Table name "divisons" missing dataset while no default dataset is set in the request.')
2021-05-15 22:54:08.501872 (Thread-1): finished collecting timing info
2021-05-15 22:54:08.502869 (Thread-1): Database Error in model dim_suppliers (models\marts\dim_suppliers.sql)
  Table name "divisons" missing dataset while no default dataset is set in the request.
  compiled SQL at target\run\northwind_shop\models\marts\dim_suppliers.sql
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/d22bc481-6df3-43a1-9bd7-6060b582a6d4?maxResults=0&location=US&prettyPrint=false: Table name "divisons" missing dataset while no default dataset is set in the request.

(job ID: d22bc481-6df3-43a1-9bd7-6060b582a6d4)

                                                              -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.dim_suppliers"} */
   2:
   3:
   4:  create or replace table `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    with
  10:    selected as (
  11:        select 
  12:          /*primary key*/
  13:            supplier_id
  14:            ,country
  15:            ,city	
  16:            ,fax	
  17:            ,postal_code
  18:            ,homepage
  19:            ,address	
  20:            ,region	
  21:
  22:        from `northwind1-313400`.`dbt_arthur`.`stg_suppliers`
  23:    )
  24:    , divisions as ( 
  25:        select *
  26:        from `northwind1-313400`.`dbt_arthur`.`seed2`
  27:    )
  28:    , transformed as (
  29:        select 
  30:        row_number() over (order by supplier_id) as supplier_sk
  31:        , suppliers.supplier_id
  32:            ,suppliers.country
  33:            ,suppliers.city	
  34:            ,suppliers.fax	
  35:            ,suppliers.postal_code
  36:            ,suppliers.homepage
  37:            ,suppliers.address	
  38:            ,suppliers.region
  39:            ,divisions.division
  40:            , case
  41:                when supplier.country = ('France', 'Germany') then 'Europe'
  42:                when supplier.country = ('USA', 'Canada') then 'North America'
  43:                when supplier.country = 'Brazil' then 'LATAM'
  44:                else 'Other'
  45:              end division 
  46:        from selected
  47:        left join divisons on suppliers.country = divisions.country
  48:    )
  49:
  50:select * from transformed
  51:  );
  52:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_suppliers (models\marts\dim_suppliers.sql)
  Table name "divisons" missing dataset while no default dataset is set in the request.
  compiled SQL at target\run\northwind_shop\models\marts\dim_suppliers.sql
2021-05-15 22:54:08.532181 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fc35cad-9e66-45da-b46c-b33706c3c310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C00F340BC8>]}
2021-05-15 22:54:08.532181 (Thread-1): 19:54:08 | 1 of 1 ERROR creating table model dbt_arthur.dim_suppliers........... [ERROR in 4.16s]
2021-05-15 22:54:08.533571 (Thread-1): Finished running node model.northwind_shop.dim_suppliers
2021-05-15 22:54:08.545020 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 22:54:08.545020 (MainThread): 19:54:08 | 
2021-05-15 22:54:08.546170 (MainThread): 19:54:08 | Finished running 1 table model in 6.58s.
2021-05-15 22:54:08.547207 (MainThread): Connection 'master' was properly closed.
2021-05-15 22:54:08.547207 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 22:54:08.547207 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 22:54:08.547207 (MainThread): Connection 'model.northwind_shop.dim_suppliers' was properly closed.
2021-05-15 22:54:08.554140 (MainThread): 
2021-05-15 22:54:08.555140 (MainThread): Completed with 1 error and 0 warnings:
2021-05-15 22:54:08.556133 (MainThread): 
2021-05-15 22:54:08.557130 (MainThread): Database Error in model dim_suppliers (models\marts\dim_suppliers.sql)
2021-05-15 22:54:08.558177 (MainThread):   Table name "divisons" missing dataset while no default dataset is set in the request.
2021-05-15 22:54:08.559980 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\dim_suppliers.sql
2021-05-15 22:54:08.561148 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-15 22:54:08.562292 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C00F3A64C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C010E203C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C01305AA08>]}
2021-05-15 22:54:08.562848 (MainThread): Flushing usage events
2021-05-15 22:55:27.198478 (MainThread): Running with dbt=0.19.1
2021-05-15 22:55:27.519609 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_suppliers'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 22:55:27.520606 (MainThread): Tracking: tracking
2021-05-15 22:55:27.520606 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA9B99DF88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA9B9A1C48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA9B9A8148>]}
2021-05-15 22:55:27.530573 (MainThread): Partial parsing not enabled
2021-05-15 22:55:27.531569 (MainThread): Parsing macros\adapters.sql
2021-05-15 22:55:27.551503 (MainThread): Parsing macros\catalog.sql
2021-05-15 22:55:27.557482 (MainThread): Parsing macros\etc.sql
2021-05-15 22:55:27.559476 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 22:55:27.564459 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 22:55:27.575422 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 22:55:27.578413 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 22:55:27.579409 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 22:55:27.588379 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 22:55:27.593362 (MainThread): Parsing macros\core.sql
2021-05-15 22:55:27.597349 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 22:55:27.638212 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 22:55:27.647182 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 22:55:27.648179 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 22:55:27.649176 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 22:55:27.651169 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 22:55:27.653162 (MainThread): Parsing macros\etc\query.sql
2021-05-15 22:55:27.654159 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 22:55:27.663129 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 22:55:27.676086 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 22:55:27.678079 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 22:55:27.684059 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 22:55:27.702996 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 22:55:27.733892 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 22:55:27.735886 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 22:55:27.751832 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 22:55:27.757812 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 22:55:27.762796 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 22:55:27.768776 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 22:55:27.771766 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 22:55:27.772762 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 22:55:27.774756 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 22:55:27.780736 (MainThread): Partial parsing not enabled
2021-05-15 22:55:27.804656 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 22:55:27.813626 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 22:55:27.817613 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 22:55:27.821599 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 22:55:27.824589 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 22:55:27.828576 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 22:55:27.834556 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 22:55:27.837546 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 22:55:27.841532 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 22:55:27.845519 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 22:55:27.848509 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 22:55:27.852496 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 22:55:27.856483 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 22:55:27.866449 (MainThread): Acquiring new bigquery connection "test.northwind_shop.test_sum_qty".
2021-05-15 22:55:27.989052 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '156d8b38-ea4f-463b-8332-f3d65e8a6b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA9F690E48>]}
2021-05-15 22:55:28.028918 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '156d8b38-ea4f-463b-8332-f3d65e8a6b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA9D979D08>]}
2021-05-15 22:55:28.028918 (MainThread): Found 13 models, 15 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 1 seed file, 7 sources, 0 exposures
2021-05-15 22:55:28.031984 (MainThread): 
2021-05-15 22:55:28.032906 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 22:55:28.034900 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 22:55:28.034900 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 22:55:29.163315 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 22:55:29.163315 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 22:55:29.168289 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 22:55:30.269882 (MainThread): 19:55:30 | Concurrency: 1 threads (target='dev')
2021-05-15 22:55:30.270890 (MainThread): 19:55:30 | 
2021-05-15 22:55:30.275910 (Thread-1): Began running node model.northwind_shop.dim_suppliers
2021-05-15 22:55:30.276910 (Thread-1): 19:55:30 | 1 of 1 START table model dbt_arthur.dim_suppliers.................... [RUN]
2021-05-15 22:55:30.277903 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 22:55:30.278864 (Thread-1): Compiling model.northwind_shop.dim_suppliers
2021-05-15 22:55:30.282846 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_suppliers"
2021-05-15 22:55:30.283841 (Thread-1): finished collecting timing info
2021-05-15 22:55:30.306764 (Thread-1): Opening a new connection, currently in state init
2021-05-15 22:55:30.313882 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 22:55:31.451848 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_suppliers"
2021-05-15 22:55:31.453842 (Thread-1): On model.northwind_shop.dim_suppliers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.dim_suppliers"} */


  create or replace table `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
  
  
  OPTIONS()
  as (
    with
    selected as (
        select 
          /*primary key*/
            supplier_id
            ,country
            ,city	
            ,fax	
            ,postal_code
            ,homepage
            ,address	
            ,region	

        from `northwind1-313400`.`dbt_arthur`.`stg_suppliers`
    )
    , divisions as ( 
        select *
        from `northwind1-313400`.`dbt_arthur`.`seed2`
    )
    , transformed as (
        select 
        row_number() over (order by supplier_id) as supplier_sk
        , suppliers.supplier_id
            ,suppliers.country
            ,suppliers.city	
            ,suppliers.fax	
            ,suppliers.postal_code
            ,suppliers.homepage
            ,suppliers.address	
            ,suppliers.region
            ,divisions.division
            , case
                when supplier.country = ('France', 'Germany') then 'Europe'
                when supplier.country = ('USA', 'Canada') then 'North America'
                when supplier.country = 'Brazil' then 'LATAM'
                else 'Other'
              end division 
        from selected
        left join divisions on suppliers.country = divisions.country
    )

select * from transformed
  );
    
2021-05-15 22:55:32.515460 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/8737c92c-126c-4cf0-bcd0-33c0e5dc92d4?maxResults=0&location=US&prettyPrint=false: Unrecognized name: suppliers; Did you mean supplier_id? at [47:32]')
2021-05-15 22:55:34.283125 (Thread-1): finished collecting timing info
2021-05-15 22:55:34.284123 (Thread-1): Database Error in model dim_suppliers (models\marts\dim_suppliers.sql)
  Unrecognized name: suppliers; Did you mean supplier_id? at [47:32]
  compiled SQL at target\run\northwind_shop\models\marts\dim_suppliers.sql
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/ba824154-c234-496c-8f67-623c83cddb62?maxResults=0&location=US&prettyPrint=false: Unrecognized name: suppliers; Did you mean supplier_id? at [47:32]

(job ID: ba824154-c234-496c-8f67-623c83cddb62)

                                                              -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.dim_suppliers"} */
   2:
   3:
   4:  create or replace table `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    with
  10:    selected as (
  11:        select 
  12:          /*primary key*/
  13:            supplier_id
  14:            ,country
  15:            ,city	
  16:            ,fax	
  17:            ,postal_code
  18:            ,homepage
  19:            ,address	
  20:            ,region	
  21:
  22:        from `northwind1-313400`.`dbt_arthur`.`stg_suppliers`
  23:    )
  24:    , divisions as ( 
  25:        select *
  26:        from `northwind1-313400`.`dbt_arthur`.`seed2`
  27:    )
  28:    , transformed as (
  29:        select 
  30:        row_number() over (order by supplier_id) as supplier_sk
  31:        , suppliers.supplier_id
  32:            ,suppliers.country
  33:            ,suppliers.city	
  34:            ,suppliers.fax	
  35:            ,suppliers.postal_code
  36:            ,suppliers.homepage
  37:            ,suppliers.address	
  38:            ,suppliers.region
  39:            ,divisions.division
  40:            , case
  41:                when supplier.country = ('France', 'Germany') then 'Europe'
  42:                when supplier.country = ('USA', 'Canada') then 'North America'
  43:                when supplier.country = 'Brazil' then 'LATAM'
  44:                else 'Other'
  45:              end division 
  46:        from selected
  47:        left join divisions on suppliers.country = divisions.country
  48:    )
  49:
  50:select * from transformed
  51:  );
  52:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_suppliers (models\marts\dim_suppliers.sql)
  Unrecognized name: suppliers; Did you mean supplier_id? at [47:32]
  compiled SQL at target\run\northwind_shop\models\marts\dim_suppliers.sql
2021-05-15 22:55:34.288108 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '156d8b38-ea4f-463b-8332-f3d65e8a6b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA9F68A608>]}
2021-05-15 22:55:34.288108 (Thread-1): 19:55:34 | 1 of 1 ERROR creating table model dbt_arthur.dim_suppliers........... [ERROR in 4.01s]
2021-05-15 22:55:34.290052 (Thread-1): Finished running node model.northwind_shop.dim_suppliers
2021-05-15 22:55:34.313877 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 22:55:34.314927 (MainThread): 19:55:34 | 
2021-05-15 22:55:34.315865 (MainThread): 19:55:34 | Finished running 1 table model in 6.28s.
2021-05-15 22:55:34.315865 (MainThread): Connection 'master' was properly closed.
2021-05-15 22:55:34.315865 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 22:55:34.316858 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 22:55:34.316858 (MainThread): Connection 'model.northwind_shop.dim_suppliers' was properly closed.
2021-05-15 22:55:34.324872 (MainThread): 
2021-05-15 22:55:34.326131 (MainThread): Completed with 1 error and 0 warnings:
2021-05-15 22:55:34.327134 (MainThread): 
2021-05-15 22:55:34.327134 (MainThread): Database Error in model dim_suppliers (models\marts\dim_suppliers.sql)
2021-05-15 22:55:34.329125 (MainThread):   Unrecognized name: suppliers; Did you mean supplier_id? at [47:32]
2021-05-15 22:55:34.329125 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\dim_suppliers.sql
2021-05-15 22:55:34.330127 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-15 22:55:34.331152 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA9D465988>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA9B951C88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA9F59F0C8>]}
2021-05-15 22:55:34.331152 (MainThread): Flushing usage events
2021-05-15 22:57:05.757176 (MainThread): Running with dbt=0.19.1
2021-05-15 22:57:06.080045 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_suppliers'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 22:57:06.085542 (MainThread): Tracking: tracking
2021-05-15 22:57:06.086476 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBE7E33D08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBE7E33F08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBE7E36848>]}
2021-05-15 22:57:06.096487 (MainThread): Partial parsing not enabled
2021-05-15 22:57:06.098474 (MainThread): Parsing macros\adapters.sql
2021-05-15 22:57:06.118419 (MainThread): Parsing macros\catalog.sql
2021-05-15 22:57:06.124401 (MainThread): Parsing macros\etc.sql
2021-05-15 22:57:06.126394 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 22:57:06.132371 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 22:57:06.145371 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 22:57:06.148314 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 22:57:06.150323 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 22:57:06.161284 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 22:57:06.167266 (MainThread): Parsing macros\core.sql
2021-05-15 22:57:06.172249 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 22:57:06.219103 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 22:57:06.229060 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 22:57:06.230056 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 22:57:06.232050 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 22:57:06.234040 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 22:57:06.236035 (MainThread): Parsing macros\etc\query.sql
2021-05-15 22:57:06.237036 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 22:57:06.247993 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 22:57:06.262945 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 22:57:06.264947 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 22:57:06.271913 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 22:57:06.294848 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 22:57:06.330368 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 22:57:06.333344 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 22:57:06.350304 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 22:57:06.357283 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 22:57:06.363260 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 22:57:06.369253 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 22:57:06.372238 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 22:57:06.374229 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 22:57:06.376217 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 22:57:06.382200 (MainThread): Partial parsing not enabled
2021-05-15 22:57:06.405116 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 22:57:06.416078 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 22:57:06.420066 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 22:57:06.424073 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 22:57:06.429043 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 22:57:06.434036 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 22:57:06.440996 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 22:57:06.444989 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 22:57:06.448967 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 22:57:06.452953 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 22:57:06.457943 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 22:57:06.462873 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 22:57:06.466913 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 22:57:06.478867 (MainThread): Acquiring new bigquery connection "test.northwind_shop.test_sum_qty".
2021-05-15 22:57:06.618733 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbe7caf1-f65e-4383-ac75-f67145027f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBEBACEE48>]}
2021-05-15 22:57:06.661591 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbe7caf1-f65e-4383-ac75-f67145027f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBE9DCA0C8>]}
2021-05-15 22:57:06.661591 (MainThread): Found 13 models, 15 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 1 seed file, 7 sources, 0 exposures
2021-05-15 22:57:06.664644 (MainThread): 
2021-05-15 22:57:06.665675 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 22:57:06.667569 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 22:57:06.667569 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 22:57:07.785485 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 22:57:07.785485 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 22:57:07.793820 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 22:57:08.887851 (MainThread): 19:57:08 | Concurrency: 1 threads (target='dev')
2021-05-15 22:57:08.887851 (MainThread): 19:57:08 | 
2021-05-15 22:57:08.893678 (Thread-1): Began running node model.northwind_shop.dim_suppliers
2021-05-15 22:57:08.893678 (Thread-1): 19:57:08 | 1 of 1 START table model dbt_arthur.dim_suppliers.................... [RUN]
2021-05-15 22:57:08.893678 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 22:57:08.893678 (Thread-1): Compiling model.northwind_shop.dim_suppliers
2021-05-15 22:57:08.900126 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_suppliers"
2021-05-15 22:57:08.900126 (Thread-1): finished collecting timing info
2021-05-15 22:57:08.918946 (Thread-1): Opening a new connection, currently in state init
2021-05-15 22:57:08.928862 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 22:57:09.475920 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_suppliers"
2021-05-15 22:57:09.475920 (Thread-1): On model.northwind_shop.dim_suppliers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.dim_suppliers"} */


  create or replace table `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
  
  
  OPTIONS()
  as (
    with
    selected as (
        select 
          /*primary key*/
            supplier_id
            ,country
            ,city	
            ,fax	
            ,postal_code
            ,homepage
            ,address	
            ,region	

        from `northwind1-313400`.`dbt_arthur`.`stg_suppliers`
    )
    , divisions as ( 
        select *
        from `northwind1-313400`.`dbt_arthur`.`seed2`
    )
    , transformed as (
        select 
        row_number() over (order by supplier_id) as supplier_sk
        , suppliers.supplier_id
            ,suppliers.country
            ,suppliers.city	
            ,suppliers.fax	
            ,suppliers.postal_code
            ,suppliers.homepage
            ,suppliers.address	
            ,suppliers.region
            ,divisions.division
        from selected
        left join divisions on suppliers.country = divisions.country
    )

select * from transformed
  );
    
2021-05-15 22:57:10.520334 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/8185e950-dc04-4970-804c-d0710f50980d?maxResults=0&location=US&prettyPrint=false: Unrecognized name: suppliers; Did you mean supplier_id? at [41:32]')
2021-05-15 22:57:12.055087 (Thread-1): finished collecting timing info
2021-05-15 22:57:12.056084 (Thread-1): Database Error in model dim_suppliers (models\marts\dim_suppliers.sql)
  Unrecognized name: suppliers; Did you mean supplier_id? at [41:32]
  compiled SQL at target\run\northwind_shop\models\marts\dim_suppliers.sql
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/northwind1-313400/queries/ec8d132d-672d-48de-9627-220e77d0e795?maxResults=0&location=US&prettyPrint=false: Unrecognized name: suppliers; Did you mean supplier_id? at [41:32]

(job ID: ec8d132d-672d-48de-9627-220e77d0e795)

                                                              -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.dim_suppliers"} */
   2:
   3:
   4:  create or replace table `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    with
  10:    selected as (
  11:        select 
  12:          /*primary key*/
  13:            supplier_id
  14:            ,country
  15:            ,city	
  16:            ,fax	
  17:            ,postal_code
  18:            ,homepage
  19:            ,address	
  20:            ,region	
  21:
  22:        from `northwind1-313400`.`dbt_arthur`.`stg_suppliers`
  23:    )
  24:    , divisions as ( 
  25:        select *
  26:        from `northwind1-313400`.`dbt_arthur`.`seed2`
  27:    )
  28:    , transformed as (
  29:        select 
  30:        row_number() over (order by supplier_id) as supplier_sk
  31:        , suppliers.supplier_id
  32:            ,suppliers.country
  33:            ,suppliers.city	
  34:            ,suppliers.fax	
  35:            ,suppliers.postal_code
  36:            ,suppliers.homepage
  37:            ,suppliers.address	
  38:            ,suppliers.region
  39:            ,divisions.division
  40:        from selected
  41:        left join divisions on suppliers.country = divisions.country
  42:    )
  43:
  44:select * from transformed
  45:  );
  46:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_suppliers (models\marts\dim_suppliers.sql)
  Unrecognized name: suppliers; Did you mean supplier_id? at [41:32]
  compiled SQL at target\run\northwind_shop\models\marts\dim_suppliers.sql
2021-05-15 22:57:12.060069 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe7caf1-f65e-4383-ac75-f67145027f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBE7E04B48>]}
2021-05-15 22:57:12.060069 (Thread-1): 19:57:12 | 1 of 1 ERROR creating table model dbt_arthur.dim_suppliers........... [ERROR in 3.17s]
2021-05-15 22:57:12.061992 (Thread-1): Finished running node model.northwind_shop.dim_suppliers
2021-05-15 22:57:12.065958 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 22:57:12.066954 (MainThread): 19:57:12 | 
2021-05-15 22:57:12.066954 (MainThread): 19:57:12 | Finished running 1 table model in 5.40s.
2021-05-15 22:57:12.067951 (MainThread): Connection 'master' was properly closed.
2021-05-15 22:57:12.068714 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 22:57:12.068714 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 22:57:12.068714 (MainThread): Connection 'model.northwind_shop.dim_suppliers' was properly closed.
2021-05-15 22:57:12.076698 (MainThread): 
2021-05-15 22:57:12.077693 (MainThread): Completed with 1 error and 0 warnings:
2021-05-15 22:57:12.079710 (MainThread): 
2021-05-15 22:57:12.079710 (MainThread): Database Error in model dim_suppliers (models\marts\dim_suppliers.sql)
2021-05-15 22:57:12.080680 (MainThread):   Unrecognized name: suppliers; Did you mean supplier_id? at [41:32]
2021-05-15 22:57:12.081679 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\dim_suppliers.sql
2021-05-15 22:57:12.082291 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-15 22:57:12.082699 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBEBADF488>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBE7E04888>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBE7E03788>]}
2021-05-15 22:57:12.082699 (MainThread): Flushing usage events
2021-05-15 22:59:22.501122 (MainThread): Running with dbt=0.19.1
2021-05-15 22:59:22.807192 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_suppliers'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-15 22:59:22.808189 (MainThread): Tracking: tracking
2021-05-15 22:59:22.808189 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248EA6326C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248EA632A48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248EA6385C8>]}
2021-05-15 22:59:22.818169 (MainThread): Partial parsing not enabled
2021-05-15 22:59:22.819166 (MainThread): Parsing macros\adapters.sql
2021-05-15 22:59:22.837105 (MainThread): Parsing macros\catalog.sql
2021-05-15 22:59:22.843085 (MainThread): Parsing macros\etc.sql
2021-05-15 22:59:22.845079 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 22:59:22.849065 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 22:59:22.861025 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 22:59:22.864015 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 22:59:22.866009 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 22:59:22.874978 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 22:59:22.880959 (MainThread): Parsing macros\core.sql
2021-05-15 22:59:22.883949 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 22:59:22.926118 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 22:59:22.935088 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 22:59:22.936085 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 22:59:22.938078 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 22:59:22.940071 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 22:59:22.941068 (MainThread): Parsing macros\etc\query.sql
2021-05-15 22:59:22.942065 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 22:59:22.952031 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 22:59:22.965985 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 22:59:22.967978 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 22:59:22.973958 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 22:59:22.993891 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 22:59:23.027778 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 22:59:23.029771 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 22:59:23.047711 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 22:59:23.054688 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 22:59:23.059671 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 22:59:23.066648 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 22:59:23.069638 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 22:59:23.070635 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 22:59:23.072628 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 22:59:23.079605 (MainThread): Partial parsing not enabled
2021-05-15 22:59:23.101531 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 22:59:23.112495 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 22:59:23.116481 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 22:59:23.119471 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 22:59:23.123458 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 22:59:23.127445 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 22:59:23.133425 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 22:59:23.137411 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 22:59:23.141398 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 22:59:23.145385 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 22:59:23.149371 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 22:59:23.152361 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 22:59:23.157344 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 22:59:23.167311 (MainThread): Acquiring new bigquery connection "test.northwind_shop.test_sum_qty".
2021-05-15 22:59:23.309299 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a24adb6-d244-448a-bdcd-dcac2e3b1ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248EE320E48>]}
2021-05-15 22:59:23.367837 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a24adb6-d244-448a-bdcd-dcac2e3b1ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248EC60AC08>]}
2021-05-15 22:59:23.367837 (MainThread): Found 13 models, 15 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 1 seed file, 7 sources, 0 exposures
2021-05-15 22:59:23.370818 (MainThread): 
2021-05-15 22:59:23.370818 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 22:59:23.372822 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400".
2021-05-15 22:59:23.372822 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 22:59:24.044826 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 22:59:24.045325 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 22:59:24.052445 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 22:59:25.158024 (MainThread): 19:59:25 | Concurrency: 1 threads (target='dev')
2021-05-15 22:59:25.159019 (MainThread): 19:59:25 | 
2021-05-15 22:59:25.162237 (Thread-1): Began running node model.northwind_shop.dim_suppliers
2021-05-15 22:59:25.163237 (Thread-1): 19:59:25 | 1 of 1 START table model dbt_arthur.dim_suppliers.................... [RUN]
2021-05-15 22:59:25.163237 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 22:59:25.164256 (Thread-1): Compiling model.northwind_shop.dim_suppliers
2021-05-15 22:59:25.167806 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_suppliers"
2021-05-15 22:59:25.168812 (Thread-1): finished collecting timing info
2021-05-15 22:59:25.191729 (Thread-1): Opening a new connection, currently in state init
2021-05-15 22:59:25.197760 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 22:59:25.749367 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_suppliers"
2021-05-15 22:59:25.750366 (Thread-1): On model.northwind_shop.dim_suppliers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "node_id": "model.northwind_shop.dim_suppliers"} */


  create or replace table `northwind1-313400`.`dbt_arthur`.`dim_suppliers`
  
  
  OPTIONS()
  as (
    with
    suppliers as (
        select 
          /*primary key*/
            supplier_id
            ,country
            ,city	
            ,fax	
            ,postal_code
            ,homepage
            ,address	
            ,region	

        from `northwind1-313400`.`dbt_arthur`.`stg_suppliers`
    )
    , divisions as ( 
        select *
        from `northwind1-313400`.`dbt_arthur`.`seed2`
    )
    , transformed as (
        select 
        row_number() over (order by supplier_id) as supplier_sk
        , suppliers.supplier_id
            ,suppliers.country
            ,suppliers.city	
            ,suppliers.fax	
            ,suppliers.postal_code
            ,suppliers.homepage
            ,suppliers.address	
            ,suppliers.region
            ,divisions.division
        from suppliers
        left join divisions on suppliers.country = divisions.country
    )

select * from transformed
  );
    
2021-05-15 22:59:29.037763 (Thread-1): finished collecting timing info
2021-05-15 22:59:29.037763 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a24adb6-d244-448a-bdcd-dcac2e3b1ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248EA65A888>]}
2021-05-15 22:59:29.037763 (Thread-1): 19:59:29 | 1 of 1 OK created table model dbt_arthur.dim_suppliers............... [CREATE TABLE (29.0 rows, 2.4 KB processed) in 3.87s]
2021-05-15 22:59:29.039443 (Thread-1): Finished running node model.northwind_shop.dim_suppliers
2021-05-15 22:59:29.092211 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 22:59:29.093245 (MainThread): 19:59:29 | 
2021-05-15 22:59:29.093777 (MainThread): 19:59:29 | Finished running 1 table model in 5.72s.
2021-05-15 22:59:29.094780 (MainThread): Connection 'master' was properly closed.
2021-05-15 22:59:29.094780 (MainThread): Connection 'list_northwind1-313400' was properly closed.
2021-05-15 22:59:29.094780 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 22:59:29.094780 (MainThread): Connection 'model.northwind_shop.dim_suppliers' was properly closed.
2021-05-15 22:59:29.104752 (MainThread): 
2021-05-15 22:59:29.105435 (MainThread): Completed successfully
2021-05-15 22:59:29.106436 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-15 22:59:29.107452 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248EA64C108>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248EA5D6D88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248EA881348>]}
2021-05-15 22:59:29.108431 (MainThread): Flushing usage events
2021-05-15 23:06:36.113847 (MainThread): Running with dbt=0.19.1
2021-05-15 23:06:36.584252 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2021-05-15 23:06:36.585253 (MainThread): Tracking: tracking
2021-05-15 23:06:36.585253 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011B109FC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011B23EC88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011B23EBC8>]}
2021-05-15 23:06:36.603813 (MainThread): Partial parsing not enabled
2021-05-15 23:06:36.608699 (MainThread): Parsing macros\adapters.sql
2021-05-15 23:06:36.633614 (MainThread): Parsing macros\catalog.sql
2021-05-15 23:06:36.644199 (MainThread): Parsing macros\etc.sql
2021-05-15 23:06:36.649578 (MainThread): Parsing macros\materializations\copy.sql
2021-05-15 23:06:36.660771 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-15 23:06:36.676978 (MainThread): Parsing macros\materializations\seed.sql
2021-05-15 23:06:36.679968 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-15 23:06:36.681962 (MainThread): Parsing macros\materializations\table.sql
2021-05-15 23:06:36.698903 (MainThread): Parsing macros\materializations\view.sql
2021-05-15 23:06:36.707636 (MainThread): Parsing macros\core.sql
2021-05-15 23:06:36.712620 (MainThread): Parsing macros\adapters\common.sql
2021-05-15 23:06:36.768975 (MainThread): Parsing macros\etc\datetime.sql
2021-05-15 23:06:36.782554 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-15 23:06:36.783551 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-15 23:06:36.785544 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-15 23:06:36.788540 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-15 23:06:36.792532 (MainThread): Parsing macros\etc\query.sql
2021-05-15 23:06:36.794514 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-15 23:06:36.806002 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-15 23:06:36.826466 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-15 23:06:36.828458 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-15 23:06:36.835435 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-15 23:06:36.867444 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-15 23:06:36.912606 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-15 23:06:36.914599 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-15 23:06:36.942769 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-15 23:06:36.952097 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-15 23:06:36.962312 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-15 23:06:36.975286 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-15 23:06:36.979349 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-15 23:06:36.980346 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-15 23:06:36.983347 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-15 23:06:36.997646 (MainThread): Partial parsing not enabled
2021-05-15 23:06:37.031301 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 23:06:37.050449 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 23:06:37.063860 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 23:06:37.068849 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 23:06:37.078404 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 23:06:37.083382 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 23:06:37.093716 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 23:06:37.098704 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 23:06:37.103653 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 23:06:37.114122 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 23:06:37.122154 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 23:06:37.130433 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 23:06:37.134420 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 23:06:37.150371 (MainThread): Acquiring new bigquery connection "test.northwind_shop.test_sum_qty".
2021-05-15 23:06:37.362963 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1084e38-be57-4bed-ac2d-9d39c04bd303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011B2DD9C8>]}
2021-05-15 23:06:37.414784 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1084e38-be57-4bed-ac2d-9d39c04bd303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011D217C48>]}
2021-05-15 23:06:37.414784 (MainThread): Found 13 models, 15 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 1 seed file, 7 sources, 0 exposures
2021-05-15 23:06:37.418546 (MainThread): 
2021-05-15 23:06:37.418546 (MainThread): Acquiring new bigquery connection "master".
2021-05-15 23:06:37.424533 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_northwind1-313400_dbt_arthur".
2021-05-15 23:06:37.425469 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-15 23:06:37.430460 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-15 23:06:38.703217 (MainThread): 20:06:38 | Concurrency: 1 threads (target='dev')
2021-05-15 23:06:38.705450 (MainThread): 20:06:38 | 
2021-05-15 23:06:38.710624 (Thread-1): Began running node model.northwind_shop.stg_customers
2021-05-15 23:06:38.711264 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-05-15 23:06:38.711515 (Thread-1): Compiling model.northwind_shop.stg_customers
2021-05-15 23:06:38.715396 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_customers"
2021-05-15 23:06:38.717562 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.718059 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.718493 (Thread-1): Finished running node model.northwind_shop.stg_customers
2021-05-15 23:06:38.718585 (Thread-1): Began running node model.northwind_shop.stg_products
2021-05-15 23:06:38.719873 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-05-15 23:06:38.719873 (Thread-1): Compiling model.northwind_shop.stg_products
2021-05-15 23:06:38.726809 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_products"
2021-05-15 23:06:38.728286 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.728286 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.729095 (Thread-1): Finished running node model.northwind_shop.stg_products
2021-05-15 23:06:38.729592 (Thread-1): Began running node model.northwind_shop.stg_shippers
2021-05-15 23:06:38.730358 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-05-15 23:06:38.730509 (Thread-1): Compiling model.northwind_shop.stg_shippers
2021-05-15 23:06:38.733914 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_shippers"
2021-05-15 23:06:38.735403 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.735403 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.736819 (Thread-1): Finished running node model.northwind_shop.stg_shippers
2021-05-15 23:06:38.738136 (Thread-1): Began running node model.northwind_shop.stg_suppliers
2021-05-15 23:06:38.740841 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-05-15 23:06:38.740841 (Thread-1): Compiling model.northwind_shop.stg_suppliers
2021-05-15 23:06:38.744571 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_suppliers"
2021-05-15 23:06:38.746571 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.746571 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.746972 (Thread-1): Finished running node model.northwind_shop.stg_suppliers
2021-05-15 23:06:38.747470 (Thread-1): Began running node seed.northwind_shop.seed2
2021-05-15 23:06:38.747982 (Thread-1): Acquiring new bigquery connection "seed.northwind_shop.seed2".
2021-05-15 23:06:38.747982 (Thread-1): Compiling seed.northwind_shop.seed2
2021-05-15 23:06:38.749810 (Thread-1): Writing injected SQL for node "seed.northwind_shop.seed2"
2021-05-15 23:06:38.749810 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.749810 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.749810 (Thread-1): Finished running node seed.northwind_shop.seed2
2021-05-15 23:06:38.749810 (Thread-1): Began running node model.northwind_shop.stg_employees
2021-05-15 23:06:38.751117 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-05-15 23:06:38.751117 (Thread-1): Compiling model.northwind_shop.stg_employees
2021-05-15 23:06:38.756671 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_employees"
2021-05-15 23:06:38.759318 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.759318 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.759814 (Thread-1): Finished running node model.northwind_shop.stg_employees
2021-05-15 23:06:38.760370 (Thread-1): Began running node model.northwind_shop.stg_orderdetail
2021-05-15 23:06:38.761364 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_orderdetail".
2021-05-15 23:06:38.761364 (Thread-1): Compiling model.northwind_shop.stg_orderdetail
2021-05-15 23:06:38.764055 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_orderdetail"
2021-05-15 23:06:38.765203 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.765702 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.765702 (Thread-1): Finished running node model.northwind_shop.stg_orderdetail
2021-05-15 23:06:38.765702 (Thread-1): Began running node model.northwind_shop.stg_orders
2021-05-15 23:06:38.766785 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-05-15 23:06:38.767781 (Thread-1): Compiling model.northwind_shop.stg_orders
2021-05-15 23:06:38.773897 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_orders"
2021-05-15 23:06:38.776711 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.777351 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.777351 (Thread-1): Finished running node model.northwind_shop.stg_orders
2021-05-15 23:06:38.777849 (Thread-1): Began running node test.northwind_shop.source_not_null_northwind_etl_orders_order_id
2021-05-15 23:06:38.778344 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.source_not_null_northwind_etl_orders_order_id".
2021-05-15 23:06:38.778344 (Thread-1): Compiling test.northwind_shop.source_not_null_northwind_etl_orders_order_id
2021-05-15 23:06:38.791352 (Thread-1): Writing injected SQL for node "test.northwind_shop.source_not_null_northwind_etl_orders_order_id"
2021-05-15 23:06:38.794866 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.794866 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.794866 (Thread-1): Finished running node test.northwind_shop.source_not_null_northwind_etl_orders_order_id
2021-05-15 23:06:38.794866 (Thread-1): Began running node test.northwind_shop.source_unique_northwind_etl_orders_order_id
2021-05-15 23:06:38.796085 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.source_unique_northwind_etl_orders_order_id".
2021-05-15 23:06:38.796085 (Thread-1): Compiling test.northwind_shop.source_unique_northwind_etl_orders_order_id
2021-05-15 23:06:38.809916 (Thread-1): Writing injected SQL for node "test.northwind_shop.source_unique_northwind_etl_orders_order_id"
2021-05-15 23:06:38.811405 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.811901 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.812398 (Thread-1): Finished running node test.northwind_shop.source_unique_northwind_etl_orders_order_id
2021-05-15 23:06:38.812398 (Thread-1): Began running node model.northwind_shop.dim_customers
2021-05-15 23:06:38.812398 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-05-15 23:06:38.812398 (Thread-1): Compiling model.northwind_shop.dim_customers
2021-05-15 23:06:38.818356 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_customers"
2021-05-15 23:06:38.822282 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.822282 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.823767 (Thread-1): Finished running node model.northwind_shop.dim_customers
2021-05-15 23:06:38.823767 (Thread-1): Began running node model.northwind_shop.dim_products
2021-05-15 23:06:38.824778 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-05-15 23:06:38.824778 (Thread-1): Compiling model.northwind_shop.dim_products
2021-05-15 23:06:38.828684 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_products"
2021-05-15 23:06:38.830845 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.831340 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.832332 (Thread-1): Finished running node model.northwind_shop.dim_products
2021-05-15 23:06:38.832332 (Thread-1): Began running node model.northwind_shop.dim_shippers
2021-05-15 23:06:38.833326 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-05-15 23:06:38.833326 (Thread-1): Compiling model.northwind_shop.dim_shippers
2021-05-15 23:06:38.837457 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_shippers"
2021-05-15 23:06:38.841738 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.842235 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.842743 (Thread-1): Finished running node model.northwind_shop.dim_shippers
2021-05-15 23:06:38.842743 (Thread-1): Began running node model.northwind_shop.dim_suppliers
2021-05-15 23:06:38.843737 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-05-15 23:06:38.843737 (Thread-1): Compiling model.northwind_shop.dim_suppliers
2021-05-15 23:06:38.848338 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_suppliers"
2021-05-15 23:06:38.848338 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.849854 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.850554 (Thread-1): Finished running node model.northwind_shop.dim_suppliers
2021-05-15 23:06:38.850629 (Thread-1): Began running node model.northwind_shop.dim_employees
2021-05-15 23:06:38.851127 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-05-15 23:06:38.851689 (Thread-1): Compiling model.northwind_shop.dim_employees
2021-05-15 23:06:38.859518 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_employees"
2021-05-15 23:06:38.861199 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.861199 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.861199 (Thread-1): Finished running node model.northwind_shop.dim_employees
2021-05-15 23:06:38.862262 (Thread-1): Began running node test.northwind_shop.not_null_dim_customers_customer_sk
2021-05-15 23:06:38.862262 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.not_null_dim_customers_customer_sk".
2021-05-15 23:06:38.862262 (Thread-1): Compiling test.northwind_shop.not_null_dim_customers_customer_sk
2021-05-15 23:06:38.867373 (Thread-1): Writing injected SQL for node "test.northwind_shop.not_null_dim_customers_customer_sk"
2021-05-15 23:06:38.872522 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.873507 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.875154 (Thread-1): Finished running node test.northwind_shop.not_null_dim_customers_customer_sk
2021-05-15 23:06:38.875648 (Thread-1): Began running node test.northwind_shop.unique_dim_customers_customer_sk
2021-05-15 23:06:38.876388 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.unique_dim_customers_customer_sk".
2021-05-15 23:06:38.877265 (Thread-1): Compiling test.northwind_shop.unique_dim_customers_customer_sk
2021-05-15 23:06:38.881813 (Thread-1): Writing injected SQL for node "test.northwind_shop.unique_dim_customers_customer_sk"
2021-05-15 23:06:38.883257 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.883257 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.883257 (Thread-1): Finished running node test.northwind_shop.unique_dim_customers_customer_sk
2021-05-15 23:06:38.884264 (Thread-1): Began running node test.northwind_shop.not_null_dim_products_product_sk
2021-05-15 23:06:38.884837 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.not_null_dim_products_product_sk".
2021-05-15 23:06:38.884837 (Thread-1): Compiling test.northwind_shop.not_null_dim_products_product_sk
2021-05-15 23:06:38.894592 (Thread-1): Writing injected SQL for node "test.northwind_shop.not_null_dim_products_product_sk"
2021-05-15 23:06:38.896598 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.896598 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.897595 (Thread-1): Finished running node test.northwind_shop.not_null_dim_products_product_sk
2021-05-15 23:06:38.897595 (Thread-1): Began running node test.northwind_shop.unique_dim_products_product_sk
2021-05-15 23:06:38.898193 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.unique_dim_products_product_sk".
2021-05-15 23:06:38.898193 (Thread-1): Compiling test.northwind_shop.unique_dim_products_product_sk
2021-05-15 23:06:38.906043 (Thread-1): Writing injected SQL for node "test.northwind_shop.unique_dim_products_product_sk"
2021-05-15 23:06:38.909811 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.909811 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.911067 (Thread-1): Finished running node test.northwind_shop.unique_dim_products_product_sk
2021-05-15 23:06:38.911067 (Thread-1): Began running node test.northwind_shop.not_null_dim_shippers_shipper_sk
2021-05-15 23:06:38.911924 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.not_null_dim_shippers_shipper_sk".
2021-05-15 23:06:38.912145 (Thread-1): Compiling test.northwind_shop.not_null_dim_shippers_shipper_sk
2021-05-15 23:06:38.916449 (Thread-1): Writing injected SQL for node "test.northwind_shop.not_null_dim_shippers_shipper_sk"
2021-05-15 23:06:38.922971 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.923471 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.923965 (Thread-1): Finished running node test.northwind_shop.not_null_dim_shippers_shipper_sk
2021-05-15 23:06:38.923965 (Thread-1): Began running node test.northwind_shop.unique_dim_shippers_shipper_sk
2021-05-15 23:06:38.925975 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.unique_dim_shippers_shipper_sk".
2021-05-15 23:06:38.925975 (Thread-1): Compiling test.northwind_shop.unique_dim_shippers_shipper_sk
2021-05-15 23:06:38.931202 (Thread-1): Writing injected SQL for node "test.northwind_shop.unique_dim_shippers_shipper_sk"
2021-05-15 23:06:38.933169 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.933659 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.934172 (Thread-1): Finished running node test.northwind_shop.unique_dim_shippers_shipper_sk
2021-05-15 23:06:38.934172 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-05-15 23:06:38.935242 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-05-15 23:06:38.935740 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-05-15 23:06:38.946894 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-05-15 23:06:38.948390 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.948390 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.948390 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-05-15 23:06:38.948390 (Thread-1): Began running node test.northwind_shop.not_null_dim_suppliers_supplier_sk
2021-05-15 23:06:38.949709 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.not_null_dim_suppliers_supplier_sk".
2021-05-15 23:06:38.949709 (Thread-1): Compiling test.northwind_shop.not_null_dim_suppliers_supplier_sk
2021-05-15 23:06:38.958282 (Thread-1): Writing injected SQL for node "test.northwind_shop.not_null_dim_suppliers_supplier_sk"
2021-05-15 23:06:38.960270 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.960270 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.960270 (Thread-1): Finished running node test.northwind_shop.not_null_dim_suppliers_supplier_sk
2021-05-15 23:06:38.960270 (Thread-1): Began running node test.northwind_shop.unique_dim_suppliers_supplier_sk
2021-05-15 23:06:38.961279 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.unique_dim_suppliers_supplier_sk".
2021-05-15 23:06:38.961279 (Thread-1): Compiling test.northwind_shop.unique_dim_suppliers_supplier_sk
2021-05-15 23:06:38.965718 (Thread-1): Writing injected SQL for node "test.northwind_shop.unique_dim_suppliers_supplier_sk"
2021-05-15 23:06:38.967208 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.967735 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.967735 (Thread-1): Finished running node test.northwind_shop.unique_dim_suppliers_supplier_sk
2021-05-15 23:06:38.968233 (Thread-1): Began running node test.northwind_shop.not_null_fact_order_details_order_id
2021-05-15 23:06:38.969227 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.not_null_fact_order_details_order_id".
2021-05-15 23:06:38.969724 (Thread-1): Compiling test.northwind_shop.not_null_fact_order_details_order_id
2021-05-15 23:06:38.978295 (Thread-1): Writing injected SQL for node "test.northwind_shop.not_null_fact_order_details_order_id"
2021-05-15 23:06:38.980865 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.981069 (Thread-1): finished collecting timing info
2021-05-15 23:06:38.981565 (Thread-1): Finished running node test.northwind_shop.not_null_fact_order_details_order_id
2021-05-15 23:06:38.981565 (Thread-1): Began running node test.northwind_shop.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_
2021-05-15 23:06:38.982062 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_".
2021-05-15 23:06:38.982062 (Thread-1): Compiling test.northwind_shop.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_
2021-05-15 23:06:39.004427 (Thread-1): Writing injected SQL for node "test.northwind_shop.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_"
2021-05-15 23:06:39.008741 (Thread-1): finished collecting timing info
2021-05-15 23:06:39.008741 (Thread-1): finished collecting timing info
2021-05-15 23:06:39.008741 (Thread-1): Finished running node test.northwind_shop.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_
2021-05-15 23:06:39.008741 (Thread-1): Began running node test.northwind_shop.relationships_fact_order_details_product_fk__product_sk__ref_dim_products_
2021-05-15 23:06:39.009762 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.relationships_fact_order_details_product_fk__product_sk__ref_dim_products_".
2021-05-15 23:06:39.009762 (Thread-1): Compiling test.northwind_shop.relationships_fact_order_details_product_fk__product_sk__ref_dim_products_
2021-05-15 23:06:39.015729 (Thread-1): Writing injected SQL for node "test.northwind_shop.relationships_fact_order_details_product_fk__product_sk__ref_dim_products_"
2021-05-15 23:06:39.017732 (Thread-1): finished collecting timing info
2021-05-15 23:06:39.017732 (Thread-1): finished collecting timing info
2021-05-15 23:06:39.018313 (Thread-1): Finished running node test.northwind_shop.relationships_fact_order_details_product_fk__product_sk__ref_dim_products_
2021-05-15 23:06:39.018810 (Thread-1): Began running node test.northwind_shop.relationships_fact_order_details_shipper_fk__shipper_sk__ref_dim_shippers_
2021-05-15 23:06:39.019802 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.relationships_fact_order_details_shipper_fk__shipper_sk__ref_dim_shippers_".
2021-05-15 23:06:39.020306 (Thread-1): Compiling test.northwind_shop.relationships_fact_order_details_shipper_fk__shipper_sk__ref_dim_shippers_
2021-05-15 23:06:39.030029 (Thread-1): Writing injected SQL for node "test.northwind_shop.relationships_fact_order_details_shipper_fk__shipper_sk__ref_dim_shippers_"
2021-05-15 23:06:39.031646 (Thread-1): finished collecting timing info
2021-05-15 23:06:39.032128 (Thread-1): finished collecting timing info
2021-05-15 23:06:39.032128 (Thread-1): Finished running node test.northwind_shop.relationships_fact_order_details_shipper_fk__shipper_sk__ref_dim_shippers_
2021-05-15 23:06:39.032640 (Thread-1): Began running node test.northwind_shop.test_sum_qty
2021-05-15 23:06:39.032640 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.test_sum_qty".
2021-05-15 23:06:39.032640 (Thread-1): Compiling test.northwind_shop.test_sum_qty
2021-05-15 23:06:39.050152 (Thread-1): Writing injected SQL for node "test.northwind_shop.test_sum_qty"
2021-05-15 23:06:39.052465 (Thread-1): finished collecting timing info
2021-05-15 23:06:39.053199 (Thread-1): finished collecting timing info
2021-05-15 23:06:39.056889 (Thread-1): Finished running node test.northwind_shop.test_sum_qty
2021-05-15 23:06:39.139811 (MainThread): Connection 'master' was properly closed.
2021-05-15 23:06:39.140595 (MainThread): Connection 'list_northwind1-313400_dbt_arthur' was properly closed.
2021-05-15 23:06:39.140595 (MainThread): Connection 'test.northwind_shop.test_sum_qty' was properly closed.
2021-05-15 23:06:39.148373 (MainThread): 20:06:39 | Done.
2021-05-15 23:06:39.157073 (MainThread): Acquiring new bigquery connection "generate_catalog".
2021-05-15 23:06:39.157073 (MainThread): 20:06:39 | Building catalog
2021-05-15 23:06:39.161059 (MainThread): Opening a new connection, currently in state init
2021-05-15 23:06:40.274423 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "northwind1-313400.information_schema".
2021-05-15 23:06:40.292430 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-15 23:06:40.298405 (ThreadPoolExecutor-1_0): On northwind1-313400.information_schema: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "connection_name": "northwind1-313400.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `northwind1-313400`.`dbt_arthur`.__TABLES__
        where (upper(dataset_id) = upper('dbt_arthur'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `northwind1-313400`.`dbt_arthur`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `northwind1-313400`.`dbt_arthur`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
2021-05-15 23:06:44.339617 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "northwind1-313400.information_schema".
2021-05-15 23:06:44.341626 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-15 23:06:44.346537 (ThreadPoolExecutor-1_0): On northwind1-313400.information_schema: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "northwind_shop", "target_name": "dev", "connection_name": "northwind1-313400.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `northwind1-313400`.`northwind_etl`.__TABLES__
        where (upper(dataset_id) = upper('northwind_etl'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `northwind1-313400`.`northwind_etl`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `northwind1-313400`.`northwind_etl`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
2021-05-15 23:06:48.835467 (MainThread): 20:06:48 | Catalog written to C:\Users\arthu\tutorial-dbt\tutorial_dbt\target\catalog.json
2021-05-15 23:06:48.836524 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011B1F3C88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011B25E748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011B2EDF08>]}
2021-05-15 23:06:48.837463 (MainThread): Flushing usage events
2021-05-15 23:06:49.590132 (MainThread): Connection 'generate_catalog' was properly closed.
2021-05-15 23:06:49.591129 (MainThread): Connection 'northwind1-313400.information_schema' was properly closed.
2021-05-15 23:07:31.787237 (MainThread): Running with dbt=0.19.1
2021-05-15 23:07:32.343076 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='serve', write_json=True)
2021-05-15 23:07:32.343076 (MainThread): Tracking: tracking
2021-05-15 23:07:32.344049 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA417B0BC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA417B0D08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA417B4AC8>]}
2021-05-15 23:07:32.347043 (MainThread): Serving docs at 0.0.0.0:8080
2021-05-15 23:07:32.348035 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2021-05-15 23:07:32.348035 (MainThread): Press Ctrl+C to exit.


